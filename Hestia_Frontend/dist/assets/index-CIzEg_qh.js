function EV(e,g){for(var t=0;t<g.length;t++){const I=g[t];if(typeof I!="string"&&!Array.isArray(I)){for(const o in I)if(o!=="default"&&!(o in e)){const C=Object.getOwnPropertyDescriptor(I,o);C&&Object.defineProperty(e,o,C.get?C:{enumerable:!0,get:()=>I[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))I(o);new MutationObserver(o=>{for(const C of o)if(C.type==="childList")for(const s of C.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&I(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const C={};return o.integrity&&(C.integrity=o.integrity),o.referrerPolicy&&(C.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?C.credentials="include":o.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function I(o){if(o.ep)return;o.ep=!0;const C=t(o);fetch(o.href,C)}})();function BA(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Nc={exports:{}},To={},xc={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kp;function zV(){if(Kp)return Ue;Kp=1;var e=Symbol.for("react.element"),g=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),s=Symbol.for("react.context"),r=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),m=Symbol.iterator;function Z(H){return H===null||typeof H!="object"?null:(H=m&&H[m]||H["@@iterator"],typeof H=="function"?H:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,B={};function f(H,M,te){this.props=H,this.context=M,this.refs=B,this.updater=te||y}f.prototype.isReactComponent={},f.prototype.setState=function(H,M){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,M,"setState")},f.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function W(){}W.prototype=f.prototype;function v(H,M,te){this.props=H,this.context=M,this.refs=B,this.updater=te||y}var R=v.prototype=new W;R.constructor=v,G(R,f.prototype),R.isPureReactComponent=!0;var k=Array.isArray,J=Object.prototype.hasOwnProperty,F={current:null},U={key:!0,ref:!0,__self:!0,__source:!0};function X(H,M,te){var oe,ne={},ae=null,re=null;if(M!=null)for(oe in M.ref!==void 0&&(re=M.ref),M.key!==void 0&&(ae=""+M.key),M)J.call(M,oe)&&!U.hasOwnProperty(oe)&&(ne[oe]=M[oe]);var Ge=arguments.length-2;if(Ge===1)ne.children=te;else if(1<Ge){for(var ue=Array(Ge),Ae=0;Ae<Ge;Ae++)ue[Ae]=arguments[Ae+2];ne.children=ue}if(H&&H.defaultProps)for(oe in Ge=H.defaultProps,Ge)ne[oe]===void 0&&(ne[oe]=Ge[oe]);return{$$typeof:e,type:H,key:ae,ref:re,props:ne,_owner:F.current}}function K(H,M){return{$$typeof:e,type:H.type,key:M,ref:H.ref,props:H.props,_owner:H._owner}}function w(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function D(H){var M={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(te){return M[te]})}var V=/\/+/g;function z(H,M){return typeof H=="object"&&H!==null&&H.key!=null?D(""+H.key):M.toString(36)}function N(H,M,te,oe,ne){var ae=typeof H;(ae==="undefined"||ae==="boolean")&&(H=null);var re=!1;if(H===null)re=!0;else switch(ae){case"string":case"number":re=!0;break;case"object":switch(H.$$typeof){case e:case g:re=!0}}if(re)return re=H,ne=ne(re),H=oe===""?"."+z(re,0):oe,k(ne)?(te="",H!=null&&(te=H.replace(V,"$&/")+"/"),N(ne,M,te,"",function(Ae){return Ae})):ne!=null&&(w(ne)&&(ne=K(ne,te+(!ne.key||re&&re.key===ne.key?"":(""+ne.key).replace(V,"$&/")+"/")+H)),M.push(ne)),1;if(re=0,oe=oe===""?".":oe+":",k(H))for(var Ge=0;Ge<H.length;Ge++){ae=H[Ge];var ue=oe+z(ae,Ge);re+=N(ae,M,te,ue,ne)}else if(ue=Z(H),typeof ue=="function")for(H=ue.call(H),Ge=0;!(ae=H.next()).done;)ae=ae.value,ue=oe+z(ae,Ge++),re+=N(ae,M,te,ue,ne);else if(ae==="object")throw M=String(H),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.");return re}function L(H,M,te){if(H==null)return H;var oe=[],ne=0;return N(H,oe,"","",function(ae){return M.call(te,ae,ne++)}),oe}function Q(H){if(H._status===-1){var M=H._result;M=M(),M.then(function(te){(H._status===0||H._status===-1)&&(H._status=1,H._result=te)},function(te){(H._status===0||H._status===-1)&&(H._status=2,H._result=te)}),H._status===-1&&(H._status=0,H._result=M)}if(H._status===1)return H._result.default;throw H._result}var q={current:null},j={transition:null},P={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:j,ReactCurrentOwner:F};function $(){throw Error("act(...) is not supported in production builds of React.")}return Ue.Children={map:L,forEach:function(H,M,te){L(H,function(){M.apply(this,arguments)},te)},count:function(H){var M=0;return L(H,function(){M++}),M},toArray:function(H){return L(H,function(M){return M})||[]},only:function(H){if(!w(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Ue.Component=f,Ue.Fragment=t,Ue.Profiler=o,Ue.PureComponent=v,Ue.StrictMode=I,Ue.Suspense=c,Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,Ue.act=$,Ue.cloneElement=function(H,M,te){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var oe=G({},H.props),ne=H.key,ae=H.ref,re=H._owner;if(M!=null){if(M.ref!==void 0&&(ae=M.ref,re=F.current),M.key!==void 0&&(ne=""+M.key),H.type&&H.type.defaultProps)var Ge=H.type.defaultProps;for(ue in M)J.call(M,ue)&&!U.hasOwnProperty(ue)&&(oe[ue]=M[ue]===void 0&&Ge!==void 0?Ge[ue]:M[ue])}var ue=arguments.length-2;if(ue===1)oe.children=te;else if(1<ue){Ge=Array(ue);for(var Ae=0;Ae<ue;Ae++)Ge[Ae]=arguments[Ae+2];oe.children=Ge}return{$$typeof:e,type:H.type,key:ne,ref:ae,props:oe,_owner:re}},Ue.createContext=function(H){return H={$$typeof:s,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:C,_context:H},H.Consumer=H},Ue.createElement=X,Ue.createFactory=function(H){var M=X.bind(null,H);return M.type=H,M},Ue.createRef=function(){return{current:null}},Ue.forwardRef=function(H){return{$$typeof:r,render:H}},Ue.isValidElement=w,Ue.lazy=function(H){return{$$typeof:A,_payload:{_status:-1,_result:H},_init:Q}},Ue.memo=function(H,M){return{$$typeof:d,type:H,compare:M===void 0?null:M}},Ue.startTransition=function(H){var M=j.transition;j.transition={};try{H()}finally{j.transition=M}},Ue.unstable_act=$,Ue.useCallback=function(H,M){return q.current.useCallback(H,M)},Ue.useContext=function(H){return q.current.useContext(H)},Ue.useDebugValue=function(){},Ue.useDeferredValue=function(H){return q.current.useDeferredValue(H)},Ue.useEffect=function(H,M){return q.current.useEffect(H,M)},Ue.useId=function(){return q.current.useId()},Ue.useImperativeHandle=function(H,M,te){return q.current.useImperativeHandle(H,M,te)},Ue.useInsertionEffect=function(H,M){return q.current.useInsertionEffect(H,M)},Ue.useLayoutEffect=function(H,M){return q.current.useLayoutEffect(H,M)},Ue.useMemo=function(H,M){return q.current.useMemo(H,M)},Ue.useReducer=function(H,M,te){return q.current.useReducer(H,M,te)},Ue.useRef=function(H){return q.current.useRef(H)},Ue.useState=function(H){return q.current.useState(H)},Ue.useSyncExternalStore=function(H,M,te){return q.current.useSyncExternalStore(H,M,te)},Ue.useTransition=function(){return q.current.useTransition()},Ue.version="18.3.1",Ue}var Np;function Cr(){return Np||(Np=1,xc.exports=zV()),xc.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xp;function MV(){if(xp)return To;xp=1;var e=Cr(),g=Symbol.for("react.element"),t=Symbol.for("react.fragment"),I=Object.prototype.hasOwnProperty,o=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,C={key:!0,ref:!0,__self:!0,__source:!0};function s(r,c,d){var A,m={},Z=null,y=null;d!==void 0&&(Z=""+d),c.key!==void 0&&(Z=""+c.key),c.ref!==void 0&&(y=c.ref);for(A in c)I.call(c,A)&&!C.hasOwnProperty(A)&&(m[A]=c[A]);if(r&&r.defaultProps)for(A in c=r.defaultProps,c)m[A]===void 0&&(m[A]=c[A]);return{$$typeof:g,type:r,key:Z,ref:y,props:m,_owner:o.current}}return To.Fragment=t,To.jsx=s,To.jsxs=s,To}var Ep;function UV(){return Ep||(Ep=1,Nc.exports=MV()),Nc.exports}var p=UV(),b=Cr();const tn=BA(b),fd=EV({__proto__:null,default:tn},[b]);var Cs={},Ec={exports:{}},mt={},zc={exports:{}},Mc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zp;function LV(){return zp||(zp=1,function(e){function g(j,P){var $=j.length;j.push(P);e:for(;0<$;){var H=$-1>>>1,M=j[H];if(0<o(M,P))j[H]=P,j[$]=M,$=H;else break e}}function t(j){return j.length===0?null:j[0]}function I(j){if(j.length===0)return null;var P=j[0],$=j.pop();if($!==P){j[0]=$;e:for(var H=0,M=j.length,te=M>>>1;H<te;){var oe=2*(H+1)-1,ne=j[oe],ae=oe+1,re=j[ae];if(0>o(ne,$))ae<M&&0>o(re,ne)?(j[H]=re,j[ae]=$,H=ae):(j[H]=ne,j[oe]=$,H=oe);else if(ae<M&&0>o(re,$))j[H]=re,j[ae]=$,H=ae;else break e}}return P}function o(j,P){var $=j.sortIndex-P.sortIndex;return $!==0?$:j.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var C=performance;e.unstable_now=function(){return C.now()}}else{var s=Date,r=s.now();e.unstable_now=function(){return s.now()-r}}var c=[],d=[],A=1,m=null,Z=3,y=!1,G=!1,B=!1,f=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(j){for(var P=t(d);P!==null;){if(P.callback===null)I(d);else if(P.startTime<=j)I(d),P.sortIndex=P.expirationTime,g(c,P);else break;P=t(d)}}function k(j){if(B=!1,R(j),!G)if(t(c)!==null)G=!0,Q(J);else{var P=t(d);P!==null&&q(k,P.startTime-j)}}function J(j,P){G=!1,B&&(B=!1,W(X),X=-1),y=!0;var $=Z;try{for(R(P),m=t(c);m!==null&&(!(m.expirationTime>P)||j&&!D());){var H=m.callback;if(typeof H=="function"){m.callback=null,Z=m.priorityLevel;var M=H(m.expirationTime<=P);P=e.unstable_now(),typeof M=="function"?m.callback=M:m===t(c)&&I(c),R(P)}else I(c);m=t(c)}if(m!==null)var te=!0;else{var oe=t(d);oe!==null&&q(k,oe.startTime-P),te=!1}return te}finally{m=null,Z=$,y=!1}}var F=!1,U=null,X=-1,K=5,w=-1;function D(){return!(e.unstable_now()-w<K)}function V(){if(U!==null){var j=e.unstable_now();w=j;var P=!0;try{P=U(!0,j)}finally{P?z():(F=!1,U=null)}}else F=!1}var z;if(typeof v=="function")z=function(){v(V)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,L=N.port2;N.port1.onmessage=V,z=function(){L.postMessage(null)}}else z=function(){f(V,0)};function Q(j){U=j,F||(F=!0,z())}function q(j,P){X=f(function(){j(e.unstable_now())},P)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(j){j.callback=null},e.unstable_continueExecution=function(){G||y||(G=!0,Q(J))},e.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<j?Math.floor(1e3/j):5},e.unstable_getCurrentPriorityLevel=function(){return Z},e.unstable_getFirstCallbackNode=function(){return t(c)},e.unstable_next=function(j){switch(Z){case 1:case 2:case 3:var P=3;break;default:P=Z}var $=Z;Z=P;try{return j()}finally{Z=$}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(j,P){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var $=Z;Z=j;try{return P()}finally{Z=$}},e.unstable_scheduleCallback=function(j,P,$){var H=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?H+$:H):$=H,j){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=$+M,j={id:A++,callback:P,priorityLevel:j,startTime:$,expirationTime:M,sortIndex:-1},$>H?(j.sortIndex=$,g(d,j),t(c)===null&&j===t(d)&&(B?(W(X),X=-1):B=!0,q(k,$-H))):(j.sortIndex=M,g(c,j),G||y||(G=!0,Q(J))),j},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(j){var P=Z;return function(){var $=Z;Z=P;try{return j.apply(this,arguments)}finally{Z=$}}}}(Mc)),Mc}var Mp;function TV(){return Mp||(Mp=1,zc.exports=LV()),zc.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Up;function QV(){if(Up)return mt;Up=1;var e=Cr(),g=TV();function t(n){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+n,i=1;i<arguments.length;i++)l+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+n+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var I=new Set,o={};function C(n,l){s(n,l),s(n+"Capture",l)}function s(n,l){for(o[n]=l,n=0;n<l.length;n++)I.add(l[n])}var r=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A={},m={};function Z(n){return c.call(m,n)?!0:c.call(A,n)?!1:d.test(n)?m[n]=!0:(A[n]=!0,!1)}function y(n,l,i,a){if(i!==null&&i.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return a?!1:i!==null?!i.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function G(n,l,i,a){if(l===null||typeof l>"u"||y(n,l,i,a))return!0;if(a)return!1;if(i!==null)switch(i.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function B(n,l,i,a,u,h,S){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=a,this.attributeNamespace=u,this.mustUseProperty=i,this.propertyName=n,this.type=l,this.sanitizeURL=h,this.removeEmptyString=S}var f={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){f[n]=new B(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var l=n[0];f[l]=new B(l,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){f[n]=new B(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){f[n]=new B(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){f[n]=new B(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){f[n]=new B(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){f[n]=new B(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){f[n]=new B(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){f[n]=new B(n,5,!1,n.toLowerCase(),null,!1,!1)});var W=/[\-:]([a-z])/g;function v(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var l=n.replace(W,v);f[l]=new B(l,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var l=n.replace(W,v);f[l]=new B(l,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var l=n.replace(W,v);f[l]=new B(l,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){f[n]=new B(n,1,!1,n.toLowerCase(),null,!1,!1)}),f.xlinkHref=new B("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){f[n]=new B(n,1,!1,n.toLowerCase(),null,!0,!0)});function R(n,l,i,a){var u=f.hasOwnProperty(l)?f[l]:null;(u!==null?u.type!==0:a||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(G(l,i,u,a)&&(i=null),a||u===null?Z(l)&&(i===null?n.removeAttribute(l):n.setAttribute(l,""+i)):u.mustUseProperty?n[u.propertyName]=i===null?u.type===3?!1:"":i:(l=u.attributeName,a=u.attributeNamespace,i===null?n.removeAttribute(l):(u=u.type,i=u===3||u===4&&i===!0?"":""+i,a?n.setAttributeNS(a,l,i):n.setAttribute(l,i))))}var k=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,J=Symbol.for("react.element"),F=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),X=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),D=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),j=Symbol.iterator;function P(n){return n===null||typeof n!="object"?null:(n=j&&n[j]||n["@@iterator"],typeof n=="function"?n:null)}var $=Object.assign,H;function M(n){if(H===void 0)try{throw Error()}catch(i){var l=i.stack.trim().match(/\n( *(at )?)/);H=l&&l[1]||""}return`
`+H+n}var te=!1;function oe(n,l){if(!n||te)return"";te=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(_){var a=_}Reflect.construct(n,[],l)}else{try{l.call()}catch(_){a=_}n.call(l.prototype)}else{try{throw Error()}catch(_){a=_}n()}}catch(_){if(_&&a&&typeof _.stack=="string"){for(var u=_.stack.split(`
`),h=a.stack.split(`
`),S=u.length-1,Y=h.length-1;1<=S&&0<=Y&&u[S]!==h[Y];)Y--;for(;1<=S&&0<=Y;S--,Y--)if(u[S]!==h[Y]){if(S!==1||Y!==1)do if(S--,Y--,0>Y||u[S]!==h[Y]){var x=`
`+u[S].replace(" at new "," at ");return n.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",n.displayName)),x}while(1<=S&&0<=Y);break}}}finally{te=!1,Error.prepareStackTrace=i}return(n=n?n.displayName||n.name:"")?M(n):""}function ne(n){switch(n.tag){case 5:return M(n.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return n=oe(n.type,!1),n;case 11:return n=oe(n.type.render,!1),n;case 1:return n=oe(n.type,!0),n;default:return""}}function ae(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case U:return"Fragment";case F:return"Portal";case K:return"Profiler";case X:return"StrictMode";case z:return"Suspense";case N:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case D:return(n.displayName||"Context")+".Consumer";case w:return(n._context.displayName||"Context")+".Provider";case V:var l=n.render;return n=n.displayName,n||(n=l.displayName||l.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case L:return l=n.displayName||null,l!==null?l:ae(n.type)||"Memo";case Q:l=n._payload,n=n._init;try{return ae(n(l))}catch{}}return null}function re(n){var l=n.type;switch(n.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=l.render,n=n.displayName||n.name||"",l.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(l);case 8:return l===X?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Ge(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ue(n){var l=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ae(n){var l=ue(n)?"checked":"value",i=Object.getOwnPropertyDescriptor(n.constructor.prototype,l),a=""+n[l];if(!n.hasOwnProperty(l)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var u=i.get,h=i.set;return Object.defineProperty(n,l,{configurable:!0,get:function(){return u.call(this)},set:function(S){a=""+S,h.call(this,S)}}),Object.defineProperty(n,l,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(S){a=""+S},stopTracking:function(){n._valueTracker=null,delete n[l]}}}}function ce(n){n._valueTracker||(n._valueTracker=Ae(n))}function me(n){if(!n)return!1;var l=n._valueTracker;if(!l)return!0;var i=l.getValue(),a="";return n&&(a=ue(n)?n.checked?"true":"false":n.value),n=a,n!==i?(l.setValue(n),!0):!1}function Ke(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ye(n,l){var i=l.checked;return $({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??n._wrapperState.initialChecked})}function xe(n,l){var i=l.defaultValue==null?"":l.defaultValue,a=l.checked!=null?l.checked:l.defaultChecked;i=Ge(l.value!=null?l.value:i),n._wrapperState={initialChecked:a,initialValue:i,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function Qe(n,l){l=l.checked,l!=null&&R(n,"checked",l,!1)}function ye(n,l){Qe(n,l);var i=Ge(l.value),a=l.type;if(i!=null)a==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+i):n.value!==""+i&&(n.value=""+i);else if(a==="submit"||a==="reset"){n.removeAttribute("value");return}l.hasOwnProperty("value")?be(n,l.type,i):l.hasOwnProperty("defaultValue")&&be(n,l.type,Ge(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(n.defaultChecked=!!l.defaultChecked)}function he(n,l,i){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var a=l.type;if(!(a!=="submit"&&a!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+n._wrapperState.initialValue,i||l===n.value||(n.value=l),n.defaultValue=l}i=n.name,i!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,i!==""&&(n.name=i)}function be(n,l,i){(l!=="number"||Ke(n.ownerDocument)!==n)&&(i==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+i&&(n.defaultValue=""+i))}var se=Array.isArray;function pe(n,l,i,a){if(n=n.options,l){l={};for(var u=0;u<i.length;u++)l["$"+i[u]]=!0;for(i=0;i<n.length;i++)u=l.hasOwnProperty("$"+n[i].value),n[i].selected!==u&&(n[i].selected=u),u&&a&&(n[i].defaultSelected=!0)}else{for(i=""+Ge(i),l=null,u=0;u<n.length;u++){if(n[u].value===i){n[u].selected=!0,a&&(n[u].defaultSelected=!0);return}l!==null||n[u].disabled||(l=n[u])}l!==null&&(l.selected=!0)}}function Ie(n,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return $({},l,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function ke(n,l){var i=l.value;if(i==null){if(i=l.children,l=l.defaultValue,i!=null){if(l!=null)throw Error(t(92));if(se(i)){if(1<i.length)throw Error(t(93));i=i[0]}l=i}l==null&&(l=""),i=l}n._wrapperState={initialValue:Ge(i)}}function He(n,l){var i=Ge(l.value),a=Ge(l.defaultValue);i!=null&&(i=""+i,i!==n.value&&(n.value=i),l.defaultValue==null&&n.defaultValue!==i&&(n.defaultValue=i)),a!=null&&(n.defaultValue=""+a)}function Me(n){var l=n.textContent;l===n._wrapperState.initialValue&&l!==""&&l!==null&&(n.value=l)}function gg(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yg(n,l){return n==null||n==="http://www.w3.org/1999/xhtml"?gg(l):n==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var jg,rt=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,i,a,u){MSApp.execUnsafeLocalFunction(function(){return n(l,i,a,u)})}:n}(function(n,l){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=l;else{for(jg=jg||document.createElement("div"),jg.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=jg.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;l.firstChild;)n.appendChild(l.firstChild)}});function rg(n,l){if(l){var i=n.firstChild;if(i&&i===n.lastChild&&i.nodeType===3){i.nodeValue=l;return}}n.textContent=l}var De={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ag=["Webkit","ms","Moz","O"];Object.keys(De).forEach(function(n){ag.forEach(function(l){l=l+n.charAt(0).toUpperCase()+n.substring(1),De[l]=De[n]})});function on(n,l,i){return l==null||typeof l=="boolean"||l===""?"":i||typeof l!="number"||l===0||De.hasOwnProperty(n)&&De[n]?(""+l).trim():l+"px"}function Dn(n,l){n=n.style;for(var i in l)if(l.hasOwnProperty(i)){var a=i.indexOf("--")===0,u=on(i,l[i],a);i==="float"&&(i="cssFloat"),a?n.setProperty(i,u):n[i]=u}}var Re=$({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function je(n,l){if(l){if(Re[n]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function pg(n,l){if(n.indexOf("-")===-1)return typeof l.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cn=null;function Il(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ea=null,ll=null,ol=null;function em(n){if(n=ko(n)){if(typeof ea!="function")throw Error(t(280));var l=n.stateNode;l&&(l=yi(l),ea(n.stateNode,n.type,l))}}function gm(n){ll?ol?ol.push(n):ol=[n]:ll=n}function tm(){if(ll){var n=ll,l=ol;if(ol=ll=null,em(n),l)for(n=0;n<l.length;n++)em(l[n])}}function nm(n,l){return n(l)}function Im(){}var ga=!1;function lm(n,l,i){if(ga)return n(l,i);ga=!0;try{return nm(n,l,i)}finally{ga=!1,(ll!==null||ol!==null)&&(Im(),tm())}}function io(n,l){var i=n.stateNode;if(i===null)return null;var a=yi(i);if(a===null)return null;i=a[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(n=n.type,a=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!a;break e;default:n=!1}if(n)return null;if(i&&typeof i!="function")throw Error(t(231,l,typeof i));return i}var ta=!1;if(r)try{var so={};Object.defineProperty(so,"passive",{get:function(){ta=!0}}),window.addEventListener("test",so,so),window.removeEventListener("test",so,so)}catch{ta=!1}function Qf(n,l,i,a,u,h,S,Y,x){var _=Array.prototype.slice.call(arguments,3);try{l.apply(i,_)}catch(Ce){this.onError(Ce)}}var ro=!1,ei=null,gi=!1,na=null,Df={onError:function(n){ro=!0,ei=n}};function jf(n,l,i,a,u,h,S,Y,x){ro=!1,ei=null,Qf.apply(Df,arguments)}function Pf(n,l,i,a,u,h,S,Y,x){if(jf.apply(this,arguments),ro){if(ro){var _=ei;ro=!1,ei=null}else throw Error(t(198));gi||(gi=!0,na=_)}}function BI(n){var l=n,i=n;if(n.alternate)for(;l.return;)l=l.return;else{n=l;do l=n,(l.flags&4098)!==0&&(i=l.return),n=l.return;while(n)}return l.tag===3?i:null}function om(n){if(n.tag===13){var l=n.memoizedState;if(l===null&&(n=n.alternate,n!==null&&(l=n.memoizedState)),l!==null)return l.dehydrated}return null}function Cm(n){if(BI(n)!==n)throw Error(t(188))}function Of(n){var l=n.alternate;if(!l){if(l=BI(n),l===null)throw Error(t(188));return l!==n?null:n}for(var i=n,a=l;;){var u=i.return;if(u===null)break;var h=u.alternate;if(h===null){if(a=u.return,a!==null){i=a;continue}break}if(u.child===h.child){for(h=u.child;h;){if(h===i)return Cm(u),n;if(h===a)return Cm(u),l;h=h.sibling}throw Error(t(188))}if(i.return!==a.return)i=u,a=h;else{for(var S=!1,Y=u.child;Y;){if(Y===i){S=!0,i=u,a=h;break}if(Y===a){S=!0,a=u,i=h;break}Y=Y.sibling}if(!S){for(Y=h.child;Y;){if(Y===i){S=!0,i=h,a=u;break}if(Y===a){S=!0,a=h,i=u;break}Y=Y.sibling}if(!S)throw Error(t(189))}}if(i.alternate!==a)throw Error(t(190))}if(i.tag!==3)throw Error(t(188));return i.stateNode.current===i?n:l}function im(n){return n=Of(n),n!==null?sm(n):null}function sm(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var l=sm(n);if(l!==null)return l;n=n.sibling}return null}var rm=g.unstable_scheduleCallback,am=g.unstable_cancelCallback,qf=g.unstable_shouldYield,_f=g.unstable_requestPaint,Rg=g.unstable_now,$f=g.unstable_getCurrentPriorityLevel,Ia=g.unstable_ImmediatePriority,cm=g.unstable_UserBlockingPriority,ti=g.unstable_NormalPriority,eS=g.unstable_LowPriority,dm=g.unstable_IdlePriority,ni=null,sn=null;function gS(n){if(sn&&typeof sn.onCommitFiberRoot=="function")try{sn.onCommitFiberRoot(ni,n,void 0,(n.current.flags&128)===128)}catch{}}var Qt=Math.clz32?Math.clz32:IS,tS=Math.log,nS=Math.LN2;function IS(n){return n>>>=0,n===0?32:31-(tS(n)/nS|0)|0}var Ii=64,li=4194304;function ao(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function oi(n,l){var i=n.pendingLanes;if(i===0)return 0;var a=0,u=n.suspendedLanes,h=n.pingedLanes,S=i&268435455;if(S!==0){var Y=S&~u;Y!==0?a=ao(Y):(h&=S,h!==0&&(a=ao(h)))}else S=i&~u,S!==0?a=ao(S):h!==0&&(a=ao(h));if(a===0)return 0;if(l!==0&&l!==a&&(l&u)===0&&(u=a&-a,h=l&-l,u>=h||u===16&&(h&4194240)!==0))return l;if((a&4)!==0&&(a|=i&16),l=n.entangledLanes,l!==0)for(n=n.entanglements,l&=a;0<l;)i=31-Qt(l),u=1<<i,a|=n[i],l&=~u;return a}function lS(n,l){switch(n){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oS(n,l){for(var i=n.suspendedLanes,a=n.pingedLanes,u=n.expirationTimes,h=n.pendingLanes;0<h;){var S=31-Qt(h),Y=1<<S,x=u[S];x===-1?((Y&i)===0||(Y&a)!==0)&&(u[S]=lS(Y,l)):x<=l&&(n.expiredLanes|=Y),h&=~Y}}function la(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Am(){var n=Ii;return Ii<<=1,(Ii&4194240)===0&&(Ii=64),n}function oa(n){for(var l=[],i=0;31>i;i++)l.push(n);return l}function co(n,l,i){n.pendingLanes|=l,l!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,l=31-Qt(l),n[l]=i}function CS(n,l){var i=n.pendingLanes&~l;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=l,n.mutableReadLanes&=l,n.entangledLanes&=l,l=n.entanglements;var a=n.eventTimes;for(n=n.expirationTimes;0<i;){var u=31-Qt(i),h=1<<u;l[u]=0,a[u]=-1,n[u]=-1,i&=~h}}function Ca(n,l){var i=n.entangledLanes|=l;for(n=n.entanglements;i;){var a=31-Qt(i),u=1<<a;u&l|n[a]&l&&(n[a]|=l),i&=~u}}var tg=0;function um(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var mm,ia,hm,pm,Zm,sa=!1,Ci=[],jn=null,Pn=null,On=null,Ao=new Map,uo=new Map,qn=[],iS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bm(n,l){switch(n){case"focusin":case"focusout":jn=null;break;case"dragenter":case"dragleave":Pn=null;break;case"mouseover":case"mouseout":On=null;break;case"pointerover":case"pointerout":Ao.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":uo.delete(l.pointerId)}}function mo(n,l,i,a,u,h){return n===null||n.nativeEvent!==h?(n={blockedOn:l,domEventName:i,eventSystemFlags:a,nativeEvent:h,targetContainers:[u]},l!==null&&(l=ko(l),l!==null&&ia(l)),n):(n.eventSystemFlags|=a,l=n.targetContainers,u!==null&&l.indexOf(u)===-1&&l.push(u),n)}function sS(n,l,i,a,u){switch(l){case"focusin":return jn=mo(jn,n,l,i,a,u),!0;case"dragenter":return Pn=mo(Pn,n,l,i,a,u),!0;case"mouseover":return On=mo(On,n,l,i,a,u),!0;case"pointerover":var h=u.pointerId;return Ao.set(h,mo(Ao.get(h)||null,n,l,i,a,u)),!0;case"gotpointercapture":return h=u.pointerId,uo.set(h,mo(uo.get(h)||null,n,l,i,a,u)),!0}return!1}function Gm(n){var l=fI(n.target);if(l!==null){var i=BI(l);if(i!==null){if(l=i.tag,l===13){if(l=om(i),l!==null){n.blockedOn=l,Zm(n.priority,function(){hm(i)});return}}else if(l===3&&i.stateNode.current.memoizedState.isDehydrated){n.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ii(n){if(n.blockedOn!==null)return!1;for(var l=n.targetContainers;0<l.length;){var i=aa(n.domEventName,n.eventSystemFlags,l[0],n.nativeEvent);if(i===null){i=n.nativeEvent;var a=new i.constructor(i.type,i);Cn=a,i.target.dispatchEvent(a),Cn=null}else return l=ko(i),l!==null&&ia(l),n.blockedOn=i,!1;l.shift()}return!0}function ym(n,l,i){ii(n)&&i.delete(l)}function rS(){sa=!1,jn!==null&&ii(jn)&&(jn=null),Pn!==null&&ii(Pn)&&(Pn=null),On!==null&&ii(On)&&(On=null),Ao.forEach(ym),uo.forEach(ym)}function ho(n,l){n.blockedOn===l&&(n.blockedOn=null,sa||(sa=!0,g.unstable_scheduleCallback(g.unstable_NormalPriority,rS)))}function po(n){function l(u){return ho(u,n)}if(0<Ci.length){ho(Ci[0],n);for(var i=1;i<Ci.length;i++){var a=Ci[i];a.blockedOn===n&&(a.blockedOn=null)}}for(jn!==null&&ho(jn,n),Pn!==null&&ho(Pn,n),On!==null&&ho(On,n),Ao.forEach(l),uo.forEach(l),i=0;i<qn.length;i++)a=qn[i],a.blockedOn===n&&(a.blockedOn=null);for(;0<qn.length&&(i=qn[0],i.blockedOn===null);)Gm(i),i.blockedOn===null&&qn.shift()}var Cl=k.ReactCurrentBatchConfig,si=!0;function aS(n,l,i,a){var u=tg,h=Cl.transition;Cl.transition=null;try{tg=1,ra(n,l,i,a)}finally{tg=u,Cl.transition=h}}function cS(n,l,i,a){var u=tg,h=Cl.transition;Cl.transition=null;try{tg=4,ra(n,l,i,a)}finally{tg=u,Cl.transition=h}}function ra(n,l,i,a){if(si){var u=aa(n,l,i,a);if(u===null)Ra(n,l,a,ri,i),bm(n,a);else if(sS(u,n,l,i,a))a.stopPropagation();else if(bm(n,a),l&4&&-1<iS.indexOf(n)){for(;u!==null;){var h=ko(u);if(h!==null&&mm(h),h=aa(n,l,i,a),h===null&&Ra(n,l,a,ri,i),h===u)break;u=h}u!==null&&a.stopPropagation()}else Ra(n,l,a,null,i)}}var ri=null;function aa(n,l,i,a){if(ri=null,n=Il(a),n=fI(n),n!==null)if(l=BI(n),l===null)n=null;else if(i=l.tag,i===13){if(n=om(l),n!==null)return n;n=null}else if(i===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;n=null}else l!==n&&(n=null);return ri=n,null}function Bm(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($f()){case Ia:return 1;case cm:return 4;case ti:case eS:return 16;case dm:return 536870912;default:return 16}default:return 16}}var _n=null,ca=null,ai=null;function fm(){if(ai)return ai;var n,l=ca,i=l.length,a,u="value"in _n?_n.value:_n.textContent,h=u.length;for(n=0;n<i&&l[n]===u[n];n++);var S=i-n;for(a=1;a<=S&&l[i-a]===u[h-a];a++);return ai=u.slice(n,1<a?1-a:void 0)}function ci(n){var l=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&l===13&&(n=13)):n=l,n===10&&(n=13),32<=n||n===13?n:0}function di(){return!0}function Sm(){return!1}function Bt(n){function l(i,a,u,h,S){this._reactName=i,this._targetInst=u,this.type=a,this.nativeEvent=h,this.target=S,this.currentTarget=null;for(var Y in n)n.hasOwnProperty(Y)&&(i=n[Y],this[Y]=i?i(h):h[Y]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?di:Sm,this.isPropagationStopped=Sm,this}return $(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=di)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=di)},persist:function(){},isPersistent:di}),l}var il={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},da=Bt(il),Zo=$({},il,{view:0,detail:0}),dS=Bt(Zo),Aa,ua,bo,Ai=$({},Zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ha,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==bo&&(bo&&n.type==="mousemove"?(Aa=n.screenX-bo.screenX,ua=n.screenY-bo.screenY):ua=Aa=0,bo=n),Aa)},movementY:function(n){return"movementY"in n?n.movementY:ua}}),Vm=Bt(Ai),AS=$({},Ai,{dataTransfer:0}),uS=Bt(AS),mS=$({},Zo,{relatedTarget:0}),ma=Bt(mS),hS=$({},il,{animationName:0,elapsedTime:0,pseudoElement:0}),pS=Bt(hS),ZS=$({},il,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),bS=Bt(ZS),GS=$({},il,{data:0}),Wm=Bt(GS),yS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function SS(n){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(n):(n=fS[n])?!!l[n]:!1}function ha(){return SS}var VS=$({},Zo,{key:function(n){if(n.key){var l=yS[n.key]||n.key;if(l!=="Unidentified")return l}return n.type==="keypress"?(n=ci(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?BS[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ha,charCode:function(n){return n.type==="keypress"?ci(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ci(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),WS=Bt(VS),RS=$({},Ai,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rm=Bt(RS),XS=$({},Zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ha}),kS=Bt(XS),JS=$({},il,{propertyName:0,elapsedTime:0,pseudoElement:0}),vS=Bt(JS),YS=$({},Ai,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),HS=Bt(YS),wS=[9,13,27,32],pa=r&&"CompositionEvent"in window,Go=null;r&&"documentMode"in document&&(Go=document.documentMode);var FS=r&&"TextEvent"in window&&!Go,Xm=r&&(!pa||Go&&8<Go&&11>=Go),km=" ",Jm=!1;function vm(n,l){switch(n){case"keyup":return wS.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ym(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var sl=!1;function KS(n,l){switch(n){case"compositionend":return Ym(l);case"keypress":return l.which!==32?null:(Jm=!0,km);case"textInput":return n=l.data,n===km&&Jm?null:n;default:return null}}function NS(n,l){if(sl)return n==="compositionend"||!pa&&vm(n,l)?(n=fm(),ai=ca=_n=null,sl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Xm&&l.locale!=="ko"?null:l.data;default:return null}}var xS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hm(n){var l=n&&n.nodeName&&n.nodeName.toLowerCase();return l==="input"?!!xS[n.type]:l==="textarea"}function wm(n,l,i,a){gm(a),l=Zi(l,"onChange"),0<l.length&&(i=new da("onChange","change",null,i,a),n.push({event:i,listeners:l}))}var yo=null,Bo=null;function ES(n){$m(n,0)}function ui(n){var l=Al(n);if(me(l))return n}function zS(n,l){if(n==="change")return l}var Fm=!1;if(r){var Za;if(r){var ba="oninput"in document;if(!ba){var Km=document.createElement("div");Km.setAttribute("oninput","return;"),ba=typeof Km.oninput=="function"}Za=ba}else Za=!1;Fm=Za&&(!document.documentMode||9<document.documentMode)}function Nm(){yo&&(yo.detachEvent("onpropertychange",xm),Bo=yo=null)}function xm(n){if(n.propertyName==="value"&&ui(Bo)){var l=[];wm(l,Bo,n,Il(n)),lm(ES,l)}}function MS(n,l,i){n==="focusin"?(Nm(),yo=l,Bo=i,yo.attachEvent("onpropertychange",xm)):n==="focusout"&&Nm()}function US(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return ui(Bo)}function LS(n,l){if(n==="click")return ui(l)}function TS(n,l){if(n==="input"||n==="change")return ui(l)}function QS(n,l){return n===l&&(n!==0||1/n===1/l)||n!==n&&l!==l}var Dt=typeof Object.is=="function"?Object.is:QS;function fo(n,l){if(Dt(n,l))return!0;if(typeof n!="object"||n===null||typeof l!="object"||l===null)return!1;var i=Object.keys(n),a=Object.keys(l);if(i.length!==a.length)return!1;for(a=0;a<i.length;a++){var u=i[a];if(!c.call(l,u)||!Dt(n[u],l[u]))return!1}return!0}function Em(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function zm(n,l){var i=Em(n);n=0;for(var a;i;){if(i.nodeType===3){if(a=n+i.textContent.length,n<=l&&a>=l)return{node:i,offset:l-n};n=a}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Em(i)}}function Mm(n,l){return n&&l?n===l?!0:n&&n.nodeType===3?!1:l&&l.nodeType===3?Mm(n,l.parentNode):"contains"in n?n.contains(l):n.compareDocumentPosition?!!(n.compareDocumentPosition(l)&16):!1:!1}function Um(){for(var n=window,l=Ke();l instanceof n.HTMLIFrameElement;){try{var i=typeof l.contentWindow.location.href=="string"}catch{i=!1}if(i)n=l.contentWindow;else break;l=Ke(n.document)}return l}function Ga(n){var l=n&&n.nodeName&&n.nodeName.toLowerCase();return l&&(l==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||l==="textarea"||n.contentEditable==="true")}function DS(n){var l=Um(),i=n.focusedElem,a=n.selectionRange;if(l!==i&&i&&i.ownerDocument&&Mm(i.ownerDocument.documentElement,i)){if(a!==null&&Ga(i)){if(l=a.start,n=a.end,n===void 0&&(n=l),"selectionStart"in i)i.selectionStart=l,i.selectionEnd=Math.min(n,i.value.length);else if(n=(l=i.ownerDocument||document)&&l.defaultView||window,n.getSelection){n=n.getSelection();var u=i.textContent.length,h=Math.min(a.start,u);a=a.end===void 0?h:Math.min(a.end,u),!n.extend&&h>a&&(u=a,a=h,h=u),u=zm(i,h);var S=zm(i,a);u&&S&&(n.rangeCount!==1||n.anchorNode!==u.node||n.anchorOffset!==u.offset||n.focusNode!==S.node||n.focusOffset!==S.offset)&&(l=l.createRange(),l.setStart(u.node,u.offset),n.removeAllRanges(),h>a?(n.addRange(l),n.extend(S.node,S.offset)):(l.setEnd(S.node,S.offset),n.addRange(l)))}}for(l=[],n=i;n=n.parentNode;)n.nodeType===1&&l.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<l.length;i++)n=l[i],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var jS=r&&"documentMode"in document&&11>=document.documentMode,rl=null,ya=null,So=null,Ba=!1;function Lm(n,l,i){var a=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Ba||rl==null||rl!==Ke(a)||(a=rl,"selectionStart"in a&&Ga(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),So&&fo(So,a)||(So=a,a=Zi(ya,"onSelect"),0<a.length&&(l=new da("onSelect","select",null,l,i),n.push({event:l,listeners:a}),l.target=rl)))}function mi(n,l){var i={};return i[n.toLowerCase()]=l.toLowerCase(),i["Webkit"+n]="webkit"+l,i["Moz"+n]="moz"+l,i}var al={animationend:mi("Animation","AnimationEnd"),animationiteration:mi("Animation","AnimationIteration"),animationstart:mi("Animation","AnimationStart"),transitionend:mi("Transition","TransitionEnd")},fa={},Tm={};r&&(Tm=document.createElement("div").style,"AnimationEvent"in window||(delete al.animationend.animation,delete al.animationiteration.animation,delete al.animationstart.animation),"TransitionEvent"in window||delete al.transitionend.transition);function hi(n){if(fa[n])return fa[n];if(!al[n])return n;var l=al[n],i;for(i in l)if(l.hasOwnProperty(i)&&i in Tm)return fa[n]=l[i];return n}var Qm=hi("animationend"),Dm=hi("animationiteration"),jm=hi("animationstart"),Pm=hi("transitionend"),Om=new Map,qm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $n(n,l){Om.set(n,l),C(l,[n])}for(var Sa=0;Sa<qm.length;Sa++){var Va=qm[Sa],PS=Va.toLowerCase(),OS=Va[0].toUpperCase()+Va.slice(1);$n(PS,"on"+OS)}$n(Qm,"onAnimationEnd"),$n(Dm,"onAnimationIteration"),$n(jm,"onAnimationStart"),$n("dblclick","onDoubleClick"),$n("focusin","onFocus"),$n("focusout","onBlur"),$n(Pm,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),C("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),C("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),C("onBeforeInput",["compositionend","keypress","textInput","paste"]),C("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),C("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),C("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vo));function _m(n,l,i){var a=n.type||"unknown-event";n.currentTarget=i,Pf(a,l,void 0,n),n.currentTarget=null}function $m(n,l){l=(l&4)!==0;for(var i=0;i<n.length;i++){var a=n[i],u=a.event;a=a.listeners;e:{var h=void 0;if(l)for(var S=a.length-1;0<=S;S--){var Y=a[S],x=Y.instance,_=Y.currentTarget;if(Y=Y.listener,x!==h&&u.isPropagationStopped())break e;_m(u,Y,_),h=x}else for(S=0;S<a.length;S++){if(Y=a[S],x=Y.instance,_=Y.currentTarget,Y=Y.listener,x!==h&&u.isPropagationStopped())break e;_m(u,Y,_),h=x}}}if(gi)throw n=na,gi=!1,na=null,n}function dg(n,l){var i=l[Ha];i===void 0&&(i=l[Ha]=new Set);var a=n+"__bubble";i.has(a)||(eh(l,n,2,!1),i.add(a))}function Wa(n,l,i){var a=0;l&&(a|=4),eh(i,n,a,l)}var pi="_reactListening"+Math.random().toString(36).slice(2);function Wo(n){if(!n[pi]){n[pi]=!0,I.forEach(function(i){i!=="selectionchange"&&(qS.has(i)||Wa(i,!1,n),Wa(i,!0,n))});var l=n.nodeType===9?n:n.ownerDocument;l===null||l[pi]||(l[pi]=!0,Wa("selectionchange",!1,l))}}function eh(n,l,i,a){switch(Bm(l)){case 1:var u=aS;break;case 4:u=cS;break;default:u=ra}i=u.bind(null,l,i,n),u=void 0,!ta||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(u=!0),a?u!==void 0?n.addEventListener(l,i,{capture:!0,passive:u}):n.addEventListener(l,i,!0):u!==void 0?n.addEventListener(l,i,{passive:u}):n.addEventListener(l,i,!1)}function Ra(n,l,i,a,u){var h=a;if((l&1)===0&&(l&2)===0&&a!==null)e:for(;;){if(a===null)return;var S=a.tag;if(S===3||S===4){var Y=a.stateNode.containerInfo;if(Y===u||Y.nodeType===8&&Y.parentNode===u)break;if(S===4)for(S=a.return;S!==null;){var x=S.tag;if((x===3||x===4)&&(x=S.stateNode.containerInfo,x===u||x.nodeType===8&&x.parentNode===u))return;S=S.return}for(;Y!==null;){if(S=fI(Y),S===null)return;if(x=S.tag,x===5||x===6){a=h=S;continue e}Y=Y.parentNode}}a=a.return}lm(function(){var _=h,Ce=Il(i),ie=[];e:{var le=Om.get(n);if(le!==void 0){var Ze=da,fe=n;switch(n){case"keypress":if(ci(i)===0)break e;case"keydown":case"keyup":Ze=WS;break;case"focusin":fe="focus",Ze=ma;break;case"focusout":fe="blur",Ze=ma;break;case"beforeblur":case"afterblur":Ze=ma;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Vm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=uS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=kS;break;case Qm:case Dm:case jm:Ze=pS;break;case Pm:Ze=vS;break;case"scroll":Ze=dS;break;case"wheel":Ze=HS;break;case"copy":case"cut":case"paste":Ze=bS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=Rm}var Se=(l&4)!==0,Xg=!Se&&n==="scroll",T=Se?le!==null?le+"Capture":null:le;Se=[];for(var E=_,O;E!==null;){O=E;var de=O.stateNode;if(O.tag===5&&de!==null&&(O=de,T!==null&&(de=io(E,T),de!=null&&Se.push(Ro(E,de,O)))),Xg)break;E=E.return}0<Se.length&&(le=new Ze(le,fe,null,i,Ce),ie.push({event:le,listeners:Se}))}}if((l&7)===0){e:{if(le=n==="mouseover"||n==="pointerover",Ze=n==="mouseout"||n==="pointerout",le&&i!==Cn&&(fe=i.relatedTarget||i.fromElement)&&(fI(fe)||fe[Rn]))break e;if((Ze||le)&&(le=Ce.window===Ce?Ce:(le=Ce.ownerDocument)?le.defaultView||le.parentWindow:window,Ze?(fe=i.relatedTarget||i.toElement,Ze=_,fe=fe?fI(fe):null,fe!==null&&(Xg=BI(fe),fe!==Xg||fe.tag!==5&&fe.tag!==6)&&(fe=null)):(Ze=null,fe=_),Ze!==fe)){if(Se=Vm,de="onMouseLeave",T="onMouseEnter",E="mouse",(n==="pointerout"||n==="pointerover")&&(Se=Rm,de="onPointerLeave",T="onPointerEnter",E="pointer"),Xg=Ze==null?le:Al(Ze),O=fe==null?le:Al(fe),le=new Se(de,E+"leave",Ze,i,Ce),le.target=Xg,le.relatedTarget=O,de=null,fI(Ce)===_&&(Se=new Se(T,E+"enter",fe,i,Ce),Se.target=O,Se.relatedTarget=Xg,de=Se),Xg=de,Ze&&fe)g:{for(Se=Ze,T=fe,E=0,O=Se;O;O=cl(O))E++;for(O=0,de=T;de;de=cl(de))O++;for(;0<E-O;)Se=cl(Se),E--;for(;0<O-E;)T=cl(T),O--;for(;E--;){if(Se===T||T!==null&&Se===T.alternate)break g;Se=cl(Se),T=cl(T)}Se=null}else Se=null;Ze!==null&&gh(ie,le,Ze,Se,!1),fe!==null&&Xg!==null&&gh(ie,Xg,fe,Se,!0)}}e:{if(le=_?Al(_):window,Ze=le.nodeName&&le.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&le.type==="file")var Ve=zS;else if(Hm(le))if(Fm)Ve=TS;else{Ve=US;var Je=MS}else(Ze=le.nodeName)&&Ze.toLowerCase()==="input"&&(le.type==="checkbox"||le.type==="radio")&&(Ve=LS);if(Ve&&(Ve=Ve(n,_))){wm(ie,Ve,i,Ce);break e}Je&&Je(n,le,_),n==="focusout"&&(Je=le._wrapperState)&&Je.controlled&&le.type==="number"&&be(le,"number",le.value)}switch(Je=_?Al(_):window,n){case"focusin":(Hm(Je)||Je.contentEditable==="true")&&(rl=Je,ya=_,So=null);break;case"focusout":So=ya=rl=null;break;case"mousedown":Ba=!0;break;case"contextmenu":case"mouseup":case"dragend":Ba=!1,Lm(ie,i,Ce);break;case"selectionchange":if(jS)break;case"keydown":case"keyup":Lm(ie,i,Ce)}var ve;if(pa)e:{switch(n){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else sl?vm(n,i)&&(Fe="onCompositionEnd"):n==="keydown"&&i.keyCode===229&&(Fe="onCompositionStart");Fe&&(Xm&&i.locale!=="ko"&&(sl||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&sl&&(ve=fm()):(_n=Ce,ca="value"in _n?_n.value:_n.textContent,sl=!0)),Je=Zi(_,Fe),0<Je.length&&(Fe=new Wm(Fe,n,null,i,Ce),ie.push({event:Fe,listeners:Je}),ve?Fe.data=ve:(ve=Ym(i),ve!==null&&(Fe.data=ve)))),(ve=FS?KS(n,i):NS(n,i))&&(_=Zi(_,"onBeforeInput"),0<_.length&&(Ce=new Wm("onBeforeInput","beforeinput",null,i,Ce),ie.push({event:Ce,listeners:_}),Ce.data=ve))}$m(ie,l)})}function Ro(n,l,i){return{instance:n,listener:l,currentTarget:i}}function Zi(n,l){for(var i=l+"Capture",a=[];n!==null;){var u=n,h=u.stateNode;u.tag===5&&h!==null&&(u=h,h=io(n,i),h!=null&&a.unshift(Ro(n,h,u)),h=io(n,l),h!=null&&a.push(Ro(n,h,u))),n=n.return}return a}function cl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function gh(n,l,i,a,u){for(var h=l._reactName,S=[];i!==null&&i!==a;){var Y=i,x=Y.alternate,_=Y.stateNode;if(x!==null&&x===a)break;Y.tag===5&&_!==null&&(Y=_,u?(x=io(i,h),x!=null&&S.unshift(Ro(i,x,Y))):u||(x=io(i,h),x!=null&&S.push(Ro(i,x,Y)))),i=i.return}S.length!==0&&n.push({event:l,listeners:S})}var _S=/\r\n?/g,$S=/\u0000|\uFFFD/g;function th(n){return(typeof n=="string"?n:""+n).replace(_S,`
`).replace($S,"")}function bi(n,l,i){if(l=th(l),th(n)!==l&&i)throw Error(t(425))}function Gi(){}var Xa=null,ka=null;function Ja(n,l){return n==="textarea"||n==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var va=typeof setTimeout=="function"?setTimeout:void 0,eV=typeof clearTimeout=="function"?clearTimeout:void 0,nh=typeof Promise=="function"?Promise:void 0,gV=typeof queueMicrotask=="function"?queueMicrotask:typeof nh<"u"?function(n){return nh.resolve(null).then(n).catch(tV)}:va;function tV(n){setTimeout(function(){throw n})}function Ya(n,l){var i=l,a=0;do{var u=i.nextSibling;if(n.removeChild(i),u&&u.nodeType===8)if(i=u.data,i==="/$"){if(a===0){n.removeChild(u),po(l);return}a--}else i!=="$"&&i!=="$?"&&i!=="$!"||a++;i=u}while(i);po(l)}function eI(n){for(;n!=null;n=n.nextSibling){var l=n.nodeType;if(l===1||l===3)break;if(l===8){if(l=n.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return n}function Ih(n){n=n.previousSibling;for(var l=0;n;){if(n.nodeType===8){var i=n.data;if(i==="$"||i==="$!"||i==="$?"){if(l===0)return n;l--}else i==="/$"&&l++}n=n.previousSibling}return null}var dl=Math.random().toString(36).slice(2),rn="__reactFiber$"+dl,Xo="__reactProps$"+dl,Rn="__reactContainer$"+dl,Ha="__reactEvents$"+dl,nV="__reactListeners$"+dl,IV="__reactHandles$"+dl;function fI(n){var l=n[rn];if(l)return l;for(var i=n.parentNode;i;){if(l=i[Rn]||i[rn]){if(i=l.alternate,l.child!==null||i!==null&&i.child!==null)for(n=Ih(n);n!==null;){if(i=n[rn])return i;n=Ih(n)}return l}n=i,i=n.parentNode}return null}function ko(n){return n=n[rn]||n[Rn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Al(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function yi(n){return n[Xo]||null}var wa=[],ul=-1;function gI(n){return{current:n}}function Ag(n){0>ul||(n.current=wa[ul],wa[ul]=null,ul--)}function cg(n,l){ul++,wa[ul]=n.current,n.current=l}var tI={},Pg=gI(tI),at=gI(!1),SI=tI;function ml(n,l){var i=n.type.contextTypes;if(!i)return tI;var a=n.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===l)return a.__reactInternalMemoizedMaskedChildContext;var u={},h;for(h in i)u[h]=l[h];return a&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=l,n.__reactInternalMemoizedMaskedChildContext=u),u}function ct(n){return n=n.childContextTypes,n!=null}function Bi(){Ag(at),Ag(Pg)}function lh(n,l,i){if(Pg.current!==tI)throw Error(t(168));cg(Pg,l),cg(at,i)}function oh(n,l,i){var a=n.stateNode;if(l=l.childContextTypes,typeof a.getChildContext!="function")return i;a=a.getChildContext();for(var u in a)if(!(u in l))throw Error(t(108,re(n)||"Unknown",u));return $({},i,a)}function fi(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||tI,SI=Pg.current,cg(Pg,n),cg(at,at.current),!0}function Ch(n,l,i){var a=n.stateNode;if(!a)throw Error(t(169));i?(n=oh(n,l,SI),a.__reactInternalMemoizedMergedChildContext=n,Ag(at),Ag(Pg),cg(Pg,n)):Ag(at),cg(at,i)}var Xn=null,Si=!1,Fa=!1;function ih(n){Xn===null?Xn=[n]:Xn.push(n)}function lV(n){Si=!0,ih(n)}function nI(){if(!Fa&&Xn!==null){Fa=!0;var n=0,l=tg;try{var i=Xn;for(tg=1;n<i.length;n++){var a=i[n];do a=a(!0);while(a!==null)}Xn=null,Si=!1}catch(u){throw Xn!==null&&(Xn=Xn.slice(n+1)),rm(Ia,nI),u}finally{tg=l,Fa=!1}}return null}var hl=[],pl=0,Vi=null,Wi=0,Jt=[],vt=0,VI=null,kn=1,Jn="";function WI(n,l){hl[pl++]=Wi,hl[pl++]=Vi,Vi=n,Wi=l}function sh(n,l,i){Jt[vt++]=kn,Jt[vt++]=Jn,Jt[vt++]=VI,VI=n;var a=kn;n=Jn;var u=32-Qt(a)-1;a&=~(1<<u),i+=1;var h=32-Qt(l)+u;if(30<h){var S=u-u%5;h=(a&(1<<S)-1).toString(32),a>>=S,u-=S,kn=1<<32-Qt(l)+u|i<<u|a,Jn=h+n}else kn=1<<h|i<<u|a,Jn=n}function Ka(n){n.return!==null&&(WI(n,1),sh(n,1,0))}function Na(n){for(;n===Vi;)Vi=hl[--pl],hl[pl]=null,Wi=hl[--pl],hl[pl]=null;for(;n===VI;)VI=Jt[--vt],Jt[vt]=null,Jn=Jt[--vt],Jt[vt]=null,kn=Jt[--vt],Jt[vt]=null}var ft=null,St=null,ug=!1,jt=null;function rh(n,l){var i=Ft(5,null,null,0);i.elementType="DELETED",i.stateNode=l,i.return=n,l=n.deletions,l===null?(n.deletions=[i],n.flags|=16):l.push(i)}function ah(n,l){switch(n.tag){case 5:var i=n.type;return l=l.nodeType!==1||i.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(n.stateNode=l,ft=n,St=eI(l.firstChild),!0):!1;case 6:return l=n.pendingProps===""||l.nodeType!==3?null:l,l!==null?(n.stateNode=l,ft=n,St=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(i=VI!==null?{id:kn,overflow:Jn}:null,n.memoizedState={dehydrated:l,treeContext:i,retryLane:1073741824},i=Ft(18,null,null,0),i.stateNode=l,i.return=n,n.child=i,ft=n,St=null,!0):!1;default:return!1}}function xa(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Ea(n){if(ug){var l=St;if(l){var i=l;if(!ah(n,l)){if(xa(n))throw Error(t(418));l=eI(i.nextSibling);var a=ft;l&&ah(n,l)?rh(a,i):(n.flags=n.flags&-4097|2,ug=!1,ft=n)}}else{if(xa(n))throw Error(t(418));n.flags=n.flags&-4097|2,ug=!1,ft=n}}}function ch(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ft=n}function Ri(n){if(n!==ft)return!1;if(!ug)return ch(n),ug=!0,!1;var l;if((l=n.tag!==3)&&!(l=n.tag!==5)&&(l=n.type,l=l!=="head"&&l!=="body"&&!Ja(n.type,n.memoizedProps)),l&&(l=St)){if(xa(n))throw dh(),Error(t(418));for(;l;)rh(n,l),l=eI(l.nextSibling)}if(ch(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,l=0;n;){if(n.nodeType===8){var i=n.data;if(i==="/$"){if(l===0){St=eI(n.nextSibling);break e}l--}else i!=="$"&&i!=="$!"&&i!=="$?"||l++}n=n.nextSibling}St=null}}else St=ft?eI(n.stateNode.nextSibling):null;return!0}function dh(){for(var n=St;n;)n=eI(n.nextSibling)}function Zl(){St=ft=null,ug=!1}function za(n){jt===null?jt=[n]:jt.push(n)}var oV=k.ReactCurrentBatchConfig;function Jo(n,l,i){if(n=i.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(t(309));var a=i.stateNode}if(!a)throw Error(t(147,n));var u=a,h=""+n;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===h?l.ref:(l=function(S){var Y=u.refs;S===null?delete Y[h]:Y[h]=S},l._stringRef=h,l)}if(typeof n!="string")throw Error(t(284));if(!i._owner)throw Error(t(290,n))}return n}function Xi(n,l){throw n=Object.prototype.toString.call(l),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":n))}function Ah(n){var l=n._init;return l(n._payload)}function uh(n){function l(T,E){if(n){var O=T.deletions;O===null?(T.deletions=[E],T.flags|=16):O.push(E)}}function i(T,E){if(!n)return null;for(;E!==null;)l(T,E),E=E.sibling;return null}function a(T,E){for(T=new Map;E!==null;)E.key!==null?T.set(E.key,E):T.set(E.index,E),E=E.sibling;return T}function u(T,E){return T=aI(T,E),T.index=0,T.sibling=null,T}function h(T,E,O){return T.index=O,n?(O=T.alternate,O!==null?(O=O.index,O<E?(T.flags|=2,E):O):(T.flags|=2,E)):(T.flags|=1048576,E)}function S(T){return n&&T.alternate===null&&(T.flags|=2),T}function Y(T,E,O,de){return E===null||E.tag!==6?(E=vc(O,T.mode,de),E.return=T,E):(E=u(E,O),E.return=T,E)}function x(T,E,O,de){var Ve=O.type;return Ve===U?Ce(T,E,O.props.children,de,O.key):E!==null&&(E.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===Q&&Ah(Ve)===E.type)?(de=u(E,O.props),de.ref=Jo(T,E,O),de.return=T,de):(de=$i(O.type,O.key,O.props,null,T.mode,de),de.ref=Jo(T,E,O),de.return=T,de)}function _(T,E,O,de){return E===null||E.tag!==4||E.stateNode.containerInfo!==O.containerInfo||E.stateNode.implementation!==O.implementation?(E=Yc(O,T.mode,de),E.return=T,E):(E=u(E,O.children||[]),E.return=T,E)}function Ce(T,E,O,de,Ve){return E===null||E.tag!==7?(E=wI(O,T.mode,de,Ve),E.return=T,E):(E=u(E,O),E.return=T,E)}function ie(T,E,O){if(typeof E=="string"&&E!==""||typeof E=="number")return E=vc(""+E,T.mode,O),E.return=T,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case J:return O=$i(E.type,E.key,E.props,null,T.mode,O),O.ref=Jo(T,null,E),O.return=T,O;case F:return E=Yc(E,T.mode,O),E.return=T,E;case Q:var de=E._init;return ie(T,de(E._payload),O)}if(se(E)||P(E))return E=wI(E,T.mode,O,null),E.return=T,E;Xi(T,E)}return null}function le(T,E,O,de){var Ve=E!==null?E.key:null;if(typeof O=="string"&&O!==""||typeof O=="number")return Ve!==null?null:Y(T,E,""+O,de);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case J:return O.key===Ve?x(T,E,O,de):null;case F:return O.key===Ve?_(T,E,O,de):null;case Q:return Ve=O._init,le(T,E,Ve(O._payload),de)}if(se(O)||P(O))return Ve!==null?null:Ce(T,E,O,de,null);Xi(T,O)}return null}function Ze(T,E,O,de,Ve){if(typeof de=="string"&&de!==""||typeof de=="number")return T=T.get(O)||null,Y(E,T,""+de,Ve);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case J:return T=T.get(de.key===null?O:de.key)||null,x(E,T,de,Ve);case F:return T=T.get(de.key===null?O:de.key)||null,_(E,T,de,Ve);case Q:var Je=de._init;return Ze(T,E,O,Je(de._payload),Ve)}if(se(de)||P(de))return T=T.get(O)||null,Ce(E,T,de,Ve,null);Xi(E,de)}return null}function fe(T,E,O,de){for(var Ve=null,Je=null,ve=E,Fe=E=0,Mg=null;ve!==null&&Fe<O.length;Fe++){ve.index>Fe?(Mg=ve,ve=null):Mg=ve.sibling;var Pe=le(T,ve,O[Fe],de);if(Pe===null){ve===null&&(ve=Mg);break}n&&ve&&Pe.alternate===null&&l(T,ve),E=h(Pe,E,Fe),Je===null?Ve=Pe:Je.sibling=Pe,Je=Pe,ve=Mg}if(Fe===O.length)return i(T,ve),ug&&WI(T,Fe),Ve;if(ve===null){for(;Fe<O.length;Fe++)ve=ie(T,O[Fe],de),ve!==null&&(E=h(ve,E,Fe),Je===null?Ve=ve:Je.sibling=ve,Je=ve);return ug&&WI(T,Fe),Ve}for(ve=a(T,ve);Fe<O.length;Fe++)Mg=Ze(ve,T,Fe,O[Fe],de),Mg!==null&&(n&&Mg.alternate!==null&&ve.delete(Mg.key===null?Fe:Mg.key),E=h(Mg,E,Fe),Je===null?Ve=Mg:Je.sibling=Mg,Je=Mg);return n&&ve.forEach(function(cI){return l(T,cI)}),ug&&WI(T,Fe),Ve}function Se(T,E,O,de){var Ve=P(O);if(typeof Ve!="function")throw Error(t(150));if(O=Ve.call(O),O==null)throw Error(t(151));for(var Je=Ve=null,ve=E,Fe=E=0,Mg=null,Pe=O.next();ve!==null&&!Pe.done;Fe++,Pe=O.next()){ve.index>Fe?(Mg=ve,ve=null):Mg=ve.sibling;var cI=le(T,ve,Pe.value,de);if(cI===null){ve===null&&(ve=Mg);break}n&&ve&&cI.alternate===null&&l(T,ve),E=h(cI,E,Fe),Je===null?Ve=cI:Je.sibling=cI,Je=cI,ve=Mg}if(Pe.done)return i(T,ve),ug&&WI(T,Fe),Ve;if(ve===null){for(;!Pe.done;Fe++,Pe=O.next())Pe=ie(T,Pe.value,de),Pe!==null&&(E=h(Pe,E,Fe),Je===null?Ve=Pe:Je.sibling=Pe,Je=Pe);return ug&&WI(T,Fe),Ve}for(ve=a(T,ve);!Pe.done;Fe++,Pe=O.next())Pe=Ze(ve,T,Fe,Pe.value,de),Pe!==null&&(n&&Pe.alternate!==null&&ve.delete(Pe.key===null?Fe:Pe.key),E=h(Pe,E,Fe),Je===null?Ve=Pe:Je.sibling=Pe,Je=Pe);return n&&ve.forEach(function(xV){return l(T,xV)}),ug&&WI(T,Fe),Ve}function Xg(T,E,O,de){if(typeof O=="object"&&O!==null&&O.type===U&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case J:e:{for(var Ve=O.key,Je=E;Je!==null;){if(Je.key===Ve){if(Ve=O.type,Ve===U){if(Je.tag===7){i(T,Je.sibling),E=u(Je,O.props.children),E.return=T,T=E;break e}}else if(Je.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===Q&&Ah(Ve)===Je.type){i(T,Je.sibling),E=u(Je,O.props),E.ref=Jo(T,Je,O),E.return=T,T=E;break e}i(T,Je);break}else l(T,Je);Je=Je.sibling}O.type===U?(E=wI(O.props.children,T.mode,de,O.key),E.return=T,T=E):(de=$i(O.type,O.key,O.props,null,T.mode,de),de.ref=Jo(T,E,O),de.return=T,T=de)}return S(T);case F:e:{for(Je=O.key;E!==null;){if(E.key===Je)if(E.tag===4&&E.stateNode.containerInfo===O.containerInfo&&E.stateNode.implementation===O.implementation){i(T,E.sibling),E=u(E,O.children||[]),E.return=T,T=E;break e}else{i(T,E);break}else l(T,E);E=E.sibling}E=Yc(O,T.mode,de),E.return=T,T=E}return S(T);case Q:return Je=O._init,Xg(T,E,Je(O._payload),de)}if(se(O))return fe(T,E,O,de);if(P(O))return Se(T,E,O,de);Xi(T,O)}return typeof O=="string"&&O!==""||typeof O=="number"?(O=""+O,E!==null&&E.tag===6?(i(T,E.sibling),E=u(E,O),E.return=T,T=E):(i(T,E),E=vc(O,T.mode,de),E.return=T,T=E),S(T)):i(T,E)}return Xg}var bl=uh(!0),mh=uh(!1),ki=gI(null),Ji=null,Gl=null,Ma=null;function Ua(){Ma=Gl=Ji=null}function La(n){var l=ki.current;Ag(ki),n._currentValue=l}function Ta(n,l,i){for(;n!==null;){var a=n.alternate;if((n.childLanes&l)!==l?(n.childLanes|=l,a!==null&&(a.childLanes|=l)):a!==null&&(a.childLanes&l)!==l&&(a.childLanes|=l),n===i)break;n=n.return}}function yl(n,l){Ji=n,Ma=Gl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&l)!==0&&(dt=!0),n.firstContext=null)}function Yt(n){var l=n._currentValue;if(Ma!==n)if(n={context:n,memoizedValue:l,next:null},Gl===null){if(Ji===null)throw Error(t(308));Gl=n,Ji.dependencies={lanes:0,firstContext:n}}else Gl=Gl.next=n;return l}var RI=null;function Qa(n){RI===null?RI=[n]:RI.push(n)}function hh(n,l,i,a){var u=l.interleaved;return u===null?(i.next=i,Qa(l)):(i.next=u.next,u.next=i),l.interleaved=i,vn(n,a)}function vn(n,l){n.lanes|=l;var i=n.alternate;for(i!==null&&(i.lanes|=l),i=n,n=n.return;n!==null;)n.childLanes|=l,i=n.alternate,i!==null&&(i.childLanes|=l),i=n,n=n.return;return i.tag===3?i.stateNode:null}var II=!1;function Da(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ph(n,l){n=n.updateQueue,l.updateQueue===n&&(l.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Yn(n,l){return{eventTime:n,lane:l,tag:0,payload:null,callback:null,next:null}}function lI(n,l,i){var a=n.updateQueue;if(a===null)return null;if(a=a.shared,(Te&2)!==0){var u=a.pending;return u===null?l.next=l:(l.next=u.next,u.next=l),a.pending=l,vn(n,i)}return u=a.interleaved,u===null?(l.next=l,Qa(a)):(l.next=u.next,u.next=l),a.interleaved=l,vn(n,i)}function vi(n,l,i){if(l=l.updateQueue,l!==null&&(l=l.shared,(i&4194240)!==0)){var a=l.lanes;a&=n.pendingLanes,i|=a,l.lanes=i,Ca(n,i)}}function Zh(n,l){var i=n.updateQueue,a=n.alternate;if(a!==null&&(a=a.updateQueue,i===a)){var u=null,h=null;if(i=i.firstBaseUpdate,i!==null){do{var S={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};h===null?u=h=S:h=h.next=S,i=i.next}while(i!==null);h===null?u=h=l:h=h.next=l}else u=h=l;i={baseState:a.baseState,firstBaseUpdate:u,lastBaseUpdate:h,shared:a.shared,effects:a.effects},n.updateQueue=i;return}n=i.lastBaseUpdate,n===null?i.firstBaseUpdate=l:n.next=l,i.lastBaseUpdate=l}function Yi(n,l,i,a){var u=n.updateQueue;II=!1;var h=u.firstBaseUpdate,S=u.lastBaseUpdate,Y=u.shared.pending;if(Y!==null){u.shared.pending=null;var x=Y,_=x.next;x.next=null,S===null?h=_:S.next=_,S=x;var Ce=n.alternate;Ce!==null&&(Ce=Ce.updateQueue,Y=Ce.lastBaseUpdate,Y!==S&&(Y===null?Ce.firstBaseUpdate=_:Y.next=_,Ce.lastBaseUpdate=x))}if(h!==null){var ie=u.baseState;S=0,Ce=_=x=null,Y=h;do{var le=Y.lane,Ze=Y.eventTime;if((a&le)===le){Ce!==null&&(Ce=Ce.next={eventTime:Ze,lane:0,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null});e:{var fe=n,Se=Y;switch(le=l,Ze=i,Se.tag){case 1:if(fe=Se.payload,typeof fe=="function"){ie=fe.call(Ze,ie,le);break e}ie=fe;break e;case 3:fe.flags=fe.flags&-65537|128;case 0:if(fe=Se.payload,le=typeof fe=="function"?fe.call(Ze,ie,le):fe,le==null)break e;ie=$({},ie,le);break e;case 2:II=!0}}Y.callback!==null&&Y.lane!==0&&(n.flags|=64,le=u.effects,le===null?u.effects=[Y]:le.push(Y))}else Ze={eventTime:Ze,lane:le,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},Ce===null?(_=Ce=Ze,x=ie):Ce=Ce.next=Ze,S|=le;if(Y=Y.next,Y===null){if(Y=u.shared.pending,Y===null)break;le=Y,Y=le.next,le.next=null,u.lastBaseUpdate=le,u.shared.pending=null}}while(!0);if(Ce===null&&(x=ie),u.baseState=x,u.firstBaseUpdate=_,u.lastBaseUpdate=Ce,l=u.shared.interleaved,l!==null){u=l;do S|=u.lane,u=u.next;while(u!==l)}else h===null&&(u.shared.lanes=0);JI|=S,n.lanes=S,n.memoizedState=ie}}function bh(n,l,i){if(n=l.effects,l.effects=null,n!==null)for(l=0;l<n.length;l++){var a=n[l],u=a.callback;if(u!==null){if(a.callback=null,a=i,typeof u!="function")throw Error(t(191,u));u.call(a)}}}var vo={},an=gI(vo),Yo=gI(vo),Ho=gI(vo);function XI(n){if(n===vo)throw Error(t(174));return n}function ja(n,l){switch(cg(Ho,l),cg(Yo,n),cg(an,vo),n=l.nodeType,n){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Yg(null,"");break;default:n=n===8?l.parentNode:l,l=n.namespaceURI||null,n=n.tagName,l=Yg(l,n)}Ag(an),cg(an,l)}function Bl(){Ag(an),Ag(Yo),Ag(Ho)}function Gh(n){XI(Ho.current);var l=XI(an.current),i=Yg(l,n.type);l!==i&&(cg(Yo,n),cg(an,i))}function Pa(n){Yo.current===n&&(Ag(an),Ag(Yo))}var Zg=gI(0);function Hi(n){for(var l=n;l!==null;){if(l.tag===13){var i=l.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===n)break;for(;l.sibling===null;){if(l.return===null||l.return===n)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Oa=[];function qa(){for(var n=0;n<Oa.length;n++)Oa[n]._workInProgressVersionPrimary=null;Oa.length=0}var wi=k.ReactCurrentDispatcher,_a=k.ReactCurrentBatchConfig,kI=0,bg=null,Ng=null,Eg=null,Fi=!1,wo=!1,Fo=0,CV=0;function Og(){throw Error(t(321))}function $a(n,l){if(l===null)return!1;for(var i=0;i<l.length&&i<n.length;i++)if(!Dt(n[i],l[i]))return!1;return!0}function ec(n,l,i,a,u,h){if(kI=h,bg=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,wi.current=n===null||n.memoizedState===null?aV:cV,n=i(a,u),wo){h=0;do{if(wo=!1,Fo=0,25<=h)throw Error(t(301));h+=1,Eg=Ng=null,l.updateQueue=null,wi.current=dV,n=i(a,u)}while(wo)}if(wi.current=xi,l=Ng!==null&&Ng.next!==null,kI=0,Eg=Ng=bg=null,Fi=!1,l)throw Error(t(300));return n}function gc(){var n=Fo!==0;return Fo=0,n}function cn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Eg===null?bg.memoizedState=Eg=n:Eg=Eg.next=n,Eg}function Ht(){if(Ng===null){var n=bg.alternate;n=n!==null?n.memoizedState:null}else n=Ng.next;var l=Eg===null?bg.memoizedState:Eg.next;if(l!==null)Eg=l,Ng=n;else{if(n===null)throw Error(t(310));Ng=n,n={memoizedState:Ng.memoizedState,baseState:Ng.baseState,baseQueue:Ng.baseQueue,queue:Ng.queue,next:null},Eg===null?bg.memoizedState=Eg=n:Eg=Eg.next=n}return Eg}function Ko(n,l){return typeof l=="function"?l(n):l}function tc(n){var l=Ht(),i=l.queue;if(i===null)throw Error(t(311));i.lastRenderedReducer=n;var a=Ng,u=a.baseQueue,h=i.pending;if(h!==null){if(u!==null){var S=u.next;u.next=h.next,h.next=S}a.baseQueue=u=h,i.pending=null}if(u!==null){h=u.next,a=a.baseState;var Y=S=null,x=null,_=h;do{var Ce=_.lane;if((kI&Ce)===Ce)x!==null&&(x=x.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),a=_.hasEagerState?_.eagerState:n(a,_.action);else{var ie={lane:Ce,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};x===null?(Y=x=ie,S=a):x=x.next=ie,bg.lanes|=Ce,JI|=Ce}_=_.next}while(_!==null&&_!==h);x===null?S=a:x.next=Y,Dt(a,l.memoizedState)||(dt=!0),l.memoizedState=a,l.baseState=S,l.baseQueue=x,i.lastRenderedState=a}if(n=i.interleaved,n!==null){u=n;do h=u.lane,bg.lanes|=h,JI|=h,u=u.next;while(u!==n)}else u===null&&(i.lanes=0);return[l.memoizedState,i.dispatch]}function nc(n){var l=Ht(),i=l.queue;if(i===null)throw Error(t(311));i.lastRenderedReducer=n;var a=i.dispatch,u=i.pending,h=l.memoizedState;if(u!==null){i.pending=null;var S=u=u.next;do h=n(h,S.action),S=S.next;while(S!==u);Dt(h,l.memoizedState)||(dt=!0),l.memoizedState=h,l.baseQueue===null&&(l.baseState=h),i.lastRenderedState=h}return[h,a]}function yh(){}function Bh(n,l){var i=bg,a=Ht(),u=l(),h=!Dt(a.memoizedState,u);if(h&&(a.memoizedState=u,dt=!0),a=a.queue,Ic(Vh.bind(null,i,a,n),[n]),a.getSnapshot!==l||h||Eg!==null&&Eg.memoizedState.tag&1){if(i.flags|=2048,No(9,Sh.bind(null,i,a,u,l),void 0,null),zg===null)throw Error(t(349));(kI&30)!==0||fh(i,l,u)}return u}function fh(n,l,i){n.flags|=16384,n={getSnapshot:l,value:i},l=bg.updateQueue,l===null?(l={lastEffect:null,stores:null},bg.updateQueue=l,l.stores=[n]):(i=l.stores,i===null?l.stores=[n]:i.push(n))}function Sh(n,l,i,a){l.value=i,l.getSnapshot=a,Wh(l)&&Rh(n)}function Vh(n,l,i){return i(function(){Wh(l)&&Rh(n)})}function Wh(n){var l=n.getSnapshot;n=n.value;try{var i=l();return!Dt(n,i)}catch{return!0}}function Rh(n){var l=vn(n,1);l!==null&&_t(l,n,1,-1)}function Xh(n){var l=cn();return typeof n=="function"&&(n=n()),l.memoizedState=l.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ko,lastRenderedState:n},l.queue=n,n=n.dispatch=rV.bind(null,bg,n),[l.memoizedState,n]}function No(n,l,i,a){return n={tag:n,create:l,destroy:i,deps:a,next:null},l=bg.updateQueue,l===null?(l={lastEffect:null,stores:null},bg.updateQueue=l,l.lastEffect=n.next=n):(i=l.lastEffect,i===null?l.lastEffect=n.next=n:(a=i.next,i.next=n,n.next=a,l.lastEffect=n)),n}function kh(){return Ht().memoizedState}function Ki(n,l,i,a){var u=cn();bg.flags|=n,u.memoizedState=No(1|l,i,void 0,a===void 0?null:a)}function Ni(n,l,i,a){var u=Ht();a=a===void 0?null:a;var h=void 0;if(Ng!==null){var S=Ng.memoizedState;if(h=S.destroy,a!==null&&$a(a,S.deps)){u.memoizedState=No(l,i,h,a);return}}bg.flags|=n,u.memoizedState=No(1|l,i,h,a)}function Jh(n,l){return Ki(8390656,8,n,l)}function Ic(n,l){return Ni(2048,8,n,l)}function vh(n,l){return Ni(4,2,n,l)}function Yh(n,l){return Ni(4,4,n,l)}function Hh(n,l){if(typeof l=="function")return n=n(),l(n),function(){l(null)};if(l!=null)return n=n(),l.current=n,function(){l.current=null}}function wh(n,l,i){return i=i!=null?i.concat([n]):null,Ni(4,4,Hh.bind(null,l,n),i)}function lc(){}function Fh(n,l){var i=Ht();l=l===void 0?null:l;var a=i.memoizedState;return a!==null&&l!==null&&$a(l,a[1])?a[0]:(i.memoizedState=[n,l],n)}function Kh(n,l){var i=Ht();l=l===void 0?null:l;var a=i.memoizedState;return a!==null&&l!==null&&$a(l,a[1])?a[0]:(n=n(),i.memoizedState=[n,l],n)}function Nh(n,l,i){return(kI&21)===0?(n.baseState&&(n.baseState=!1,dt=!0),n.memoizedState=i):(Dt(i,l)||(i=Am(),bg.lanes|=i,JI|=i,n.baseState=!0),l)}function iV(n,l){var i=tg;tg=i!==0&&4>i?i:4,n(!0);var a=_a.transition;_a.transition={};try{n(!1),l()}finally{tg=i,_a.transition=a}}function xh(){return Ht().memoizedState}function sV(n,l,i){var a=sI(n);if(i={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null},Eh(n))zh(l,i);else if(i=hh(n,l,i,a),i!==null){var u=lt();_t(i,n,a,u),Mh(i,l,a)}}function rV(n,l,i){var a=sI(n),u={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null};if(Eh(n))zh(l,u);else{var h=n.alternate;if(n.lanes===0&&(h===null||h.lanes===0)&&(h=l.lastRenderedReducer,h!==null))try{var S=l.lastRenderedState,Y=h(S,i);if(u.hasEagerState=!0,u.eagerState=Y,Dt(Y,S)){var x=l.interleaved;x===null?(u.next=u,Qa(l)):(u.next=x.next,x.next=u),l.interleaved=u;return}}catch{}finally{}i=hh(n,l,u,a),i!==null&&(u=lt(),_t(i,n,a,u),Mh(i,l,a))}}function Eh(n){var l=n.alternate;return n===bg||l!==null&&l===bg}function zh(n,l){wo=Fi=!0;var i=n.pending;i===null?l.next=l:(l.next=i.next,i.next=l),n.pending=l}function Mh(n,l,i){if((i&4194240)!==0){var a=l.lanes;a&=n.pendingLanes,i|=a,l.lanes=i,Ca(n,i)}}var xi={readContext:Yt,useCallback:Og,useContext:Og,useEffect:Og,useImperativeHandle:Og,useInsertionEffect:Og,useLayoutEffect:Og,useMemo:Og,useReducer:Og,useRef:Og,useState:Og,useDebugValue:Og,useDeferredValue:Og,useTransition:Og,useMutableSource:Og,useSyncExternalStore:Og,useId:Og,unstable_isNewReconciler:!1},aV={readContext:Yt,useCallback:function(n,l){return cn().memoizedState=[n,l===void 0?null:l],n},useContext:Yt,useEffect:Jh,useImperativeHandle:function(n,l,i){return i=i!=null?i.concat([n]):null,Ki(4194308,4,Hh.bind(null,l,n),i)},useLayoutEffect:function(n,l){return Ki(4194308,4,n,l)},useInsertionEffect:function(n,l){return Ki(4,2,n,l)},useMemo:function(n,l){var i=cn();return l=l===void 0?null:l,n=n(),i.memoizedState=[n,l],n},useReducer:function(n,l,i){var a=cn();return l=i!==void 0?i(l):l,a.memoizedState=a.baseState=l,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:l},a.queue=n,n=n.dispatch=sV.bind(null,bg,n),[a.memoizedState,n]},useRef:function(n){var l=cn();return n={current:n},l.memoizedState=n},useState:Xh,useDebugValue:lc,useDeferredValue:function(n){return cn().memoizedState=n},useTransition:function(){var n=Xh(!1),l=n[0];return n=iV.bind(null,n[1]),cn().memoizedState=n,[l,n]},useMutableSource:function(){},useSyncExternalStore:function(n,l,i){var a=bg,u=cn();if(ug){if(i===void 0)throw Error(t(407));i=i()}else{if(i=l(),zg===null)throw Error(t(349));(kI&30)!==0||fh(a,l,i)}u.memoizedState=i;var h={value:i,getSnapshot:l};return u.queue=h,Jh(Vh.bind(null,a,h,n),[n]),a.flags|=2048,No(9,Sh.bind(null,a,h,i,l),void 0,null),i},useId:function(){var n=cn(),l=zg.identifierPrefix;if(ug){var i=Jn,a=kn;i=(a&~(1<<32-Qt(a)-1)).toString(32)+i,l=":"+l+"R"+i,i=Fo++,0<i&&(l+="H"+i.toString(32)),l+=":"}else i=CV++,l=":"+l+"r"+i.toString(32)+":";return n.memoizedState=l},unstable_isNewReconciler:!1},cV={readContext:Yt,useCallback:Fh,useContext:Yt,useEffect:Ic,useImperativeHandle:wh,useInsertionEffect:vh,useLayoutEffect:Yh,useMemo:Kh,useReducer:tc,useRef:kh,useState:function(){return tc(Ko)},useDebugValue:lc,useDeferredValue:function(n){var l=Ht();return Nh(l,Ng.memoizedState,n)},useTransition:function(){var n=tc(Ko)[0],l=Ht().memoizedState;return[n,l]},useMutableSource:yh,useSyncExternalStore:Bh,useId:xh,unstable_isNewReconciler:!1},dV={readContext:Yt,useCallback:Fh,useContext:Yt,useEffect:Ic,useImperativeHandle:wh,useInsertionEffect:vh,useLayoutEffect:Yh,useMemo:Kh,useReducer:nc,useRef:kh,useState:function(){return nc(Ko)},useDebugValue:lc,useDeferredValue:function(n){var l=Ht();return Ng===null?l.memoizedState=n:Nh(l,Ng.memoizedState,n)},useTransition:function(){var n=nc(Ko)[0],l=Ht().memoizedState;return[n,l]},useMutableSource:yh,useSyncExternalStore:Bh,useId:xh,unstable_isNewReconciler:!1};function Pt(n,l){if(n&&n.defaultProps){l=$({},l),n=n.defaultProps;for(var i in n)l[i]===void 0&&(l[i]=n[i]);return l}return l}function oc(n,l,i,a){l=n.memoizedState,i=i(a,l),i=i==null?l:$({},l,i),n.memoizedState=i,n.lanes===0&&(n.updateQueue.baseState=i)}var Ei={isMounted:function(n){return(n=n._reactInternals)?BI(n)===n:!1},enqueueSetState:function(n,l,i){n=n._reactInternals;var a=lt(),u=sI(n),h=Yn(a,u);h.payload=l,i!=null&&(h.callback=i),l=lI(n,h,u),l!==null&&(_t(l,n,u,a),vi(l,n,u))},enqueueReplaceState:function(n,l,i){n=n._reactInternals;var a=lt(),u=sI(n),h=Yn(a,u);h.tag=1,h.payload=l,i!=null&&(h.callback=i),l=lI(n,h,u),l!==null&&(_t(l,n,u,a),vi(l,n,u))},enqueueForceUpdate:function(n,l){n=n._reactInternals;var i=lt(),a=sI(n),u=Yn(i,a);u.tag=2,l!=null&&(u.callback=l),l=lI(n,u,a),l!==null&&(_t(l,n,a,i),vi(l,n,a))}};function Uh(n,l,i,a,u,h,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(a,h,S):l.prototype&&l.prototype.isPureReactComponent?!fo(i,a)||!fo(u,h):!0}function Lh(n,l,i){var a=!1,u=tI,h=l.contextType;return typeof h=="object"&&h!==null?h=Yt(h):(u=ct(l)?SI:Pg.current,a=l.contextTypes,h=(a=a!=null)?ml(n,u):tI),l=new l(i,h),n.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Ei,n.stateNode=l,l._reactInternals=n,a&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=u,n.__reactInternalMemoizedMaskedChildContext=h),l}function Th(n,l,i,a){n=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(i,a),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(i,a),l.state!==n&&Ei.enqueueReplaceState(l,l.state,null)}function Cc(n,l,i,a){var u=n.stateNode;u.props=i,u.state=n.memoizedState,u.refs={},Da(n);var h=l.contextType;typeof h=="object"&&h!==null?u.context=Yt(h):(h=ct(l)?SI:Pg.current,u.context=ml(n,h)),u.state=n.memoizedState,h=l.getDerivedStateFromProps,typeof h=="function"&&(oc(n,l,h,i),u.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(l=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),l!==u.state&&Ei.enqueueReplaceState(u,u.state,null),Yi(n,i,u,a),u.state=n.memoizedState),typeof u.componentDidMount=="function"&&(n.flags|=4194308)}function fl(n,l){try{var i="",a=l;do i+=ne(a),a=a.return;while(a);var u=i}catch(h){u=`
Error generating stack: `+h.message+`
`+h.stack}return{value:n,source:l,stack:u,digest:null}}function ic(n,l,i){return{value:n,source:null,stack:i??null,digest:l??null}}function sc(n,l){try{console.error(l.value)}catch(i){setTimeout(function(){throw i})}}var AV=typeof WeakMap=="function"?WeakMap:Map;function Qh(n,l,i){i=Yn(-1,i),i.tag=3,i.payload={element:null};var a=l.value;return i.callback=function(){Di||(Di=!0,fc=a),sc(n,l)},i}function Dh(n,l,i){i=Yn(-1,i),i.tag=3;var a=n.type.getDerivedStateFromError;if(typeof a=="function"){var u=l.value;i.payload=function(){return a(u)},i.callback=function(){sc(n,l)}}var h=n.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(i.callback=function(){sc(n,l),typeof a!="function"&&(CI===null?CI=new Set([this]):CI.add(this));var S=l.stack;this.componentDidCatch(l.value,{componentStack:S!==null?S:""})}),i}function jh(n,l,i){var a=n.pingCache;if(a===null){a=n.pingCache=new AV;var u=new Set;a.set(l,u)}else u=a.get(l),u===void 0&&(u=new Set,a.set(l,u));u.has(i)||(u.add(i),n=RV.bind(null,n,l,i),l.then(n,n))}function Ph(n){do{var l;if((l=n.tag===13)&&(l=n.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return n;n=n.return}while(n!==null);return null}function Oh(n,l,i,a,u){return(n.mode&1)===0?(n===l?n.flags|=65536:(n.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(l=Yn(-1,1),l.tag=2,lI(i,l,1))),i.lanes|=1),n):(n.flags|=65536,n.lanes=u,n)}var uV=k.ReactCurrentOwner,dt=!1;function It(n,l,i,a){l.child=n===null?mh(l,null,i,a):bl(l,n.child,i,a)}function qh(n,l,i,a,u){i=i.render;var h=l.ref;return yl(l,u),a=ec(n,l,i,a,h,u),i=gc(),n!==null&&!dt?(l.updateQueue=n.updateQueue,l.flags&=-2053,n.lanes&=~u,Hn(n,l,u)):(ug&&i&&Ka(l),l.flags|=1,It(n,l,a,u),l.child)}function _h(n,l,i,a,u){if(n===null){var h=i.type;return typeof h=="function"&&!Jc(h)&&h.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(l.tag=15,l.type=h,$h(n,l,h,a,u)):(n=$i(i.type,null,a,l,l.mode,u),n.ref=l.ref,n.return=l,l.child=n)}if(h=n.child,(n.lanes&u)===0){var S=h.memoizedProps;if(i=i.compare,i=i!==null?i:fo,i(S,a)&&n.ref===l.ref)return Hn(n,l,u)}return l.flags|=1,n=aI(h,a),n.ref=l.ref,n.return=l,l.child=n}function $h(n,l,i,a,u){if(n!==null){var h=n.memoizedProps;if(fo(h,a)&&n.ref===l.ref)if(dt=!1,l.pendingProps=a=h,(n.lanes&u)!==0)(n.flags&131072)!==0&&(dt=!0);else return l.lanes=n.lanes,Hn(n,l,u)}return rc(n,l,i,a,u)}function ep(n,l,i){var a=l.pendingProps,u=a.children,h=n!==null?n.memoizedState:null;if(a.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},cg(Vl,Vt),Vt|=i;else{if((i&1073741824)===0)return n=h!==null?h.baseLanes|i:i,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:n,cachePool:null,transitions:null},l.updateQueue=null,cg(Vl,Vt),Vt|=n,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=h!==null?h.baseLanes:i,cg(Vl,Vt),Vt|=a}else h!==null?(a=h.baseLanes|i,l.memoizedState=null):a=i,cg(Vl,Vt),Vt|=a;return It(n,l,u,i),l.child}function gp(n,l){var i=l.ref;(n===null&&i!==null||n!==null&&n.ref!==i)&&(l.flags|=512,l.flags|=2097152)}function rc(n,l,i,a,u){var h=ct(i)?SI:Pg.current;return h=ml(l,h),yl(l,u),i=ec(n,l,i,a,h,u),a=gc(),n!==null&&!dt?(l.updateQueue=n.updateQueue,l.flags&=-2053,n.lanes&=~u,Hn(n,l,u)):(ug&&a&&Ka(l),l.flags|=1,It(n,l,i,u),l.child)}function tp(n,l,i,a,u){if(ct(i)){var h=!0;fi(l)}else h=!1;if(yl(l,u),l.stateNode===null)Mi(n,l),Lh(l,i,a),Cc(l,i,a,u),a=!0;else if(n===null){var S=l.stateNode,Y=l.memoizedProps;S.props=Y;var x=S.context,_=i.contextType;typeof _=="object"&&_!==null?_=Yt(_):(_=ct(i)?SI:Pg.current,_=ml(l,_));var Ce=i.getDerivedStateFromProps,ie=typeof Ce=="function"||typeof S.getSnapshotBeforeUpdate=="function";ie||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(Y!==a||x!==_)&&Th(l,S,a,_),II=!1;var le=l.memoizedState;S.state=le,Yi(l,a,S,u),x=l.memoizedState,Y!==a||le!==x||at.current||II?(typeof Ce=="function"&&(oc(l,i,Ce,a),x=l.memoizedState),(Y=II||Uh(l,i,Y,a,le,x,_))?(ie||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(l.flags|=4194308)):(typeof S.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=a,l.memoizedState=x),S.props=a,S.state=x,S.context=_,a=Y):(typeof S.componentDidMount=="function"&&(l.flags|=4194308),a=!1)}else{S=l.stateNode,ph(n,l),Y=l.memoizedProps,_=l.type===l.elementType?Y:Pt(l.type,Y),S.props=_,ie=l.pendingProps,le=S.context,x=i.contextType,typeof x=="object"&&x!==null?x=Yt(x):(x=ct(i)?SI:Pg.current,x=ml(l,x));var Ze=i.getDerivedStateFromProps;(Ce=typeof Ze=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(Y!==ie||le!==x)&&Th(l,S,a,x),II=!1,le=l.memoizedState,S.state=le,Yi(l,a,S,u);var fe=l.memoizedState;Y!==ie||le!==fe||at.current||II?(typeof Ze=="function"&&(oc(l,i,Ze,a),fe=l.memoizedState),(_=II||Uh(l,i,_,a,le,fe,x)||!1)?(Ce||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(a,fe,x),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(a,fe,x)),typeof S.componentDidUpdate=="function"&&(l.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof S.componentDidUpdate!="function"||Y===n.memoizedProps&&le===n.memoizedState||(l.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||Y===n.memoizedProps&&le===n.memoizedState||(l.flags|=1024),l.memoizedProps=a,l.memoizedState=fe),S.props=a,S.state=fe,S.context=x,a=_):(typeof S.componentDidUpdate!="function"||Y===n.memoizedProps&&le===n.memoizedState||(l.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||Y===n.memoizedProps&&le===n.memoizedState||(l.flags|=1024),a=!1)}return ac(n,l,i,a,h,u)}function ac(n,l,i,a,u,h){gp(n,l);var S=(l.flags&128)!==0;if(!a&&!S)return u&&Ch(l,i,!1),Hn(n,l,h);a=l.stateNode,uV.current=l;var Y=S&&typeof i.getDerivedStateFromError!="function"?null:a.render();return l.flags|=1,n!==null&&S?(l.child=bl(l,n.child,null,h),l.child=bl(l,null,Y,h)):It(n,l,Y,h),l.memoizedState=a.state,u&&Ch(l,i,!0),l.child}function np(n){var l=n.stateNode;l.pendingContext?lh(n,l.pendingContext,l.pendingContext!==l.context):l.context&&lh(n,l.context,!1),ja(n,l.containerInfo)}function Ip(n,l,i,a,u){return Zl(),za(u),l.flags|=256,It(n,l,i,a),l.child}var cc={dehydrated:null,treeContext:null,retryLane:0};function dc(n){return{baseLanes:n,cachePool:null,transitions:null}}function lp(n,l,i){var a=l.pendingProps,u=Zg.current,h=!1,S=(l.flags&128)!==0,Y;if((Y=S)||(Y=n!==null&&n.memoizedState===null?!1:(u&2)!==0),Y?(h=!0,l.flags&=-129):(n===null||n.memoizedState!==null)&&(u|=1),cg(Zg,u&1),n===null)return Ea(l),n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((l.mode&1)===0?l.lanes=1:n.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(S=a.children,n=a.fallback,h?(a=l.mode,h=l.child,S={mode:"hidden",children:S},(a&1)===0&&h!==null?(h.childLanes=0,h.pendingProps=S):h=es(S,a,0,null),n=wI(n,a,i,null),h.return=l,n.return=l,h.sibling=n,l.child=h,l.child.memoizedState=dc(i),l.memoizedState=cc,n):Ac(l,S));if(u=n.memoizedState,u!==null&&(Y=u.dehydrated,Y!==null))return mV(n,l,S,a,Y,u,i);if(h){h=a.fallback,S=l.mode,u=n.child,Y=u.sibling;var x={mode:"hidden",children:a.children};return(S&1)===0&&l.child!==u?(a=l.child,a.childLanes=0,a.pendingProps=x,l.deletions=null):(a=aI(u,x),a.subtreeFlags=u.subtreeFlags&14680064),Y!==null?h=aI(Y,h):(h=wI(h,S,i,null),h.flags|=2),h.return=l,a.return=l,a.sibling=h,l.child=a,a=h,h=l.child,S=n.child.memoizedState,S=S===null?dc(i):{baseLanes:S.baseLanes|i,cachePool:null,transitions:S.transitions},h.memoizedState=S,h.childLanes=n.childLanes&~i,l.memoizedState=cc,a}return h=n.child,n=h.sibling,a=aI(h,{mode:"visible",children:a.children}),(l.mode&1)===0&&(a.lanes=i),a.return=l,a.sibling=null,n!==null&&(i=l.deletions,i===null?(l.deletions=[n],l.flags|=16):i.push(n)),l.child=a,l.memoizedState=null,a}function Ac(n,l){return l=es({mode:"visible",children:l},n.mode,0,null),l.return=n,n.child=l}function zi(n,l,i,a){return a!==null&&za(a),bl(l,n.child,null,i),n=Ac(l,l.pendingProps.children),n.flags|=2,l.memoizedState=null,n}function mV(n,l,i,a,u,h,S){if(i)return l.flags&256?(l.flags&=-257,a=ic(Error(t(422))),zi(n,l,S,a)):l.memoizedState!==null?(l.child=n.child,l.flags|=128,null):(h=a.fallback,u=l.mode,a=es({mode:"visible",children:a.children},u,0,null),h=wI(h,u,S,null),h.flags|=2,a.return=l,h.return=l,a.sibling=h,l.child=a,(l.mode&1)!==0&&bl(l,n.child,null,S),l.child.memoizedState=dc(S),l.memoizedState=cc,h);if((l.mode&1)===0)return zi(n,l,S,null);if(u.data==="$!"){if(a=u.nextSibling&&u.nextSibling.dataset,a)var Y=a.dgst;return a=Y,h=Error(t(419)),a=ic(h,a,void 0),zi(n,l,S,a)}if(Y=(S&n.childLanes)!==0,dt||Y){if(a=zg,a!==null){switch(S&-S){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=(u&(a.suspendedLanes|S))!==0?0:u,u!==0&&u!==h.retryLane&&(h.retryLane=u,vn(n,u),_t(a,n,u,-1))}return kc(),a=ic(Error(t(421))),zi(n,l,S,a)}return u.data==="$?"?(l.flags|=128,l.child=n.child,l=XV.bind(null,n),u._reactRetry=l,null):(n=h.treeContext,St=eI(u.nextSibling),ft=l,ug=!0,jt=null,n!==null&&(Jt[vt++]=kn,Jt[vt++]=Jn,Jt[vt++]=VI,kn=n.id,Jn=n.overflow,VI=l),l=Ac(l,a.children),l.flags|=4096,l)}function op(n,l,i){n.lanes|=l;var a=n.alternate;a!==null&&(a.lanes|=l),Ta(n.return,l,i)}function uc(n,l,i,a,u){var h=n.memoizedState;h===null?n.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:a,tail:i,tailMode:u}:(h.isBackwards=l,h.rendering=null,h.renderingStartTime=0,h.last=a,h.tail=i,h.tailMode=u)}function Cp(n,l,i){var a=l.pendingProps,u=a.revealOrder,h=a.tail;if(It(n,l,a.children,i),a=Zg.current,(a&2)!==0)a=a&1|2,l.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=l.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&op(n,i,l);else if(n.tag===19)op(n,i,l);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===l)break e;for(;n.sibling===null;){if(n.return===null||n.return===l)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}a&=1}if(cg(Zg,a),(l.mode&1)===0)l.memoizedState=null;else switch(u){case"forwards":for(i=l.child,u=null;i!==null;)n=i.alternate,n!==null&&Hi(n)===null&&(u=i),i=i.sibling;i=u,i===null?(u=l.child,l.child=null):(u=i.sibling,i.sibling=null),uc(l,!1,u,i,h);break;case"backwards":for(i=null,u=l.child,l.child=null;u!==null;){if(n=u.alternate,n!==null&&Hi(n)===null){l.child=u;break}n=u.sibling,u.sibling=i,i=u,u=n}uc(l,!0,i,null,h);break;case"together":uc(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Mi(n,l){(l.mode&1)===0&&n!==null&&(n.alternate=null,l.alternate=null,l.flags|=2)}function Hn(n,l,i){if(n!==null&&(l.dependencies=n.dependencies),JI|=l.lanes,(i&l.childLanes)===0)return null;if(n!==null&&l.child!==n.child)throw Error(t(153));if(l.child!==null){for(n=l.child,i=aI(n,n.pendingProps),l.child=i,i.return=l;n.sibling!==null;)n=n.sibling,i=i.sibling=aI(n,n.pendingProps),i.return=l;i.sibling=null}return l.child}function hV(n,l,i){switch(l.tag){case 3:np(l),Zl();break;case 5:Gh(l);break;case 1:ct(l.type)&&fi(l);break;case 4:ja(l,l.stateNode.containerInfo);break;case 10:var a=l.type._context,u=l.memoizedProps.value;cg(ki,a._currentValue),a._currentValue=u;break;case 13:if(a=l.memoizedState,a!==null)return a.dehydrated!==null?(cg(Zg,Zg.current&1),l.flags|=128,null):(i&l.child.childLanes)!==0?lp(n,l,i):(cg(Zg,Zg.current&1),n=Hn(n,l,i),n!==null?n.sibling:null);cg(Zg,Zg.current&1);break;case 19:if(a=(i&l.childLanes)!==0,(n.flags&128)!==0){if(a)return Cp(n,l,i);l.flags|=128}if(u=l.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),cg(Zg,Zg.current),a)break;return null;case 22:case 23:return l.lanes=0,ep(n,l,i)}return Hn(n,l,i)}var ip,mc,sp,rp;ip=function(n,l){for(var i=l.child;i!==null;){if(i.tag===5||i.tag===6)n.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break;for(;i.sibling===null;){if(i.return===null||i.return===l)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},mc=function(){},sp=function(n,l,i,a){var u=n.memoizedProps;if(u!==a){n=l.stateNode,XI(an.current);var h=null;switch(i){case"input":u=Ye(n,u),a=Ye(n,a),h=[];break;case"select":u=$({},u,{value:void 0}),a=$({},a,{value:void 0}),h=[];break;case"textarea":u=Ie(n,u),a=Ie(n,a),h=[];break;default:typeof u.onClick!="function"&&typeof a.onClick=="function"&&(n.onclick=Gi)}je(i,a);var S;i=null;for(_ in u)if(!a.hasOwnProperty(_)&&u.hasOwnProperty(_)&&u[_]!=null)if(_==="style"){var Y=u[_];for(S in Y)Y.hasOwnProperty(S)&&(i||(i={}),i[S]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(o.hasOwnProperty(_)?h||(h=[]):(h=h||[]).push(_,null));for(_ in a){var x=a[_];if(Y=u?.[_],a.hasOwnProperty(_)&&x!==Y&&(x!=null||Y!=null))if(_==="style")if(Y){for(S in Y)!Y.hasOwnProperty(S)||x&&x.hasOwnProperty(S)||(i||(i={}),i[S]="");for(S in x)x.hasOwnProperty(S)&&Y[S]!==x[S]&&(i||(i={}),i[S]=x[S])}else i||(h||(h=[]),h.push(_,i)),i=x;else _==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,Y=Y?Y.__html:void 0,x!=null&&Y!==x&&(h=h||[]).push(_,x)):_==="children"?typeof x!="string"&&typeof x!="number"||(h=h||[]).push(_,""+x):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(o.hasOwnProperty(_)?(x!=null&&_==="onScroll"&&dg("scroll",n),h||Y===x||(h=[])):(h=h||[]).push(_,x))}i&&(h=h||[]).push("style",i);var _=h;(l.updateQueue=_)&&(l.flags|=4)}},rp=function(n,l,i,a){i!==a&&(l.flags|=4)};function xo(n,l){if(!ug)switch(n.tailMode){case"hidden":l=n.tail;for(var i=null;l!==null;)l.alternate!==null&&(i=l),l=l.sibling;i===null?n.tail=null:i.sibling=null;break;case"collapsed":i=n.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?l||n.tail===null?n.tail=null:n.tail.sibling=null:a.sibling=null}}function qg(n){var l=n.alternate!==null&&n.alternate.child===n.child,i=0,a=0;if(l)for(var u=n.child;u!==null;)i|=u.lanes|u.childLanes,a|=u.subtreeFlags&14680064,a|=u.flags&14680064,u.return=n,u=u.sibling;else for(u=n.child;u!==null;)i|=u.lanes|u.childLanes,a|=u.subtreeFlags,a|=u.flags,u.return=n,u=u.sibling;return n.subtreeFlags|=a,n.childLanes=i,l}function pV(n,l,i){var a=l.pendingProps;switch(Na(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qg(l),null;case 1:return ct(l.type)&&Bi(),qg(l),null;case 3:return a=l.stateNode,Bl(),Ag(at),Ag(Pg),qa(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(n===null||n.child===null)&&(Ri(l)?l.flags|=4:n===null||n.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,jt!==null&&(Wc(jt),jt=null))),mc(n,l),qg(l),null;case 5:Pa(l);var u=XI(Ho.current);if(i=l.type,n!==null&&l.stateNode!=null)sp(n,l,i,a,u),n.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!a){if(l.stateNode===null)throw Error(t(166));return qg(l),null}if(n=XI(an.current),Ri(l)){a=l.stateNode,i=l.type;var h=l.memoizedProps;switch(a[rn]=l,a[Xo]=h,n=(l.mode&1)!==0,i){case"dialog":dg("cancel",a),dg("close",a);break;case"iframe":case"object":case"embed":dg("load",a);break;case"video":case"audio":for(u=0;u<Vo.length;u++)dg(Vo[u],a);break;case"source":dg("error",a);break;case"img":case"image":case"link":dg("error",a),dg("load",a);break;case"details":dg("toggle",a);break;case"input":xe(a,h),dg("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!h.multiple},dg("invalid",a);break;case"textarea":ke(a,h),dg("invalid",a)}je(i,h),u=null;for(var S in h)if(h.hasOwnProperty(S)){var Y=h[S];S==="children"?typeof Y=="string"?a.textContent!==Y&&(h.suppressHydrationWarning!==!0&&bi(a.textContent,Y,n),u=["children",Y]):typeof Y=="number"&&a.textContent!==""+Y&&(h.suppressHydrationWarning!==!0&&bi(a.textContent,Y,n),u=["children",""+Y]):o.hasOwnProperty(S)&&Y!=null&&S==="onScroll"&&dg("scroll",a)}switch(i){case"input":ce(a),he(a,h,!0);break;case"textarea":ce(a),Me(a);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(a.onclick=Gi)}a=u,l.updateQueue=a,a!==null&&(l.flags|=4)}else{S=u.nodeType===9?u:u.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=gg(i)),n==="http://www.w3.org/1999/xhtml"?i==="script"?(n=S.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof a.is=="string"?n=S.createElement(i,{is:a.is}):(n=S.createElement(i),i==="select"&&(S=n,a.multiple?S.multiple=!0:a.size&&(S.size=a.size))):n=S.createElementNS(n,i),n[rn]=l,n[Xo]=a,ip(n,l,!1,!1),l.stateNode=n;e:{switch(S=pg(i,a),i){case"dialog":dg("cancel",n),dg("close",n),u=a;break;case"iframe":case"object":case"embed":dg("load",n),u=a;break;case"video":case"audio":for(u=0;u<Vo.length;u++)dg(Vo[u],n);u=a;break;case"source":dg("error",n),u=a;break;case"img":case"image":case"link":dg("error",n),dg("load",n),u=a;break;case"details":dg("toggle",n),u=a;break;case"input":xe(n,a),u=Ye(n,a),dg("invalid",n);break;case"option":u=a;break;case"select":n._wrapperState={wasMultiple:!!a.multiple},u=$({},a,{value:void 0}),dg("invalid",n);break;case"textarea":ke(n,a),u=Ie(n,a),dg("invalid",n);break;default:u=a}je(i,u),Y=u;for(h in Y)if(Y.hasOwnProperty(h)){var x=Y[h];h==="style"?Dn(n,x):h==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,x!=null&&rt(n,x)):h==="children"?typeof x=="string"?(i!=="textarea"||x!=="")&&rg(n,x):typeof x=="number"&&rg(n,""+x):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(o.hasOwnProperty(h)?x!=null&&h==="onScroll"&&dg("scroll",n):x!=null&&R(n,h,x,S))}switch(i){case"input":ce(n),he(n,a,!1);break;case"textarea":ce(n),Me(n);break;case"option":a.value!=null&&n.setAttribute("value",""+Ge(a.value));break;case"select":n.multiple=!!a.multiple,h=a.value,h!=null?pe(n,!!a.multiple,h,!1):a.defaultValue!=null&&pe(n,!!a.multiple,a.defaultValue,!0);break;default:typeof u.onClick=="function"&&(n.onclick=Gi)}switch(i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return qg(l),null;case 6:if(n&&l.stateNode!=null)rp(n,l,n.memoizedProps,a);else{if(typeof a!="string"&&l.stateNode===null)throw Error(t(166));if(i=XI(Ho.current),XI(an.current),Ri(l)){if(a=l.stateNode,i=l.memoizedProps,a[rn]=l,(h=a.nodeValue!==i)&&(n=ft,n!==null))switch(n.tag){case 3:bi(a.nodeValue,i,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&bi(a.nodeValue,i,(n.mode&1)!==0)}h&&(l.flags|=4)}else a=(i.nodeType===9?i:i.ownerDocument).createTextNode(a),a[rn]=l,l.stateNode=a}return qg(l),null;case 13:if(Ag(Zg),a=l.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ug&&St!==null&&(l.mode&1)!==0&&(l.flags&128)===0)dh(),Zl(),l.flags|=98560,h=!1;else if(h=Ri(l),a!==null&&a.dehydrated!==null){if(n===null){if(!h)throw Error(t(318));if(h=l.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(t(317));h[rn]=l}else Zl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;qg(l),h=!1}else jt!==null&&(Wc(jt),jt=null),h=!0;if(!h)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=i,l):(a=a!==null,a!==(n!==null&&n.memoizedState!==null)&&a&&(l.child.flags|=8192,(l.mode&1)!==0&&(n===null||(Zg.current&1)!==0?xg===0&&(xg=3):kc())),l.updateQueue!==null&&(l.flags|=4),qg(l),null);case 4:return Bl(),mc(n,l),n===null&&Wo(l.stateNode.containerInfo),qg(l),null;case 10:return La(l.type._context),qg(l),null;case 17:return ct(l.type)&&Bi(),qg(l),null;case 19:if(Ag(Zg),h=l.memoizedState,h===null)return qg(l),null;if(a=(l.flags&128)!==0,S=h.rendering,S===null)if(a)xo(h,!1);else{if(xg!==0||n!==null&&(n.flags&128)!==0)for(n=l.child;n!==null;){if(S=Hi(n),S!==null){for(l.flags|=128,xo(h,!1),a=S.updateQueue,a!==null&&(l.updateQueue=a,l.flags|=4),l.subtreeFlags=0,a=i,i=l.child;i!==null;)h=i,n=a,h.flags&=14680066,S=h.alternate,S===null?(h.childLanes=0,h.lanes=n,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=S.childLanes,h.lanes=S.lanes,h.child=S.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=S.memoizedProps,h.memoizedState=S.memoizedState,h.updateQueue=S.updateQueue,h.type=S.type,n=S.dependencies,h.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),i=i.sibling;return cg(Zg,Zg.current&1|2),l.child}n=n.sibling}h.tail!==null&&Rg()>Wl&&(l.flags|=128,a=!0,xo(h,!1),l.lanes=4194304)}else{if(!a)if(n=Hi(S),n!==null){if(l.flags|=128,a=!0,i=n.updateQueue,i!==null&&(l.updateQueue=i,l.flags|=4),xo(h,!0),h.tail===null&&h.tailMode==="hidden"&&!S.alternate&&!ug)return qg(l),null}else 2*Rg()-h.renderingStartTime>Wl&&i!==1073741824&&(l.flags|=128,a=!0,xo(h,!1),l.lanes=4194304);h.isBackwards?(S.sibling=l.child,l.child=S):(i=h.last,i!==null?i.sibling=S:l.child=S,h.last=S)}return h.tail!==null?(l=h.tail,h.rendering=l,h.tail=l.sibling,h.renderingStartTime=Rg(),l.sibling=null,i=Zg.current,cg(Zg,a?i&1|2:i&1),l):(qg(l),null);case 22:case 23:return Xc(),a=l.memoizedState!==null,n!==null&&n.memoizedState!==null!==a&&(l.flags|=8192),a&&(l.mode&1)!==0?(Vt&1073741824)!==0&&(qg(l),l.subtreeFlags&6&&(l.flags|=8192)):qg(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function ZV(n,l){switch(Na(l),l.tag){case 1:return ct(l.type)&&Bi(),n=l.flags,n&65536?(l.flags=n&-65537|128,l):null;case 3:return Bl(),Ag(at),Ag(Pg),qa(),n=l.flags,(n&65536)!==0&&(n&128)===0?(l.flags=n&-65537|128,l):null;case 5:return Pa(l),null;case 13:if(Ag(Zg),n=l.memoizedState,n!==null&&n.dehydrated!==null){if(l.alternate===null)throw Error(t(340));Zl()}return n=l.flags,n&65536?(l.flags=n&-65537|128,l):null;case 19:return Ag(Zg),null;case 4:return Bl(),null;case 10:return La(l.type._context),null;case 22:case 23:return Xc(),null;case 24:return null;default:return null}}var Ui=!1,_g=!1,bV=typeof WeakSet=="function"?WeakSet:Set,Be=null;function Sl(n,l){var i=n.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(a){fg(n,l,a)}else i.current=null}function hc(n,l,i){try{i()}catch(a){fg(n,l,a)}}var ap=!1;function GV(n,l){if(Xa=si,n=Um(),Ga(n)){if("selectionStart"in n)var i={start:n.selectionStart,end:n.selectionEnd};else e:{i=(i=n.ownerDocument)&&i.defaultView||window;var a=i.getSelection&&i.getSelection();if(a&&a.rangeCount!==0){i=a.anchorNode;var u=a.anchorOffset,h=a.focusNode;a=a.focusOffset;try{i.nodeType,h.nodeType}catch{i=null;break e}var S=0,Y=-1,x=-1,_=0,Ce=0,ie=n,le=null;g:for(;;){for(var Ze;ie!==i||u!==0&&ie.nodeType!==3||(Y=S+u),ie!==h||a!==0&&ie.nodeType!==3||(x=S+a),ie.nodeType===3&&(S+=ie.nodeValue.length),(Ze=ie.firstChild)!==null;)le=ie,ie=Ze;for(;;){if(ie===n)break g;if(le===i&&++_===u&&(Y=S),le===h&&++Ce===a&&(x=S),(Ze=ie.nextSibling)!==null)break;ie=le,le=ie.parentNode}ie=Ze}i=Y===-1||x===-1?null:{start:Y,end:x}}else i=null}i=i||{start:0,end:0}}else i=null;for(ka={focusedElem:n,selectionRange:i},si=!1,Be=l;Be!==null;)if(l=Be,n=l.child,(l.subtreeFlags&1028)!==0&&n!==null)n.return=l,Be=n;else for(;Be!==null;){l=Be;try{var fe=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(fe!==null){var Se=fe.memoizedProps,Xg=fe.memoizedState,T=l.stateNode,E=T.getSnapshotBeforeUpdate(l.elementType===l.type?Se:Pt(l.type,Se),Xg);T.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var O=l.stateNode.containerInfo;O.nodeType===1?O.textContent="":O.nodeType===9&&O.documentElement&&O.removeChild(O.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(de){fg(l,l.return,de)}if(n=l.sibling,n!==null){n.return=l.return,Be=n;break}Be=l.return}return fe=ap,ap=!1,fe}function Eo(n,l,i){var a=l.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var u=a=a.next;do{if((u.tag&n)===n){var h=u.destroy;u.destroy=void 0,h!==void 0&&hc(l,i,h)}u=u.next}while(u!==a)}}function Li(n,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var i=l=l.next;do{if((i.tag&n)===n){var a=i.create;i.destroy=a()}i=i.next}while(i!==l)}}function pc(n){var l=n.ref;if(l!==null){var i=n.stateNode;switch(n.tag){case 5:n=i;break;default:n=i}typeof l=="function"?l(n):l.current=n}}function cp(n){var l=n.alternate;l!==null&&(n.alternate=null,cp(l)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(l=n.stateNode,l!==null&&(delete l[rn],delete l[Xo],delete l[Ha],delete l[nV],delete l[IV])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function dp(n){return n.tag===5||n.tag===3||n.tag===4}function Ap(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||dp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Zc(n,l,i){var a=n.tag;if(a===5||a===6)n=n.stateNode,l?i.nodeType===8?i.parentNode.insertBefore(n,l):i.insertBefore(n,l):(i.nodeType===8?(l=i.parentNode,l.insertBefore(n,i)):(l=i,l.appendChild(n)),i=i._reactRootContainer,i!=null||l.onclick!==null||(l.onclick=Gi));else if(a!==4&&(n=n.child,n!==null))for(Zc(n,l,i),n=n.sibling;n!==null;)Zc(n,l,i),n=n.sibling}function bc(n,l,i){var a=n.tag;if(a===5||a===6)n=n.stateNode,l?i.insertBefore(n,l):i.appendChild(n);else if(a!==4&&(n=n.child,n!==null))for(bc(n,l,i),n=n.sibling;n!==null;)bc(n,l,i),n=n.sibling}var Lg=null,Ot=!1;function oI(n,l,i){for(i=i.child;i!==null;)up(n,l,i),i=i.sibling}function up(n,l,i){if(sn&&typeof sn.onCommitFiberUnmount=="function")try{sn.onCommitFiberUnmount(ni,i)}catch{}switch(i.tag){case 5:_g||Sl(i,l);case 6:var a=Lg,u=Ot;Lg=null,oI(n,l,i),Lg=a,Ot=u,Lg!==null&&(Ot?(n=Lg,i=i.stateNode,n.nodeType===8?n.parentNode.removeChild(i):n.removeChild(i)):Lg.removeChild(i.stateNode));break;case 18:Lg!==null&&(Ot?(n=Lg,i=i.stateNode,n.nodeType===8?Ya(n.parentNode,i):n.nodeType===1&&Ya(n,i),po(n)):Ya(Lg,i.stateNode));break;case 4:a=Lg,u=Ot,Lg=i.stateNode.containerInfo,Ot=!0,oI(n,l,i),Lg=a,Ot=u;break;case 0:case 11:case 14:case 15:if(!_g&&(a=i.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){u=a=a.next;do{var h=u,S=h.destroy;h=h.tag,S!==void 0&&((h&2)!==0||(h&4)!==0)&&hc(i,l,S),u=u.next}while(u!==a)}oI(n,l,i);break;case 1:if(!_g&&(Sl(i,l),a=i.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=i.memoizedProps,a.state=i.memoizedState,a.componentWillUnmount()}catch(Y){fg(i,l,Y)}oI(n,l,i);break;case 21:oI(n,l,i);break;case 22:i.mode&1?(_g=(a=_g)||i.memoizedState!==null,oI(n,l,i),_g=a):oI(n,l,i);break;default:oI(n,l,i)}}function mp(n){var l=n.updateQueue;if(l!==null){n.updateQueue=null;var i=n.stateNode;i===null&&(i=n.stateNode=new bV),l.forEach(function(a){var u=kV.bind(null,n,a);i.has(a)||(i.add(a),a.then(u,u))})}}function qt(n,l){var i=l.deletions;if(i!==null)for(var a=0;a<i.length;a++){var u=i[a];try{var h=n,S=l,Y=S;e:for(;Y!==null;){switch(Y.tag){case 5:Lg=Y.stateNode,Ot=!1;break e;case 3:Lg=Y.stateNode.containerInfo,Ot=!0;break e;case 4:Lg=Y.stateNode.containerInfo,Ot=!0;break e}Y=Y.return}if(Lg===null)throw Error(t(160));up(h,S,u),Lg=null,Ot=!1;var x=u.alternate;x!==null&&(x.return=null),u.return=null}catch(_){fg(u,l,_)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)hp(l,n),l=l.sibling}function hp(n,l){var i=n.alternate,a=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(qt(l,n),dn(n),a&4){try{Eo(3,n,n.return),Li(3,n)}catch(Se){fg(n,n.return,Se)}try{Eo(5,n,n.return)}catch(Se){fg(n,n.return,Se)}}break;case 1:qt(l,n),dn(n),a&512&&i!==null&&Sl(i,i.return);break;case 5:if(qt(l,n),dn(n),a&512&&i!==null&&Sl(i,i.return),n.flags&32){var u=n.stateNode;try{rg(u,"")}catch(Se){fg(n,n.return,Se)}}if(a&4&&(u=n.stateNode,u!=null)){var h=n.memoizedProps,S=i!==null?i.memoizedProps:h,Y=n.type,x=n.updateQueue;if(n.updateQueue=null,x!==null)try{Y==="input"&&h.type==="radio"&&h.name!=null&&Qe(u,h),pg(Y,S);var _=pg(Y,h);for(S=0;S<x.length;S+=2){var Ce=x[S],ie=x[S+1];Ce==="style"?Dn(u,ie):Ce==="dangerouslySetInnerHTML"?rt(u,ie):Ce==="children"?rg(u,ie):R(u,Ce,ie,_)}switch(Y){case"input":ye(u,h);break;case"textarea":He(u,h);break;case"select":var le=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!h.multiple;var Ze=h.value;Ze!=null?pe(u,!!h.multiple,Ze,!1):le!==!!h.multiple&&(h.defaultValue!=null?pe(u,!!h.multiple,h.defaultValue,!0):pe(u,!!h.multiple,h.multiple?[]:"",!1))}u[Xo]=h}catch(Se){fg(n,n.return,Se)}}break;case 6:if(qt(l,n),dn(n),a&4){if(n.stateNode===null)throw Error(t(162));u=n.stateNode,h=n.memoizedProps;try{u.nodeValue=h}catch(Se){fg(n,n.return,Se)}}break;case 3:if(qt(l,n),dn(n),a&4&&i!==null&&i.memoizedState.isDehydrated)try{po(l.containerInfo)}catch(Se){fg(n,n.return,Se)}break;case 4:qt(l,n),dn(n);break;case 13:qt(l,n),dn(n),u=n.child,u.flags&8192&&(h=u.memoizedState!==null,u.stateNode.isHidden=h,!h||u.alternate!==null&&u.alternate.memoizedState!==null||(Bc=Rg())),a&4&&mp(n);break;case 22:if(Ce=i!==null&&i.memoizedState!==null,n.mode&1?(_g=(_=_g)||Ce,qt(l,n),_g=_):qt(l,n),dn(n),a&8192){if(_=n.memoizedState!==null,(n.stateNode.isHidden=_)&&!Ce&&(n.mode&1)!==0)for(Be=n,Ce=n.child;Ce!==null;){for(ie=Be=Ce;Be!==null;){switch(le=Be,Ze=le.child,le.tag){case 0:case 11:case 14:case 15:Eo(4,le,le.return);break;case 1:Sl(le,le.return);var fe=le.stateNode;if(typeof fe.componentWillUnmount=="function"){a=le,i=le.return;try{l=a,fe.props=l.memoizedProps,fe.state=l.memoizedState,fe.componentWillUnmount()}catch(Se){fg(a,i,Se)}}break;case 5:Sl(le,le.return);break;case 22:if(le.memoizedState!==null){bp(ie);continue}}Ze!==null?(Ze.return=le,Be=Ze):bp(ie)}Ce=Ce.sibling}e:for(Ce=null,ie=n;;){if(ie.tag===5){if(Ce===null){Ce=ie;try{u=ie.stateNode,_?(h=u.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(Y=ie.stateNode,x=ie.memoizedProps.style,S=x!=null&&x.hasOwnProperty("display")?x.display:null,Y.style.display=on("display",S))}catch(Se){fg(n,n.return,Se)}}}else if(ie.tag===6){if(Ce===null)try{ie.stateNode.nodeValue=_?"":ie.memoizedProps}catch(Se){fg(n,n.return,Se)}}else if((ie.tag!==22&&ie.tag!==23||ie.memoizedState===null||ie===n)&&ie.child!==null){ie.child.return=ie,ie=ie.child;continue}if(ie===n)break e;for(;ie.sibling===null;){if(ie.return===null||ie.return===n)break e;Ce===ie&&(Ce=null),ie=ie.return}Ce===ie&&(Ce=null),ie.sibling.return=ie.return,ie=ie.sibling}}break;case 19:qt(l,n),dn(n),a&4&&mp(n);break;case 21:break;default:qt(l,n),dn(n)}}function dn(n){var l=n.flags;if(l&2){try{e:{for(var i=n.return;i!==null;){if(dp(i)){var a=i;break e}i=i.return}throw Error(t(160))}switch(a.tag){case 5:var u=a.stateNode;a.flags&32&&(rg(u,""),a.flags&=-33);var h=Ap(n);bc(n,h,u);break;case 3:case 4:var S=a.stateNode.containerInfo,Y=Ap(n);Zc(n,Y,S);break;default:throw Error(t(161))}}catch(x){fg(n,n.return,x)}n.flags&=-3}l&4096&&(n.flags&=-4097)}function yV(n,l,i){Be=n,pp(n)}function pp(n,l,i){for(var a=(n.mode&1)!==0;Be!==null;){var u=Be,h=u.child;if(u.tag===22&&a){var S=u.memoizedState!==null||Ui;if(!S){var Y=u.alternate,x=Y!==null&&Y.memoizedState!==null||_g;Y=Ui;var _=_g;if(Ui=S,(_g=x)&&!_)for(Be=u;Be!==null;)S=Be,x=S.child,S.tag===22&&S.memoizedState!==null?Gp(u):x!==null?(x.return=S,Be=x):Gp(u);for(;h!==null;)Be=h,pp(h),h=h.sibling;Be=u,Ui=Y,_g=_}Zp(n)}else(u.subtreeFlags&8772)!==0&&h!==null?(h.return=u,Be=h):Zp(n)}}function Zp(n){for(;Be!==null;){var l=Be;if((l.flags&8772)!==0){var i=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:_g||Li(5,l);break;case 1:var a=l.stateNode;if(l.flags&4&&!_g)if(i===null)a.componentDidMount();else{var u=l.elementType===l.type?i.memoizedProps:Pt(l.type,i.memoizedProps);a.componentDidUpdate(u,i.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var h=l.updateQueue;h!==null&&bh(l,h,a);break;case 3:var S=l.updateQueue;if(S!==null){if(i=null,l.child!==null)switch(l.child.tag){case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}bh(l,S,i)}break;case 5:var Y=l.stateNode;if(i===null&&l.flags&4){i=Y;var x=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":x.autoFocus&&i.focus();break;case"img":x.src&&(i.src=x.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var _=l.alternate;if(_!==null){var Ce=_.memoizedState;if(Ce!==null){var ie=Ce.dehydrated;ie!==null&&po(ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}_g||l.flags&512&&pc(l)}catch(le){fg(l,l.return,le)}}if(l===n){Be=null;break}if(i=l.sibling,i!==null){i.return=l.return,Be=i;break}Be=l.return}}function bp(n){for(;Be!==null;){var l=Be;if(l===n){Be=null;break}var i=l.sibling;if(i!==null){i.return=l.return,Be=i;break}Be=l.return}}function Gp(n){for(;Be!==null;){var l=Be;try{switch(l.tag){case 0:case 11:case 15:var i=l.return;try{Li(4,l)}catch(x){fg(l,i,x)}break;case 1:var a=l.stateNode;if(typeof a.componentDidMount=="function"){var u=l.return;try{a.componentDidMount()}catch(x){fg(l,u,x)}}var h=l.return;try{pc(l)}catch(x){fg(l,h,x)}break;case 5:var S=l.return;try{pc(l)}catch(x){fg(l,S,x)}}}catch(x){fg(l,l.return,x)}if(l===n){Be=null;break}var Y=l.sibling;if(Y!==null){Y.return=l.return,Be=Y;break}Be=l.return}}var BV=Math.ceil,Ti=k.ReactCurrentDispatcher,Gc=k.ReactCurrentOwner,wt=k.ReactCurrentBatchConfig,Te=0,zg=null,Hg=null,Tg=0,Vt=0,Vl=gI(0),xg=0,zo=null,JI=0,Qi=0,yc=0,Mo=null,At=null,Bc=0,Wl=1/0,wn=null,Di=!1,fc=null,CI=null,ji=!1,iI=null,Pi=0,Uo=0,Sc=null,Oi=-1,qi=0;function lt(){return(Te&6)!==0?Rg():Oi!==-1?Oi:Oi=Rg()}function sI(n){return(n.mode&1)===0?1:(Te&2)!==0&&Tg!==0?Tg&-Tg:oV.transition!==null?(qi===0&&(qi=Am()),qi):(n=tg,n!==0||(n=window.event,n=n===void 0?16:Bm(n.type)),n)}function _t(n,l,i,a){if(50<Uo)throw Uo=0,Sc=null,Error(t(185));co(n,i,a),((Te&2)===0||n!==zg)&&(n===zg&&((Te&2)===0&&(Qi|=i),xg===4&&rI(n,Tg)),ut(n,a),i===1&&Te===0&&(l.mode&1)===0&&(Wl=Rg()+500,Si&&nI()))}function ut(n,l){var i=n.callbackNode;oS(n,l);var a=oi(n,n===zg?Tg:0);if(a===0)i!==null&&am(i),n.callbackNode=null,n.callbackPriority=0;else if(l=a&-a,n.callbackPriority!==l){if(i!=null&&am(i),l===1)n.tag===0?lV(Bp.bind(null,n)):ih(Bp.bind(null,n)),gV(function(){(Te&6)===0&&nI()}),i=null;else{switch(um(a)){case 1:i=Ia;break;case 4:i=cm;break;case 16:i=ti;break;case 536870912:i=dm;break;default:i=ti}i=Jp(i,yp.bind(null,n))}n.callbackPriority=l,n.callbackNode=i}}function yp(n,l){if(Oi=-1,qi=0,(Te&6)!==0)throw Error(t(327));var i=n.callbackNode;if(Rl()&&n.callbackNode!==i)return null;var a=oi(n,n===zg?Tg:0);if(a===0)return null;if((a&30)!==0||(a&n.expiredLanes)!==0||l)l=_i(n,a);else{l=a;var u=Te;Te|=2;var h=Sp();(zg!==n||Tg!==l)&&(wn=null,Wl=Rg()+500,YI(n,l));do try{VV();break}catch(Y){fp(n,Y)}while(!0);Ua(),Ti.current=h,Te=u,Hg!==null?l=0:(zg=null,Tg=0,l=xg)}if(l!==0){if(l===2&&(u=la(n),u!==0&&(a=u,l=Vc(n,u))),l===1)throw i=zo,YI(n,0),rI(n,a),ut(n,Rg()),i;if(l===6)rI(n,a);else{if(u=n.current.alternate,(a&30)===0&&!fV(u)&&(l=_i(n,a),l===2&&(h=la(n),h!==0&&(a=h,l=Vc(n,h))),l===1))throw i=zo,YI(n,0),rI(n,a),ut(n,Rg()),i;switch(n.finishedWork=u,n.finishedLanes=a,l){case 0:case 1:throw Error(t(345));case 2:HI(n,At,wn);break;case 3:if(rI(n,a),(a&130023424)===a&&(l=Bc+500-Rg(),10<l)){if(oi(n,0)!==0)break;if(u=n.suspendedLanes,(u&a)!==a){lt(),n.pingedLanes|=n.suspendedLanes&u;break}n.timeoutHandle=va(HI.bind(null,n,At,wn),l);break}HI(n,At,wn);break;case 4:if(rI(n,a),(a&4194240)===a)break;for(l=n.eventTimes,u=-1;0<a;){var S=31-Qt(a);h=1<<S,S=l[S],S>u&&(u=S),a&=~h}if(a=u,a=Rg()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*BV(a/1960))-a,10<a){n.timeoutHandle=va(HI.bind(null,n,At,wn),a);break}HI(n,At,wn);break;case 5:HI(n,At,wn);break;default:throw Error(t(329))}}}return ut(n,Rg()),n.callbackNode===i?yp.bind(null,n):null}function Vc(n,l){var i=Mo;return n.current.memoizedState.isDehydrated&&(YI(n,l).flags|=256),n=_i(n,l),n!==2&&(l=At,At=i,l!==null&&Wc(l)),n}function Wc(n){At===null?At=n:At.push.apply(At,n)}function fV(n){for(var l=n;;){if(l.flags&16384){var i=l.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var a=0;a<i.length;a++){var u=i[a],h=u.getSnapshot;u=u.value;try{if(!Dt(h(),u))return!1}catch{return!1}}}if(i=l.child,l.subtreeFlags&16384&&i!==null)i.return=l,l=i;else{if(l===n)break;for(;l.sibling===null;){if(l.return===null||l.return===n)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function rI(n,l){for(l&=~yc,l&=~Qi,n.suspendedLanes|=l,n.pingedLanes&=~l,n=n.expirationTimes;0<l;){var i=31-Qt(l),a=1<<i;n[i]=-1,l&=~a}}function Bp(n){if((Te&6)!==0)throw Error(t(327));Rl();var l=oi(n,0);if((l&1)===0)return ut(n,Rg()),null;var i=_i(n,l);if(n.tag!==0&&i===2){var a=la(n);a!==0&&(l=a,i=Vc(n,a))}if(i===1)throw i=zo,YI(n,0),rI(n,l),ut(n,Rg()),i;if(i===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=l,HI(n,At,wn),ut(n,Rg()),null}function Rc(n,l){var i=Te;Te|=1;try{return n(l)}finally{Te=i,Te===0&&(Wl=Rg()+500,Si&&nI())}}function vI(n){iI!==null&&iI.tag===0&&(Te&6)===0&&Rl();var l=Te;Te|=1;var i=wt.transition,a=tg;try{if(wt.transition=null,tg=1,n)return n()}finally{tg=a,wt.transition=i,Te=l,(Te&6)===0&&nI()}}function Xc(){Vt=Vl.current,Ag(Vl)}function YI(n,l){n.finishedWork=null,n.finishedLanes=0;var i=n.timeoutHandle;if(i!==-1&&(n.timeoutHandle=-1,eV(i)),Hg!==null)for(i=Hg.return;i!==null;){var a=i;switch(Na(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&Bi();break;case 3:Bl(),Ag(at),Ag(Pg),qa();break;case 5:Pa(a);break;case 4:Bl();break;case 13:Ag(Zg);break;case 19:Ag(Zg);break;case 10:La(a.type._context);break;case 22:case 23:Xc()}i=i.return}if(zg=n,Hg=n=aI(n.current,null),Tg=Vt=l,xg=0,zo=null,yc=Qi=JI=0,At=Mo=null,RI!==null){for(l=0;l<RI.length;l++)if(i=RI[l],a=i.interleaved,a!==null){i.interleaved=null;var u=a.next,h=i.pending;if(h!==null){var S=h.next;h.next=u,a.next=S}i.pending=a}RI=null}return n}function fp(n,l){do{var i=Hg;try{if(Ua(),wi.current=xi,Fi){for(var a=bg.memoizedState;a!==null;){var u=a.queue;u!==null&&(u.pending=null),a=a.next}Fi=!1}if(kI=0,Eg=Ng=bg=null,wo=!1,Fo=0,Gc.current=null,i===null||i.return===null){xg=1,zo=l,Hg=null;break}e:{var h=n,S=i.return,Y=i,x=l;if(l=Tg,Y.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){var _=x,Ce=Y,ie=Ce.tag;if((Ce.mode&1)===0&&(ie===0||ie===11||ie===15)){var le=Ce.alternate;le?(Ce.updateQueue=le.updateQueue,Ce.memoizedState=le.memoizedState,Ce.lanes=le.lanes):(Ce.updateQueue=null,Ce.memoizedState=null)}var Ze=Ph(S);if(Ze!==null){Ze.flags&=-257,Oh(Ze,S,Y,h,l),Ze.mode&1&&jh(h,_,l),l=Ze,x=_;var fe=l.updateQueue;if(fe===null){var Se=new Set;Se.add(x),l.updateQueue=Se}else fe.add(x);break e}else{if((l&1)===0){jh(h,_,l),kc();break e}x=Error(t(426))}}else if(ug&&Y.mode&1){var Xg=Ph(S);if(Xg!==null){(Xg.flags&65536)===0&&(Xg.flags|=256),Oh(Xg,S,Y,h,l),za(fl(x,Y));break e}}h=x=fl(x,Y),xg!==4&&(xg=2),Mo===null?Mo=[h]:Mo.push(h),h=S;do{switch(h.tag){case 3:h.flags|=65536,l&=-l,h.lanes|=l;var T=Qh(h,x,l);Zh(h,T);break e;case 1:Y=x;var E=h.type,O=h.stateNode;if((h.flags&128)===0&&(typeof E.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(CI===null||!CI.has(O)))){h.flags|=65536,l&=-l,h.lanes|=l;var de=Dh(h,Y,l);Zh(h,de);break e}}h=h.return}while(h!==null)}Wp(i)}catch(Ve){l=Ve,Hg===i&&i!==null&&(Hg=i=i.return);continue}break}while(!0)}function Sp(){var n=Ti.current;return Ti.current=xi,n===null?xi:n}function kc(){(xg===0||xg===3||xg===2)&&(xg=4),zg===null||(JI&268435455)===0&&(Qi&268435455)===0||rI(zg,Tg)}function _i(n,l){var i=Te;Te|=2;var a=Sp();(zg!==n||Tg!==l)&&(wn=null,YI(n,l));do try{SV();break}catch(u){fp(n,u)}while(!0);if(Ua(),Te=i,Ti.current=a,Hg!==null)throw Error(t(261));return zg=null,Tg=0,xg}function SV(){for(;Hg!==null;)Vp(Hg)}function VV(){for(;Hg!==null&&!qf();)Vp(Hg)}function Vp(n){var l=kp(n.alternate,n,Vt);n.memoizedProps=n.pendingProps,l===null?Wp(n):Hg=l,Gc.current=null}function Wp(n){var l=n;do{var i=l.alternate;if(n=l.return,(l.flags&32768)===0){if(i=pV(i,l,Vt),i!==null){Hg=i;return}}else{if(i=ZV(i,l),i!==null){i.flags&=32767,Hg=i;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{xg=6,Hg=null;return}}if(l=l.sibling,l!==null){Hg=l;return}Hg=l=n}while(l!==null);xg===0&&(xg=5)}function HI(n,l,i){var a=tg,u=wt.transition;try{wt.transition=null,tg=1,WV(n,l,i,a)}finally{wt.transition=u,tg=a}return null}function WV(n,l,i,a){do Rl();while(iI!==null);if((Te&6)!==0)throw Error(t(327));i=n.finishedWork;var u=n.finishedLanes;if(i===null)return null;if(n.finishedWork=null,n.finishedLanes=0,i===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var h=i.lanes|i.childLanes;if(CS(n,h),n===zg&&(Hg=zg=null,Tg=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||ji||(ji=!0,Jp(ti,function(){return Rl(),null})),h=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||h){h=wt.transition,wt.transition=null;var S=tg;tg=1;var Y=Te;Te|=4,Gc.current=null,GV(n,i),hp(i,n),DS(ka),si=!!Xa,ka=Xa=null,n.current=i,yV(i),_f(),Te=Y,tg=S,wt.transition=h}else n.current=i;if(ji&&(ji=!1,iI=n,Pi=u),h=n.pendingLanes,h===0&&(CI=null),gS(i.stateNode),ut(n,Rg()),l!==null)for(a=n.onRecoverableError,i=0;i<l.length;i++)u=l[i],a(u.value,{componentStack:u.stack,digest:u.digest});if(Di)throw Di=!1,n=fc,fc=null,n;return(Pi&1)!==0&&n.tag!==0&&Rl(),h=n.pendingLanes,(h&1)!==0?n===Sc?Uo++:(Uo=0,Sc=n):Uo=0,nI(),null}function Rl(){if(iI!==null){var n=um(Pi),l=wt.transition,i=tg;try{if(wt.transition=null,tg=16>n?16:n,iI===null)var a=!1;else{if(n=iI,iI=null,Pi=0,(Te&6)!==0)throw Error(t(331));var u=Te;for(Te|=4,Be=n.current;Be!==null;){var h=Be,S=h.child;if((Be.flags&16)!==0){var Y=h.deletions;if(Y!==null){for(var x=0;x<Y.length;x++){var _=Y[x];for(Be=_;Be!==null;){var Ce=Be;switch(Ce.tag){case 0:case 11:case 15:Eo(8,Ce,h)}var ie=Ce.child;if(ie!==null)ie.return=Ce,Be=ie;else for(;Be!==null;){Ce=Be;var le=Ce.sibling,Ze=Ce.return;if(cp(Ce),Ce===_){Be=null;break}if(le!==null){le.return=Ze,Be=le;break}Be=Ze}}}var fe=h.alternate;if(fe!==null){var Se=fe.child;if(Se!==null){fe.child=null;do{var Xg=Se.sibling;Se.sibling=null,Se=Xg}while(Se!==null)}}Be=h}}if((h.subtreeFlags&2064)!==0&&S!==null)S.return=h,Be=S;else e:for(;Be!==null;){if(h=Be,(h.flags&2048)!==0)switch(h.tag){case 0:case 11:case 15:Eo(9,h,h.return)}var T=h.sibling;if(T!==null){T.return=h.return,Be=T;break e}Be=h.return}}var E=n.current;for(Be=E;Be!==null;){S=Be;var O=S.child;if((S.subtreeFlags&2064)!==0&&O!==null)O.return=S,Be=O;else e:for(S=E;Be!==null;){if(Y=Be,(Y.flags&2048)!==0)try{switch(Y.tag){case 0:case 11:case 15:Li(9,Y)}}catch(Ve){fg(Y,Y.return,Ve)}if(Y===S){Be=null;break e}var de=Y.sibling;if(de!==null){de.return=Y.return,Be=de;break e}Be=Y.return}}if(Te=u,nI(),sn&&typeof sn.onPostCommitFiberRoot=="function")try{sn.onPostCommitFiberRoot(ni,n)}catch{}a=!0}return a}finally{tg=i,wt.transition=l}}return!1}function Rp(n,l,i){l=fl(i,l),l=Qh(n,l,1),n=lI(n,l,1),l=lt(),n!==null&&(co(n,1,l),ut(n,l))}function fg(n,l,i){if(n.tag===3)Rp(n,n,i);else for(;l!==null;){if(l.tag===3){Rp(l,n,i);break}else if(l.tag===1){var a=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(CI===null||!CI.has(a))){n=fl(i,n),n=Dh(l,n,1),l=lI(l,n,1),n=lt(),l!==null&&(co(l,1,n),ut(l,n));break}}l=l.return}}function RV(n,l,i){var a=n.pingCache;a!==null&&a.delete(l),l=lt(),n.pingedLanes|=n.suspendedLanes&i,zg===n&&(Tg&i)===i&&(xg===4||xg===3&&(Tg&130023424)===Tg&&500>Rg()-Bc?YI(n,0):yc|=i),ut(n,l)}function Xp(n,l){l===0&&((n.mode&1)===0?l=1:(l=li,li<<=1,(li&130023424)===0&&(li=4194304)));var i=lt();n=vn(n,l),n!==null&&(co(n,l,i),ut(n,i))}function XV(n){var l=n.memoizedState,i=0;l!==null&&(i=l.retryLane),Xp(n,i)}function kV(n,l){var i=0;switch(n.tag){case 13:var a=n.stateNode,u=n.memoizedState;u!==null&&(i=u.retryLane);break;case 19:a=n.stateNode;break;default:throw Error(t(314))}a!==null&&a.delete(l),Xp(n,i)}var kp;kp=function(n,l,i){if(n!==null)if(n.memoizedProps!==l.pendingProps||at.current)dt=!0;else{if((n.lanes&i)===0&&(l.flags&128)===0)return dt=!1,hV(n,l,i);dt=(n.flags&131072)!==0}else dt=!1,ug&&(l.flags&1048576)!==0&&sh(l,Wi,l.index);switch(l.lanes=0,l.tag){case 2:var a=l.type;Mi(n,l),n=l.pendingProps;var u=ml(l,Pg.current);yl(l,i),u=ec(null,l,a,n,u,i);var h=gc();return l.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,ct(a)?(h=!0,fi(l)):h=!1,l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,Da(l),u.updater=Ei,l.stateNode=u,u._reactInternals=l,Cc(l,a,n,i),l=ac(null,l,a,!0,h,i)):(l.tag=0,ug&&h&&Ka(l),It(null,l,u,i),l=l.child),l;case 16:a=l.elementType;e:{switch(Mi(n,l),n=l.pendingProps,u=a._init,a=u(a._payload),l.type=a,u=l.tag=vV(a),n=Pt(a,n),u){case 0:l=rc(null,l,a,n,i);break e;case 1:l=tp(null,l,a,n,i);break e;case 11:l=qh(null,l,a,n,i);break e;case 14:l=_h(null,l,a,Pt(a.type,n),i);break e}throw Error(t(306,a,""))}return l;case 0:return a=l.type,u=l.pendingProps,u=l.elementType===a?u:Pt(a,u),rc(n,l,a,u,i);case 1:return a=l.type,u=l.pendingProps,u=l.elementType===a?u:Pt(a,u),tp(n,l,a,u,i);case 3:e:{if(np(l),n===null)throw Error(t(387));a=l.pendingProps,h=l.memoizedState,u=h.element,ph(n,l),Yi(l,a,null,i);var S=l.memoizedState;if(a=S.element,h.isDehydrated)if(h={element:a,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},l.updateQueue.baseState=h,l.memoizedState=h,l.flags&256){u=fl(Error(t(423)),l),l=Ip(n,l,a,i,u);break e}else if(a!==u){u=fl(Error(t(424)),l),l=Ip(n,l,a,i,u);break e}else for(St=eI(l.stateNode.containerInfo.firstChild),ft=l,ug=!0,jt=null,i=mh(l,null,a,i),l.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Zl(),a===u){l=Hn(n,l,i);break e}It(n,l,a,i)}l=l.child}return l;case 5:return Gh(l),n===null&&Ea(l),a=l.type,u=l.pendingProps,h=n!==null?n.memoizedProps:null,S=u.children,Ja(a,u)?S=null:h!==null&&Ja(a,h)&&(l.flags|=32),gp(n,l),It(n,l,S,i),l.child;case 6:return n===null&&Ea(l),null;case 13:return lp(n,l,i);case 4:return ja(l,l.stateNode.containerInfo),a=l.pendingProps,n===null?l.child=bl(l,null,a,i):It(n,l,a,i),l.child;case 11:return a=l.type,u=l.pendingProps,u=l.elementType===a?u:Pt(a,u),qh(n,l,a,u,i);case 7:return It(n,l,l.pendingProps,i),l.child;case 8:return It(n,l,l.pendingProps.children,i),l.child;case 12:return It(n,l,l.pendingProps.children,i),l.child;case 10:e:{if(a=l.type._context,u=l.pendingProps,h=l.memoizedProps,S=u.value,cg(ki,a._currentValue),a._currentValue=S,h!==null)if(Dt(h.value,S)){if(h.children===u.children&&!at.current){l=Hn(n,l,i);break e}}else for(h=l.child,h!==null&&(h.return=l);h!==null;){var Y=h.dependencies;if(Y!==null){S=h.child;for(var x=Y.firstContext;x!==null;){if(x.context===a){if(h.tag===1){x=Yn(-1,i&-i),x.tag=2;var _=h.updateQueue;if(_!==null){_=_.shared;var Ce=_.pending;Ce===null?x.next=x:(x.next=Ce.next,Ce.next=x),_.pending=x}}h.lanes|=i,x=h.alternate,x!==null&&(x.lanes|=i),Ta(h.return,i,l),Y.lanes|=i;break}x=x.next}}else if(h.tag===10)S=h.type===l.type?null:h.child;else if(h.tag===18){if(S=h.return,S===null)throw Error(t(341));S.lanes|=i,Y=S.alternate,Y!==null&&(Y.lanes|=i),Ta(S,i,l),S=h.sibling}else S=h.child;if(S!==null)S.return=h;else for(S=h;S!==null;){if(S===l){S=null;break}if(h=S.sibling,h!==null){h.return=S.return,S=h;break}S=S.return}h=S}It(n,l,u.children,i),l=l.child}return l;case 9:return u=l.type,a=l.pendingProps.children,yl(l,i),u=Yt(u),a=a(u),l.flags|=1,It(n,l,a,i),l.child;case 14:return a=l.type,u=Pt(a,l.pendingProps),u=Pt(a.type,u),_h(n,l,a,u,i);case 15:return $h(n,l,l.type,l.pendingProps,i);case 17:return a=l.type,u=l.pendingProps,u=l.elementType===a?u:Pt(a,u),Mi(n,l),l.tag=1,ct(a)?(n=!0,fi(l)):n=!1,yl(l,i),Lh(l,a,u),Cc(l,a,u,i),ac(null,l,a,!0,n,i);case 19:return Cp(n,l,i);case 22:return ep(n,l,i)}throw Error(t(156,l.tag))};function Jp(n,l){return rm(n,l)}function JV(n,l,i,a){this.tag=n,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ft(n,l,i,a){return new JV(n,l,i,a)}function Jc(n){return n=n.prototype,!(!n||!n.isReactComponent)}function vV(n){if(typeof n=="function")return Jc(n)?1:0;if(n!=null){if(n=n.$$typeof,n===V)return 11;if(n===L)return 14}return 2}function aI(n,l){var i=n.alternate;return i===null?(i=Ft(n.tag,l,n.key,n.mode),i.elementType=n.elementType,i.type=n.type,i.stateNode=n.stateNode,i.alternate=n,n.alternate=i):(i.pendingProps=l,i.type=n.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=n.flags&14680064,i.childLanes=n.childLanes,i.lanes=n.lanes,i.child=n.child,i.memoizedProps=n.memoizedProps,i.memoizedState=n.memoizedState,i.updateQueue=n.updateQueue,l=n.dependencies,i.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},i.sibling=n.sibling,i.index=n.index,i.ref=n.ref,i}function $i(n,l,i,a,u,h){var S=2;if(a=n,typeof n=="function")Jc(n)&&(S=1);else if(typeof n=="string")S=5;else e:switch(n){case U:return wI(i.children,u,h,l);case X:S=8,u|=8;break;case K:return n=Ft(12,i,l,u|2),n.elementType=K,n.lanes=h,n;case z:return n=Ft(13,i,l,u),n.elementType=z,n.lanes=h,n;case N:return n=Ft(19,i,l,u),n.elementType=N,n.lanes=h,n;case q:return es(i,u,h,l);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case w:S=10;break e;case D:S=9;break e;case V:S=11;break e;case L:S=14;break e;case Q:S=16,a=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return l=Ft(S,i,l,u),l.elementType=n,l.type=a,l.lanes=h,l}function wI(n,l,i,a){return n=Ft(7,n,a,l),n.lanes=i,n}function es(n,l,i,a){return n=Ft(22,n,a,l),n.elementType=q,n.lanes=i,n.stateNode={isHidden:!1},n}function vc(n,l,i){return n=Ft(6,n,null,l),n.lanes=i,n}function Yc(n,l,i){return l=Ft(4,n.children!==null?n.children:[],n.key,l),l.lanes=i,l.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},l}function YV(n,l,i,a,u){this.tag=l,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oa(0),this.expirationTimes=oa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oa(0),this.identifierPrefix=a,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function Hc(n,l,i,a,u,h,S,Y,x){return n=new YV(n,l,i,Y,x),l===1?(l=1,h===!0&&(l|=8)):l=0,h=Ft(3,null,null,l),n.current=h,h.stateNode=n,h.memoizedState={element:a,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Da(h),n}function HV(n,l,i){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:a==null?null:""+a,children:n,containerInfo:l,implementation:i}}function vp(n){if(!n)return tI;n=n._reactInternals;e:{if(BI(n)!==n||n.tag!==1)throw Error(t(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(ct(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(n.tag===1){var i=n.type;if(ct(i))return oh(n,i,l)}return l}function Yp(n,l,i,a,u,h,S,Y,x){return n=Hc(i,a,!0,n,u,h,S,Y,x),n.context=vp(null),i=n.current,a=lt(),u=sI(i),h=Yn(a,u),h.callback=l??null,lI(i,h,u),n.current.lanes=u,co(n,u,a),ut(n,a),n}function gs(n,l,i,a){var u=l.current,h=lt(),S=sI(u);return i=vp(i),l.context===null?l.context=i:l.pendingContext=i,l=Yn(h,S),l.payload={element:n},a=a===void 0?null:a,a!==null&&(l.callback=a),n=lI(u,l,S),n!==null&&(_t(n,u,S,h),vi(n,u,S)),S}function ts(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Hp(n,l){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var i=n.retryLane;n.retryLane=i!==0&&i<l?i:l}}function wc(n,l){Hp(n,l),(n=n.alternate)&&Hp(n,l)}function wV(){return null}var wp=typeof reportError=="function"?reportError:function(n){console.error(n)};function Fc(n){this._internalRoot=n}ns.prototype.render=Fc.prototype.render=function(n){var l=this._internalRoot;if(l===null)throw Error(t(409));gs(n,l,null,null)},ns.prototype.unmount=Fc.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var l=n.containerInfo;vI(function(){gs(null,n,null,null)}),l[Rn]=null}};function ns(n){this._internalRoot=n}ns.prototype.unstable_scheduleHydration=function(n){if(n){var l=pm();n={blockedOn:null,target:n,priority:l};for(var i=0;i<qn.length&&l!==0&&l<qn[i].priority;i++);qn.splice(i,0,n),i===0&&Gm(n)}};function Kc(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Is(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Fp(){}function FV(n,l,i,a,u){if(u){if(typeof a=="function"){var h=a;a=function(){var _=ts(S);h.call(_)}}var S=Yp(l,a,n,0,null,!1,!1,"",Fp);return n._reactRootContainer=S,n[Rn]=S.current,Wo(n.nodeType===8?n.parentNode:n),vI(),S}for(;u=n.lastChild;)n.removeChild(u);if(typeof a=="function"){var Y=a;a=function(){var _=ts(x);Y.call(_)}}var x=Hc(n,0,!1,null,null,!1,!1,"",Fp);return n._reactRootContainer=x,n[Rn]=x.current,Wo(n.nodeType===8?n.parentNode:n),vI(function(){gs(l,x,i,a)}),x}function ls(n,l,i,a,u){var h=i._reactRootContainer;if(h){var S=h;if(typeof u=="function"){var Y=u;u=function(){var x=ts(S);Y.call(x)}}gs(l,S,n,u)}else S=FV(i,l,n,u,a);return ts(S)}mm=function(n){switch(n.tag){case 3:var l=n.stateNode;if(l.current.memoizedState.isDehydrated){var i=ao(l.pendingLanes);i!==0&&(Ca(l,i|1),ut(l,Rg()),(Te&6)===0&&(Wl=Rg()+500,nI()))}break;case 13:vI(function(){var a=vn(n,1);if(a!==null){var u=lt();_t(a,n,1,u)}}),wc(n,1)}},ia=function(n){if(n.tag===13){var l=vn(n,134217728);if(l!==null){var i=lt();_t(l,n,134217728,i)}wc(n,134217728)}},hm=function(n){if(n.tag===13){var l=sI(n),i=vn(n,l);if(i!==null){var a=lt();_t(i,n,l,a)}wc(n,l)}},pm=function(){return tg},Zm=function(n,l){var i=tg;try{return tg=n,l()}finally{tg=i}},ea=function(n,l,i){switch(l){case"input":if(ye(n,i),l=i.name,i.type==="radio"&&l!=null){for(i=n;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<i.length;l++){var a=i[l];if(a!==n&&a.form===n.form){var u=yi(a);if(!u)throw Error(t(90));me(a),ye(a,u)}}}break;case"textarea":He(n,i);break;case"select":l=i.value,l!=null&&pe(n,!!i.multiple,l,!1)}},nm=Rc,Im=vI;var KV={usingClientEntryPoint:!1,Events:[ko,Al,yi,gm,tm,Rc]},Lo={findFiberByHostInstance:fI,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NV={bundleType:Lo.bundleType,version:Lo.version,rendererPackageName:Lo.rendererPackageName,rendererConfig:Lo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=im(n),n===null?null:n.stateNode},findFiberByHostInstance:Lo.findFiberByHostInstance||wV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var os=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!os.isDisabled&&os.supportsFiber)try{ni=os.inject(NV),sn=os}catch{}}return mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KV,mt.createPortal=function(n,l){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kc(l))throw Error(t(200));return HV(n,l,null,i)},mt.createRoot=function(n,l){if(!Kc(n))throw Error(t(299));var i=!1,a="",u=wp;return l!=null&&(l.unstable_strictMode===!0&&(i=!0),l.identifierPrefix!==void 0&&(a=l.identifierPrefix),l.onRecoverableError!==void 0&&(u=l.onRecoverableError)),l=Hc(n,1,!1,null,null,i,!1,a,u),n[Rn]=l.current,Wo(n.nodeType===8?n.parentNode:n),new Fc(l)},mt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var l=n._reactInternals;if(l===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=im(l),n=n===null?null:n.stateNode,n},mt.flushSync=function(n){return vI(n)},mt.hydrate=function(n,l,i){if(!Is(l))throw Error(t(200));return ls(null,n,l,!0,i)},mt.hydrateRoot=function(n,l,i){if(!Kc(n))throw Error(t(405));var a=i!=null&&i.hydratedSources||null,u=!1,h="",S=wp;if(i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(S=i.onRecoverableError)),l=Yp(l,null,n,1,i??null,u,!1,h,S),n[Rn]=l.current,Wo(n),a)for(n=0;n<a.length;n++)i=a[n],u=i._getVersion,u=u(i._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[i,u]:l.mutableSourceEagerHydrationData.push(i,u);return new ns(l)},mt.render=function(n,l,i){if(!Is(l))throw Error(t(200));return ls(null,n,l,!1,i)},mt.unmountComponentAtNode=function(n){if(!Is(n))throw Error(t(40));return n._reactRootContainer?(vI(function(){ls(null,null,n,!1,function(){n._reactRootContainer=null,n[Rn]=null})}),!0):!1},mt.unstable_batchedUpdates=Rc,mt.unstable_renderSubtreeIntoContainer=function(n,l,i,a){if(!Is(i))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return ls(n,l,i,!1,a)},mt.version="18.3.1-next-f1338f8080-20240426",mt}var Lp;function lG(){if(Lp)return Ec.exports;Lp=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(g){console.error(g)}}return e(),Ec.exports=QV(),Ec.exports}var Tp;function DV(){if(Tp)return Cs;Tp=1;var e=lG();return Cs.createRoot=e.createRoot,Cs.hydrateRoot=e.hydrateRoot,Cs}var jV=DV();const PV=BA(jV);var Qo={},Qp;function OV(){if(Qp)return Qo;Qp=1,Object.defineProperty(Qo,"__esModule",{value:!0}),Qo.parse=s,Qo.serialize=d;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,g=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,I=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,C=(()=>{const Z=function(){};return Z.prototype=Object.create(null),Z})();function s(Z,y){const G=new C,B=Z.length;if(B<2)return G;const f=y?.decode||A;let W=0;do{const v=Z.indexOf("=",W);if(v===-1)break;const R=Z.indexOf(";",W),k=R===-1?B:R;if(v>k){W=Z.lastIndexOf(";",v-1)+1;continue}const J=r(Z,W,v),F=c(Z,v,J),U=Z.slice(J,F);if(G[U]===void 0){let X=r(Z,v+1,k),K=c(Z,k,X);const w=f(Z.slice(X,K));G[U]=w}W=k+1}while(W<B);return G}function r(Z,y,G){do{const B=Z.charCodeAt(y);if(B!==32&&B!==9)return y}while(++y<G);return G}function c(Z,y,G){for(;y>G;){const B=Z.charCodeAt(--y);if(B!==32&&B!==9)return y+1}return G}function d(Z,y,G){const B=G?.encode||encodeURIComponent;if(!e.test(Z))throw new TypeError(`argument name is invalid: ${Z}`);const f=B(y);if(!g.test(f))throw new TypeError(`argument val is invalid: ${y}`);let W=Z+"="+f;if(!G)return W;if(G.maxAge!==void 0){if(!Number.isInteger(G.maxAge))throw new TypeError(`option maxAge is invalid: ${G.maxAge}`);W+="; Max-Age="+G.maxAge}if(G.domain){if(!t.test(G.domain))throw new TypeError(`option domain is invalid: ${G.domain}`);W+="; Domain="+G.domain}if(G.path){if(!I.test(G.path))throw new TypeError(`option path is invalid: ${G.path}`);W+="; Path="+G.path}if(G.expires){if(!m(G.expires)||!Number.isFinite(G.expires.valueOf()))throw new TypeError(`option expires is invalid: ${G.expires}`);W+="; Expires="+G.expires.toUTCString()}if(G.httpOnly&&(W+="; HttpOnly"),G.secure&&(W+="; Secure"),G.partitioned&&(W+="; Partitioned"),G.priority)switch(typeof G.priority=="string"?G.priority.toLowerCase():void 0){case"low":W+="; Priority=Low";break;case"medium":W+="; Priority=Medium";break;case"high":W+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${G.priority}`)}if(G.sameSite)switch(typeof G.sameSite=="string"?G.sameSite.toLowerCase():G.sameSite){case!0:case"strict":W+="; SameSite=Strict";break;case"lax":W+="; SameSite=Lax";break;case"none":W+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${G.sameSite}`)}return W}function A(Z){if(Z.indexOf("%")===-1)return Z;try{return decodeURIComponent(Z)}catch{return Z}}function m(Z){return o.call(Z)==="[object Date]"}return Qo}OV();var Dp="popstate";function qV(e={}){function g(I,o){let{pathname:C,search:s,hash:r}=I.location;return Sd("",{pathname:C,search:s,hash:r},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(I,o){return typeof o=="string"?o:ZC(o)}return $V(g,t,null,e)}function Bg(e,g){if(e===!1||e===null||typeof e>"u")throw new Error(g)}function fn(e,g){if(!e){typeof console<"u"&&console.warn(g);try{throw new Error(g)}catch{}}}function _V(){return Math.random().toString(36).substring(2,10)}function jp(e,g){return{usr:e.state,key:e.key,idx:g}}function Sd(e,g,t=null,I){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof g=="string"?Ol(g):g,state:t,key:g&&g.key||I||_V()}}function ZC({pathname:e="/",search:g="",hash:t=""}){return g&&g!=="?"&&(e+=g.charAt(0)==="?"?g:"?"+g),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Ol(e){let g={};if(e){let t=e.indexOf("#");t>=0&&(g.hash=e.substring(t),e=e.substring(0,t));let I=e.indexOf("?");I>=0&&(g.search=e.substring(I),e=e.substring(0,I)),e&&(g.pathname=e)}return g}function $V(e,g,t,I={}){let{window:o=document.defaultView,v5Compat:C=!1}=I,s=o.history,r="POP",c=null,d=A();d==null&&(d=0,s.replaceState({...s.state,idx:d},""));function A(){return(s.state||{idx:null}).idx}function m(){r="POP";let f=A(),W=f==null?null:f-d;d=f,c&&c({action:r,location:B.location,delta:W})}function Z(f,W){r="PUSH";let v=Sd(B.location,f,W);d=A()+1;let R=jp(v,d),k=B.createHref(v);try{s.pushState(R,"",k)}catch(J){if(J instanceof DOMException&&J.name==="DataCloneError")throw J;o.location.assign(k)}C&&c&&c({action:r,location:B.location,delta:1})}function y(f,W){r="REPLACE";let v=Sd(B.location,f,W);d=A();let R=jp(v,d),k=B.createHref(v);s.replaceState(R,"",k),C&&c&&c({action:r,location:B.location,delta:0})}function G(f){return eW(f)}let B={get action(){return r},get location(){return e(o,s)},listen(f){if(c)throw new Error("A history only accepts one active listener");return o.addEventListener(Dp,m),c=f,()=>{o.removeEventListener(Dp,m),c=null}},createHref(f){return g(o,f)},createURL:G,encodeLocation(f){let W=G(f);return{pathname:W.pathname,search:W.search,hash:W.hash}},push:Z,replace:y,go(f){return s.go(f)}};return B}function eW(e,g=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Bg(t,"No window.location.(origin|href) available to create URL");let I=typeof e=="string"?e:ZC(e);return I=I.replace(/ $/,"%20"),!g&&I.startsWith("//")&&(I=t+I),new URL(I,t)}function oG(e,g,t="/"){return gW(e,g,t,!1)}function gW(e,g,t,I){let o=typeof g=="string"?Ol(g):g,C=xn(o.pathname||"/",t);if(C==null)return null;let s=CG(e);tW(s);let r=null;for(let c=0;r==null&&c<s.length;++c){let d=dW(C);r=aW(s[c],d,I)}return r}function CG(e,g=[],t=[],I=""){let o=(C,s,r)=>{let c={relativePath:r===void 0?C.path||"":r,caseSensitive:C.caseSensitive===!0,childrenIndex:s,route:C};c.relativePath.startsWith("/")&&(Bg(c.relativePath.startsWith(I),`Absolute route path "${c.relativePath}" nested under path "${I}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(I.length));let d=Nn([I,c.relativePath]),A=t.concat(c);C.children&&C.children.length>0&&(Bg(C.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),CG(C.children,g,A,d)),!(C.path==null&&!C.index)&&g.push({path:d,score:sW(d,C.index),routesMeta:A})};return e.forEach((C,s)=>{if(C.path===""||!C.path?.includes("?"))o(C,s);else for(let r of iG(C.path))o(C,s,r)}),g}function iG(e){let g=e.split("/");if(g.length===0)return[];let[t,...I]=g,o=t.endsWith("?"),C=t.replace(/\?$/,"");if(I.length===0)return o?[C,""]:[C];let s=iG(I.join("/")),r=[];return r.push(...s.map(c=>c===""?C:[C,c].join("/"))),o&&r.push(...s),r.map(c=>e.startsWith("/")&&c===""?"/":c)}function tW(e){e.sort((g,t)=>g.score!==t.score?t.score-g.score:rW(g.routesMeta.map(I=>I.childrenIndex),t.routesMeta.map(I=>I.childrenIndex)))}var nW=/^:[\w-]+$/,IW=3,lW=2,oW=1,CW=10,iW=-2,Pp=e=>e==="*";function sW(e,g){let t=e.split("/"),I=t.length;return t.some(Pp)&&(I+=iW),g&&(I+=lW),t.filter(o=>!Pp(o)).reduce((o,C)=>o+(nW.test(C)?IW:C===""?oW:CW),I)}function rW(e,g){return e.length===g.length&&e.slice(0,-1).every((I,o)=>I===g[o])?e[e.length-1]-g[g.length-1]:0}function aW(e,g,t=!1){let{routesMeta:I}=e,o={},C="/",s=[];for(let r=0;r<I.length;++r){let c=I[r],d=r===I.length-1,A=C==="/"?g:g.slice(C.length)||"/",m=Ls({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},A),Z=c.route;if(!m&&d&&t&&!I[I.length-1].route.index&&(m=Ls({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},A)),!m)return null;Object.assign(o,m.params),s.push({params:o,pathname:Nn([C,m.pathname]),pathnameBase:hW(Nn([C,m.pathnameBase])),route:Z}),m.pathnameBase!=="/"&&(C=Nn([C,m.pathnameBase]))}return s}function Ls(e,g){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,I]=cW(e.path,e.caseSensitive,e.end),o=g.match(t);if(!o)return null;let C=o[0],s=C.replace(/(.)\/+$/,"$1"),r=o.slice(1);return{params:I.reduce((d,{paramName:A,isOptional:m},Z)=>{if(A==="*"){let G=r[Z]||"";s=C.slice(0,C.length-G.length).replace(/(.)\/+$/,"$1")}const y=r[Z];return m&&!y?d[A]=void 0:d[A]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:C,pathnameBase:s,pattern:e}}function cW(e,g=!1,t=!0){fn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let I=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,r,c)=>(I.push({paramName:r,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(I.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,g?void 0:"i"),I]}function dW(e){try{return e.split("/").map(g=>decodeURIComponent(g).replace(/\//g,"%2F")).join("/")}catch(g){return fn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${g}).`),e}}function xn(e,g){if(g==="/")return e;if(!e.toLowerCase().startsWith(g.toLowerCase()))return null;let t=g.endsWith("/")?g.length-1:g.length,I=e.charAt(t);return I&&I!=="/"?null:e.slice(t)||"/"}function AW(e,g="/"){let{pathname:t,search:I="",hash:o=""}=typeof e=="string"?Ol(e):e;return{pathname:t?t.startsWith("/")?t:uW(t,g):g,search:pW(I),hash:ZW(o)}}function uW(e,g){let t=g.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Uc(e,g,t,I){return`Cannot include a '${e}' character in a manually specified \`to.${g}\` field [${JSON.stringify(I)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function mW(e){return e.filter((g,t)=>t===0||g.route.path&&g.route.path.length>0)}function sG(e){let g=mW(e);return g.map((t,I)=>I===g.length-1?t.pathname:t.pathnameBase)}function rG(e,g,t,I=!1){let o;typeof e=="string"?o=Ol(e):(o={...e},Bg(!o.pathname||!o.pathname.includes("?"),Uc("?","pathname","search",o)),Bg(!o.pathname||!o.pathname.includes("#"),Uc("#","pathname","hash",o)),Bg(!o.search||!o.search.includes("#"),Uc("#","search","hash",o)));let C=e===""||o.pathname==="",s=C?"/":o.pathname,r;if(s==null)r=t;else{let m=g.length-1;if(!I&&s.startsWith("..")){let Z=s.split("/");for(;Z[0]==="..";)Z.shift(),m-=1;o.pathname=Z.join("/")}r=m>=0?g[m]:"/"}let c=AW(o,r),d=s&&s!=="/"&&s.endsWith("/"),A=(C||s===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||A)&&(c.pathname+="/"),c}var Nn=e=>e.join("/").replace(/\/\/+/g,"/"),hW=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),pW=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ZW=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function bW(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var aG=["POST","PUT","PATCH","DELETE"];new Set(aG);var GW=["GET",...aG];new Set(GW);var ql=b.createContext(null);ql.displayName="DataRouter";var ir=b.createContext(null);ir.displayName="DataRouterState";var cG=b.createContext({isTransitioning:!1});cG.displayName="ViewTransition";var yW=b.createContext(new Map);yW.displayName="Fetchers";var BW=b.createContext(null);BW.displayName="Await";var Vn=b.createContext(null);Vn.displayName="Navigation";var wC=b.createContext(null);wC.displayName="Location";var Tn=b.createContext({outlet:null,matches:[],isDataRoute:!1});Tn.displayName="Route";var fA=b.createContext(null);fA.displayName="RouteError";function fW(e,{relative:g}={}){Bg(FC(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:I}=b.useContext(Vn),{hash:o,pathname:C,search:s}=KC(e,{relative:g}),r=C;return t!=="/"&&(r=C==="/"?t:Nn([t,C])),I.createHref({pathname:r,search:s,hash:o})}function FC(){return b.useContext(wC)!=null}function gl(){return Bg(FC(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(wC).location}var dG="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function AG(e){b.useContext(Vn).static||b.useLayoutEffect(e)}function Qn(){let{isDataRoute:e}=b.useContext(Tn);return e?KW():SW()}function SW(){Bg(FC(),"useNavigate() may be used only in the context of a <Router> component.");let e=b.useContext(ql),{basename:g,navigator:t}=b.useContext(Vn),{matches:I}=b.useContext(Tn),{pathname:o}=gl(),C=JSON.stringify(sG(I)),s=b.useRef(!1);return AG(()=>{s.current=!0}),b.useCallback((c,d={})=>{if(fn(s.current,dG),!s.current)return;if(typeof c=="number"){t.go(c);return}let A=rG(c,JSON.parse(C),o,d.relative==="path");e==null&&g!=="/"&&(A.pathname=A.pathname==="/"?g:Nn([g,A.pathname])),(d.replace?t.replace:t.push)(A,d.state,d)},[g,t,C,o,e])}b.createContext(null);function KC(e,{relative:g}={}){let{matches:t}=b.useContext(Tn),{pathname:I}=gl(),o=JSON.stringify(sG(t));return b.useMemo(()=>rG(e,JSON.parse(o),I,g==="path"),[e,o,I,g])}function VW(e,g){return uG(e,g)}function uG(e,g,t,I){Bg(FC(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=b.useContext(Vn),{matches:C}=b.useContext(Tn),s=C[C.length-1],r=s?s.params:{},c=s?s.pathname:"/",d=s?s.pathnameBase:"/",A=s&&s.route;{let W=A&&A.path||"";mG(c,!A||W.endsWith("*")||W.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${W}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${W}"> to <Route path="${W==="/"?"*":`${W}/*`}">.`)}let m=gl(),Z;if(g){let W=typeof g=="string"?Ol(g):g;Bg(d==="/"||W.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${W.pathname}" was given in the \`location\` prop.`),Z=W}else Z=m;let y=Z.pathname||"/",G=y;if(d!=="/"){let W=d.replace(/^\//,"").split("/");G="/"+y.replace(/^\//,"").split("/").slice(W.length).join("/")}let B=oG(e,{pathname:G});fn(A||B!=null,`No routes matched location "${Z.pathname}${Z.search}${Z.hash}" `),fn(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${Z.pathname}${Z.search}${Z.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let f=JW(B&&B.map(W=>Object.assign({},W,{params:Object.assign({},r,W.params),pathname:Nn([d,o.encodeLocation?o.encodeLocation(W.pathname).pathname:W.pathname]),pathnameBase:W.pathnameBase==="/"?d:Nn([d,o.encodeLocation?o.encodeLocation(W.pathnameBase).pathname:W.pathnameBase])})),C,t,I);return g&&f?b.createElement(wC.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...Z},navigationType:"POP"}},f):f}function WW(){let e=FW(),g=bW(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,I="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:I},C={padding:"2px 4px",backgroundColor:I},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=b.createElement(b.Fragment,null,b.createElement("p",null,"💿 Hey developer 👋"),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:C},"ErrorBoundary")," or"," ",b.createElement("code",{style:C},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},g),t?b.createElement("pre",{style:o},t):null,s)}var RW=b.createElement(WW,null),XW=class extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,g){return g.location!==e.location||g.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:g.error,location:g.location,revalidation:e.revalidation||g.revalidation}}componentDidCatch(e,g){console.error("React Router caught the following error during render",e,g)}render(){return this.state.error!==void 0?b.createElement(Tn.Provider,{value:this.props.routeContext},b.createElement(fA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function kW({routeContext:e,match:g,children:t}){let I=b.useContext(ql);return I&&I.static&&I.staticContext&&(g.route.errorElement||g.route.ErrorBoundary)&&(I.staticContext._deepestRenderedBoundaryId=g.route.id),b.createElement(Tn.Provider,{value:e},t)}function JW(e,g=[],t=null,I=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(g.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let o=e,C=t?.errors;if(C!=null){let c=o.findIndex(d=>d.route.id&&C?.[d.route.id]!==void 0);Bg(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(C).join(",")}`),o=o.slice(0,Math.min(o.length,c+1))}let s=!1,r=-1;if(t)for(let c=0;c<o.length;c++){let d=o[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(r=c),d.route.id){let{loaderData:A,errors:m}=t,Z=d.route.loader&&!A.hasOwnProperty(d.route.id)&&(!m||m[d.route.id]===void 0);if(d.route.lazy||Z){s=!0,r>=0?o=o.slice(0,r+1):o=[o[0]];break}}}return o.reduceRight((c,d,A)=>{let m,Z=!1,y=null,G=null;t&&(m=C&&d.route.id?C[d.route.id]:void 0,y=d.route.errorElement||RW,s&&(r<0&&A===0?(mG("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),Z=!0,G=null):r===A&&(Z=!0,G=d.route.hydrateFallbackElement||null)));let B=g.concat(o.slice(0,A+1)),f=()=>{let W;return m?W=y:Z?W=G:d.route.Component?W=b.createElement(d.route.Component,null):d.route.element?W=d.route.element:W=c,b.createElement(kW,{match:d,routeContext:{outlet:c,matches:B,isDataRoute:t!=null},children:W})};return t&&(d.route.ErrorBoundary||d.route.errorElement||A===0)?b.createElement(XW,{location:t.location,revalidation:t.revalidation,component:y,error:m,children:f(),routeContext:{outlet:null,matches:B,isDataRoute:!0}}):f()},null)}function SA(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vW(e){let g=b.useContext(ql);return Bg(g,SA(e)),g}function YW(e){let g=b.useContext(ir);return Bg(g,SA(e)),g}function HW(e){let g=b.useContext(Tn);return Bg(g,SA(e)),g}function VA(e){let g=HW(e),t=g.matches[g.matches.length-1];return Bg(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function wW(){return VA("useRouteId")}function FW(){let e=b.useContext(fA),g=YW("useRouteError"),t=VA("useRouteError");return e!==void 0?e:g.errors?.[t]}function KW(){let{router:e}=vW("useNavigate"),g=VA("useNavigate"),t=b.useRef(!1);return AG(()=>{t.current=!0}),b.useCallback(async(o,C={})=>{fn(t.current,dG),t.current&&(typeof o=="number"?e.navigate(o):await e.navigate(o,{fromRouteId:g,...C}))},[e,g])}var Op={};function mG(e,g,t){!g&&!Op[e]&&(Op[e]=!0,fn(!1,t))}b.memo(NW);function NW({routes:e,future:g,state:t}){return uG(e,void 0,t,g)}function $t(e){Bg(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xW({basename:e="/",children:g=null,location:t,navigationType:I="POP",navigator:o,static:C=!1}){Bg(!FC(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=e.replace(/^\/*/,"/"),r=b.useMemo(()=>({basename:s,navigator:o,static:C,future:{}}),[s,o,C]);typeof t=="string"&&(t=Ol(t));let{pathname:c="/",search:d="",hash:A="",state:m=null,key:Z="default"}=t,y=b.useMemo(()=>{let G=xn(c,s);return G==null?null:{location:{pathname:G,search:d,hash:A,state:m,key:Z},navigationType:I}},[s,c,d,A,m,Z,I]);return fn(y!=null,`<Router basename="${s}"> is not able to match the URL "${c}${d}${A}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:b.createElement(Vn.Provider,{value:r},b.createElement(wC.Provider,{children:g,value:y}))}function EW({children:e,location:g}){return VW(Vd(e),g)}function Vd(e,g=[]){let t=[];return b.Children.forEach(e,(I,o)=>{if(!b.isValidElement(I))return;let C=[...g,o];if(I.type===b.Fragment){t.push.apply(t,Vd(I.props.children,C));return}Bg(I.type===$t,`[${typeof I.type=="string"?I.type:I.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Bg(!I.props.index||!I.props.children,"An index route cannot have child routes.");let s={id:I.props.id||C.join("-"),caseSensitive:I.props.caseSensitive,element:I.props.element,Component:I.props.Component,index:I.props.index,path:I.props.path,loader:I.props.loader,action:I.props.action,hydrateFallbackElement:I.props.hydrateFallbackElement,HydrateFallback:I.props.HydrateFallback,errorElement:I.props.errorElement,ErrorBoundary:I.props.ErrorBoundary,hasErrorBoundary:I.props.hasErrorBoundary===!0||I.props.ErrorBoundary!=null||I.props.errorElement!=null,shouldRevalidate:I.props.shouldRevalidate,handle:I.props.handle,lazy:I.props.lazy};I.props.children&&(s.children=Vd(I.props.children,C)),t.push(s)}),t}var Ss="get",Vs="application/x-www-form-urlencoded";function sr(e){return e!=null&&typeof e.tagName=="string"}function zW(e){return sr(e)&&e.tagName.toLowerCase()==="button"}function MW(e){return sr(e)&&e.tagName.toLowerCase()==="form"}function UW(e){return sr(e)&&e.tagName.toLowerCase()==="input"}function LW(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function TW(e,g){return e.button===0&&(!g||g==="_self")&&!LW(e)}var is=null;function QW(){if(is===null)try{new FormData(document.createElement("form"),0),is=!1}catch{is=!0}return is}var DW=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Lc(e){return e!=null&&!DW.has(e)?(fn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Vs}"`),null):e}function jW(e,g){let t,I,o,C,s;if(MW(e)){let r=e.getAttribute("action");I=r?xn(r,g):null,t=e.getAttribute("method")||Ss,o=Lc(e.getAttribute("enctype"))||Vs,C=new FormData(e)}else if(zW(e)||UW(e)&&(e.type==="submit"||e.type==="image")){let r=e.form;if(r==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||r.getAttribute("action");if(I=c?xn(c,g):null,t=e.getAttribute("formmethod")||r.getAttribute("method")||Ss,o=Lc(e.getAttribute("formenctype"))||Lc(r.getAttribute("enctype"))||Vs,C=new FormData(r,e),!QW()){let{name:d,type:A,value:m}=e;if(A==="image"){let Z=d?`${d}.`:"";C.append(`${Z}x`,"0"),C.append(`${Z}y`,"0")}else d&&C.append(d,m)}}else{if(sr(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Ss,I=null,o=Vs,s=e}return C&&o==="text/plain"&&(s=C,C=void 0),{action:I,method:t.toLowerCase(),encType:o,formData:C,body:s}}function WA(e,g){if(e===!1||e===null||typeof e>"u")throw new Error(g)}async function PW(e,g){if(e.id in g)return g[e.id];try{let t=await import(e.module);return g[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function OW(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function qW(e,g,t){let I=await Promise.all(e.map(async o=>{let C=g.routes[o.route.id];if(C){let s=await PW(C,t);return s.links?s.links():[]}return[]}));return gR(I.flat(1).filter(OW).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function qp(e,g,t,I,o,C){let s=(c,d)=>t[d]?c.route.id!==t[d].route.id:!0,r=(c,d)=>t[d].pathname!==c.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==c.params["*"];return C==="assets"?g.filter((c,d)=>s(c,d)||r(c,d)):C==="data"?g.filter((c,d)=>{let A=I.routes[c.route.id];if(!A||!A.hasLoader)return!1;if(s(c,d)||r(c,d))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function _W(e,g,{includeHydrateFallback:t}={}){return $W(e.map(I=>{let o=g.routes[I.route.id];if(!o)return[];let C=[o.module];return o.clientActionModule&&(C=C.concat(o.clientActionModule)),o.clientLoaderModule&&(C=C.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(C=C.concat(o.hydrateFallbackModule)),o.imports&&(C=C.concat(o.imports)),C}).flat(1))}function $W(e){return[...new Set(e)]}function eR(e){let g={},t=Object.keys(e).sort();for(let I of t)g[I]=e[I];return g}function gR(e,g){let t=new Set;return new Set(g),e.reduce((I,o)=>{let C=JSON.stringify(eR(o));return t.has(C)||(t.add(C),I.push({key:C,link:o})),I},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var tR=new Set([100,101,204,205]);function nR(e,g){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":g&&xn(t.pathname,g)==="/"?t.pathname=`${g.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function hG(){let e=b.useContext(ql);return WA(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function IR(){let e=b.useContext(ir);return WA(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var RA=b.createContext(void 0);RA.displayName="FrameworkContext";function pG(){let e=b.useContext(RA);return WA(e,"You must render this element inside a <HydratedRouter> element"),e}function lR(e,g){let t=b.useContext(RA),[I,o]=b.useState(!1),[C,s]=b.useState(!1),{onFocus:r,onBlur:c,onMouseEnter:d,onMouseLeave:A,onTouchStart:m}=g,Z=b.useRef(null);b.useEffect(()=>{if(e==="render"&&s(!0),e==="viewport"){let B=W=>{W.forEach(v=>{s(v.isIntersecting)})},f=new IntersectionObserver(B,{threshold:.5});return Z.current&&f.observe(Z.current),()=>{f.disconnect()}}},[e]),b.useEffect(()=>{if(I){let B=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(B)}}},[I]);let y=()=>{o(!0)},G=()=>{o(!1),s(!1)};return t?e!=="intent"?[C,Z,{}]:[C,Z,{onFocus:Do(r,y),onBlur:Do(c,G),onMouseEnter:Do(d,y),onMouseLeave:Do(A,G),onTouchStart:Do(m,y)}]:[!1,Z,{}]}function Do(e,g){return t=>{e&&e(t),t.defaultPrevented||g(t)}}function oR({page:e,...g}){let{router:t}=hG(),I=b.useMemo(()=>oG(t.routes,e,t.basename),[t.routes,e,t.basename]);return I?b.createElement(iR,{page:e,matches:I,...g}):null}function CR(e){let{manifest:g,routeModules:t}=pG(),[I,o]=b.useState([]);return b.useEffect(()=>{let C=!1;return qW(e,g,t).then(s=>{C||o(s)}),()=>{C=!0}},[e,g,t]),I}function iR({page:e,matches:g,...t}){let I=gl(),{manifest:o,routeModules:C}=pG(),{basename:s}=hG(),{loaderData:r,matches:c}=IR(),d=b.useMemo(()=>qp(e,g,c,o,I,"data"),[e,g,c,o,I]),A=b.useMemo(()=>qp(e,g,c,o,I,"assets"),[e,g,c,o,I]),m=b.useMemo(()=>{if(e===I.pathname+I.search+I.hash)return[];let G=new Set,B=!1;if(g.forEach(W=>{let v=o.routes[W.route.id];!v||!v.hasLoader||(!d.some(R=>R.route.id===W.route.id)&&W.route.id in r&&C[W.route.id]?.shouldRevalidate||v.hasClientLoader?B=!0:G.add(W.route.id))}),G.size===0)return[];let f=nR(e,s);return B&&G.size>0&&f.searchParams.set("_routes",g.filter(W=>G.has(W.route.id)).map(W=>W.route.id).join(",")),[f.pathname+f.search]},[s,r,I,o,d,g,e,C]),Z=b.useMemo(()=>_W(A,o),[A,o]),y=CR(A);return b.createElement(b.Fragment,null,m.map(G=>b.createElement("link",{key:G,rel:"prefetch",as:"fetch",href:G,...t})),Z.map(G=>b.createElement("link",{key:G,rel:"modulepreload",href:G,...t})),y.map(({key:G,link:B})=>b.createElement("link",{key:G,...B})))}function sR(...e){return g=>{e.forEach(t=>{typeof t=="function"?t(g):t!=null&&(t.current=g)})}}var ZG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ZG&&(window.__reactRouterVersion="7.6.2")}catch{}function rR({basename:e,children:g,window:t}){let I=b.useRef();I.current==null&&(I.current=qV({window:t,v5Compat:!0}));let o=I.current,[C,s]=b.useState({action:o.action,location:o.location}),r=b.useCallback(c=>{b.startTransition(()=>s(c))},[s]);return b.useLayoutEffect(()=>o.listen(r),[o,r]),b.createElement(xW,{basename:e,children:g,location:C.location,navigationType:C.action,navigator:o})}var bG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,GG=b.forwardRef(function({onClick:g,discover:t="render",prefetch:I="none",relative:o,reloadDocument:C,replace:s,state:r,target:c,to:d,preventScrollReset:A,viewTransition:m,...Z},y){let{basename:G}=b.useContext(Vn),B=typeof d=="string"&&bG.test(d),f,W=!1;if(typeof d=="string"&&B&&(f=d,ZG))try{let K=new URL(window.location.href),w=d.startsWith("//")?new URL(K.protocol+d):new URL(d),D=xn(w.pathname,G);w.origin===K.origin&&D!=null?d=D+w.search+w.hash:W=!0}catch{fn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let v=fW(d,{relative:o}),[R,k,J]=lR(I,Z),F=AR(d,{replace:s,state:r,target:c,preventScrollReset:A,relative:o,viewTransition:m});function U(K){g&&g(K),K.defaultPrevented||F(K)}let X=b.createElement("a",{...Z,...J,href:f||v,onClick:W||C?g:U,ref:sR(y,k),target:c,"data-discover":!B&&t==="render"?"true":void 0});return R&&!B?b.createElement(b.Fragment,null,X,b.createElement(oR,{page:v})):X});GG.displayName="Link";var aR=b.forwardRef(function({"aria-current":g="page",caseSensitive:t=!1,className:I="",end:o=!1,style:C,to:s,viewTransition:r,children:c,...d},A){let m=KC(s,{relative:d.relative}),Z=gl(),y=b.useContext(ir),{navigator:G,basename:B}=b.useContext(Vn),f=y!=null&&ZR(m)&&r===!0,W=G.encodeLocation?G.encodeLocation(m).pathname:m.pathname,v=Z.pathname,R=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;t||(v=v.toLowerCase(),R=R?R.toLowerCase():null,W=W.toLowerCase()),R&&B&&(R=xn(R,B)||R);const k=W!=="/"&&W.endsWith("/")?W.length-1:W.length;let J=v===W||!o&&v.startsWith(W)&&v.charAt(k)==="/",F=R!=null&&(R===W||!o&&R.startsWith(W)&&R.charAt(W.length)==="/"),U={isActive:J,isPending:F,isTransitioning:f},X=J?g:void 0,K;typeof I=="function"?K=I(U):K=[I,J?"active":null,F?"pending":null,f?"transitioning":null].filter(Boolean).join(" ");let w=typeof C=="function"?C(U):C;return b.createElement(GG,{...d,"aria-current":X,className:K,ref:A,style:w,to:s,viewTransition:r},typeof c=="function"?c(U):c)});aR.displayName="NavLink";var cR=b.forwardRef(({discover:e="render",fetcherKey:g,navigate:t,reloadDocument:I,replace:o,state:C,method:s=Ss,action:r,onSubmit:c,relative:d,preventScrollReset:A,viewTransition:m,...Z},y)=>{let G=hR(),B=pR(r,{relative:d}),f=s.toLowerCase()==="get"?"get":"post",W=typeof r=="string"&&bG.test(r),v=R=>{if(c&&c(R),R.defaultPrevented)return;R.preventDefault();let k=R.nativeEvent.submitter,J=k?.getAttribute("formmethod")||s;G(k||R.currentTarget,{fetcherKey:g,method:J,navigate:t,replace:o,state:C,relative:d,preventScrollReset:A,viewTransition:m})};return b.createElement("form",{ref:y,method:f,action:B,onSubmit:I?c:v,...Z,"data-discover":!W&&e==="render"?"true":void 0})});cR.displayName="Form";function dR(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yG(e){let g=b.useContext(ql);return Bg(g,dR(e)),g}function AR(e,{target:g,replace:t,state:I,preventScrollReset:o,relative:C,viewTransition:s}={}){let r=Qn(),c=gl(),d=KC(e,{relative:C});return b.useCallback(A=>{if(TW(A,g)){A.preventDefault();let m=t!==void 0?t:ZC(c)===ZC(d);r(e,{replace:m,state:I,preventScrollReset:o,relative:C,viewTransition:s})}},[c,r,d,t,I,g,e,o,C,s])}var uR=0,mR=()=>`__${String(++uR)}__`;function hR(){let{router:e}=yG("useSubmit"),{basename:g}=b.useContext(Vn),t=wW();return b.useCallback(async(I,o={})=>{let{action:C,method:s,encType:r,formData:c,body:d}=jW(I,g);if(o.navigate===!1){let A=o.fetcherKey||mR();await e.fetch(A,t,o.action||C,{preventScrollReset:o.preventScrollReset,formData:c,body:d,formMethod:o.method||s,formEncType:o.encType||r,flushSync:o.flushSync})}else await e.navigate(o.action||C,{preventScrollReset:o.preventScrollReset,formData:c,body:d,formMethod:o.method||s,formEncType:o.encType||r,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[e,g,t])}function pR(e,{relative:g}={}){let{basename:t}=b.useContext(Vn),I=b.useContext(Tn);Bg(I,"useFormAction must be used inside a RouteContext");let[o]=I.matches.slice(-1),C={...KC(e||".",{relative:g})},s=gl();if(e==null){C.search=s.search;let r=new URLSearchParams(C.search),c=r.getAll("index");if(c.some(A=>A==="")){r.delete("index"),c.filter(m=>m).forEach(m=>r.append("index",m));let A=r.toString();C.search=A?`?${A}`:""}}return(!e||e===".")&&o.route.index&&(C.search=C.search?C.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(C.pathname=C.pathname==="/"?t:Nn([t,C.pathname])),ZC(C)}function ZR(e,g={}){let t=b.useContext(cG);Bg(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:I}=yG("useViewTransitionState"),o=KC(e,{relative:g.relative});if(!t.isTransitioning)return!1;let C=xn(t.currentLocation.pathname,I)||t.currentLocation.pathname,s=xn(t.nextLocation.pathname,I)||t.nextLocation.pathname;return Ls(o.pathname,s)!=null||Ls(o.pathname,C)!=null}[...tR];var BG=lG();const ss=BA(BG),_p=e=>e,bR=()=>{let e=_p;return{configure(g){e=g},generate(g){return e(g)},reset(){e=_p}}},fG=bR();function En(e,...g){const t=new URL(`https://mui.com/production-error/?code=${e}`);return g.forEach(I=>t.searchParams.append("args[]",I)),`Minified MUI error #${e}; visit ${t} for the full message.`}function ze(e){if(typeof e!="string")throw new Error(En(7));return e.charAt(0).toUpperCase()+e.slice(1)}function $p(...e){return e.reduce((g,t)=>t==null?g:function(...o){g.apply(this,o),t.apply(this,o)},()=>{})}function SG(e){var g,t,I="";if(typeof e=="string"||typeof e=="number")I+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(g=0;g<o;g++)e[g]&&(t=SG(e[g]))&&(I&&(I+=" "),I+=t)}else for(t in e)e[t]&&(I&&(I+=" "),I+=t);return I}function Ne(){for(var e,g,t=0,I="",o=arguments.length;t<o;t++)(e=arguments[t])&&(g=SG(e))&&(I&&(I+=" "),I+=g);return I}function og(e,g,t=void 0){const I={};for(const o in e){const C=e[o];let s="",r=!0;for(let c=0;c<C.length;c+=1){const d=C[c];d&&(s+=(r===!0?"":" ")+g(d),r=!1,t&&t[d]&&(s+=" "+t[d]))}I[o]=s}return I}var Tc={exports:{}},lg={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eZ;function GR(){if(eZ)return lg;eZ=1;var e=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),s=Symbol.for("react.context"),r=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),Z=Symbol.for("react.view_transition"),y=Symbol.for("react.client.reference");function G(B){if(typeof B=="object"&&B!==null){var f=B.$$typeof;switch(f){case e:switch(B=B.type,B){case t:case o:case I:case c:case d:case Z:return B;default:switch(B=B&&B.$$typeof,B){case s:case r:case m:case A:return B;case C:return B;default:return f}}case g:return f}}}return lg.ContextConsumer=C,lg.ContextProvider=s,lg.Element=e,lg.ForwardRef=r,lg.Fragment=t,lg.Lazy=m,lg.Memo=A,lg.Portal=g,lg.Profiler=o,lg.StrictMode=I,lg.Suspense=c,lg.SuspenseList=d,lg.isContextConsumer=function(B){return G(B)===C},lg.isContextProvider=function(B){return G(B)===s},lg.isElement=function(B){return typeof B=="object"&&B!==null&&B.$$typeof===e},lg.isForwardRef=function(B){return G(B)===r},lg.isFragment=function(B){return G(B)===t},lg.isLazy=function(B){return G(B)===m},lg.isMemo=function(B){return G(B)===A},lg.isPortal=function(B){return G(B)===g},lg.isProfiler=function(B){return G(B)===o},lg.isStrictMode=function(B){return G(B)===I},lg.isSuspense=function(B){return G(B)===c},lg.isSuspenseList=function(B){return G(B)===d},lg.isValidElementType=function(B){return typeof B=="string"||typeof B=="function"||B===t||B===o||B===I||B===c||B===d||typeof B=="object"&&B!==null&&(B.$$typeof===m||B.$$typeof===A||B.$$typeof===s||B.$$typeof===C||B.$$typeof===r||B.$$typeof===y||B.getModuleId!==void 0)},lg.typeOf=G,lg}var gZ;function yR(){return gZ||(gZ=1,Tc.exports=GR()),Tc.exports}var VG=yR();function Zn(e){if(typeof e!="object"||e===null)return!1;const g=Object.getPrototypeOf(e);return(g===null||g===Object.prototype||Object.getPrototypeOf(g)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function WG(e){if(b.isValidElement(e)||VG.isValidElementType(e)||!Zn(e))return e;const g={};return Object.keys(e).forEach(t=>{g[t]=WG(e[t])}),g}function nt(e,g,t={clone:!0}){const I=t.clone?{...e}:e;return Zn(e)&&Zn(g)&&Object.keys(g).forEach(o=>{b.isValidElement(g[o])||VG.isValidElementType(g[o])?I[o]=g[o]:Zn(g[o])&&Object.prototype.hasOwnProperty.call(e,o)&&Zn(e[o])?I[o]=nt(e[o],g[o],t):t.clone?I[o]=Zn(g[o])?WG(g[o]):g[o]:I[o]=g[o]}),I}function aC(e,g){return g?nt(e,g,{clone:!1}):e}function tZ(e,g){if(!e.containerQueries)return g;const t=Object.keys(g).filter(I=>I.startsWith("@container")).sort((I,o)=>{const C=/min-width:\s*([0-9.]+)/;return+(I.match(C)?.[1]||0)-+(o.match(C)?.[1]||0)});return t.length?t.reduce((I,o)=>{const C=g[o];return delete I[o],I[o]=C,I},{...g}):g}function BR(e,g){return g==="@"||g.startsWith("@")&&(e.some(t=>g.startsWith(`@${t}`))||!!g.match(/^@\d/))}function fR(e,g){const t=g.match(/^@([^/]+)?\/?(.+)?$/);if(!t)return null;const[,I,o]=t,C=Number.isNaN(+I)?I||0:+I;return e.containerQueries(o).up(C)}function SR(e){const g=(C,s)=>C.replace("@media",s?`@container ${s}`:"@container");function t(C,s){C.up=(...r)=>g(e.breakpoints.up(...r),s),C.down=(...r)=>g(e.breakpoints.down(...r),s),C.between=(...r)=>g(e.breakpoints.between(...r),s),C.only=(...r)=>g(e.breakpoints.only(...r),s),C.not=(...r)=>{const c=g(e.breakpoints.not(...r),s);return c.includes("not all and")?c.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):c}}const I={},o=C=>(t(I,C),I);return t(o),{...e,containerQueries:o}}const rr={xs:0,sm:600,md:900,lg:1200,xl:1536},nZ={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${rr[e]}px)`},VR={containerQueries:e=>({up:g=>{let t=typeof g=="number"?g:rr[g]||g;return typeof t=="number"&&(t=`${t}px`),e?`@container ${e} (min-width:${t})`:`@container (min-width:${t})`}})};function zn(e,g,t){const I=e.theme||{};if(Array.isArray(g)){const C=I.breakpoints||nZ;return g.reduce((s,r,c)=>(s[C.up(C.keys[c])]=t(g[c]),s),{})}if(typeof g=="object"){const C=I.breakpoints||nZ;return Object.keys(g).reduce((s,r)=>{if(BR(C.keys,r)){const c=fR(I.containerQueries?I:VR,r);c&&(s[c]=t(g[r],r))}else if(Object.keys(C.values||rr).includes(r)){const c=C.up(r);s[c]=t(g[r],r)}else{const c=r;s[c]=g[c]}return s},{})}return t(g)}function WR(e={}){return e.keys?.reduce((t,I)=>{const o=e.up(I);return t[o]={},t},{})||{}}function IZ(e,g){return e.reduce((t,I)=>{const o=t[I];return(!o||Object.keys(o).length===0)&&delete t[I],t},g)}function ar(e,g,t=!0){if(!g||typeof g!="string")return null;if(e&&e.vars&&t){const I=`vars.${g}`.split(".").reduce((o,C)=>o&&o[C]?o[C]:null,e);if(I!=null)return I}return g.split(".").reduce((I,o)=>I&&I[o]!=null?I[o]:null,e)}function Ts(e,g,t,I=t){let o;return typeof e=="function"?o=e(t):Array.isArray(e)?o=e[t]||I:o=ar(e,t)||I,g&&(o=g(o,I,e)),o}function Jg(e){const{prop:g,cssProperty:t=e.prop,themeKey:I,transform:o}=e,C=s=>{if(s[g]==null)return null;const r=s[g],c=s.theme,d=ar(c,I)||{};return zn(s,r,m=>{let Z=Ts(d,o,m);return m===Z&&typeof m=="string"&&(Z=Ts(d,o,`${g}${m==="default"?"":ze(m)}`,m)),t===!1?Z:{[t]:Z}})};return C.propTypes={},C.filterProps=[g],C}function RR(e){const g={};return t=>(g[t]===void 0&&(g[t]=e(t)),g[t])}const XR={m:"margin",p:"padding"},kR={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},lZ={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},JR=RR(e=>{if(e.length>2)if(lZ[e])e=lZ[e];else return[e];const[g,t]=e.split(""),I=XR[g],o=kR[t]||"";return Array.isArray(o)?o.map(C=>I+C):[I+o]}),XA=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],kA=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...XA,...kA];function NC(e,g,t,I){const o=ar(e,g,!0)??t;return typeof o=="number"||typeof o=="string"?C=>typeof C=="string"?C:typeof o=="string"?o.startsWith("var(")&&C===0?0:o.startsWith("var(")&&C===1?o:`calc(${C} * ${o})`:o*C:Array.isArray(o)?C=>{if(typeof C=="string")return C;const s=Math.abs(C),r=o[s];return C>=0?r:typeof r=="number"?-r:typeof r=="string"&&r.startsWith("var(")?`calc(-1 * ${r})`:`-${r}`}:typeof o=="function"?o:()=>{}}function JA(e){return NC(e,"spacing",8)}function xC(e,g){return typeof g=="string"||g==null?g:e(g)}function vR(e,g){return t=>e.reduce((I,o)=>(I[o]=xC(g,t),I),{})}function YR(e,g,t,I){if(!g.includes(t))return null;const o=JR(t),C=vR(o,I),s=e[t];return zn(e,s,C)}function RG(e,g){const t=JA(e.theme);return Object.keys(e).map(I=>YR(e,g,I,t)).reduce(aC,{})}function Sg(e){return RG(e,XA)}Sg.propTypes={};Sg.filterProps=XA;function Vg(e){return RG(e,kA)}Vg.propTypes={};Vg.filterProps=kA;function cr(...e){const g=e.reduce((I,o)=>(o.filterProps.forEach(C=>{I[C]=o}),I),{}),t=I=>Object.keys(I).reduce((o,C)=>g[C]?aC(o,g[C](I)):o,{});return t.propTypes={},t.filterProps=e.reduce((I,o)=>I.concat(o.filterProps),[]),t}function zt(e){return typeof e!="number"?e:`${e}px solid`}function Lt(e,g){return Jg({prop:e,themeKey:"borders",transform:g})}const HR=Lt("border",zt),wR=Lt("borderTop",zt),FR=Lt("borderRight",zt),KR=Lt("borderBottom",zt),NR=Lt("borderLeft",zt),xR=Lt("borderColor"),ER=Lt("borderTopColor"),zR=Lt("borderRightColor"),MR=Lt("borderBottomColor"),UR=Lt("borderLeftColor"),LR=Lt("outline",zt),TR=Lt("outlineColor"),dr=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const g=NC(e.theme,"shape.borderRadius",4),t=I=>({borderRadius:xC(g,I)});return zn(e,e.borderRadius,t)}return null};dr.propTypes={};dr.filterProps=["borderRadius"];cr(HR,wR,FR,KR,NR,xR,ER,zR,MR,UR,dr,LR,TR);const Ar=e=>{if(e.gap!==void 0&&e.gap!==null){const g=NC(e.theme,"spacing",8),t=I=>({gap:xC(g,I)});return zn(e,e.gap,t)}return null};Ar.propTypes={};Ar.filterProps=["gap"];const ur=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const g=NC(e.theme,"spacing",8),t=I=>({columnGap:xC(g,I)});return zn(e,e.columnGap,t)}return null};ur.propTypes={};ur.filterProps=["columnGap"];const mr=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const g=NC(e.theme,"spacing",8),t=I=>({rowGap:xC(g,I)});return zn(e,e.rowGap,t)}return null};mr.propTypes={};mr.filterProps=["rowGap"];const QR=Jg({prop:"gridColumn"}),DR=Jg({prop:"gridRow"}),jR=Jg({prop:"gridAutoFlow"}),PR=Jg({prop:"gridAutoColumns"}),OR=Jg({prop:"gridAutoRows"}),qR=Jg({prop:"gridTemplateColumns"}),_R=Jg({prop:"gridTemplateRows"}),$R=Jg({prop:"gridTemplateAreas"}),eX=Jg({prop:"gridArea"});cr(Ar,ur,mr,QR,DR,jR,PR,OR,qR,_R,$R,eX);function Ml(e,g){return g==="grey"?g:e}const gX=Jg({prop:"color",themeKey:"palette",transform:Ml}),tX=Jg({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Ml}),nX=Jg({prop:"backgroundColor",themeKey:"palette",transform:Ml});cr(gX,tX,nX);function Wt(e){return e<=1&&e!==0?`${e*100}%`:e}const IX=Jg({prop:"width",transform:Wt}),vA=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const g=t=>{const I=e.theme?.breakpoints?.values?.[t]||rr[t];return I?e.theme?.breakpoints?.unit!=="px"?{maxWidth:`${I}${e.theme.breakpoints.unit}`}:{maxWidth:I}:{maxWidth:Wt(t)}};return zn(e,e.maxWidth,g)}return null};vA.filterProps=["maxWidth"];const lX=Jg({prop:"minWidth",transform:Wt}),oX=Jg({prop:"height",transform:Wt}),CX=Jg({prop:"maxHeight",transform:Wt}),iX=Jg({prop:"minHeight",transform:Wt});Jg({prop:"size",cssProperty:"width",transform:Wt});Jg({prop:"size",cssProperty:"height",transform:Wt});const sX=Jg({prop:"boxSizing"});cr(IX,vA,lX,oX,CX,iX,sX);const EC={border:{themeKey:"borders",transform:zt},borderTop:{themeKey:"borders",transform:zt},borderRight:{themeKey:"borders",transform:zt},borderBottom:{themeKey:"borders",transform:zt},borderLeft:{themeKey:"borders",transform:zt},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:zt},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:dr},color:{themeKey:"palette",transform:Ml},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Ml},backgroundColor:{themeKey:"palette",transform:Ml},p:{style:Vg},pt:{style:Vg},pr:{style:Vg},pb:{style:Vg},pl:{style:Vg},px:{style:Vg},py:{style:Vg},padding:{style:Vg},paddingTop:{style:Vg},paddingRight:{style:Vg},paddingBottom:{style:Vg},paddingLeft:{style:Vg},paddingX:{style:Vg},paddingY:{style:Vg},paddingInline:{style:Vg},paddingInlineStart:{style:Vg},paddingInlineEnd:{style:Vg},paddingBlock:{style:Vg},paddingBlockStart:{style:Vg},paddingBlockEnd:{style:Vg},m:{style:Sg},mt:{style:Sg},mr:{style:Sg},mb:{style:Sg},ml:{style:Sg},mx:{style:Sg},my:{style:Sg},margin:{style:Sg},marginTop:{style:Sg},marginRight:{style:Sg},marginBottom:{style:Sg},marginLeft:{style:Sg},marginX:{style:Sg},marginY:{style:Sg},marginInline:{style:Sg},marginInlineStart:{style:Sg},marginInlineEnd:{style:Sg},marginBlock:{style:Sg},marginBlockStart:{style:Sg},marginBlockEnd:{style:Sg},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Ar},rowGap:{style:mr},columnGap:{style:ur},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Wt},maxWidth:{style:vA},minWidth:{transform:Wt},height:{transform:Wt},maxHeight:{transform:Wt},minHeight:{transform:Wt},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function rX(...e){const g=e.reduce((I,o)=>I.concat(Object.keys(o)),[]),t=new Set(g);return e.every(I=>t.size===Object.keys(I).length)}function aX(e,g){return typeof e=="function"?e(g):e}function cX(){function e(t,I,o,C){const s={[t]:I,theme:o},r=C[t];if(!r)return{[t]:I};const{cssProperty:c=t,themeKey:d,transform:A,style:m}=r;if(I==null)return null;if(d==="typography"&&I==="inherit")return{[t]:I};const Z=ar(o,d)||{};return m?m(s):zn(s,I,G=>{let B=Ts(Z,A,G);return G===B&&typeof G=="string"&&(B=Ts(Z,A,`${t}${G==="default"?"":ze(G)}`,G)),c===!1?B:{[c]:B}})}function g(t){const{sx:I,theme:o={},nested:C}=t||{};if(!I)return null;const s=o.unstable_sxConfig??EC;function r(c){let d=c;if(typeof c=="function")d=c(o);else if(typeof c!="object")return c;if(!d)return null;const A=WR(o.breakpoints),m=Object.keys(A);let Z=A;return Object.keys(d).forEach(y=>{const G=aX(d[y],o);if(G!=null)if(typeof G=="object")if(s[y])Z=aC(Z,e(y,G,o,s));else{const B=zn({theme:o},G,f=>({[y]:f}));rX(B,G)?Z[y]=g({sx:G,theme:o,nested:!0}):Z=aC(Z,B)}else Z=aC(Z,e(y,G,o,s))}),!C&&o.modularCssLayers?{"@layer sx":tZ(o,IZ(m,Z))}:tZ(o,IZ(m,Z))}return Array.isArray(I)?I.map(r):r(I)}return g}const $I=cX();$I.filterProps=["sx"];const dX=e=>{const g={systemProps:{},otherProps:{}},t=e?.theme?.unstable_sxConfig??EC;return Object.keys(e).forEach(I=>{t[I]?g.systemProps[I]=e[I]:g.otherProps[I]=e[I]}),g};function YA(e){const{sx:g,...t}=e,{systemProps:I,otherProps:o}=dX(t);let C;return Array.isArray(g)?C=[I,...g]:typeof g=="function"?C=(...s)=>{const r=g(...s);return Zn(r)?{...I,...r}:I}:C={...I,...g},{...o,sx:C}}function bC(){return bC=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var I in t)({}).hasOwnProperty.call(t,I)&&(e[I]=t[I])}return e},bC.apply(null,arguments)}function AX(e){if(e.sheet)return e.sheet;for(var g=0;g<document.styleSheets.length;g++)if(document.styleSheets[g].ownerNode===e)return document.styleSheets[g]}function uX(e){var g=document.createElement("style");return g.setAttribute("data-emotion",e.key),e.nonce!==void 0&&g.setAttribute("nonce",e.nonce),g.appendChild(document.createTextNode("")),g.setAttribute("data-s",""),g}var mX=function(){function e(t){var I=this;this._insertTag=function(o){var C;I.tags.length===0?I.insertionPoint?C=I.insertionPoint.nextSibling:I.prepend?C=I.container.firstChild:C=I.before:C=I.tags[I.tags.length-1].nextSibling,I.container.insertBefore(o,C),I.tags.push(o)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var g=e.prototype;return g.hydrate=function(I){I.forEach(this._insertTag)},g.insert=function(I){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(uX(this));var o=this.tags[this.tags.length-1];if(this.isSpeedy){var C=AX(o);try{C.insertRule(I,C.cssRules.length)}catch{}}else o.appendChild(document.createTextNode(I));this.ctr++},g.flush=function(){this.tags.forEach(function(I){var o;return(o=I.parentNode)==null?void 0:o.removeChild(I)}),this.tags=[],this.ctr=0},e}(),$g="-ms-",Qs="-moz-",Oe="-webkit-",XG="comm",HA="rule",wA="decl",hX="@import",kG="@keyframes",pX="@layer",ZX=Math.abs,hr=String.fromCharCode,bX=Object.assign;function GX(e,g){return Dg(e,0)^45?(((g<<2^Dg(e,0))<<2^Dg(e,1))<<2^Dg(e,2))<<2^Dg(e,3):0}function JG(e){return e.trim()}function yX(e,g){return(e=g.exec(e))?e[0]:e}function qe(e,g,t){return e.replace(g,t)}function Wd(e,g){return e.indexOf(g)}function Dg(e,g){return e.charCodeAt(g)|0}function GC(e,g,t){return e.slice(g,t)}function hn(e){return e.length}function FA(e){return e.length}function rs(e,g){return g.push(e),e}function BX(e,g){return e.map(g).join("")}var pr=1,Ql=1,vG=0,Gt=0,Fg=0,_l="";function Zr(e,g,t,I,o,C,s){return{value:e,root:g,parent:t,type:I,props:o,children:C,line:pr,column:Ql,length:s,return:""}}function jo(e,g){return bX(Zr("",null,null,"",null,null,0),e,{length:-e.length},g)}function fX(){return Fg}function SX(){return Fg=Gt>0?Dg(_l,--Gt):0,Ql--,Fg===10&&(Ql=1,pr--),Fg}function Xt(){return Fg=Gt<vG?Dg(_l,Gt++):0,Ql++,Fg===10&&(Ql=1,pr++),Fg}function bn(){return Dg(_l,Gt)}function Ws(){return Gt}function zC(e,g){return GC(_l,e,g)}function yC(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function YG(e){return pr=Ql=1,vG=hn(_l=e),Gt=0,[]}function HG(e){return _l="",e}function Rs(e){return JG(zC(Gt-1,Rd(e===91?e+2:e===40?e+1:e)))}function VX(e){for(;(Fg=bn())&&Fg<33;)Xt();return yC(e)>2||yC(Fg)>3?"":" "}function WX(e,g){for(;--g&&Xt()&&!(Fg<48||Fg>102||Fg>57&&Fg<65||Fg>70&&Fg<97););return zC(e,Ws()+(g<6&&bn()==32&&Xt()==32))}function Rd(e){for(;Xt();)switch(Fg){case e:return Gt;case 34:case 39:e!==34&&e!==39&&Rd(Fg);break;case 40:e===41&&Rd(e);break;case 92:Xt();break}return Gt}function RX(e,g){for(;Xt()&&e+Fg!==57;)if(e+Fg===84&&bn()===47)break;return"/*"+zC(g,Gt-1)+"*"+hr(e===47?e:Xt())}function XX(e){for(;!yC(bn());)Xt();return zC(e,Gt)}function kX(e){return HG(Xs("",null,null,null,[""],e=YG(e),0,[0],e))}function Xs(e,g,t,I,o,C,s,r,c){for(var d=0,A=0,m=s,Z=0,y=0,G=0,B=1,f=1,W=1,v=0,R="",k=o,J=C,F=I,U=R;f;)switch(G=v,v=Xt()){case 40:if(G!=108&&Dg(U,m-1)==58){Wd(U+=qe(Rs(v),"&","&\f"),"&\f")!=-1&&(W=-1);break}case 34:case 39:case 91:U+=Rs(v);break;case 9:case 10:case 13:case 32:U+=VX(G);break;case 92:U+=WX(Ws()-1,7);continue;case 47:switch(bn()){case 42:case 47:rs(JX(RX(Xt(),Ws()),g,t),c);break;default:U+="/"}break;case 123*B:r[d++]=hn(U)*W;case 125*B:case 59:case 0:switch(v){case 0:case 125:f=0;case 59+A:W==-1&&(U=qe(U,/\f/g,"")),y>0&&hn(U)-m&&rs(y>32?CZ(U+";",I,t,m-1):CZ(qe(U," ","")+";",I,t,m-2),c);break;case 59:U+=";";default:if(rs(F=oZ(U,g,t,d,A,o,r,R,k=[],J=[],m),C),v===123)if(A===0)Xs(U,g,F,F,k,C,m,r,J);else switch(Z===99&&Dg(U,3)===110?100:Z){case 100:case 108:case 109:case 115:Xs(e,F,F,I&&rs(oZ(e,F,F,0,0,o,r,R,o,k=[],m),J),o,J,m,r,I?k:J);break;default:Xs(U,F,F,F,[""],J,0,r,J)}}d=A=y=0,B=W=1,R=U="",m=s;break;case 58:m=1+hn(U),y=G;default:if(B<1){if(v==123)--B;else if(v==125&&B++==0&&SX()==125)continue}switch(U+=hr(v),v*B){case 38:W=A>0?1:(U+="\f",-1);break;case 44:r[d++]=(hn(U)-1)*W,W=1;break;case 64:bn()===45&&(U+=Rs(Xt())),Z=bn(),A=m=hn(R=U+=XX(Ws())),v++;break;case 45:G===45&&hn(U)==2&&(B=0)}}return C}function oZ(e,g,t,I,o,C,s,r,c,d,A){for(var m=o-1,Z=o===0?C:[""],y=FA(Z),G=0,B=0,f=0;G<I;++G)for(var W=0,v=GC(e,m+1,m=ZX(B=s[G])),R=e;W<y;++W)(R=JG(B>0?Z[W]+" "+v:qe(v,/&\f/g,Z[W])))&&(c[f++]=R);return Zr(e,g,t,o===0?HA:r,c,d,A)}function JX(e,g,t){return Zr(e,g,t,XG,hr(fX()),GC(e,2,-2),0)}function CZ(e,g,t,I){return Zr(e,g,t,wA,GC(e,0,I),GC(e,I+1,-1),I)}function Ul(e,g){for(var t="",I=FA(e),o=0;o<I;o++)t+=g(e[o],o,e,g)||"";return t}function vX(e,g,t,I){switch(e.type){case pX:if(e.children.length)break;case hX:case wA:return e.return=e.return||e.value;case XG:return"";case kG:return e.return=e.value+"{"+Ul(e.children,I)+"}";case HA:e.value=e.props.join(",")}return hn(t=Ul(e.children,I))?e.return=e.value+"{"+t+"}":""}function YX(e){var g=FA(e);return function(t,I,o,C){for(var s="",r=0;r<g;r++)s+=e[r](t,I,o,C)||"";return s}}function HX(e){return function(g){g.root||(g=g.return)&&e(g)}}function wG(e){var g=Object.create(null);return function(t){return g[t]===void 0&&(g[t]=e(t)),g[t]}}var wX=function(g,t,I){for(var o=0,C=0;o=C,C=bn(),o===38&&C===12&&(t[I]=1),!yC(C);)Xt();return zC(g,Gt)},FX=function(g,t){var I=-1,o=44;do switch(yC(o)){case 0:o===38&&bn()===12&&(t[I]=1),g[I]+=wX(Gt-1,t,I);break;case 2:g[I]+=Rs(o);break;case 4:if(o===44){g[++I]=bn()===58?"&\f":"",t[I]=g[I].length;break}default:g[I]+=hr(o)}while(o=Xt());return g},KX=function(g,t){return HG(FX(YG(g),t))},iZ=new WeakMap,NX=function(g){if(!(g.type!=="rule"||!g.parent||g.length<1)){for(var t=g.value,I=g.parent,o=g.column===I.column&&g.line===I.line;I.type!=="rule";)if(I=I.parent,!I)return;if(!(g.props.length===1&&t.charCodeAt(0)!==58&&!iZ.get(I))&&!o){iZ.set(g,!0);for(var C=[],s=KX(t,C),r=I.props,c=0,d=0;c<s.length;c++)for(var A=0;A<r.length;A++,d++)g.props[d]=C[c]?s[c].replace(/&\f/g,r[A]):r[A]+" "+s[c]}}},xX=function(g){if(g.type==="decl"){var t=g.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(g.return="",g.value="")}};function FG(e,g){switch(GX(e,g)){case 5103:return Oe+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Oe+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Oe+e+Qs+e+$g+e+e;case 6828:case 4268:return Oe+e+$g+e+e;case 6165:return Oe+e+$g+"flex-"+e+e;case 5187:return Oe+e+qe(e,/(\w+).+(:[^]+)/,Oe+"box-$1$2"+$g+"flex-$1$2")+e;case 5443:return Oe+e+$g+"flex-item-"+qe(e,/flex-|-self/,"")+e;case 4675:return Oe+e+$g+"flex-line-pack"+qe(e,/align-content|flex-|-self/,"")+e;case 5548:return Oe+e+$g+qe(e,"shrink","negative")+e;case 5292:return Oe+e+$g+qe(e,"basis","preferred-size")+e;case 6060:return Oe+"box-"+qe(e,"-grow","")+Oe+e+$g+qe(e,"grow","positive")+e;case 4554:return Oe+qe(e,/([^-])(transform)/g,"$1"+Oe+"$2")+e;case 6187:return qe(qe(qe(e,/(zoom-|grab)/,Oe+"$1"),/(image-set)/,Oe+"$1"),e,"")+e;case 5495:case 3959:return qe(e,/(image-set\([^]*)/,Oe+"$1$`$1");case 4968:return qe(qe(e,/(.+:)(flex-)?(.*)/,Oe+"box-pack:$3"+$g+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Oe+e+e;case 4095:case 3583:case 4068:case 2532:return qe(e,/(.+)-inline(.+)/,Oe+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(hn(e)-1-g>6)switch(Dg(e,g+1)){case 109:if(Dg(e,g+4)!==45)break;case 102:return qe(e,/(.+:)(.+)-([^]+)/,"$1"+Oe+"$2-$3$1"+Qs+(Dg(e,g+3)==108?"$3":"$2-$3"))+e;case 115:return~Wd(e,"stretch")?FG(qe(e,"stretch","fill-available"),g)+e:e}break;case 4949:if(Dg(e,g+1)!==115)break;case 6444:switch(Dg(e,hn(e)-3-(~Wd(e,"!important")&&10))){case 107:return qe(e,":",":"+Oe)+e;case 101:return qe(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Oe+(Dg(e,14)===45?"inline-":"")+"box$3$1"+Oe+"$2$3$1"+$g+"$2box$3")+e}break;case 5936:switch(Dg(e,g+11)){case 114:return Oe+e+$g+qe(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Oe+e+$g+qe(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Oe+e+$g+qe(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Oe+e+$g+e+e}return e}var EX=function(g,t,I,o){if(g.length>-1&&!g.return)switch(g.type){case wA:g.return=FG(g.value,g.length);break;case kG:return Ul([jo(g,{value:qe(g.value,"@","@"+Oe)})],o);case HA:if(g.length)return BX(g.props,function(C){switch(yX(C,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ul([jo(g,{props:[qe(C,/:(read-\w+)/,":"+Qs+"$1")]})],o);case"::placeholder":return Ul([jo(g,{props:[qe(C,/:(plac\w+)/,":"+Oe+"input-$1")]}),jo(g,{props:[qe(C,/:(plac\w+)/,":"+Qs+"$1")]}),jo(g,{props:[qe(C,/:(plac\w+)/,$g+"input-$1")]})],o)}return""})}},zX=[EX],MX=function(g){var t=g.key;if(t==="css"){var I=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(I,function(B){var f=B.getAttribute("data-emotion");f.indexOf(" ")!==-1&&(document.head.appendChild(B),B.setAttribute("data-s",""))})}var o=g.stylisPlugins||zX,C={},s,r=[];s=g.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(B){for(var f=B.getAttribute("data-emotion").split(" "),W=1;W<f.length;W++)C[f[W]]=!0;r.push(B)});var c,d=[NX,xX];{var A,m=[vX,HX(function(B){A.insert(B)})],Z=YX(d.concat(o,m)),y=function(f){return Ul(kX(f),Z)};c=function(f,W,v,R){A=v,y(f?f+"{"+W.styles+"}":W.styles),R&&(G.inserted[W.name]=!0)}}var G={key:t,sheet:new mX({key:t,container:s,nonce:g.nonce,speedy:g.speedy,prepend:g.prepend,insertionPoint:g.insertionPoint}),nonce:g.nonce,inserted:C,registered:{},insert:c};return G.sheet.hydrate(r),G},Qc={exports:{}},eg={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sZ;function UX(){if(sZ)return eg;sZ=1;var e=typeof Symbol=="function"&&Symbol.for,g=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,I=e?Symbol.for("react.fragment"):60107,o=e?Symbol.for("react.strict_mode"):60108,C=e?Symbol.for("react.profiler"):60114,s=e?Symbol.for("react.provider"):60109,r=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,A=e?Symbol.for("react.forward_ref"):60112,m=e?Symbol.for("react.suspense"):60113,Z=e?Symbol.for("react.suspense_list"):60120,y=e?Symbol.for("react.memo"):60115,G=e?Symbol.for("react.lazy"):60116,B=e?Symbol.for("react.block"):60121,f=e?Symbol.for("react.fundamental"):60117,W=e?Symbol.for("react.responder"):60118,v=e?Symbol.for("react.scope"):60119;function R(J){if(typeof J=="object"&&J!==null){var F=J.$$typeof;switch(F){case g:switch(J=J.type,J){case c:case d:case I:case C:case o:case m:return J;default:switch(J=J&&J.$$typeof,J){case r:case A:case G:case y:case s:return J;default:return F}}case t:return F}}}function k(J){return R(J)===d}return eg.AsyncMode=c,eg.ConcurrentMode=d,eg.ContextConsumer=r,eg.ContextProvider=s,eg.Element=g,eg.ForwardRef=A,eg.Fragment=I,eg.Lazy=G,eg.Memo=y,eg.Portal=t,eg.Profiler=C,eg.StrictMode=o,eg.Suspense=m,eg.isAsyncMode=function(J){return k(J)||R(J)===c},eg.isConcurrentMode=k,eg.isContextConsumer=function(J){return R(J)===r},eg.isContextProvider=function(J){return R(J)===s},eg.isElement=function(J){return typeof J=="object"&&J!==null&&J.$$typeof===g},eg.isForwardRef=function(J){return R(J)===A},eg.isFragment=function(J){return R(J)===I},eg.isLazy=function(J){return R(J)===G},eg.isMemo=function(J){return R(J)===y},eg.isPortal=function(J){return R(J)===t},eg.isProfiler=function(J){return R(J)===C},eg.isStrictMode=function(J){return R(J)===o},eg.isSuspense=function(J){return R(J)===m},eg.isValidElementType=function(J){return typeof J=="string"||typeof J=="function"||J===I||J===d||J===C||J===o||J===m||J===Z||typeof J=="object"&&J!==null&&(J.$$typeof===G||J.$$typeof===y||J.$$typeof===s||J.$$typeof===r||J.$$typeof===A||J.$$typeof===f||J.$$typeof===W||J.$$typeof===v||J.$$typeof===B)},eg.typeOf=R,eg}var rZ;function LX(){return rZ||(rZ=1,Qc.exports=UX()),Qc.exports}var Dc,aZ;function TX(){if(aZ)return Dc;aZ=1;var e=LX(),g={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},I={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},C={};C[e.ForwardRef]=I,C[e.Memo]=o;function s(G){return e.isMemo(G)?o:C[G.$$typeof]||g}var r=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,A=Object.getOwnPropertyDescriptor,m=Object.getPrototypeOf,Z=Object.prototype;function y(G,B,f){if(typeof B!="string"){if(Z){var W=m(B);W&&W!==Z&&y(G,W,f)}var v=c(B);d&&(v=v.concat(d(B)));for(var R=s(G),k=s(B),J=0;J<v.length;++J){var F=v[J];if(!t[F]&&!(f&&f[F])&&!(k&&k[F])&&!(R&&R[F])){var U=A(B,F);try{r(G,F,U)}catch{}}}}return G}return Dc=y,Dc}TX();var QX=!0;function KG(e,g,t){var I="";return t.split(" ").forEach(function(o){e[o]!==void 0?g.push(e[o]+";"):o&&(I+=o+" ")}),I}var KA=function(g,t,I){var o=g.key+"-"+t.name;(I===!1||QX===!1)&&g.registered[o]===void 0&&(g.registered[o]=t.styles)},NA=function(g,t,I){KA(g,t,I);var o=g.key+"-"+t.name;if(g.inserted[t.name]===void 0){var C=t;do g.insert(t===C?"."+o:"",C,g.sheet,!0),C=C.next;while(C!==void 0)}};function DX(e){for(var g=0,t,I=0,o=e.length;o>=4;++I,o-=4)t=e.charCodeAt(I)&255|(e.charCodeAt(++I)&255)<<8|(e.charCodeAt(++I)&255)<<16|(e.charCodeAt(++I)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,g=(t&65535)*1540483477+((t>>>16)*59797<<16)^(g&65535)*1540483477+((g>>>16)*59797<<16);switch(o){case 3:g^=(e.charCodeAt(I+2)&255)<<16;case 2:g^=(e.charCodeAt(I+1)&255)<<8;case 1:g^=e.charCodeAt(I)&255,g=(g&65535)*1540483477+((g>>>16)*59797<<16)}return g^=g>>>13,g=(g&65535)*1540483477+((g>>>16)*59797<<16),((g^g>>>15)>>>0).toString(36)}var jX={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},PX=/[A-Z]|^ms/g,OX=/_EMO_([^_]+?)_([^]*?)_EMO_/g,NG=function(g){return g.charCodeAt(1)===45},cZ=function(g){return g!=null&&typeof g!="boolean"},jc=wG(function(e){return NG(e)?e:e.replace(PX,"-$&").toLowerCase()}),dZ=function(g,t){switch(g){case"animation":case"animationName":if(typeof t=="string")return t.replace(OX,function(I,o,C){return pn={name:o,styles:C,next:pn},o})}return jX[g]!==1&&!NG(g)&&typeof t=="number"&&t!==0?t+"px":t};function BC(e,g,t){if(t==null)return"";var I=t;if(I.__emotion_styles!==void 0)return I;switch(typeof t){case"boolean":return"";case"object":{var o=t;if(o.anim===1)return pn={name:o.name,styles:o.styles,next:pn},o.name;var C=t;if(C.styles!==void 0){var s=C.next;if(s!==void 0)for(;s!==void 0;)pn={name:s.name,styles:s.styles,next:pn},s=s.next;var r=C.styles+";";return r}return qX(e,g,t)}case"function":{if(e!==void 0){var c=pn,d=t(e);return pn=c,BC(e,g,d)}break}}var A=t;if(g==null)return A;var m=g[A];return m!==void 0?m:A}function qX(e,g,t){var I="";if(Array.isArray(t))for(var o=0;o<t.length;o++)I+=BC(e,g,t[o])+";";else for(var C in t){var s=t[C];if(typeof s!="object"){var r=s;g!=null&&g[r]!==void 0?I+=C+"{"+g[r]+"}":cZ(r)&&(I+=jc(C)+":"+dZ(C,r)+";")}else if(Array.isArray(s)&&typeof s[0]=="string"&&(g==null||g[s[0]]===void 0))for(var c=0;c<s.length;c++)cZ(s[c])&&(I+=jc(C)+":"+dZ(C,s[c])+";");else{var d=BC(e,g,s);switch(C){case"animation":case"animationName":{I+=jc(C)+":"+d+";";break}default:I+=C+"{"+d+"}"}}}return I}var AZ=/label:\s*([^\s;{]+)\s*(;|$)/g,pn;function MC(e,g,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var I=!0,o="";pn=void 0;var C=e[0];if(C==null||C.raw===void 0)I=!1,o+=BC(t,g,C);else{var s=C;o+=s[0]}for(var r=1;r<e.length;r++)if(o+=BC(t,g,e[r]),I){var c=C;o+=c[r]}AZ.lastIndex=0;for(var d="",A;(A=AZ.exec(o))!==null;)d+="-"+A[1];var m=DX(o)+d;return{name:m,styles:o,next:pn}}var _X=function(g){return g()},xG=fd.useInsertionEffect?fd.useInsertionEffect:!1,EG=xG||_X,uZ=xG||b.useLayoutEffect,zG=b.createContext(typeof HTMLElement<"u"?MX({key:"css"}):null);zG.Provider;var xA=function(g){return b.forwardRef(function(t,I){var o=b.useContext(zG);return g(t,o,I)})},br=b.createContext({}),EA={}.hasOwnProperty,Xd="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",$X=function(g,t){var I={};for(var o in t)EA.call(t,o)&&(I[o]=t[o]);return I[Xd]=g,I},ek=function(g){var t=g.cache,I=g.serialized,o=g.isStringTag;return KA(t,I,o),EG(function(){return NA(t,I,o)}),null},gk=xA(function(e,g,t){var I=e.css;typeof I=="string"&&g.registered[I]!==void 0&&(I=g.registered[I]);var o=e[Xd],C=[I],s="";typeof e.className=="string"?s=KG(g.registered,C,e.className):e.className!=null&&(s=e.className+" ");var r=MC(C,void 0,b.useContext(br));s+=g.key+"-"+r.name;var c={};for(var d in e)EA.call(e,d)&&d!=="css"&&d!==Xd&&(c[d]=e[d]);return c.className=s,t&&(c.ref=t),b.createElement(b.Fragment,null,b.createElement(ek,{cache:g,serialized:r,isStringTag:typeof o=="string"}),b.createElement(o,c))}),tk=gk,mZ=function(g,t){var I=arguments;if(t==null||!EA.call(t,"css"))return b.createElement.apply(void 0,I);var o=I.length,C=new Array(o);C[0]=tk,C[1]=$X(g,t);for(var s=2;s<o;s++)C[s]=I[s];return b.createElement.apply(null,C)};(function(e){var g;g||(g=e.JSX||(e.JSX={}))})(mZ||(mZ={}));var nk=xA(function(e,g){var t=e.styles,I=MC([t],void 0,b.useContext(br)),o=b.useRef();return uZ(function(){var C=g.key+"-global",s=new g.sheet.constructor({key:C,nonce:g.sheet.nonce,container:g.sheet.container,speedy:g.sheet.isSpeedy}),r=!1,c=document.querySelector('style[data-emotion="'+C+" "+I.name+'"]');return g.sheet.tags.length&&(s.before=g.sheet.tags[0]),c!==null&&(r=!0,c.setAttribute("data-emotion",C),s.hydrate([c])),o.current=[s,r],function(){s.flush()}},[g]),uZ(function(){var C=o.current,s=C[0],r=C[1];if(r){C[1]=!1;return}if(I.next!==void 0&&NA(g,I.next,!0),s.tags.length){var c=s.tags[s.tags.length-1].nextElementSibling;s.before=c,s.flush()}g.insert("",I,s,!1)},[g,I.name]),null});function zA(){for(var e=arguments.length,g=new Array(e),t=0;t<e;t++)g[t]=arguments[t];return MC(g)}function UC(){var e=zA.apply(void 0,arguments),g="animation-"+e.name;return{name:g,styles:"@keyframes "+g+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var Ik=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,lk=wG(function(e){return Ik.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),ok=lk,Ck=function(g){return g!=="theme"},hZ=function(g){return typeof g=="string"&&g.charCodeAt(0)>96?ok:Ck},pZ=function(g,t,I){var o;if(t){var C=t.shouldForwardProp;o=g.__emotion_forwardProp&&C?function(s){return g.__emotion_forwardProp(s)&&C(s)}:C}return typeof o!="function"&&I&&(o=g.__emotion_forwardProp),o},ik=function(g){var t=g.cache,I=g.serialized,o=g.isStringTag;return KA(t,I,o),EG(function(){return NA(t,I,o)}),null},sk=function e(g,t){var I=g.__emotion_real===g,o=I&&g.__emotion_base||g,C,s;t!==void 0&&(C=t.label,s=t.target);var r=pZ(g,t,I),c=r||hZ(o),d=!c("as");return function(){var A=arguments,m=I&&g.__emotion_styles!==void 0?g.__emotion_styles.slice(0):[];if(C!==void 0&&m.push("label:"+C+";"),A[0]==null||A[0].raw===void 0)m.push.apply(m,A);else{var Z=A[0];m.push(Z[0]);for(var y=A.length,G=1;G<y;G++)m.push(A[G],Z[G])}var B=xA(function(f,W,v){var R=d&&f.as||o,k="",J=[],F=f;if(f.theme==null){F={};for(var U in f)F[U]=f[U];F.theme=b.useContext(br)}typeof f.className=="string"?k=KG(W.registered,J,f.className):f.className!=null&&(k=f.className+" ");var X=MC(m.concat(J),W.registered,F);k+=W.key+"-"+X.name,s!==void 0&&(k+=" "+s);var K=d&&r===void 0?hZ(R):c,w={};for(var D in f)d&&D==="as"||K(D)&&(w[D]=f[D]);return w.className=k,v&&(w.ref=v),b.createElement(b.Fragment,null,b.createElement(ik,{cache:W,serialized:X,isStringTag:typeof R=="string"}),b.createElement(R,w))});return B.displayName=C!==void 0?C:"Styled("+(typeof o=="string"?o:o.displayName||o.name||"Component")+")",B.defaultProps=g.defaultProps,B.__emotion_real=B,B.__emotion_base=o,B.__emotion_styles=m,B.__emotion_forwardProp=r,Object.defineProperty(B,"toString",{value:function(){return"."+s}}),B.withComponent=function(f,W){var v=e(f,bC({},t,W,{shouldForwardProp:pZ(B,W,!0)}));return v.apply(void 0,m)},B}},rk=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],kd=sk.bind(null);rk.forEach(function(e){kd[e]=kd(e)});function ak(e){return e==null||Object.keys(e).length===0}function ck(e){const{styles:g,defaultTheme:t={}}=e,I=typeof g=="function"?o=>g(ak(o)?t:o):g;return p.jsx(nk,{styles:I})}function MG(e,g){return kd(e,g)}function dk(e,g){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=g(e.__emotion_styles))}const ZZ=[];function mI(e){return ZZ[0]=e,MC(ZZ)}const Ak=e=>{const g=Object.keys(e).map(t=>({key:t,val:e[t]}))||[];return g.sort((t,I)=>t.val-I.val),g.reduce((t,I)=>({...t,[I.key]:I.val}),{})};function uk(e){const{values:g={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:t="px",step:I=5,...o}=e,C=Ak(g),s=Object.keys(C);function r(Z){return`@media (min-width:${typeof g[Z]=="number"?g[Z]:Z}${t})`}function c(Z){return`@media (max-width:${(typeof g[Z]=="number"?g[Z]:Z)-I/100}${t})`}function d(Z,y){const G=s.indexOf(y);return`@media (min-width:${typeof g[Z]=="number"?g[Z]:Z}${t}) and (max-width:${(G!==-1&&typeof g[s[G]]=="number"?g[s[G]]:y)-I/100}${t})`}function A(Z){return s.indexOf(Z)+1<s.length?d(Z,s[s.indexOf(Z)+1]):r(Z)}function m(Z){const y=s.indexOf(Z);return y===0?r(s[1]):y===s.length-1?c(s[y]):d(Z,s[s.indexOf(Z)+1]).replace("@media","@media not all and")}return{keys:s,values:C,up:r,down:c,between:d,only:A,not:m,unit:t,...o}}const mk={borderRadius:4};function UG(e=8,g=JA({spacing:e})){if(e.mui)return e;const t=(...I)=>(I.length===0?[1]:I).map(C=>{const s=g(C);return typeof s=="number"?`${s}px`:s}).join(" ");return t.mui=!0,t}function hk(e,g){const t=this;if(t.vars){if(!t.colorSchemes?.[e]||typeof t.getColorSchemeSelector!="function")return{};let I=t.getColorSchemeSelector(e);return I==="&"?g:((I.includes("data-")||I.includes("."))&&(I=`*:where(${I.replace(/\s*&$/,"")}) &`),{[I]:g})}return t.palette.mode===e?g:{}}function Gr(e={},...g){const{breakpoints:t={},palette:I={},spacing:o,shape:C={},...s}=e,r=uk(t),c=UG(o);let d=nt({breakpoints:r,direction:"ltr",components:{},palette:{mode:"light",...I},spacing:c,shape:{...mk,...C}},s);return d=SR(d),d.applyStyles=hk,d=g.reduce((A,m)=>nt(A,m),d),d.unstable_sxConfig={...EC,...s?.unstable_sxConfig},d.unstable_sx=function(m){return $I({sx:m,theme:this})},d}function pk(e){return Object.keys(e).length===0}function Zk(e=null){const g=b.useContext(br);return!g||pk(g)?e:g}const bk=Gr();function LC(e=bk){return Zk(e)}function Pc(e){const g=mI(e);return e!==g&&g.styles?(g.styles.match(/^@layer\s+[^{]*$/)||(g.styles=`@layer global{${g.styles}}`),g):e}function Gk({styles:e,themeId:g,defaultTheme:t={}}){const I=LC(t),o=g&&I[g]||I;let C=typeof e=="function"?e(o):e;return o.modularCssLayers&&(Array.isArray(C)?C=C.map(s=>Pc(typeof s=="function"?s(o):s)):C=Pc(C)),p.jsx(ck,{styles:C})}function yk(e={}){const{themeId:g,defaultTheme:t,defaultClassName:I="MuiBox-root",generateClassName:o}=e,C=MG("div",{shouldForwardProp:r=>r!=="theme"&&r!=="sx"&&r!=="as"})($I);return b.forwardRef(function(c,d){const A=LC(t),{className:m,component:Z="div",...y}=YA(c);return p.jsx(C,{as:Z,ref:d,className:Ne(m,o?o(I):I),theme:g&&A[g]||A,...y})})}const Bk={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Cg(e,g,t="Mui"){const I=Bk[g];return I?`${t}-${I}`:`${fG.generate(e)}-${g}`}function $e(e,g,t="Mui"){const I={};return g.forEach(o=>{I[o]=Cg(e,o,t)}),I}function LG(e){const{variants:g,...t}=e,I={variants:g,style:mI(t),isProcessed:!0};return I.style===t||g&&g.forEach(o=>{typeof o.style!="function"&&(o.style=mI(o.style))}),I}const fk=Gr();function Oc(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function LI(e,g){return g&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${g}{${String(e.styles)}}`),e}function Sk(e){return e?(g,t)=>t[e]:null}function Vk(e,g,t){e.theme=Rk(e.theme)?t:e.theme[g]||e.theme}function ks(e,g,t){const I=typeof g=="function"?g(e):g;if(Array.isArray(I))return I.flatMap(o=>ks(e,o,t));if(Array.isArray(I?.variants)){let o;if(I.isProcessed)o=t?LI(I.style,t):I.style;else{const{variants:C,...s}=I;o=t?LI(mI(s),t):s}return TG(e,I.variants,[o],t)}return I?.isProcessed?t?LI(mI(I.style),t):I.style:t?LI(mI(I),t):I}function TG(e,g,t=[],I=void 0){let o;e:for(let C=0;C<g.length;C+=1){const s=g[C];if(typeof s.props=="function"){if(o??={...e,...e.ownerState,ownerState:e.ownerState},!s.props(o))continue}else for(const r in s.props)if(e[r]!==s.props[r]&&e.ownerState?.[r]!==s.props[r])continue e;typeof s.style=="function"?(o??={...e,...e.ownerState,ownerState:e.ownerState},t.push(I?LI(mI(s.style(o)),I):s.style(o))):t.push(I?LI(mI(s.style),I):s.style)}return t}function QG(e={}){const{themeId:g,defaultTheme:t=fk,rootShouldForwardProp:I=Oc,slotShouldForwardProp:o=Oc}=e;function C(r){Vk(r,g,t)}return(r,c={})=>{dk(r,F=>F.filter(U=>U!==$I));const{name:d,slot:A,skipVariantsResolver:m,skipSx:Z,overridesResolver:y=Sk(kk(A)),...G}=c,B=d&&d.startsWith("Mui")||A?"components":"custom",f=m!==void 0?m:A&&A!=="Root"&&A!=="root"||!1,W=Z||!1;let v=Oc;A==="Root"||A==="root"?v=I:A?v=o:Xk(r)&&(v=void 0);const R=MG(r,{shouldForwardProp:v,label:Wk(),...G}),k=F=>{if(F.__emotion_real===F)return F;if(typeof F=="function")return function(X){return ks(X,F,X.theme.modularCssLayers?B:void 0)};if(Zn(F)){const U=LG(F);return function(K){return U.variants?ks(K,U,K.theme.modularCssLayers?B:void 0):K.theme.modularCssLayers?LI(U.style,B):U.style}}return F},J=(...F)=>{const U=[],X=F.map(k),K=[];if(U.push(C),d&&y&&K.push(function(z){const L=z.theme.components?.[d]?.styleOverrides;if(!L)return null;const Q={};for(const q in L)Q[q]=ks(z,L[q],z.theme.modularCssLayers?"theme":void 0);return y(z,Q)}),d&&!f&&K.push(function(z){const L=z.theme?.components?.[d]?.variants;return L?TG(z,L,[],z.theme.modularCssLayers?"theme":void 0):null}),W||K.push($I),Array.isArray(X[0])){const V=X.shift(),z=new Array(U.length).fill(""),N=new Array(K.length).fill("");let L;L=[...z,...V,...N],L.raw=[...z,...V.raw,...N],U.unshift(L)}const w=[...U,...X,...K],D=R(...w);return r.muiName&&(D.muiName=r.muiName),D};return R.withConfig&&(J.withConfig=R.withConfig),J}}function Wk(e,g){return void 0}function Rk(e){for(const g in e)return!1;return!0}function Xk(e){return typeof e=="string"&&e.charCodeAt(0)>96}function kk(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}const Jk=QG();function fC(e,g,t=!1){const I={...g};for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){const C=o;if(C==="components"||C==="slots")I[C]={...e[C],...I[C]};else if(C==="componentsProps"||C==="slotProps"){const s=e[C],r=g[C];if(!r)I[C]=s||{};else if(!s)I[C]=r;else{I[C]={...r};for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const d=c;I[C][d]=fC(s[d],r[d],t)}}}else C==="className"&&t&&g.className?I.className=Ne(e?.className,g?.className):C==="style"&&t&&g.style?I.style={...e?.style,...g?.style}:I[C]===void 0&&(I[C]=e[C])}return I}function vk(e){const{theme:g,name:t,props:I}=e;return!g||!g.components||!g.components[t]||!g.components[t].defaultProps?I:fC(g.components[t].defaultProps,I)}function Yk({props:e,name:g,defaultTheme:t,themeId:I}){let o=LC(t);return I&&(o=o[I]||o),vk({theme:o,name:g,props:e})}const pI=typeof window<"u"?b.useLayoutEffect:b.useEffect;function Hk(e,g=Number.MIN_SAFE_INTEGER,t=Number.MAX_SAFE_INTEGER){return Math.max(g,Math.min(e,t))}function MA(e,g=0,t=1){return Hk(e,g,t)}function wk(e){e=e.slice(1);const g=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let t=e.match(g);return t&&t[0].length===1&&(t=t.map(I=>I+I)),t?`rgb${t.length===4?"a":""}(${t.map((I,o)=>o<3?parseInt(I,16):Math.round(parseInt(I,16)/255*1e3)/1e3).join(", ")})`:""}function ZI(e){if(e.type)return e;if(e.charAt(0)==="#")return ZI(wk(e));const g=e.indexOf("("),t=e.substring(0,g);if(!["rgb","rgba","hsl","hsla","color"].includes(t))throw new Error(En(9,e));let I=e.substring(g+1,e.length-1),o;if(t==="color"){if(I=I.split(" "),o=I.shift(),I.length===4&&I[3].charAt(0)==="/"&&(I[3]=I[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(o))throw new Error(En(10,o))}else I=I.split(",");return I=I.map(C=>parseFloat(C)),{type:t,values:I,colorSpace:o}}const Fk=e=>{const g=ZI(e);return g.values.slice(0,3).map((t,I)=>g.type.includes("hsl")&&I!==0?`${t}%`:t).join(" ")},lC=(e,g)=>{try{return Fk(e)}catch{return e}};function yr(e){const{type:g,colorSpace:t}=e;let{values:I}=e;return g.includes("rgb")?I=I.map((o,C)=>C<3?parseInt(o,10):o):g.includes("hsl")&&(I[1]=`${I[1]}%`,I[2]=`${I[2]}%`),g.includes("color")?I=`${t} ${I.join(" ")}`:I=`${I.join(", ")}`,`${g}(${I})`}function DG(e){e=ZI(e);const{values:g}=e,t=g[0],I=g[1]/100,o=g[2]/100,C=I*Math.min(o,1-o),s=(d,A=(d+t/30)%12)=>o-C*Math.max(Math.min(A-3,9-A,1),-1);let r="rgb";const c=[Math.round(s(0)*255),Math.round(s(8)*255),Math.round(s(4)*255)];return e.type==="hsla"&&(r+="a",c.push(g[3])),yr({type:r,values:c})}function Jd(e){e=ZI(e);let g=e.type==="hsl"||e.type==="hsla"?ZI(DG(e)).values:e.values;return g=g.map(t=>(e.type!=="color"&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4)),Number((.2126*g[0]+.7152*g[1]+.0722*g[2]).toFixed(3))}function Kk(e,g){const t=Jd(e),I=Jd(g);return(Math.max(t,I)+.05)/(Math.min(t,I)+.05)}function Ds(e,g){return e=ZI(e),g=MA(g),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${g}`:e.values[3]=g,yr(e)}function FI(e,g,t){try{return Ds(e,g)}catch{return e}}function Br(e,g){if(e=ZI(e),g=MA(g),e.type.includes("hsl"))e.values[2]*=1-g;else if(e.type.includes("rgb")||e.type.includes("color"))for(let t=0;t<3;t+=1)e.values[t]*=1-g;return yr(e)}function ng(e,g,t){try{return Br(e,g)}catch{return e}}function fr(e,g){if(e=ZI(e),g=MA(g),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*g;else if(e.type.includes("rgb"))for(let t=0;t<3;t+=1)e.values[t]+=(255-e.values[t])*g;else if(e.type.includes("color"))for(let t=0;t<3;t+=1)e.values[t]+=(1-e.values[t])*g;return yr(e)}function Ig(e,g,t){try{return fr(e,g)}catch{return e}}function Nk(e,g=.15){return Jd(e)>.5?Br(e,g):fr(e,g)}function as(e,g,t){try{return Nk(e,g)}catch{return e}}const xk=b.createContext(),Ek=()=>b.useContext(xk)??!1,zk=b.createContext(void 0);function Mk(e){const{theme:g,name:t,props:I}=e;if(!g||!g.components||!g.components[t])return I;const o=g.components[t];return o.defaultProps?fC(o.defaultProps,I,g.components.mergeClassNameAndStyle):!o.styleOverrides&&!o.variants?fC(o,I,g.components.mergeClassNameAndStyle):I}function Uk({props:e,name:g}){const t=b.useContext(zk);return Mk({props:e,name:g,theme:{components:t}})}let bZ=0;function Lk(e){const[g,t]=b.useState(e),I=e||g;return b.useEffect(()=>{g==null&&(bZ+=1,t(`mui-${bZ}`))},[g]),I}const Tk={...fd},GZ=Tk.useId;function UA(e){if(GZ!==void 0){const g=GZ();return e??g}return Lk(e)}const yZ={theme:void 0};function Qk(e){let g,t;return function(o){let C=g;return(C===void 0||o.theme!==t)&&(yZ.theme=o.theme,C=LG(e(yZ)),g=C,t=o.theme),C}}function Dk(e=""){function g(...I){if(!I.length)return"";const o=I[0];return typeof o=="string"&&!o.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${o}${g(...I.slice(1))})`:`, ${o}`}return(I,...o)=>`var(--${e?`${e}-`:""}${I}${g(...o)})`}const BZ=(e,g,t,I=[])=>{let o=e;g.forEach((C,s)=>{s===g.length-1?Array.isArray(o)?o[Number(C)]=t:o&&typeof o=="object"&&(o[C]=t):o&&typeof o=="object"&&(o[C]||(o[C]=I.includes(C)?[]:{}),o=o[C])})},jk=(e,g,t)=>{function I(o,C=[],s=[]){Object.entries(o).forEach(([r,c])=>{(!t||t&&!t([...C,r]))&&c!=null&&(typeof c=="object"&&Object.keys(c).length>0?I(c,[...C,r],Array.isArray(c)?[...s,r]:s):g([...C,r],c,s))})}I(e)},Pk=(e,g)=>typeof g=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(I=>e.includes(I))||e[e.length-1].toLowerCase().includes("opacity")?g:`${g}px`:g;function qc(e,g){const{prefix:t,shouldSkipGeneratingVar:I}=g||{},o={},C={},s={};return jk(e,(r,c,d)=>{if((typeof c=="string"||typeof c=="number")&&(!I||!I(r,c))){const A=`--${t?`${t}-`:""}${r.join("-")}`,m=Pk(r,c);Object.assign(o,{[A]:m}),BZ(C,r,`var(${A})`,d),BZ(s,r,`var(${A}, ${m})`,d)}},r=>r[0]==="vars"),{css:o,vars:C,varsWithDefaults:s}}function Ok(e,g={}){const{getSelector:t=W,disableCssColorScheme:I,colorSchemeSelector:o,enableContrastVars:C}=g,{colorSchemes:s={},components:r,defaultColorScheme:c="light",...d}=e,{vars:A,css:m,varsWithDefaults:Z}=qc(d,g);let y=Z;const G={},{[c]:B,...f}=s;if(Object.entries(f||{}).forEach(([k,J])=>{const{vars:F,css:U,varsWithDefaults:X}=qc(J,g);y=nt(y,X),G[k]={css:U,vars:F}}),B){const{css:k,vars:J,varsWithDefaults:F}=qc(B,g);y=nt(y,F),G[c]={css:k,vars:J}}function W(k,J){let F=o;if(o==="class"&&(F=".%s"),o==="data"&&(F="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(F=`[${o}="%s"]`),k){if(F==="media")return e.defaultColorScheme===k?":root":{[`@media (prefers-color-scheme: ${s[k]?.palette?.mode||k})`]:{":root":J}};if(F)return e.defaultColorScheme===k?`:root, ${F.replace("%s",String(k))}`:F.replace("%s",String(k))}return":root"}return{vars:y,generateThemeVars:()=>{let k={...A};return Object.entries(G).forEach(([,{vars:J}])=>{k=nt(k,J)}),k},generateStyleSheets:()=>{const k=[],J=e.defaultColorScheme||"light";function F(K,w){Object.keys(w).length&&k.push(typeof K=="string"?{[K]:{...w}}:K)}F(t(void 0,{...m}),m);const{[J]:U,...X}=G;if(U){const{css:K}=U,w=s[J]?.palette?.mode,D=!I&&w?{colorScheme:w,...K}:{...K};F(t(J,{...D}),D)}return Object.entries(X).forEach(([K,{css:w}])=>{const D=s[K]?.palette?.mode,V=!I&&D?{colorScheme:D,...w}:{...w};F(t(K,{...V}),V)}),C&&k.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),k}}}function qk(e){return function(t){return e==="media"?`@media (prefers-color-scheme: ${t})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${t}"] &`:e==="class"?`.${t} &`:e==="data"?`[data-${t}] &`:`${e.replace("%s",t)} &`:"&"}}function Js(e,g){return b.isValidElement(e)&&g.indexOf(e.type.muiName??e.type?._payload?.value?.muiName)!==-1}const _k=(e,g)=>e.filter(t=>g.includes(t)),$l=(e,g,t)=>{const I=e.keys[0];Array.isArray(g)?g.forEach((o,C)=>{t((s,r)=>{C<=e.keys.length-1&&(C===0?Object.assign(s,r):s[e.up(e.keys[C])]=r)},o)}):g&&typeof g=="object"?(Object.keys(g).length>e.keys.length?e.keys:_k(e.keys,Object.keys(g))).forEach(C=>{if(e.keys.includes(C)){const s=g[C];s!==void 0&&t((r,c)=>{I===C?Object.assign(r,c):r[e.up(C)]=c},s)}}):(typeof g=="number"||typeof g=="string")&&t((o,C)=>{Object.assign(o,C)},g)};function js(e){return`--Grid-${e}Spacing`}function Sr(e){return`--Grid-parent-${e}Spacing`}const fZ="--Grid-columns",Ll="--Grid-parent-columns",$k=({theme:e,ownerState:g})=>{const t={};return $l(e.breakpoints,g.size,(I,o)=>{let C={};o==="grow"&&(C={flexBasis:0,flexGrow:1,maxWidth:"100%"}),o==="auto"&&(C={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof o=="number"&&(C={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${o} / var(${Ll}) - (var(${Ll}) - ${o}) * (var(${Sr("column")}) / var(${Ll})))`}),I(t,C)}),t},eJ=({theme:e,ownerState:g})=>{const t={};return $l(e.breakpoints,g.offset,(I,o)=>{let C={};o==="auto"&&(C={marginLeft:"auto"}),typeof o=="number"&&(C={marginLeft:o===0?"0px":`calc(100% * ${o} / var(${Ll}) + var(${Sr("column")}) * ${o} / var(${Ll}))`}),I(t,C)}),t},gJ=({theme:e,ownerState:g})=>{if(!g.container)return{};const t={[fZ]:12};return $l(e.breakpoints,g.columns,(I,o)=>{const C=o??12;I(t,{[fZ]:C,"> *":{[Ll]:C}})}),t},tJ=({theme:e,ownerState:g})=>{if(!g.container)return{};const t={};return $l(e.breakpoints,g.rowSpacing,(I,o)=>{const C=typeof o=="string"?o:e.spacing?.(o);I(t,{[js("row")]:C,"> *":{[Sr("row")]:C}})}),t},nJ=({theme:e,ownerState:g})=>{if(!g.container)return{};const t={};return $l(e.breakpoints,g.columnSpacing,(I,o)=>{const C=typeof o=="string"?o:e.spacing?.(o);I(t,{[js("column")]:C,"> *":{[Sr("column")]:C}})}),t},IJ=({theme:e,ownerState:g})=>{if(!g.container)return{};const t={};return $l(e.breakpoints,g.direction,(I,o)=>{I(t,{flexDirection:o})}),t},lJ=({ownerState:e})=>({minWidth:0,boxSizing:"border-box",...e.container&&{display:"flex",flexWrap:"wrap",...e.wrap&&e.wrap!=="wrap"&&{flexWrap:e.wrap},gap:`var(${js("row")}) var(${js("column")})`}}),oJ=e=>{const g=[];return Object.entries(e).forEach(([t,I])=>{I!==!1&&I!==void 0&&g.push(`grid-${t}-${String(I)}`)}),g},CJ=(e,g="xs")=>{function t(I){return I===void 0?!1:typeof I=="string"&&!Number.isNaN(Number(I))||typeof I=="number"&&I>0}if(t(e))return[`spacing-${g}-${String(e)}`];if(typeof e=="object"&&!Array.isArray(e)){const I=[];return Object.entries(e).forEach(([o,C])=>{t(C)&&I.push(`spacing-${o}-${String(C)}`)}),I}return[]},iJ=e=>e===void 0?[]:typeof e=="object"?Object.entries(e).map(([g,t])=>`direction-${g}-${t}`):[`direction-xs-${String(e)}`];function sJ(e,g){e.item!==void 0&&delete e.item,e.zeroMinWidth!==void 0&&delete e.zeroMinWidth,g.keys.forEach(t=>{e[t]!==void 0&&delete e[t]})}const rJ=Gr(),aJ=Jk("div",{name:"MuiGrid",slot:"Root"});function cJ(e){return Yk({props:e,name:"MuiGrid",defaultTheme:rJ})}function dJ(e={}){const{createStyledComponent:g=aJ,useThemeProps:t=cJ,useTheme:I=LC,componentName:o="MuiGrid"}=e,C=(d,A)=>{const{container:m,direction:Z,spacing:y,wrap:G,size:B}=d,f={root:["root",m&&"container",G!=="wrap"&&`wrap-xs-${String(G)}`,...iJ(Z),...oJ(B),...m?CJ(y,A.breakpoints.keys[0]):[]]};return og(f,W=>Cg(o,W),{})};function s(d,A,m=()=>!0){const Z={};return d===null||(Array.isArray(d)?d.forEach((y,G)=>{y!==null&&m(y)&&A.keys[G]&&(Z[A.keys[G]]=y)}):typeof d=="object"?Object.keys(d).forEach(y=>{const G=d[y];G!=null&&m(G)&&(Z[y]=G)}):Z[A.keys[0]]=d),Z}const r=g(gJ,nJ,tJ,$k,IJ,lJ,eJ),c=b.forwardRef(function(A,m){const Z=I(),y=t(A),G=YA(y);sJ(G,Z.breakpoints);const{className:B,children:f,columns:W=12,container:v=!1,component:R="div",direction:k="row",wrap:J="wrap",size:F={},offset:U={},spacing:X=0,rowSpacing:K=X,columnSpacing:w=X,unstable_level:D=0,...V}=G,z=s(F,Z.breakpoints,H=>H!==!1),N=s(U,Z.breakpoints),L=A.columns??(D?void 0:W),Q=A.spacing??(D?void 0:X),q=A.rowSpacing??A.spacing??(D?void 0:K),j=A.columnSpacing??A.spacing??(D?void 0:w),P={...G,level:D,columns:L,container:v,direction:k,wrap:J,spacing:Q,rowSpacing:q,columnSpacing:j,size:z,offset:N},$=C(P,Z);return p.jsx(r,{ref:m,as:R,ownerState:P,className:Ne($.root,B),...V,children:b.Children.map(f,H=>b.isValidElement(H)&&Js(H,["Grid"])&&v&&H.props.container?b.cloneElement(H,{unstable_level:H.props?.unstable_level??D+1}):H)})});return c.muiName="Grid",c}const SC={black:"#000",white:"#fff"},AJ={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Xl={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},kl={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},Po={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Jl={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},vl={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Yl={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function jG(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:SC.white,default:SC.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const PG=jG();function OG(){return{text:{primary:SC.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:SC.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const vd=OG();function SZ(e,g,t,I){const o=I.light||I,C=I.dark||I*1.5;e[g]||(e.hasOwnProperty(t)?e[g]=e[t]:g==="light"?e.light=fr(e.main,o):g==="dark"&&(e.dark=Br(e.main,C)))}function VZ(e,g,t,I,o){const C=o.light||o,s=o.dark||o*1.5;g[t]||(g.hasOwnProperty(I)?g[t]=g[I]:t==="light"?g.light=`color-mix(in ${e}, ${g.main}, #fff ${(C*100).toFixed(0)}%)`:t==="dark"&&(g.dark=`color-mix(in ${e}, ${g.main}, #000 ${(s*100).toFixed(0)}%)`))}function uJ(e="light"){return e==="dark"?{main:Jl[200],light:Jl[50],dark:Jl[400]}:{main:Jl[700],light:Jl[400],dark:Jl[800]}}function mJ(e="light"){return e==="dark"?{main:Xl[200],light:Xl[50],dark:Xl[400]}:{main:Xl[500],light:Xl[300],dark:Xl[700]}}function hJ(e="light"){return e==="dark"?{main:kl[500],light:kl[300],dark:kl[700]}:{main:kl[700],light:kl[400],dark:kl[800]}}function pJ(e="light"){return e==="dark"?{main:vl[400],light:vl[300],dark:vl[700]}:{main:vl[700],light:vl[500],dark:vl[900]}}function ZJ(e="light"){return e==="dark"?{main:Yl[400],light:Yl[300],dark:Yl[700]}:{main:Yl[800],light:Yl[500],dark:Yl[900]}}function bJ(e="light"){return e==="dark"?{main:Po[400],light:Po[300],dark:Po[700]}:{main:"#ed6c02",light:Po[500],dark:Po[900]}}function GJ(e){return`oklch(from ${e} var(--__l) 0 h / var(--__a))`}function LA(e){const{mode:g="light",contrastThreshold:t=3,tonalOffset:I=.2,colorSpace:o,...C}=e,s=e.primary||uJ(g),r=e.secondary||mJ(g),c=e.error||hJ(g),d=e.info||pJ(g),A=e.success||ZJ(g),m=e.warning||bJ(g);function Z(f){return o?GJ(f):Kk(f,vd.text.primary)>=t?vd.text.primary:PG.text.primary}const y=({color:f,name:W,mainShade:v=500,lightShade:R=300,darkShade:k=700})=>{if(f={...f},!f.main&&f[v]&&(f.main=f[v]),!f.hasOwnProperty("main"))throw new Error(En(11,W?` (${W})`:"",v));if(typeof f.main!="string")throw new Error(En(12,W?` (${W})`:"",JSON.stringify(f.main)));return o?(VZ(o,f,"light",R,I),VZ(o,f,"dark",k,I)):(SZ(f,"light",R,I),SZ(f,"dark",k,I)),f.contrastText||(f.contrastText=Z(f.main)),f};let G;return g==="light"?G=jG():g==="dark"&&(G=OG()),nt({common:{...SC},mode:g,primary:y({color:s,name:"primary"}),secondary:y({color:r,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:y({color:c,name:"error"}),warning:y({color:m,name:"warning"}),info:y({color:d,name:"info"}),success:y({color:A,name:"success"}),grey:AJ,contrastThreshold:t,getContrastText:Z,augmentColor:y,tonalOffset:I,...G},C)}function yJ(e){const g={};return Object.entries(e).forEach(I=>{const[o,C]=I;typeof C=="object"&&(g[o]=`${C.fontStyle?`${C.fontStyle} `:""}${C.fontVariant?`${C.fontVariant} `:""}${C.fontWeight?`${C.fontWeight} `:""}${C.fontStretch?`${C.fontStretch} `:""}${C.fontSize||""}${C.lineHeight?`/${C.lineHeight} `:""}${C.fontFamily||""}`)}),g}function BJ(e,g){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...g}}function fJ(e){return Math.round(e*1e5)/1e5}const WZ={textTransform:"uppercase"},RZ='"Roboto", "Helvetica", "Arial", sans-serif';function SJ(e,g){const{fontFamily:t=RZ,fontSize:I=14,fontWeightLight:o=300,fontWeightRegular:C=400,fontWeightMedium:s=500,fontWeightBold:r=700,htmlFontSize:c=16,allVariants:d,pxToRem:A,...m}=typeof g=="function"?g(e):g,Z=I/14,y=A||(f=>`${f/c*Z}rem`),G=(f,W,v,R,k)=>({fontFamily:t,fontWeight:f,fontSize:y(W),lineHeight:v,...t===RZ?{letterSpacing:`${fJ(R/W)}em`}:{},...k,...d}),B={h1:G(o,96,1.167,-1.5),h2:G(o,60,1.2,-.5),h3:G(C,48,1.167,0),h4:G(C,34,1.235,.25),h5:G(C,24,1.334,0),h6:G(s,20,1.6,.15),subtitle1:G(C,16,1.75,.15),subtitle2:G(s,14,1.57,.1),body1:G(C,16,1.5,.15),body2:G(C,14,1.43,.15),button:G(s,14,1.75,.4,WZ),caption:G(C,12,1.66,.4),overline:G(C,12,2.66,1,WZ),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return nt({htmlFontSize:c,pxToRem:y,fontFamily:t,fontSize:I,fontWeightLight:o,fontWeightRegular:C,fontWeightMedium:s,fontWeightBold:r,...B},m,{clone:!1})}const VJ=.2,WJ=.14,RJ=.12;function mg(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${VJ})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${WJ})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${RJ})`].join(",")}const XJ=["none",mg(0,2,1,-1,0,1,1,0,0,1,3,0),mg(0,3,1,-2,0,2,2,0,0,1,5,0),mg(0,3,3,-2,0,3,4,0,0,1,8,0),mg(0,2,4,-1,0,4,5,0,0,1,10,0),mg(0,3,5,-1,0,5,8,0,0,1,14,0),mg(0,3,5,-1,0,6,10,0,0,1,18,0),mg(0,4,5,-2,0,7,10,1,0,2,16,1),mg(0,5,5,-3,0,8,10,1,0,3,14,2),mg(0,5,6,-3,0,9,12,1,0,3,16,2),mg(0,6,6,-3,0,10,14,1,0,4,18,3),mg(0,6,7,-4,0,11,15,1,0,4,20,3),mg(0,7,8,-4,0,12,17,2,0,5,22,4),mg(0,7,8,-4,0,13,19,2,0,5,24,4),mg(0,7,9,-4,0,14,21,2,0,5,26,4),mg(0,8,9,-5,0,15,22,2,0,6,28,5),mg(0,8,10,-5,0,16,24,2,0,6,30,5),mg(0,8,11,-5,0,17,26,2,0,6,32,5),mg(0,9,11,-5,0,18,28,2,0,7,34,6),mg(0,9,12,-6,0,19,29,2,0,7,36,6),mg(0,10,13,-6,0,20,31,3,0,8,38,7),mg(0,10,13,-6,0,21,33,3,0,8,40,7),mg(0,10,14,-6,0,22,35,3,0,8,42,7),mg(0,11,14,-7,0,23,36,3,0,9,44,8),mg(0,11,15,-7,0,24,38,3,0,9,46,8)],kJ={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},JJ={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function XZ(e){return`${Math.round(e)}ms`}function vJ(e){if(!e)return 0;const g=e/36;return Math.min(Math.round((4+15*g**.25+g/5)*10),3e3)}function YJ(e){const g={...kJ,...e.easing},t={...JJ,...e.duration};return{getAutoHeightDuration:vJ,create:(o=["all"],C={})=>{const{duration:s=t.standard,easing:r=g.easeInOut,delay:c=0,...d}=C;return(Array.isArray(o)?o:[o]).map(A=>`${A} ${typeof s=="string"?s:XZ(s)} ${r} ${typeof c=="string"?c:XZ(c)}`).join(",")},...e,easing:g,duration:t}}const HJ={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function wJ(e){return Zn(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function qG(e={}){const g={...e};function t(I){const o=Object.entries(I);for(let C=0;C<o.length;C++){const[s,r]=o[C];!wJ(r)||s.startsWith("unstable_")?delete I[s]:Zn(r)&&(I[s]={...r},t(I[s]))}}return t(g),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(g,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function kZ(e){return typeof e=="number"?`${(e*100).toFixed(0)}%`:`calc((${e}) * 100%)`}const FJ=e=>{if(!Number.isNaN(+e))return+e;const g=e.match(/\d*\.?\d+/g);if(!g)return 0;let t=0;for(let I=0;I<g.length;I+=1)t+=+g[I];return t};function KJ(e){Object.assign(e,{alpha(g,t){const I=this||e;return I.colorSpace?`oklch(from ${g} l c h / ${typeof t=="string"?`calc(${t})`:t})`:I.vars?`rgba(${g.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof t=="string"?`calc(${t})`:t})`:Ds(g,FJ(t))},lighten(g,t){const I=this||e;return I.colorSpace?`color-mix(in ${I.colorSpace}, ${g}, #fff ${kZ(t)})`:fr(g,t)},darken(g,t){const I=this||e;return I.colorSpace?`color-mix(in ${I.colorSpace}, ${g}, #000 ${kZ(t)})`:Br(g,t)}})}function Yd(e={},...g){const{breakpoints:t,mixins:I={},spacing:o,palette:C={},transitions:s={},typography:r={},shape:c,colorSpace:d,...A}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(En(20));const m=LA({...C,colorSpace:d}),Z=Gr(e);let y=nt(Z,{mixins:BJ(Z.breakpoints,I),palette:m,shadows:XJ.slice(),typography:SJ(m,r),transitions:YJ(s),zIndex:{...HJ}});return y=nt(y,A),y=g.reduce((G,B)=>nt(G,B),y),y.unstable_sxConfig={...EC,...A?.unstable_sxConfig},y.unstable_sx=function(B){return $I({sx:B,theme:this})},y.toRuntimeSource=qG,KJ(y),y}function Hd(e){let g;return e<1?g=5.11916*e**2:g=4.5*Math.log(e+1)+2,Math.round(g*10)/1e3}const NJ=[...Array(25)].map((e,g)=>{if(g===0)return"none";const t=Hd(g);return`linear-gradient(rgba(255 255 255 / ${t}), rgba(255 255 255 / ${t}))`});function _G(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function $G(e){return e==="dark"?NJ:[]}function xJ(e){const{palette:g={mode:"light"},opacity:t,overlays:I,colorSpace:o,...C}=e,s=LA({...g,colorSpace:o});return{palette:s,opacity:{..._G(s.mode),...t},overlays:I||$G(s.mode),...C}}function EJ(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const zJ=e=>[...[...Array(25)].map((g,t)=>`--${e?`${e}-`:""}overlays-${t}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],MJ=e=>(g,t)=>{const I=e.rootSelector||":root",o=e.colorSchemeSelector;let C=o;if(o==="class"&&(C=".%s"),o==="data"&&(C="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(C=`[${o}="%s"]`),e.defaultColorScheme===g){if(g==="dark"){const s={};return zJ(e.cssVarPrefix).forEach(r=>{s[r]=t[r],delete t[r]}),C==="media"?{[I]:t,"@media (prefers-color-scheme: dark)":{[I]:s}}:C?{[C.replace("%s",g)]:s,[`${I}, ${C.replace("%s",g)}`]:t}:{[I]:{...t,...s}}}if(C&&C!=="media")return`${I}, ${C.replace("%s",String(g))}`}else if(g){if(C==="media")return{[`@media (prefers-color-scheme: ${String(g)})`]:{[I]:t}};if(C)return C.replace("%s",String(g))}return I};function UJ(e,g){g.forEach(t=>{e[t]||(e[t]={})})}function ge(e,g,t){!e[g]&&t&&(e[g]=t)}function oC(e){return typeof e!="string"||!e.startsWith("hsl")?e:DG(e)}function Fn(e,g){`${g}Channel`in e||(e[`${g}Channel`]=lC(oC(e[g])))}function LJ(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const An=e=>{try{return e()}catch{}},TJ=(e="mui")=>Dk(e);function _c(e,g,t,I,o){if(!t)return;t=t===!0?{}:t;const C=o==="dark"?"dark":"light";if(!I){g[o]=xJ({...t,palette:{mode:C,...t?.palette},colorSpace:e});return}const{palette:s,...r}=Yd({...I,palette:{mode:C,...t?.palette},colorSpace:e});return g[o]={...t,palette:s,opacity:{..._G(C),...t?.opacity},overlays:t?.overlays||$G(C)},r}function QJ(e={},...g){const{colorSchemes:t={light:!0},defaultColorScheme:I,disableCssColorScheme:o=!1,cssVarPrefix:C="mui",nativeColor:s=!1,shouldSkipGeneratingVar:r=EJ,colorSchemeSelector:c=t.light&&t.dark?"media":void 0,rootSelector:d=":root",...A}=e,m=Object.keys(t)[0],Z=I||(t.light&&m!=="light"?"light":m),y=TJ(C),{[Z]:G,light:B,dark:f,...W}=t,v={...W};let R=G;if((Z==="dark"&&!("dark"in t)||Z==="light"&&!("light"in t))&&(R=!0),!R)throw new Error(En(21,Z));let k;s&&(k="oklch");const J=_c(k,v,R,A,Z);B&&!v.light&&_c(k,v,B,void 0,"light"),f&&!v.dark&&_c(k,v,f,void 0,"dark");let F={defaultColorScheme:Z,...J,cssVarPrefix:C,colorSchemeSelector:c,rootSelector:d,getCssVar:y,colorSchemes:v,font:{...yJ(J.typography),...J.font},spacing:LJ(A.spacing)};Object.keys(F.colorSchemes).forEach(D=>{const V=F.colorSchemes[D].palette,z=L=>{const Q=L.split("-"),q=Q[1],j=Q[2];return y(L,V[q][j])};V.mode==="light"&&(ge(V.common,"background","#fff"),ge(V.common,"onBackground","#000")),V.mode==="dark"&&(ge(V.common,"background","#000"),ge(V.common,"onBackground","#fff"));function N(L,Q,q){if(k){let j;return L===FI&&(j=`transparent ${((1-q)*100).toFixed(0)}%`),L===ng&&(j=`#000 ${(q*100).toFixed(0)}%`),L===Ig&&(j=`#fff ${(q*100).toFixed(0)}%`),`color-mix(in ${k}, ${Q}, ${j})`}return L(Q,q)}if(UJ(V,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),V.mode==="light"){ge(V.Alert,"errorColor",N(ng,V.error.light,.6)),ge(V.Alert,"infoColor",N(ng,V.info.light,.6)),ge(V.Alert,"successColor",N(ng,V.success.light,.6)),ge(V.Alert,"warningColor",N(ng,V.warning.light,.6)),ge(V.Alert,"errorFilledBg",z("palette-error-main")),ge(V.Alert,"infoFilledBg",z("palette-info-main")),ge(V.Alert,"successFilledBg",z("palette-success-main")),ge(V.Alert,"warningFilledBg",z("palette-warning-main")),ge(V.Alert,"errorFilledColor",An(()=>V.getContrastText(V.error.main))),ge(V.Alert,"infoFilledColor",An(()=>V.getContrastText(V.info.main))),ge(V.Alert,"successFilledColor",An(()=>V.getContrastText(V.success.main))),ge(V.Alert,"warningFilledColor",An(()=>V.getContrastText(V.warning.main))),ge(V.Alert,"errorStandardBg",N(Ig,V.error.light,.9)),ge(V.Alert,"infoStandardBg",N(Ig,V.info.light,.9)),ge(V.Alert,"successStandardBg",N(Ig,V.success.light,.9)),ge(V.Alert,"warningStandardBg",N(Ig,V.warning.light,.9)),ge(V.Alert,"errorIconColor",z("palette-error-main")),ge(V.Alert,"infoIconColor",z("palette-info-main")),ge(V.Alert,"successIconColor",z("palette-success-main")),ge(V.Alert,"warningIconColor",z("palette-warning-main")),ge(V.AppBar,"defaultBg",z("palette-grey-100")),ge(V.Avatar,"defaultBg",z("palette-grey-400")),ge(V.Button,"inheritContainedBg",z("palette-grey-300")),ge(V.Button,"inheritContainedHoverBg",z("palette-grey-A100")),ge(V.Chip,"defaultBorder",z("palette-grey-400")),ge(V.Chip,"defaultAvatarColor",z("palette-grey-700")),ge(V.Chip,"defaultIconColor",z("palette-grey-700")),ge(V.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),ge(V.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),ge(V.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),ge(V.LinearProgress,"primaryBg",N(Ig,V.primary.main,.62)),ge(V.LinearProgress,"secondaryBg",N(Ig,V.secondary.main,.62)),ge(V.LinearProgress,"errorBg",N(Ig,V.error.main,.62)),ge(V.LinearProgress,"infoBg",N(Ig,V.info.main,.62)),ge(V.LinearProgress,"successBg",N(Ig,V.success.main,.62)),ge(V.LinearProgress,"warningBg",N(Ig,V.warning.main,.62)),ge(V.Skeleton,"bg",k?N(FI,V.text.primary,.11):`rgba(${z("palette-text-primaryChannel")} / 0.11)`),ge(V.Slider,"primaryTrack",N(Ig,V.primary.main,.62)),ge(V.Slider,"secondaryTrack",N(Ig,V.secondary.main,.62)),ge(V.Slider,"errorTrack",N(Ig,V.error.main,.62)),ge(V.Slider,"infoTrack",N(Ig,V.info.main,.62)),ge(V.Slider,"successTrack",N(Ig,V.success.main,.62)),ge(V.Slider,"warningTrack",N(Ig,V.warning.main,.62));const L=k?N(ng,V.background.default,.6825):as(V.background.default,.8);ge(V.SnackbarContent,"bg",L),ge(V.SnackbarContent,"color",An(()=>k?vd.text.primary:V.getContrastText(L))),ge(V.SpeedDialAction,"fabHoverBg",as(V.background.paper,.15)),ge(V.StepConnector,"border",z("palette-grey-400")),ge(V.StepContent,"border",z("palette-grey-400")),ge(V.Switch,"defaultColor",z("palette-common-white")),ge(V.Switch,"defaultDisabledColor",z("palette-grey-100")),ge(V.Switch,"primaryDisabledColor",N(Ig,V.primary.main,.62)),ge(V.Switch,"secondaryDisabledColor",N(Ig,V.secondary.main,.62)),ge(V.Switch,"errorDisabledColor",N(Ig,V.error.main,.62)),ge(V.Switch,"infoDisabledColor",N(Ig,V.info.main,.62)),ge(V.Switch,"successDisabledColor",N(Ig,V.success.main,.62)),ge(V.Switch,"warningDisabledColor",N(Ig,V.warning.main,.62)),ge(V.TableCell,"border",N(Ig,N(FI,V.divider,1),.88)),ge(V.Tooltip,"bg",N(FI,V.grey[700],.92))}if(V.mode==="dark"){ge(V.Alert,"errorColor",N(Ig,V.error.light,.6)),ge(V.Alert,"infoColor",N(Ig,V.info.light,.6)),ge(V.Alert,"successColor",N(Ig,V.success.light,.6)),ge(V.Alert,"warningColor",N(Ig,V.warning.light,.6)),ge(V.Alert,"errorFilledBg",z("palette-error-dark")),ge(V.Alert,"infoFilledBg",z("palette-info-dark")),ge(V.Alert,"successFilledBg",z("palette-success-dark")),ge(V.Alert,"warningFilledBg",z("palette-warning-dark")),ge(V.Alert,"errorFilledColor",An(()=>V.getContrastText(V.error.dark))),ge(V.Alert,"infoFilledColor",An(()=>V.getContrastText(V.info.dark))),ge(V.Alert,"successFilledColor",An(()=>V.getContrastText(V.success.dark))),ge(V.Alert,"warningFilledColor",An(()=>V.getContrastText(V.warning.dark))),ge(V.Alert,"errorStandardBg",N(ng,V.error.light,.9)),ge(V.Alert,"infoStandardBg",N(ng,V.info.light,.9)),ge(V.Alert,"successStandardBg",N(ng,V.success.light,.9)),ge(V.Alert,"warningStandardBg",N(ng,V.warning.light,.9)),ge(V.Alert,"errorIconColor",z("palette-error-main")),ge(V.Alert,"infoIconColor",z("palette-info-main")),ge(V.Alert,"successIconColor",z("palette-success-main")),ge(V.Alert,"warningIconColor",z("palette-warning-main")),ge(V.AppBar,"defaultBg",z("palette-grey-900")),ge(V.AppBar,"darkBg",z("palette-background-paper")),ge(V.AppBar,"darkColor",z("palette-text-primary")),ge(V.Avatar,"defaultBg",z("palette-grey-600")),ge(V.Button,"inheritContainedBg",z("palette-grey-800")),ge(V.Button,"inheritContainedHoverBg",z("palette-grey-700")),ge(V.Chip,"defaultBorder",z("palette-grey-700")),ge(V.Chip,"defaultAvatarColor",z("palette-grey-300")),ge(V.Chip,"defaultIconColor",z("palette-grey-300")),ge(V.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),ge(V.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),ge(V.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),ge(V.LinearProgress,"primaryBg",N(ng,V.primary.main,.5)),ge(V.LinearProgress,"secondaryBg",N(ng,V.secondary.main,.5)),ge(V.LinearProgress,"errorBg",N(ng,V.error.main,.5)),ge(V.LinearProgress,"infoBg",N(ng,V.info.main,.5)),ge(V.LinearProgress,"successBg",N(ng,V.success.main,.5)),ge(V.LinearProgress,"warningBg",N(ng,V.warning.main,.5)),ge(V.Skeleton,"bg",k?N(FI,V.text.primary,.13):`rgba(${z("palette-text-primaryChannel")} / 0.13)`),ge(V.Slider,"primaryTrack",N(ng,V.primary.main,.5)),ge(V.Slider,"secondaryTrack",N(ng,V.secondary.main,.5)),ge(V.Slider,"errorTrack",N(ng,V.error.main,.5)),ge(V.Slider,"infoTrack",N(ng,V.info.main,.5)),ge(V.Slider,"successTrack",N(ng,V.success.main,.5)),ge(V.Slider,"warningTrack",N(ng,V.warning.main,.5));const L=k?N(Ig,V.background.default,.985):as(V.background.default,.98);ge(V.SnackbarContent,"bg",L),ge(V.SnackbarContent,"color",An(()=>k?PG.text.primary:V.getContrastText(L))),ge(V.SpeedDialAction,"fabHoverBg",as(V.background.paper,.15)),ge(V.StepConnector,"border",z("palette-grey-600")),ge(V.StepContent,"border",z("palette-grey-600")),ge(V.Switch,"defaultColor",z("palette-grey-300")),ge(V.Switch,"defaultDisabledColor",z("palette-grey-600")),ge(V.Switch,"primaryDisabledColor",N(ng,V.primary.main,.55)),ge(V.Switch,"secondaryDisabledColor",N(ng,V.secondary.main,.55)),ge(V.Switch,"errorDisabledColor",N(ng,V.error.main,.55)),ge(V.Switch,"infoDisabledColor",N(ng,V.info.main,.55)),ge(V.Switch,"successDisabledColor",N(ng,V.success.main,.55)),ge(V.Switch,"warningDisabledColor",N(ng,V.warning.main,.55)),ge(V.TableCell,"border",N(ng,N(FI,V.divider,1),.68)),ge(V.Tooltip,"bg",N(FI,V.grey[700],.92))}Fn(V.background,"default"),Fn(V.background,"paper"),Fn(V.common,"background"),Fn(V.common,"onBackground"),Fn(V,"divider"),Object.keys(V).forEach(L=>{const Q=V[L];L!=="tonalOffset"&&Q&&typeof Q=="object"&&(Q.main&&ge(V[L],"mainChannel",lC(oC(Q.main))),Q.light&&ge(V[L],"lightChannel",lC(oC(Q.light))),Q.dark&&ge(V[L],"darkChannel",lC(oC(Q.dark))),Q.contrastText&&ge(V[L],"contrastTextChannel",lC(oC(Q.contrastText))),L==="text"&&(Fn(V[L],"primary"),Fn(V[L],"secondary")),L==="action"&&(Q.active&&Fn(V[L],"active"),Q.selected&&Fn(V[L],"selected")))})}),F=g.reduce((D,V)=>nt(D,V),F);const U={prefix:C,disableCssColorScheme:o,shouldSkipGeneratingVar:r,getSelector:MJ(F),enableContrastVars:s},{vars:X,generateThemeVars:K,generateStyleSheets:w}=Ok(F,U);return F.vars=X,Object.entries(F.colorSchemes[F.defaultColorScheme]).forEach(([D,V])=>{F[D]=V}),F.generateThemeVars=K,F.generateStyleSheets=w,F.generateSpacing=function(){return UG(A.spacing,JA(this))},F.getColorSchemeSelector=qk(c),F.spacing=F.generateSpacing(),F.shouldSkipGeneratingVar=r,F.unstable_sxConfig={...EC,...A?.unstable_sxConfig},F.unstable_sx=function(V){return $I({sx:V,theme:this})},F.toRuntimeSource=qG,F}function JZ(e,g,t){e.colorSchemes&&t&&(e.colorSchemes[g]={...t!==!0&&t,palette:LA({...t===!0?{}:t.palette,mode:g})})}function ey(e={},...g){const{palette:t,cssVariables:I=!1,colorSchemes:o=t?void 0:{light:!0},defaultColorScheme:C=t?.mode,...s}=e,r=C||"light",c=o?.[r],d={...o,...t?{[r]:{...typeof c!="boolean"&&c,palette:t}}:void 0};if(I===!1){if(!("colorSchemes"in e))return Yd(e,...g);let A=t;"palette"in e||d[r]&&(d[r]!==!0?A=d[r].palette:r==="dark"&&(A={mode:"dark"}));const m=Yd({...e,palette:A},...g);return m.defaultColorScheme=r,m.colorSchemes=d,m.palette.mode==="light"&&(m.colorSchemes.light={...d.light!==!0&&d.light,palette:m.palette},JZ(m,"dark",d.dark)),m.palette.mode==="dark"&&(m.colorSchemes.dark={...d.dark!==!0&&d.dark,palette:m.palette},JZ(m,"light",d.light)),m}return!t&&!("light"in d)&&r==="light"&&(d.light=!0),QJ({...s,colorSchemes:d,defaultColorScheme:r,...typeof I!="boolean"&&I},...g)}const TA=ey(),Vr="$$material";function Wr(){const e=LC(TA);return e[Vr]||e}function DJ(e){return p.jsx(Gk,{...e,defaultTheme:TA,themeId:Vr})}function gy(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const Tt=e=>gy(e)&&e!=="classes",Xe=QG({themeId:Vr,defaultTheme:TA,rootShouldForwardProp:Tt});function jJ(e){return function(t){return p.jsx(DJ,{styles:typeof e=="function"?I=>e({theme:I,...t}):e})}}function PJ(){return YA}const vg=Qk;function sg(e){return Uk(e)}function OJ(e){return Cg("MuiSvgIcon",e)}$e("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const qJ=e=>{const{color:g,fontSize:t,classes:I}=e,o={root:["root",g!=="inherit"&&`color${ze(g)}`,`fontSize${ze(t)}`]};return og(o,OJ,I)},_J=Xe("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,t.color!=="inherit"&&g[`color${ze(t.color)}`],g[`fontSize${ze(t.fontSize)}`]]}})(vg(({theme:e})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:e.transitions?.create?.("fill",{duration:(e.vars??e).transitions?.duration?.shorter}),variants:[{props:g=>!g.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:e.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:e.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:e.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,g])=>g&&g.main).map(([g])=>({props:{color:g},style:{color:(e.vars??e).palette?.[g]?.main}})),{props:{color:"action"},style:{color:(e.vars??e).palette?.action?.active}},{props:{color:"disabled"},style:{color:(e.vars??e).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),wd=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiSvgIcon"}),{children:o,className:C,color:s="inherit",component:r="svg",fontSize:c="medium",htmlColor:d,inheritViewBox:A=!1,titleAccess:m,viewBox:Z="0 0 24 24",...y}=I,G=b.isValidElement(o)&&o.type==="svg",B={...I,color:s,component:r,fontSize:c,instanceFontSize:g.fontSize,inheritViewBox:A,viewBox:Z,hasSvgAsChild:G},f={};A||(f.viewBox=Z);const W=qJ(B);return p.jsxs(_J,{as:r,className:Ne(W.root,C),focusable:"false",color:d,"aria-hidden":m?void 0:!0,role:m?"img":void 0,ref:t,...f,...y,...G&&o.props,ownerState:B,children:[G?o.props.children:o,m?p.jsx("title",{children:m}):null]})});wd.muiName="SvgIcon";function In(e,g){function t(I,o){return p.jsx(wd,{"data-testid":void 0,ref:o,...I,children:e})}return t.muiName=wd.muiName,b.memo(b.forwardRef(t))}function ty(e,g=166){let t;function I(...o){const C=()=>{e.apply(this,o)};clearTimeout(t),t=setTimeout(C,g)}return I.clear=()=>{clearTimeout(t)},I}function nn(e){return e&&e.ownerDocument||document}function Mn(e){return nn(e).defaultView||window}function vZ(e,g){typeof e=="function"?e(g):e&&(e.current=g)}function YZ(e){const{controlled:g,default:t,name:I,state:o="value"}=e,{current:C}=b.useRef(g!==void 0),[s,r]=b.useState(t),c=C?g:s,d=b.useCallback(A=>{C||r(A)},[]);return[c,d]}function PI(e){const g=b.useRef(e);return pI(()=>{g.current=e}),b.useRef((...t)=>(0,g.current)(...t)).current}function it(...e){const g=b.useRef(void 0),t=b.useCallback(I=>{const o=e.map(C=>{if(C==null)return null;if(typeof C=="function"){const s=C,r=s(I);return typeof r=="function"?r:()=>{s(null)}}return C.current=I,()=>{C.current=null}});return()=>{o.forEach(C=>C?.())}},e);return b.useMemo(()=>e.every(I=>I==null)?null:I=>{g.current&&(g.current(),g.current=void 0),I!=null&&(g.current=t(I))},e)}function $J(e,g){const t=e.charCodeAt(2);return e[0]==="o"&&e[1]==="n"&&t>=65&&t<=90&&typeof g=="function"}function ev(e,g){if(!e)return g;function t(s,r){const c={};return Object.keys(r).forEach(d=>{$J(d,r[d])&&typeof s[d]=="function"&&(c[d]=(...A)=>{s[d](...A),r[d](...A)})}),c}if(typeof e=="function"||typeof g=="function")return s=>{const r=typeof g=="function"?g(s):g,c=typeof e=="function"?e({...s,...r}):e,d=Ne(s?.className,r?.className,c?.className),A=t(c,r);return{...r,...c,...A,...!!d&&{className:d},...r?.style&&c?.style&&{style:{...r.style,...c.style}},...r?.sx&&c?.sx&&{sx:[...Array.isArray(r.sx)?r.sx:[r.sx],...Array.isArray(c.sx)?c.sx:[c.sx]]}}};const I=g,o=t(e,I),C=Ne(I?.className,e?.className);return{...g,...e,...o,...!!C&&{className:C},...I?.style&&e?.style&&{style:{...I.style,...e.style}},...I?.sx&&e?.sx&&{sx:[...Array.isArray(I.sx)?I.sx:[I.sx],...Array.isArray(e.sx)?e.sx:[e.sx]]}}}const gv=In(p.jsx("path",{d:"M14.4 6 14 4H5v17h2v-7h5.6l.4 2h7V6z"}));function ny(e,g){return function(){return e.apply(g,arguments)}}const{toString:tv}=Object.prototype,{getPrototypeOf:QA}=Object,{iterator:Rr,toStringTag:Iy}=Symbol,Xr=(e=>g=>{const t=tv.call(g);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),ln=e=>(e=e.toLowerCase(),g=>Xr(g)===e),kr=e=>g=>typeof g===e,{isArray:eo}=Array,VC=kr("undefined");function nv(e){return e!==null&&!VC(e)&&e.constructor!==null&&!VC(e.constructor)&&Zt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ly=ln("ArrayBuffer");function Iv(e){let g;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?g=ArrayBuffer.isView(e):g=e&&e.buffer&&ly(e.buffer),g}const lv=kr("string"),Zt=kr("function"),oy=kr("number"),Jr=e=>e!==null&&typeof e=="object",ov=e=>e===!0||e===!1,vs=e=>{if(Xr(e)!=="object")return!1;const g=QA(e);return(g===null||g===Object.prototype||Object.getPrototypeOf(g)===null)&&!(Iy in e)&&!(Rr in e)},Cv=ln("Date"),iv=ln("File"),sv=ln("Blob"),rv=ln("FileList"),av=e=>Jr(e)&&Zt(e.pipe),cv=e=>{let g;return e&&(typeof FormData=="function"&&e instanceof FormData||Zt(e.append)&&((g=Xr(e))==="formdata"||g==="object"&&Zt(e.toString)&&e.toString()==="[object FormData]"))},dv=ln("URLSearchParams"),[Av,uv,mv,hv]=["ReadableStream","Request","Response","Headers"].map(ln),pv=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function TC(e,g,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let I,o;if(typeof e!="object"&&(e=[e]),eo(e))for(I=0,o=e.length;I<o;I++)g.call(null,e[I],I,e);else{const C=t?Object.getOwnPropertyNames(e):Object.keys(e),s=C.length;let r;for(I=0;I<s;I++)r=C[I],g.call(null,e[r],r,e)}}function Cy(e,g){g=g.toLowerCase();const t=Object.keys(e);let I=t.length,o;for(;I-- >0;)if(o=t[I],g===o.toLowerCase())return o;return null}const TI=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,iy=e=>!VC(e)&&e!==TI;function Fd(){const{caseless:e}=iy(this)&&this||{},g={},t=(I,o)=>{const C=e&&Cy(g,o)||o;vs(g[C])&&vs(I)?g[C]=Fd(g[C],I):vs(I)?g[C]=Fd({},I):eo(I)?g[C]=I.slice():g[C]=I};for(let I=0,o=arguments.length;I<o;I++)arguments[I]&&TC(arguments[I],t);return g}const Zv=(e,g,t,{allOwnKeys:I}={})=>(TC(g,(o,C)=>{t&&Zt(o)?e[C]=ny(o,t):e[C]=o},{allOwnKeys:I}),e),bv=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Gv=(e,g,t,I)=>{e.prototype=Object.create(g.prototype,I),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:g.prototype}),t&&Object.assign(e.prototype,t)},yv=(e,g,t,I)=>{let o,C,s;const r={};if(g=g||{},e==null)return g;do{for(o=Object.getOwnPropertyNames(e),C=o.length;C-- >0;)s=o[C],(!I||I(s,e,g))&&!r[s]&&(g[s]=e[s],r[s]=!0);e=t!==!1&&QA(e)}while(e&&(!t||t(e,g))&&e!==Object.prototype);return g},Bv=(e,g,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=g.length;const I=e.indexOf(g,t);return I!==-1&&I===t},fv=e=>{if(!e)return null;if(eo(e))return e;let g=e.length;if(!oy(g))return null;const t=new Array(g);for(;g-- >0;)t[g]=e[g];return t},Sv=(e=>g=>e&&g instanceof e)(typeof Uint8Array<"u"&&QA(Uint8Array)),Vv=(e,g)=>{const I=(e&&e[Rr]).call(e);let o;for(;(o=I.next())&&!o.done;){const C=o.value;g.call(e,C[0],C[1])}},Wv=(e,g)=>{let t;const I=[];for(;(t=e.exec(g))!==null;)I.push(t);return I},Rv=ln("HTMLFormElement"),Xv=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,I,o){return I.toUpperCase()+o}),HZ=(({hasOwnProperty:e})=>(g,t)=>e.call(g,t))(Object.prototype),kv=ln("RegExp"),sy=(e,g)=>{const t=Object.getOwnPropertyDescriptors(e),I={};TC(t,(o,C)=>{let s;(s=g(o,C,e))!==!1&&(I[C]=s||o)}),Object.defineProperties(e,I)},Jv=e=>{sy(e,(g,t)=>{if(Zt(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const I=e[t];if(Zt(I)){if(g.enumerable=!1,"writable"in g){g.writable=!1;return}g.set||(g.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},vv=(e,g)=>{const t={},I=o=>{o.forEach(C=>{t[C]=!0})};return eo(e)?I(e):I(String(e).split(g)),t},Yv=()=>{},Hv=(e,g)=>e!=null&&Number.isFinite(e=+e)?e:g;function wv(e){return!!(e&&Zt(e.append)&&e[Iy]==="FormData"&&e[Rr])}const Fv=e=>{const g=new Array(10),t=(I,o)=>{if(Jr(I)){if(g.indexOf(I)>=0)return;if(!("toJSON"in I)){g[o]=I;const C=eo(I)?[]:{};return TC(I,(s,r)=>{const c=t(s,o+1);!VC(c)&&(C[r]=c)}),g[o]=void 0,C}}return I};return t(e,0)},Kv=ln("AsyncFunction"),Nv=e=>e&&(Jr(e)||Zt(e))&&Zt(e.then)&&Zt(e.catch),ry=((e,g)=>e?setImmediate:g?((t,I)=>(TI.addEventListener("message",({source:o,data:C})=>{o===TI&&C===t&&I.length&&I.shift()()},!1),o=>{I.push(o),TI.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Zt(TI.postMessage)),xv=typeof queueMicrotask<"u"?queueMicrotask.bind(TI):typeof process<"u"&&process.nextTick||ry,Ev=e=>e!=null&&Zt(e[Rr]),ee={isArray:eo,isArrayBuffer:ly,isBuffer:nv,isFormData:cv,isArrayBufferView:Iv,isString:lv,isNumber:oy,isBoolean:ov,isObject:Jr,isPlainObject:vs,isReadableStream:Av,isRequest:uv,isResponse:mv,isHeaders:hv,isUndefined:VC,isDate:Cv,isFile:iv,isBlob:sv,isRegExp:kv,isFunction:Zt,isStream:av,isURLSearchParams:dv,isTypedArray:Sv,isFileList:rv,forEach:TC,merge:Fd,extend:Zv,trim:pv,stripBOM:bv,inherits:Gv,toFlatObject:yv,kindOf:Xr,kindOfTest:ln,endsWith:Bv,toArray:fv,forEachEntry:Vv,matchAll:Wv,isHTMLForm:Rv,hasOwnProperty:HZ,hasOwnProp:HZ,reduceDescriptors:sy,freezeMethods:Jv,toObjectSet:vv,toCamelCase:Xv,noop:Yv,toFiniteNumber:Hv,findKey:Cy,global:TI,isContextDefined:iy,isSpecCompliantForm:wv,toJSONObject:Fv,isAsyncFn:Kv,isThenable:Nv,setImmediate:ry,asap:xv,isIterable:Ev};function Ee(e,g,t,I,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",g&&(this.code=g),t&&(this.config=t),I&&(this.request=I),o&&(this.response=o,this.status=o.status?o.status:null)}ee.inherits(Ee,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ee.toJSONObject(this.config),code:this.code,status:this.status}}});const ay=Ee.prototype,cy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{cy[e]={value:e}});Object.defineProperties(Ee,cy);Object.defineProperty(ay,"isAxiosError",{value:!0});Ee.from=(e,g,t,I,o,C)=>{const s=Object.create(ay);return ee.toFlatObject(e,s,function(c){return c!==Error.prototype},r=>r!=="isAxiosError"),Ee.call(s,e.message,g,t,I,o),s.cause=e,s.name=e.name,C&&Object.assign(s,C),s};const zv=null;function Kd(e){return ee.isPlainObject(e)||ee.isArray(e)}function dy(e){return ee.endsWith(e,"[]")?e.slice(0,-2):e}function wZ(e,g,t){return e?e.concat(g).map(function(o,C){return o=dy(o),!t&&C?"["+o+"]":o}).join(t?".":""):g}function Mv(e){return ee.isArray(e)&&!e.some(Kd)}const Uv=ee.toFlatObject(ee,{},null,function(g){return/^is[A-Z]/.test(g)});function vr(e,g,t){if(!ee.isObject(e))throw new TypeError("target must be an object");g=g||new FormData,t=ee.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(B,f){return!ee.isUndefined(f[B])});const I=t.metaTokens,o=t.visitor||A,C=t.dots,s=t.indexes,c=(t.Blob||typeof Blob<"u"&&Blob)&&ee.isSpecCompliantForm(g);if(!ee.isFunction(o))throw new TypeError("visitor must be a function");function d(G){if(G===null)return"";if(ee.isDate(G))return G.toISOString();if(ee.isBoolean(G))return G.toString();if(!c&&ee.isBlob(G))throw new Ee("Blob is not supported. Use a Buffer instead.");return ee.isArrayBuffer(G)||ee.isTypedArray(G)?c&&typeof Blob=="function"?new Blob([G]):Buffer.from(G):G}function A(G,B,f){let W=G;if(G&&!f&&typeof G=="object"){if(ee.endsWith(B,"{}"))B=I?B:B.slice(0,-2),G=JSON.stringify(G);else if(ee.isArray(G)&&Mv(G)||(ee.isFileList(G)||ee.endsWith(B,"[]"))&&(W=ee.toArray(G)))return B=dy(B),W.forEach(function(R,k){!(ee.isUndefined(R)||R===null)&&g.append(s===!0?wZ([B],k,C):s===null?B:B+"[]",d(R))}),!1}return Kd(G)?!0:(g.append(wZ(f,B,C),d(G)),!1)}const m=[],Z=Object.assign(Uv,{defaultVisitor:A,convertValue:d,isVisitable:Kd});function y(G,B){if(!ee.isUndefined(G)){if(m.indexOf(G)!==-1)throw Error("Circular reference detected in "+B.join("."));m.push(G),ee.forEach(G,function(W,v){(!(ee.isUndefined(W)||W===null)&&o.call(g,W,ee.isString(v)?v.trim():v,B,Z))===!0&&y(W,B?B.concat(v):[v])}),m.pop()}}if(!ee.isObject(e))throw new TypeError("data must be an object");return y(e),g}function FZ(e){const g={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(I){return g[I]})}function DA(e,g){this._pairs=[],e&&vr(e,this,g)}const Ay=DA.prototype;Ay.append=function(g,t){this._pairs.push([g,t])};Ay.toString=function(g){const t=g?function(I){return g.call(this,I,FZ)}:FZ;return this._pairs.map(function(o){return t(o[0])+"="+t(o[1])},"").join("&")};function Lv(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function uy(e,g,t){if(!g)return e;const I=t&&t.encode||Lv;ee.isFunction(t)&&(t={serialize:t});const o=t&&t.serialize;let C;if(o?C=o(g,t):C=ee.isURLSearchParams(g)?g.toString():new DA(g,t).toString(I),C){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+C}return e}class KZ{constructor(){this.handlers=[]}use(g,t,I){return this.handlers.push({fulfilled:g,rejected:t,synchronous:I?I.synchronous:!1,runWhen:I?I.runWhen:null}),this.handlers.length-1}eject(g){this.handlers[g]&&(this.handlers[g]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(g){ee.forEach(this.handlers,function(I){I!==null&&g(I)})}}const my={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Tv=typeof URLSearchParams<"u"?URLSearchParams:DA,Qv=typeof FormData<"u"?FormData:null,Dv=typeof Blob<"u"?Blob:null,jv={isBrowser:!0,classes:{URLSearchParams:Tv,FormData:Qv,Blob:Dv},protocols:["http","https","file","blob","url","data"]},jA=typeof window<"u"&&typeof document<"u",Nd=typeof navigator=="object"&&navigator||void 0,Pv=jA&&(!Nd||["ReactNative","NativeScript","NS"].indexOf(Nd.product)<0),Ov=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",qv=jA&&window.location.href||"http://localhost",_v=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:jA,hasStandardBrowserEnv:Pv,hasStandardBrowserWebWorkerEnv:Ov,navigator:Nd,origin:qv},Symbol.toStringTag,{value:"Module"})),gt={..._v,...jv};function $v(e,g){return vr(e,new gt.classes.URLSearchParams,Object.assign({visitor:function(t,I,o,C){return gt.isNode&&ee.isBuffer(t)?(this.append(I,t.toString("base64")),!1):C.defaultVisitor.apply(this,arguments)}},g))}function e2(e){return ee.matchAll(/\w+|\[(\w*)]/g,e).map(g=>g[0]==="[]"?"":g[1]||g[0])}function g2(e){const g={},t=Object.keys(e);let I;const o=t.length;let C;for(I=0;I<o;I++)C=t[I],g[C]=e[C];return g}function hy(e){function g(t,I,o,C){let s=t[C++];if(s==="__proto__")return!0;const r=Number.isFinite(+s),c=C>=t.length;return s=!s&&ee.isArray(o)?o.length:s,c?(ee.hasOwnProp(o,s)?o[s]=[o[s],I]:o[s]=I,!r):((!o[s]||!ee.isObject(o[s]))&&(o[s]=[]),g(t,I,o[s],C)&&ee.isArray(o[s])&&(o[s]=g2(o[s])),!r)}if(ee.isFormData(e)&&ee.isFunction(e.entries)){const t={};return ee.forEachEntry(e,(I,o)=>{g(e2(I),o,t,0)}),t}return null}function t2(e,g,t){if(ee.isString(e))try{return(g||JSON.parse)(e),ee.trim(e)}catch(I){if(I.name!=="SyntaxError")throw I}return(t||JSON.stringify)(e)}const QC={transitional:my,adapter:["xhr","http","fetch"],transformRequest:[function(g,t){const I=t.getContentType()||"",o=I.indexOf("application/json")>-1,C=ee.isObject(g);if(C&&ee.isHTMLForm(g)&&(g=new FormData(g)),ee.isFormData(g))return o?JSON.stringify(hy(g)):g;if(ee.isArrayBuffer(g)||ee.isBuffer(g)||ee.isStream(g)||ee.isFile(g)||ee.isBlob(g)||ee.isReadableStream(g))return g;if(ee.isArrayBufferView(g))return g.buffer;if(ee.isURLSearchParams(g))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),g.toString();let r;if(C){if(I.indexOf("application/x-www-form-urlencoded")>-1)return $v(g,this.formSerializer).toString();if((r=ee.isFileList(g))||I.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return vr(r?{"files[]":g}:g,c&&new c,this.formSerializer)}}return C||o?(t.setContentType("application/json",!1),t2(g)):g}],transformResponse:[function(g){const t=this.transitional||QC.transitional,I=t&&t.forcedJSONParsing,o=this.responseType==="json";if(ee.isResponse(g)||ee.isReadableStream(g))return g;if(g&&ee.isString(g)&&(I&&!this.responseType||o)){const s=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(g)}catch(r){if(s)throw r.name==="SyntaxError"?Ee.from(r,Ee.ERR_BAD_RESPONSE,this,null,this.response):r}}return g}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:gt.classes.FormData,Blob:gt.classes.Blob},validateStatus:function(g){return g>=200&&g<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ee.forEach(["delete","get","head","post","put","patch"],e=>{QC.headers[e]={}});const n2=ee.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),I2=e=>{const g={};let t,I,o;return e&&e.split(`
`).forEach(function(s){o=s.indexOf(":"),t=s.substring(0,o).trim().toLowerCase(),I=s.substring(o+1).trim(),!(!t||g[t]&&n2[t])&&(t==="set-cookie"?g[t]?g[t].push(I):g[t]=[I]:g[t]=g[t]?g[t]+", "+I:I)}),g},NZ=Symbol("internals");function Oo(e){return e&&String(e).trim().toLowerCase()}function Ys(e){return e===!1||e==null?e:ee.isArray(e)?e.map(Ys):String(e)}function l2(e){const g=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let I;for(;I=t.exec(e);)g[I[1]]=I[2];return g}const o2=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function $c(e,g,t,I,o){if(ee.isFunction(I))return I.call(this,g,t);if(o&&(g=t),!!ee.isString(g)){if(ee.isString(I))return g.indexOf(I)!==-1;if(ee.isRegExp(I))return I.test(g)}}function C2(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(g,t,I)=>t.toUpperCase()+I)}function i2(e,g){const t=ee.toCamelCase(" "+g);["get","set","has"].forEach(I=>{Object.defineProperty(e,I+t,{value:function(o,C,s){return this[I].call(this,g,o,C,s)},configurable:!0})})}let bt=class{constructor(g){g&&this.set(g)}set(g,t,I){const o=this;function C(r,c,d){const A=Oo(c);if(!A)throw new Error("header name must be a non-empty string");const m=ee.findKey(o,A);(!m||o[m]===void 0||d===!0||d===void 0&&o[m]!==!1)&&(o[m||c]=Ys(r))}const s=(r,c)=>ee.forEach(r,(d,A)=>C(d,A,c));if(ee.isPlainObject(g)||g instanceof this.constructor)s(g,t);else if(ee.isString(g)&&(g=g.trim())&&!o2(g))s(I2(g),t);else if(ee.isObject(g)&&ee.isIterable(g)){let r={},c,d;for(const A of g){if(!ee.isArray(A))throw TypeError("Object iterator must return a key-value pair");r[d=A[0]]=(c=r[d])?ee.isArray(c)?[...c,A[1]]:[c,A[1]]:A[1]}s(r,t)}else g!=null&&C(t,g,I);return this}get(g,t){if(g=Oo(g),g){const I=ee.findKey(this,g);if(I){const o=this[I];if(!t)return o;if(t===!0)return l2(o);if(ee.isFunction(t))return t.call(this,o,I);if(ee.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(g,t){if(g=Oo(g),g){const I=ee.findKey(this,g);return!!(I&&this[I]!==void 0&&(!t||$c(this,this[I],I,t)))}return!1}delete(g,t){const I=this;let o=!1;function C(s){if(s=Oo(s),s){const r=ee.findKey(I,s);r&&(!t||$c(I,I[r],r,t))&&(delete I[r],o=!0)}}return ee.isArray(g)?g.forEach(C):C(g),o}clear(g){const t=Object.keys(this);let I=t.length,o=!1;for(;I--;){const C=t[I];(!g||$c(this,this[C],C,g,!0))&&(delete this[C],o=!0)}return o}normalize(g){const t=this,I={};return ee.forEach(this,(o,C)=>{const s=ee.findKey(I,C);if(s){t[s]=Ys(o),delete t[C];return}const r=g?C2(C):String(C).trim();r!==C&&delete t[C],t[r]=Ys(o),I[r]=!0}),this}concat(...g){return this.constructor.concat(this,...g)}toJSON(g){const t=Object.create(null);return ee.forEach(this,(I,o)=>{I!=null&&I!==!1&&(t[o]=g&&ee.isArray(I)?I.join(", "):I)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([g,t])=>g+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(g){return g instanceof this?g:new this(g)}static concat(g,...t){const I=new this(g);return t.forEach(o=>I.set(o)),I}static accessor(g){const I=(this[NZ]=this[NZ]={accessors:{}}).accessors,o=this.prototype;function C(s){const r=Oo(s);I[r]||(i2(o,s),I[r]=!0)}return ee.isArray(g)?g.forEach(C):C(g),this}};bt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ee.reduceDescriptors(bt.prototype,({value:e},g)=>{let t=g[0].toUpperCase()+g.slice(1);return{get:()=>e,set(I){this[t]=I}}});ee.freezeMethods(bt);function ed(e,g){const t=this||QC,I=g||t,o=bt.from(I.headers);let C=I.data;return ee.forEach(e,function(r){C=r.call(t,C,o.normalize(),g?g.status:void 0)}),o.normalize(),C}function py(e){return!!(e&&e.__CANCEL__)}function go(e,g,t){Ee.call(this,e??"canceled",Ee.ERR_CANCELED,g,t),this.name="CanceledError"}ee.inherits(go,Ee,{__CANCEL__:!0});function Zy(e,g,t){const I=t.config.validateStatus;!t.status||!I||I(t.status)?e(t):g(new Ee("Request failed with status code "+t.status,[Ee.ERR_BAD_REQUEST,Ee.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function s2(e){const g=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return g&&g[1]||""}function r2(e,g){e=e||10;const t=new Array(e),I=new Array(e);let o=0,C=0,s;return g=g!==void 0?g:1e3,function(c){const d=Date.now(),A=I[C];s||(s=d),t[o]=c,I[o]=d;let m=C,Z=0;for(;m!==o;)Z+=t[m++],m=m%e;if(o=(o+1)%e,o===C&&(C=(C+1)%e),d-s<g)return;const y=A&&d-A;return y?Math.round(Z*1e3/y):void 0}}function a2(e,g){let t=0,I=1e3/g,o,C;const s=(d,A=Date.now())=>{t=A,o=null,C&&(clearTimeout(C),C=null),e.apply(null,d)};return[(...d)=>{const A=Date.now(),m=A-t;m>=I?s(d,A):(o=d,C||(C=setTimeout(()=>{C=null,s(o)},I-m)))},()=>o&&s(o)]}const Ps=(e,g,t=3)=>{let I=0;const o=r2(50,250);return a2(C=>{const s=C.loaded,r=C.lengthComputable?C.total:void 0,c=s-I,d=o(c),A=s<=r;I=s;const m={loaded:s,total:r,progress:r?s/r:void 0,bytes:c,rate:d||void 0,estimated:d&&r&&A?(r-s)/d:void 0,event:C,lengthComputable:r!=null,[g?"download":"upload"]:!0};e(m)},t)},xZ=(e,g)=>{const t=e!=null;return[I=>g[0]({lengthComputable:t,total:e,loaded:I}),g[1]]},EZ=e=>(...g)=>ee.asap(()=>e(...g)),c2=gt.hasStandardBrowserEnv?((e,g)=>t=>(t=new URL(t,gt.origin),e.protocol===t.protocol&&e.host===t.host&&(g||e.port===t.port)))(new URL(gt.origin),gt.navigator&&/(msie|trident)/i.test(gt.navigator.userAgent)):()=>!0,d2=gt.hasStandardBrowserEnv?{write(e,g,t,I,o,C){const s=[e+"="+encodeURIComponent(g)];ee.isNumber(t)&&s.push("expires="+new Date(t).toGMTString()),ee.isString(I)&&s.push("path="+I),ee.isString(o)&&s.push("domain="+o),C===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){const g=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return g?decodeURIComponent(g[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function A2(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function u2(e,g){return g?e.replace(/\/?\/$/,"")+"/"+g.replace(/^\/+/,""):e}function by(e,g,t){let I=!A2(g);return e&&(I||t==!1)?u2(e,g):g}const zZ=e=>e instanceof bt?{...e}:e;function el(e,g){g=g||{};const t={};function I(d,A,m,Z){return ee.isPlainObject(d)&&ee.isPlainObject(A)?ee.merge.call({caseless:Z},d,A):ee.isPlainObject(A)?ee.merge({},A):ee.isArray(A)?A.slice():A}function o(d,A,m,Z){if(ee.isUndefined(A)){if(!ee.isUndefined(d))return I(void 0,d,m,Z)}else return I(d,A,m,Z)}function C(d,A){if(!ee.isUndefined(A))return I(void 0,A)}function s(d,A){if(ee.isUndefined(A)){if(!ee.isUndefined(d))return I(void 0,d)}else return I(void 0,A)}function r(d,A,m){if(m in g)return I(d,A);if(m in e)return I(void 0,d)}const c={url:C,method:C,data:C,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:r,headers:(d,A,m)=>o(zZ(d),zZ(A),m,!0)};return ee.forEach(Object.keys(Object.assign({},e,g)),function(A){const m=c[A]||o,Z=m(e[A],g[A],A);ee.isUndefined(Z)&&m!==r||(t[A]=Z)}),t}const Gy=e=>{const g=el({},e);let{data:t,withXSRFToken:I,xsrfHeaderName:o,xsrfCookieName:C,headers:s,auth:r}=g;g.headers=s=bt.from(s),g.url=uy(by(g.baseURL,g.url,g.allowAbsoluteUrls),e.params,e.paramsSerializer),r&&s.set("Authorization","Basic "+btoa((r.username||"")+":"+(r.password?unescape(encodeURIComponent(r.password)):"")));let c;if(ee.isFormData(t)){if(gt.hasStandardBrowserEnv||gt.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((c=s.getContentType())!==!1){const[d,...A]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];s.setContentType([d||"multipart/form-data",...A].join("; "))}}if(gt.hasStandardBrowserEnv&&(I&&ee.isFunction(I)&&(I=I(g)),I||I!==!1&&c2(g.url))){const d=o&&C&&d2.read(C);d&&s.set(o,d)}return g},m2=typeof XMLHttpRequest<"u",h2=m2&&function(e){return new Promise(function(t,I){const o=Gy(e);let C=o.data;const s=bt.from(o.headers).normalize();let{responseType:r,onUploadProgress:c,onDownloadProgress:d}=o,A,m,Z,y,G;function B(){y&&y(),G&&G(),o.cancelToken&&o.cancelToken.unsubscribe(A),o.signal&&o.signal.removeEventListener("abort",A)}let f=new XMLHttpRequest;f.open(o.method.toUpperCase(),o.url,!0),f.timeout=o.timeout;function W(){if(!f)return;const R=bt.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders()),J={data:!r||r==="text"||r==="json"?f.responseText:f.response,status:f.status,statusText:f.statusText,headers:R,config:e,request:f};Zy(function(U){t(U),B()},function(U){I(U),B()},J),f=null}"onloadend"in f?f.onloadend=W:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(W)},f.onabort=function(){f&&(I(new Ee("Request aborted",Ee.ECONNABORTED,e,f)),f=null)},f.onerror=function(){I(new Ee("Network Error",Ee.ERR_NETWORK,e,f)),f=null},f.ontimeout=function(){let k=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const J=o.transitional||my;o.timeoutErrorMessage&&(k=o.timeoutErrorMessage),I(new Ee(k,J.clarifyTimeoutError?Ee.ETIMEDOUT:Ee.ECONNABORTED,e,f)),f=null},C===void 0&&s.setContentType(null),"setRequestHeader"in f&&ee.forEach(s.toJSON(),function(k,J){f.setRequestHeader(J,k)}),ee.isUndefined(o.withCredentials)||(f.withCredentials=!!o.withCredentials),r&&r!=="json"&&(f.responseType=o.responseType),d&&([Z,G]=Ps(d,!0),f.addEventListener("progress",Z)),c&&f.upload&&([m,y]=Ps(c),f.upload.addEventListener("progress",m),f.upload.addEventListener("loadend",y)),(o.cancelToken||o.signal)&&(A=R=>{f&&(I(!R||R.type?new go(null,e,f):R),f.abort(),f=null)},o.cancelToken&&o.cancelToken.subscribe(A),o.signal&&(o.signal.aborted?A():o.signal.addEventListener("abort",A)));const v=s2(o.url);if(v&&gt.protocols.indexOf(v)===-1){I(new Ee("Unsupported protocol "+v+":",Ee.ERR_BAD_REQUEST,e));return}f.send(C||null)})},p2=(e,g)=>{const{length:t}=e=e?e.filter(Boolean):[];if(g||t){let I=new AbortController,o;const C=function(d){if(!o){o=!0,r();const A=d instanceof Error?d:this.reason;I.abort(A instanceof Ee?A:new go(A instanceof Error?A.message:A))}};let s=g&&setTimeout(()=>{s=null,C(new Ee(`timeout ${g} of ms exceeded`,Ee.ETIMEDOUT))},g);const r=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(C):d.removeEventListener("abort",C)}),e=null)};e.forEach(d=>d.addEventListener("abort",C));const{signal:c}=I;return c.unsubscribe=()=>ee.asap(r),c}},Z2=function*(e,g){let t=e.byteLength;if(t<g){yield e;return}let I=0,o;for(;I<t;)o=I+g,yield e.slice(I,o),I=o},b2=async function*(e,g){for await(const t of G2(e))yield*Z2(t,g)},G2=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const g=e.getReader();try{for(;;){const{done:t,value:I}=await g.read();if(t)break;yield I}}finally{await g.cancel()}},MZ=(e,g,t,I)=>{const o=b2(e,g);let C=0,s,r=c=>{s||(s=!0,I&&I(c))};return new ReadableStream({async pull(c){try{const{done:d,value:A}=await o.next();if(d){r(),c.close();return}let m=A.byteLength;if(t){let Z=C+=m;t(Z)}c.enqueue(new Uint8Array(A))}catch(d){throw r(d),d}},cancel(c){return r(c),o.return()}},{highWaterMark:2})},Yr=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",yy=Yr&&typeof ReadableStream=="function",y2=Yr&&(typeof TextEncoder=="function"?(e=>g=>e.encode(g))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),By=(e,...g)=>{try{return!!e(...g)}catch{return!1}},B2=yy&&By(()=>{let e=!1;const g=new Request(gt.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!g}),UZ=64*1024,xd=yy&&By(()=>ee.isReadableStream(new Response("").body)),Os={stream:xd&&(e=>e.body)};Yr&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!Os[g]&&(Os[g]=ee.isFunction(e[g])?t=>t[g]():(t,I)=>{throw new Ee(`Response type '${g}' is not supported`,Ee.ERR_NOT_SUPPORT,I)})})})(new Response);const f2=async e=>{if(e==null)return 0;if(ee.isBlob(e))return e.size;if(ee.isSpecCompliantForm(e))return(await new Request(gt.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ee.isArrayBufferView(e)||ee.isArrayBuffer(e))return e.byteLength;if(ee.isURLSearchParams(e)&&(e=e+""),ee.isString(e))return(await y2(e)).byteLength},S2=async(e,g)=>{const t=ee.toFiniteNumber(e.getContentLength());return t??f2(g)},V2=Yr&&(async e=>{let{url:g,method:t,data:I,signal:o,cancelToken:C,timeout:s,onDownloadProgress:r,onUploadProgress:c,responseType:d,headers:A,withCredentials:m="same-origin",fetchOptions:Z}=Gy(e);d=d?(d+"").toLowerCase():"text";let y=p2([o,C&&C.toAbortSignal()],s),G;const B=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let f;try{if(c&&B2&&t!=="get"&&t!=="head"&&(f=await S2(A,I))!==0){let J=new Request(g,{method:"POST",body:I,duplex:"half"}),F;if(ee.isFormData(I)&&(F=J.headers.get("content-type"))&&A.setContentType(F),J.body){const[U,X]=xZ(f,Ps(EZ(c)));I=MZ(J.body,UZ,U,X)}}ee.isString(m)||(m=m?"include":"omit");const W="credentials"in Request.prototype;G=new Request(g,{...Z,signal:y,method:t.toUpperCase(),headers:A.normalize().toJSON(),body:I,duplex:"half",credentials:W?m:void 0});let v=await fetch(G,Z);const R=xd&&(d==="stream"||d==="response");if(xd&&(r||R&&B)){const J={};["status","statusText","headers"].forEach(K=>{J[K]=v[K]});const F=ee.toFiniteNumber(v.headers.get("content-length")),[U,X]=r&&xZ(F,Ps(EZ(r),!0))||[];v=new Response(MZ(v.body,UZ,U,()=>{X&&X(),B&&B()}),J)}d=d||"text";let k=await Os[ee.findKey(Os,d)||"text"](v,e);return!R&&B&&B(),await new Promise((J,F)=>{Zy(J,F,{data:k,headers:bt.from(v.headers),status:v.status,statusText:v.statusText,config:e,request:G})})}catch(W){throw B&&B(),W&&W.name==="TypeError"&&/Load failed|fetch/i.test(W.message)?Object.assign(new Ee("Network Error",Ee.ERR_NETWORK,e,G),{cause:W.cause||W}):Ee.from(W,W&&W.code,e,G)}}),Ed={http:zv,xhr:h2,fetch:V2};ee.forEach(Ed,(e,g)=>{if(e){try{Object.defineProperty(e,"name",{value:g})}catch{}Object.defineProperty(e,"adapterName",{value:g})}});const LZ=e=>`- ${e}`,W2=e=>ee.isFunction(e)||e===null||e===!1,fy={getAdapter:e=>{e=ee.isArray(e)?e:[e];const{length:g}=e;let t,I;const o={};for(let C=0;C<g;C++){t=e[C];let s;if(I=t,!W2(t)&&(I=Ed[(s=String(t)).toLowerCase()],I===void 0))throw new Ee(`Unknown adapter '${s}'`);if(I)break;o[s||"#"+C]=I}if(!I){const C=Object.entries(o).map(([r,c])=>`adapter ${r} `+(c===!1?"is not supported by the environment":"is not available in the build"));let s=g?C.length>1?`since :
`+C.map(LZ).join(`
`):" "+LZ(C[0]):"as no adapter specified";throw new Ee("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return I},adapters:Ed};function gd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new go(null,e)}function TZ(e){return gd(e),e.headers=bt.from(e.headers),e.data=ed.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),fy.getAdapter(e.adapter||QC.adapter)(e).then(function(I){return gd(e),I.data=ed.call(e,e.transformResponse,I),I.headers=bt.from(I.headers),I},function(I){return py(I)||(gd(e),I&&I.response&&(I.response.data=ed.call(e,e.transformResponse,I.response),I.response.headers=bt.from(I.response.headers))),Promise.reject(I)})}const Sy="1.10.0",Hr={};["object","boolean","number","function","string","symbol"].forEach((e,g)=>{Hr[e]=function(I){return typeof I===e||"a"+(g<1?"n ":" ")+e}});const QZ={};Hr.transitional=function(g,t,I){function o(C,s){return"[Axios v"+Sy+"] Transitional option '"+C+"'"+s+(I?". "+I:"")}return(C,s,r)=>{if(g===!1)throw new Ee(o(s," has been removed"+(t?" in "+t:"")),Ee.ERR_DEPRECATED);return t&&!QZ[s]&&(QZ[s]=!0,console.warn(o(s," has been deprecated since v"+t+" and will be removed in the near future"))),g?g(C,s,r):!0}};Hr.spelling=function(g){return(t,I)=>(console.warn(`${I} is likely a misspelling of ${g}`),!0)};function R2(e,g,t){if(typeof e!="object")throw new Ee("options must be an object",Ee.ERR_BAD_OPTION_VALUE);const I=Object.keys(e);let o=I.length;for(;o-- >0;){const C=I[o],s=g[C];if(s){const r=e[C],c=r===void 0||s(r,C,e);if(c!==!0)throw new Ee("option "+C+" must be "+c,Ee.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Ee("Unknown option "+C,Ee.ERR_BAD_OPTION)}}const Hs={assertOptions:R2,validators:Hr},un=Hs.validators;let OI=class{constructor(g){this.defaults=g||{},this.interceptors={request:new KZ,response:new KZ}}async request(g,t){try{return await this._request(g,t)}catch(I){if(I instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const C=o.stack?o.stack.replace(/^.+\n/,""):"";try{I.stack?C&&!String(I.stack).endsWith(C.replace(/^.+\n.+\n/,""))&&(I.stack+=`
`+C):I.stack=C}catch{}}throw I}}_request(g,t){typeof g=="string"?(t=t||{},t.url=g):t=g||{},t=el(this.defaults,t);const{transitional:I,paramsSerializer:o,headers:C}=t;I!==void 0&&Hs.assertOptions(I,{silentJSONParsing:un.transitional(un.boolean),forcedJSONParsing:un.transitional(un.boolean),clarifyTimeoutError:un.transitional(un.boolean)},!1),o!=null&&(ee.isFunction(o)?t.paramsSerializer={serialize:o}:Hs.assertOptions(o,{encode:un.function,serialize:un.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Hs.assertOptions(t,{baseUrl:un.spelling("baseURL"),withXsrfToken:un.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=C&&ee.merge(C.common,C[t.method]);C&&ee.forEach(["delete","get","head","post","put","patch","common"],G=>{delete C[G]}),t.headers=bt.concat(s,C);const r=[];let c=!0;this.interceptors.request.forEach(function(B){typeof B.runWhen=="function"&&B.runWhen(t)===!1||(c=c&&B.synchronous,r.unshift(B.fulfilled,B.rejected))});const d=[];this.interceptors.response.forEach(function(B){d.push(B.fulfilled,B.rejected)});let A,m=0,Z;if(!c){const G=[TZ.bind(this),void 0];for(G.unshift.apply(G,r),G.push.apply(G,d),Z=G.length,A=Promise.resolve(t);m<Z;)A=A.then(G[m++],G[m++]);return A}Z=r.length;let y=t;for(m=0;m<Z;){const G=r[m++],B=r[m++];try{y=G(y)}catch(f){B.call(this,f);break}}try{A=TZ.call(this,y)}catch(G){return Promise.reject(G)}for(m=0,Z=d.length;m<Z;)A=A.then(d[m++],d[m++]);return A}getUri(g){g=el(this.defaults,g);const t=by(g.baseURL,g.url,g.allowAbsoluteUrls);return uy(t,g.params,g.paramsSerializer)}};ee.forEach(["delete","get","head","options"],function(g){OI.prototype[g]=function(t,I){return this.request(el(I||{},{method:g,url:t,data:(I||{}).data}))}});ee.forEach(["post","put","patch"],function(g){function t(I){return function(C,s,r){return this.request(el(r||{},{method:g,headers:I?{"Content-Type":"multipart/form-data"}:{},url:C,data:s}))}}OI.prototype[g]=t(),OI.prototype[g+"Form"]=t(!0)});let X2=class Vy{constructor(g){if(typeof g!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(C){t=C});const I=this;this.promise.then(o=>{if(!I._listeners)return;let C=I._listeners.length;for(;C-- >0;)I._listeners[C](o);I._listeners=null}),this.promise.then=o=>{let C;const s=new Promise(r=>{I.subscribe(r),C=r}).then(o);return s.cancel=function(){I.unsubscribe(C)},s},g(function(C,s,r){I.reason||(I.reason=new go(C,s,r),t(I.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(g){if(this.reason){g(this.reason);return}this._listeners?this._listeners.push(g):this._listeners=[g]}unsubscribe(g){if(!this._listeners)return;const t=this._listeners.indexOf(g);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const g=new AbortController,t=I=>{g.abort(I)};return this.subscribe(t),g.signal.unsubscribe=()=>this.unsubscribe(t),g.signal}static source(){let g;return{token:new Vy(function(o){g=o}),cancel:g}}};function k2(e){return function(t){return e.apply(null,t)}}function J2(e){return ee.isObject(e)&&e.isAxiosError===!0}const zd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(zd).forEach(([e,g])=>{zd[g]=e});function Wy(e){const g=new OI(e),t=ny(OI.prototype.request,g);return ee.extend(t,OI.prototype,g,{allOwnKeys:!0}),ee.extend(t,g,null,{allOwnKeys:!0}),t.create=function(o){return Wy(el(e,o))},t}const We=Wy(QC);We.Axios=OI;We.CanceledError=go;We.CancelToken=X2;We.isCancel=py;We.VERSION=Sy;We.toFormData=vr;We.AxiosError=Ee;We.Cancel=We.CanceledError;We.all=function(g){return Promise.all(g)};We.spread=k2;We.isAxiosError=J2;We.mergeConfig=el;We.AxiosHeaders=bt;We.formToJSON=e=>hy(ee.isHTMLForm(e)?new FormData(e):e);We.getAdapter=fy.getAdapter;We.HttpStatusCode=zd;We.default=We;const{Axios:M3,AxiosError:U3,CanceledError:L3,isCancel:T3,CancelToken:Q3,VERSION:D3,all:j3,Cancel:P3,isAxiosError:O3,spread:q3,toFormData:_3,AxiosHeaders:$3,HttpStatusCode:eE,formToJSON:gE,getAdapter:tE,mergeConfig:nE}=We,v2=()=>{const[e,g]=b.useState(0),t=1e3;let I=Math.min(e/t*100,100);const o={display:"box",width:"100%",height:"20px",borderRadius:"20px",borderWidth:"2px",borderStyle:"solid",borderColor:"white",boxShadow:"0 0 5px orange",overflow:"hidden"},C={width:`${I}%`,height:"100%",backgroundColor:"#ff2400",transition:"width 0.3s ease"};return p.jsx("div",{style:Y2,children:p.jsxs("div",{style:{margin:"1em"},children:[p.jsxs("h3",{style:DZ,children:[p.jsx(gv,{})," Goal to Scholarship Giveaway!"]}),p.jsx("div",{id:"bar",style:o,children:p.jsx("div",{style:C})}),p.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:p.jsxs("h5",{style:{...DZ},children:[" ",e," / ",t," points earned"]})})]})})},Y2={backgroundColor:"white",border:"1px solid rgba(255, 4, 4, 0.3)",borderRadius:"16px",padding:"5px",width:"100%",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},DZ={margin:0,color:"#FF5F00"};function jZ(e){try{return e.matches(":focus-visible")}catch{}return!1}const PZ={};function Ry(e,g){const t=b.useRef(PZ);return t.current===PZ&&(t.current=e(g)),t}class qs{static create(){return new qs}static use(){const g=Ry(qs.create).current,[t,I]=b.useState(!1);return g.shouldMount=t,g.setShouldMount=I,b.useEffect(g.mountEffect,[t]),g}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=w2(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...g){this.mount().then(()=>this.ref.current?.start(...g))}stop(...g){this.mount().then(()=>this.ref.current?.stop(...g))}pulsate(...g){this.mount().then(()=>this.ref.current?.pulsate(...g))}}function H2(){return qs.use()}function w2(){let e,g;const t=new Promise((I,o)=>{e=I,g=o});return t.resolve=e,t.reject=g,t}function PA(e,g){if(e==null)return{};var t={};for(var I in e)if({}.hasOwnProperty.call(e,I)){if(g.indexOf(I)!==-1)continue;t[I]=e[I]}return t}function Md(e,g){return Md=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,I){return t.__proto__=I,t},Md(e,g)}function Xy(e,g){e.prototype=Object.create(g.prototype),e.prototype.constructor=e,Md(e,g)}const OZ={disabled:!1},_s=tn.createContext(null);var F2=function(g){return g.scrollTop},CC="unmounted",zI="exited",MI="entering",Fl="entered",Ud="exiting",Wn=function(e){Xy(g,e);function g(I,o){var C;C=e.call(this,I,o)||this;var s=o,r=s&&!s.isMounting?I.enter:I.appear,c;return C.appearStatus=null,I.in?r?(c=zI,C.appearStatus=MI):c=Fl:I.unmountOnExit||I.mountOnEnter?c=CC:c=zI,C.state={status:c},C.nextCallback=null,C}g.getDerivedStateFromProps=function(o,C){var s=o.in;return s&&C.status===CC?{status:zI}:null};var t=g.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(o){var C=null;if(o!==this.props){var s=this.state.status;this.props.in?s!==MI&&s!==Fl&&(C=MI):(s===MI||s===Fl)&&(C=Ud)}this.updateStatus(!1,C)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var o=this.props.timeout,C,s,r;return C=s=r=o,o!=null&&typeof o!="number"&&(C=o.exit,s=o.enter,r=o.appear!==void 0?o.appear:s),{exit:C,enter:s,appear:r}},t.updateStatus=function(o,C){if(o===void 0&&(o=!1),C!==null)if(this.cancelNextCallback(),C===MI){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:ss.findDOMNode(this);s&&F2(s)}this.performEnter(o)}else this.performExit();else this.props.unmountOnExit&&this.state.status===zI&&this.setState({status:CC})},t.performEnter=function(o){var C=this,s=this.props.enter,r=this.context?this.context.isMounting:o,c=this.props.nodeRef?[r]:[ss.findDOMNode(this),r],d=c[0],A=c[1],m=this.getTimeouts(),Z=r?m.appear:m.enter;if(!o&&!s||OZ.disabled){this.safeSetState({status:Fl},function(){C.props.onEntered(d)});return}this.props.onEnter(d,A),this.safeSetState({status:MI},function(){C.props.onEntering(d,A),C.onTransitionEnd(Z,function(){C.safeSetState({status:Fl},function(){C.props.onEntered(d,A)})})})},t.performExit=function(){var o=this,C=this.props.exit,s=this.getTimeouts(),r=this.props.nodeRef?void 0:ss.findDOMNode(this);if(!C||OZ.disabled){this.safeSetState({status:zI},function(){o.props.onExited(r)});return}this.props.onExit(r),this.safeSetState({status:Ud},function(){o.props.onExiting(r),o.onTransitionEnd(s.exit,function(){o.safeSetState({status:zI},function(){o.props.onExited(r)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(o,C){C=this.setNextCallback(C),this.setState(o,C)},t.setNextCallback=function(o){var C=this,s=!0;return this.nextCallback=function(r){s&&(s=!1,C.nextCallback=null,o(r))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},t.onTransitionEnd=function(o,C){this.setNextCallback(C);var s=this.props.nodeRef?this.props.nodeRef.current:ss.findDOMNode(this),r=o==null&&!this.props.addEndListener;if(!s||r){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],d=c[0],A=c[1];this.props.addEndListener(d,A)}o!=null&&setTimeout(this.nextCallback,o)},t.render=function(){var o=this.state.status;if(o===CC)return null;var C=this.props,s=C.children;C.in,C.mountOnEnter,C.unmountOnExit,C.appear,C.enter,C.exit,C.timeout,C.addEndListener,C.onEnter,C.onEntering,C.onEntered,C.onExit,C.onExiting,C.onExited,C.nodeRef;var r=PA(C,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return tn.createElement(_s.Provider,{value:null},typeof s=="function"?s(o,r):tn.cloneElement(tn.Children.only(s),r))},g}(tn.Component);Wn.contextType=_s;Wn.propTypes={};function Hl(){}Wn.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Hl,onEntering:Hl,onEntered:Hl,onExit:Hl,onExiting:Hl,onExited:Hl};Wn.UNMOUNTED=CC;Wn.EXITED=zI;Wn.ENTERING=MI;Wn.ENTERED=Fl;Wn.EXITING=Ud;function K2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OA(e,g){var t=function(C){return g&&b.isValidElement(C)?g(C):C},I=Object.create(null);return e&&b.Children.map(e,function(o){return o}).forEach(function(o){I[o.key]=t(o)}),I}function N2(e,g){e=e||{},g=g||{};function t(A){return A in g?g[A]:e[A]}var I=Object.create(null),o=[];for(var C in e)C in g?o.length&&(I[C]=o,o=[]):o.push(C);var s,r={};for(var c in g){if(I[c])for(s=0;s<I[c].length;s++){var d=I[c][s];r[I[c][s]]=t(d)}r[c]=t(c)}for(s=0;s<o.length;s++)r[o[s]]=t(o[s]);return r}function QI(e,g,t){return t[g]!=null?t[g]:e.props[g]}function x2(e,g){return OA(e.children,function(t){return b.cloneElement(t,{onExited:g.bind(null,t),in:!0,appear:QI(t,"appear",e),enter:QI(t,"enter",e),exit:QI(t,"exit",e)})})}function E2(e,g,t){var I=OA(e.children),o=N2(g,I);return Object.keys(o).forEach(function(C){var s=o[C];if(b.isValidElement(s)){var r=C in g,c=C in I,d=g[C],A=b.isValidElement(d)&&!d.props.in;c&&(!r||A)?o[C]=b.cloneElement(s,{onExited:t.bind(null,s),in:!0,exit:QI(s,"exit",e),enter:QI(s,"enter",e)}):!c&&r&&!A?o[C]=b.cloneElement(s,{in:!1}):c&&r&&b.isValidElement(d)&&(o[C]=b.cloneElement(s,{onExited:t.bind(null,s),in:d.props.in,exit:QI(s,"exit",e),enter:QI(s,"enter",e)}))}}),o}var z2=Object.values||function(e){return Object.keys(e).map(function(g){return e[g]})},M2={component:"div",childFactory:function(g){return g}},qA=function(e){Xy(g,e);function g(I,o){var C;C=e.call(this,I,o)||this;var s=C.handleExited.bind(K2(C));return C.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},C}var t=g.prototype;return t.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},t.componentWillUnmount=function(){this.mounted=!1},g.getDerivedStateFromProps=function(o,C){var s=C.children,r=C.handleExited,c=C.firstRender;return{children:c?x2(o,r):E2(o,s,r),firstRender:!1}},t.handleExited=function(o,C){var s=OA(this.props.children);o.key in s||(o.props.onExited&&o.props.onExited(C),this.mounted&&this.setState(function(r){var c=bC({},r.children);return delete c[o.key],{children:c}}))},t.render=function(){var o=this.props,C=o.component,s=o.childFactory,r=PA(o,["component","childFactory"]),c=this.state.contextValue,d=z2(this.state.children).map(s);return delete r.appear,delete r.enter,delete r.exit,C===null?tn.createElement(_s.Provider,{value:c},d):tn.createElement(_s.Provider,{value:c},tn.createElement(C,r,d))},g}(tn.Component);qA.propTypes={};qA.defaultProps=M2;const U2=[];function L2(e){b.useEffect(e,U2)}class _A{static create(){return new _A}currentId=null;start(g,t){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,t()},g)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function ky(){const e=Ry(_A.create).current;return L2(e.disposeEffect),e}function T2(e){const{className:g,classes:t,pulsate:I=!1,rippleX:o,rippleY:C,rippleSize:s,in:r,onExited:c,timeout:d}=e,[A,m]=b.useState(!1),Z=Ne(g,t.ripple,t.rippleVisible,I&&t.ripplePulsate),y={width:s,height:s,top:-(s/2)+C,left:-(s/2)+o},G=Ne(t.child,A&&t.childLeaving,I&&t.childPulsate);return!r&&!A&&m(!0),b.useEffect(()=>{if(!r&&c!=null){const B=setTimeout(c,d);return()=>{clearTimeout(B)}}},[c,r,d]),p.jsx("span",{className:Z,style:y,children:p.jsx("span",{className:G})})}const Et=$e("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Ld=550,Q2=80,D2=UC`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,j2=UC`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,P2=UC`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,O2=Xe("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),q2=Xe(T2,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Et.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${D2};
    animation-duration: ${Ld}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${Et.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${Et.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Et.childLeaving} {
    opacity: 0;
    animation-name: ${j2};
    animation-duration: ${Ld}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${Et.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${P2};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,_2=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiTouchRipple"}),{center:o=!1,classes:C={},className:s,...r}=I,[c,d]=b.useState([]),A=b.useRef(0),m=b.useRef(null);b.useEffect(()=>{m.current&&(m.current(),m.current=null)},[c]);const Z=b.useRef(!1),y=ky(),G=b.useRef(null),B=b.useRef(null),f=b.useCallback(k=>{const{pulsate:J,rippleX:F,rippleY:U,rippleSize:X,cb:K}=k;d(w=>[...w,p.jsx(q2,{classes:{ripple:Ne(C.ripple,Et.ripple),rippleVisible:Ne(C.rippleVisible,Et.rippleVisible),ripplePulsate:Ne(C.ripplePulsate,Et.ripplePulsate),child:Ne(C.child,Et.child),childLeaving:Ne(C.childLeaving,Et.childLeaving),childPulsate:Ne(C.childPulsate,Et.childPulsate)},timeout:Ld,pulsate:J,rippleX:F,rippleY:U,rippleSize:X},A.current)]),A.current+=1,m.current=K},[C]),W=b.useCallback((k={},J={},F=()=>{})=>{const{pulsate:U=!1,center:X=o||J.pulsate,fakeElement:K=!1}=J;if(k?.type==="mousedown"&&Z.current){Z.current=!1;return}k?.type==="touchstart"&&(Z.current=!0);const w=K?null:B.current,D=w?w.getBoundingClientRect():{width:0,height:0,left:0,top:0};let V,z,N;if(X||k===void 0||k.clientX===0&&k.clientY===0||!k.clientX&&!k.touches)V=Math.round(D.width/2),z=Math.round(D.height/2);else{const{clientX:L,clientY:Q}=k.touches&&k.touches.length>0?k.touches[0]:k;V=Math.round(L-D.left),z=Math.round(Q-D.top)}if(X)N=Math.sqrt((2*D.width**2+D.height**2)/3),N%2===0&&(N+=1);else{const L=Math.max(Math.abs((w?w.clientWidth:0)-V),V)*2+2,Q=Math.max(Math.abs((w?w.clientHeight:0)-z),z)*2+2;N=Math.sqrt(L**2+Q**2)}k?.touches?G.current===null&&(G.current=()=>{f({pulsate:U,rippleX:V,rippleY:z,rippleSize:N,cb:F})},y.start(Q2,()=>{G.current&&(G.current(),G.current=null)})):f({pulsate:U,rippleX:V,rippleY:z,rippleSize:N,cb:F})},[o,f,y]),v=b.useCallback(()=>{W({},{pulsate:!0})},[W]),R=b.useCallback((k,J)=>{if(y.clear(),k?.type==="touchend"&&G.current){G.current(),G.current=null,y.start(0,()=>{R(k,J)});return}G.current=null,d(F=>F.length>0?F.slice(1):F),m.current=J},[y]);return b.useImperativeHandle(t,()=>({pulsate:v,start:W,stop:R}),[v,W,R]),p.jsx(O2,{className:Ne(Et.root,C.root,s),ref:B,...r,children:p.jsx(qA,{component:null,exit:!0,children:c})})});function $2(e){return Cg("MuiButtonBase",e)}const eY=$e("MuiButtonBase",["root","disabled","focusVisible"]),gY=e=>{const{disabled:g,focusVisible:t,focusVisibleClassName:I,classes:o}=e,s=og({root:["root",g&&"disabled",t&&"focusVisible"]},$2,o);return t&&I&&(s.root+=` ${I}`),s},tY=Xe("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${eY.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Jy=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiButtonBase"}),{action:o,centerRipple:C=!1,children:s,className:r,component:c="button",disabled:d=!1,disableRipple:A=!1,disableTouchRipple:m=!1,focusRipple:Z=!1,focusVisibleClassName:y,LinkComponent:G="a",onBlur:B,onClick:f,onContextMenu:W,onDragLeave:v,onFocus:R,onFocusVisible:k,onKeyDown:J,onKeyUp:F,onMouseDown:U,onMouseLeave:X,onMouseUp:K,onTouchEnd:w,onTouchMove:D,onTouchStart:V,tabIndex:z=0,TouchRippleProps:N,touchRippleRef:L,type:Q,...q}=I,j=b.useRef(null),P=H2(),$=it(P.ref,L),[H,M]=b.useState(!1);d&&H&&M(!1),b.useImperativeHandle(o,()=>({focusVisible:()=>{M(!0),j.current.focus()}}),[]);const te=P.shouldMount&&!A&&!d;b.useEffect(()=>{H&&Z&&!A&&P.pulsate()},[A,Z,H,P]);const oe=Kn(P,"start",U,m),ne=Kn(P,"stop",W,m),ae=Kn(P,"stop",v,m),re=Kn(P,"stop",K,m),Ge=Kn(P,"stop",Ie=>{H&&Ie.preventDefault(),X&&X(Ie)},m),ue=Kn(P,"start",V,m),Ae=Kn(P,"stop",w,m),ce=Kn(P,"stop",D,m),me=Kn(P,"stop",Ie=>{jZ(Ie.target)||M(!1),B&&B(Ie)},!1),Ke=PI(Ie=>{j.current||(j.current=Ie.currentTarget),jZ(Ie.target)&&(M(!0),k&&k(Ie)),R&&R(Ie)}),Ye=()=>{const Ie=j.current;return c&&c!=="button"&&!(Ie.tagName==="A"&&Ie.href)},xe=PI(Ie=>{Z&&!Ie.repeat&&H&&Ie.key===" "&&P.stop(Ie,()=>{P.start(Ie)}),Ie.target===Ie.currentTarget&&Ye()&&Ie.key===" "&&Ie.preventDefault(),J&&J(Ie),Ie.target===Ie.currentTarget&&Ye()&&Ie.key==="Enter"&&!d&&(Ie.preventDefault(),f&&f(Ie))}),Qe=PI(Ie=>{Z&&Ie.key===" "&&H&&!Ie.defaultPrevented&&P.stop(Ie,()=>{P.pulsate(Ie)}),F&&F(Ie),f&&Ie.target===Ie.currentTarget&&Ye()&&Ie.key===" "&&!Ie.defaultPrevented&&f(Ie)});let ye=c;ye==="button"&&(q.href||q.to)&&(ye=G);const he={};ye==="button"?(he.type=Q===void 0?"button":Q,he.disabled=d):(!q.href&&!q.to&&(he.role="button"),d&&(he["aria-disabled"]=d));const be=it(t,j),se={...I,centerRipple:C,component:c,disabled:d,disableRipple:A,disableTouchRipple:m,focusRipple:Z,tabIndex:z,focusVisible:H},pe=gY(se);return p.jsxs(tY,{as:ye,className:Ne(pe.root,r),ownerState:se,onBlur:me,onClick:f,onContextMenu:ne,onFocus:Ke,onKeyDown:xe,onKeyUp:Qe,onMouseDown:oe,onMouseLeave:Ge,onMouseUp:re,onDragLeave:ae,onTouchEnd:Ae,onTouchMove:ce,onTouchStart:ue,ref:be,tabIndex:d?-1:z,type:Q,...he,...q,children:[s,te?p.jsx(_2,{ref:$,center:C,...N}):null]})});function Kn(e,g,t,I=!1){return PI(o=>(t&&t(o),I||e[g](o),!0))}function nY(e){return typeof e.main=="string"}function IY(e,g=[]){if(!nY(e))return!1;for(const t of g)if(!e.hasOwnProperty(t)||typeof e[t]!="string")return!1;return!0}function tl(e=[]){return([,g])=>g&&IY(g,e)}function lY(e){return Cg("MuiCircularProgress",e)}$e("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const dI=44,Td=UC`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,Qd=UC`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,oY=typeof Td!="string"?zA`
        animation: ${Td} 1.4s linear infinite;
      `:null,CY=typeof Qd!="string"?zA`
        animation: ${Qd} 1.4s ease-in-out infinite;
      `:null,iY=e=>{const{classes:g,variant:t,color:I,disableShrink:o}=e,C={root:["root",t,`color${ze(I)}`],svg:["svg"],circle:["circle",`circle${ze(t)}`,o&&"circleDisableShrink"]};return og(C,lY,g)},sY=Xe("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,g[t.variant],g[`color${ze(t.color)}`]]}})(vg(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:oY||{animation:`${Td} 1.4s linear infinite`}},...Object.entries(e.palette).filter(tl()).map(([g])=>({props:{color:g},style:{color:(e.vars||e).palette[g].main}}))]}))),rY=Xe("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),aY=Xe("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.circle,g[`circle${ze(t.variant)}`],t.disableShrink&&g.circleDisableShrink]}})(vg(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:g})=>g.variant==="indeterminate"&&!g.disableShrink,style:CY||{animation:`${Qd} 1.4s ease-in-out infinite`}}]}))),cY=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiCircularProgress"}),{className:o,color:C="primary",disableShrink:s=!1,size:r=40,style:c,thickness:d=3.6,value:A=0,variant:m="indeterminate",...Z}=I,y={...I,color:C,disableShrink:s,size:r,thickness:d,value:A,variant:m},G=iY(y),B={},f={},W={};if(m==="determinate"){const v=2*Math.PI*((dI-d)/2);B.strokeDasharray=v.toFixed(3),W["aria-valuenow"]=Math.round(A),B.strokeDashoffset=`${((100-A)/100*v).toFixed(3)}px`,f.transform="rotate(-90deg)"}return p.jsx(sY,{className:Ne(G.root,o),style:{width:r,height:r,...f,...c},ownerState:y,ref:t,role:"progressbar",...W,...Z,children:p.jsx(rY,{className:G.svg,ownerState:y,viewBox:`${dI/2} ${dI/2} ${dI} ${dI}`,children:p.jsx(aY,{className:G.circle,style:B,ownerState:y,cx:dI,cy:dI,r:(dI-d)/2,fill:"none",strokeWidth:d})})})});function dY(e){return Cg("MuiButton",e)}const KI=$e("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),AY=b.createContext({}),uY=b.createContext(void 0),mY=e=>{const{color:g,disableElevation:t,fullWidth:I,size:o,variant:C,loading:s,loadingPosition:r,classes:c}=e,d={root:["root",s&&"loading",C,`${C}${ze(g)}`,`size${ze(o)}`,`${C}Size${ze(o)}`,`color${ze(g)}`,t&&"disableElevation",I&&"fullWidth",s&&`loadingPosition${ze(r)}`],startIcon:["icon","startIcon",`iconSize${ze(o)}`],endIcon:["icon","endIcon",`iconSize${ze(o)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},A=og(d,dY,c);return{...c,...A}},vy=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],hY=Xe(Jy,{shouldForwardProp:e=>Tt(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,g[t.variant],g[`${t.variant}${ze(t.color)}`],g[`size${ze(t.size)}`],g[`${t.variant}Size${ze(t.size)}`],t.color==="inherit"&&g.colorInherit,t.disableElevation&&g.disableElevation,t.fullWidth&&g.fullWidth,t.loading&&g.loading]}})(vg(({theme:e})=>{const g=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],t=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${KI.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${KI.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${KI.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${KI.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(tl()).map(([I])=>({props:{color:I},style:{"--variant-textColor":(e.vars||e).palette[I].main,"--variant-outlinedColor":(e.vars||e).palette[I].main,"--variant-outlinedBorder":e.alpha((e.vars||e).palette[I].main,.5),"--variant-containedColor":(e.vars||e).palette[I].contrastText,"--variant-containedBg":(e.vars||e).palette[I].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[I].dark,"--variant-textBg":e.alpha((e.vars||e).palette[I].main,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[I].main,"--variant-outlinedBg":e.alpha((e.vars||e).palette[I].main,(e.vars||e).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:g,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:t,"--variant-textBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${KI.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${KI.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${KI.loading}`]:{color:"transparent"}}}]}})),pY=Xe("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.startIcon,t.loading&&g.startIconLoadingStart,g[`iconSize${ze(t.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...vy]})),ZY=Xe("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.endIcon,t.loading&&g.endIconLoadingEnd,g[`iconSize${ze(t.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...vy]})),bY=Xe("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),qZ=Xe("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),_e=b.forwardRef(function(g,t){const I=b.useContext(AY),o=b.useContext(uY),C=fC(I,g),s=sg({props:C,name:"MuiButton"}),{children:r,color:c="primary",component:d="button",className:A,disabled:m=!1,disableElevation:Z=!1,disableFocusRipple:y=!1,endIcon:G,focusVisibleClassName:B,fullWidth:f=!1,id:W,loading:v=null,loadingIndicator:R,loadingPosition:k="center",size:J="medium",startIcon:F,type:U,variant:X="text",...K}=s,w=UA(W),D=R??p.jsx(cY,{"aria-labelledby":w,color:"inherit",size:16}),V={...s,color:c,component:d,disabled:m,disableElevation:Z,disableFocusRipple:y,fullWidth:f,loading:v,loadingIndicator:D,loadingPosition:k,size:J,type:U,variant:X},z=mY(V),N=(F||v&&k==="start")&&p.jsx(pY,{className:z.startIcon,ownerState:V,children:F||p.jsx(qZ,{className:z.loadingIconPlaceholder,ownerState:V})}),L=(G||v&&k==="end")&&p.jsx(ZY,{className:z.endIcon,ownerState:V,children:G||p.jsx(qZ,{className:z.loadingIconPlaceholder,ownerState:V})}),Q=o||"",q=typeof v=="boolean"?p.jsx("span",{className:z.loadingWrapper,style:{display:"contents"},children:v&&p.jsx(bY,{className:z.loadingIndicator,ownerState:V,children:D})}):null;return p.jsxs(hY,{ownerState:V,className:Ne(I.className,z.root,A,Q),component:d,disabled:m||v,focusRipple:!y,focusVisibleClassName:Ne(z.focusVisible,B),ref:t,type:U,id:v?w:W,...K,classes:z,children:[N,k!=="end"&&q,r,k==="end"&&q,L]})}),Yy=In(p.jsx("path",{d:"M2 15.5v2h20v-2zm0-5v2h20v-2zm0-5v2h20v-2z"}));function GY(e){return typeof e=="string"}function Hy(e,g,t){return e===void 0||GY(e)?g:{...g,ownerState:{...g.ownerState,...t}}}function wy(e,g=[]){if(e===void 0)return{};const t={};return Object.keys(e).filter(I=>I.match(/^on[A-Z]/)&&typeof e[I]=="function"&&!g.includes(I)).forEach(I=>{t[I]=e[I]}),t}function _Z(e){if(e===void 0)return{};const g={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&typeof e[t]=="function")).forEach(t=>{g[t]=e[t]}),g}function Fy(e){const{getSlotProps:g,additionalProps:t,externalSlotProps:I,externalForwardedProps:o,className:C}=e;if(!g){const y=Ne(t?.className,C,o?.className,I?.className),G={...t?.style,...o?.style,...I?.style},B={...t,...o,...I};return y.length>0&&(B.className=y),Object.keys(G).length>0&&(B.style=G),{props:B,internalRef:void 0}}const s=wy({...o,...I}),r=_Z(I),c=_Z(o),d=g(s),A=Ne(d?.className,t?.className,C,o?.className,I?.className),m={...d?.style,...t?.style,...o?.style,...I?.style},Z={...d,...t,...c,...r};return A.length>0&&(Z.className=A),Object.keys(m).length>0&&(Z.style=m),{props:Z,internalRef:d.ref}}function Ky(e,g,t){return typeof e=="function"?e(g,t):e}function yY(e){const{elementType:g,externalSlotProps:t,ownerState:I,skipResolvingSlotProps:o=!1,...C}=e,s=o?{}:Ky(t,I),{props:r,internalRef:c}=Fy({...C,externalSlotProps:s}),d=it(c,s?.ref,e.additionalProps?.ref);return Hy(g,{...r,ref:d},I)}const Dd=b.createContext({});function BY(e){return Cg("MuiList",e)}$e("MuiList",["root","padding","dense","subheader"]);const fY=e=>{const{classes:g,disablePadding:t,dense:I,subheader:o}=e;return og({root:["root",!t&&"padding",I&&"dense",o&&"subheader"]},BY,g)},SY=Xe("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,!t.disablePadding&&g.padding,t.dense&&g.dense,t.subheader&&g.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>e.subheader,style:{paddingTop:0}}]}),VY=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiList"}),{children:o,className:C,component:s="ul",dense:r=!1,disablePadding:c=!1,subheader:d,...A}=I,m=b.useMemo(()=>({dense:r}),[r]),Z={...I,component:s,dense:r,disablePadding:c},y=fY(Z);return p.jsx(Dd.Provider,{value:m,children:p.jsxs(SY,{as:s,className:Ne(y.root,C),ref:t,ownerState:Z,...A,children:[d,o]})})});function Ny(e=window){const g=e.document.documentElement.clientWidth;return e.innerWidth-g}function td(e,g,t){return e===g?e.firstChild:g&&g.nextElementSibling?g.nextElementSibling:t?null:e.firstChild}function $Z(e,g,t){return e===g?t?e.firstChild:e.lastChild:g&&g.previousElementSibling?g.previousElementSibling:t?null:e.lastChild}function xy(e,g){if(g===void 0)return!0;let t=e.innerText;return t===void 0&&(t=e.textContent),t=t.trim().toLowerCase(),t.length===0?!1:g.repeating?t[0]===g.keys[0]:t.startsWith(g.keys.join(""))}function qo(e,g,t,I,o,C){let s=!1,r=o(e,g,g?t:!1);for(;r;){if(r===e.firstChild){if(s)return!1;s=!0}const c=I?!1:r.disabled||r.getAttribute("aria-disabled")==="true";if(!r.hasAttribute("tabindex")||!xy(r,C)||c)r=o(e,r,t);else return r.focus(),!0}return!1}const WY=b.forwardRef(function(g,t){const{actions:I,autoFocus:o=!1,autoFocusItem:C=!1,children:s,className:r,disabledItemsFocusable:c=!1,disableListWrap:d=!1,onKeyDown:A,variant:m="selectedMenu",...Z}=g,y=b.useRef(null),G=b.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});pI(()=>{o&&y.current.focus()},[o]),b.useImperativeHandle(I,()=>({adjustStyleForScrollbar:(R,{direction:k})=>{const J=!y.current.style.width;if(R.clientHeight<y.current.clientHeight&&J){const F=`${Ny(Mn(R))}px`;y.current.style[k==="rtl"?"paddingLeft":"paddingRight"]=F,y.current.style.width=`calc(100% + ${F})`}return y.current}}),[]);const B=R=>{const k=y.current,J=R.key;if(R.ctrlKey||R.metaKey||R.altKey){A&&A(R);return}const U=nn(k).activeElement;if(J==="ArrowDown")R.preventDefault(),qo(k,U,d,c,td);else if(J==="ArrowUp")R.preventDefault(),qo(k,U,d,c,$Z);else if(J==="Home")R.preventDefault(),qo(k,null,d,c,td);else if(J==="End")R.preventDefault(),qo(k,null,d,c,$Z);else if(J.length===1){const X=G.current,K=J.toLowerCase(),w=performance.now();X.keys.length>0&&(w-X.lastTime>500?(X.keys=[],X.repeating=!0,X.previousKeyMatched=!0):X.repeating&&K!==X.keys[0]&&(X.repeating=!1)),X.lastTime=w,X.keys.push(K);const D=U&&!X.repeating&&xy(U,X);X.previousKeyMatched&&(D||qo(k,U,!1,c,td,X))?R.preventDefault():X.previousKeyMatched=!1}A&&A(R)},f=it(y,t);let W=-1;b.Children.forEach(s,(R,k)=>{if(!b.isValidElement(R)){W===k&&(W+=1,W>=s.length&&(W=-1));return}R.props.disabled||(m==="selectedMenu"&&R.props.selected||W===-1)&&(W=k),W===k&&(R.props.disabled||R.props.muiSkipListHighlight||R.type.muiSkipListHighlight)&&(W+=1,W>=s.length&&(W=-1))});const v=b.Children.map(s,(R,k)=>{if(k===W){const J={};return C&&(J.autoFocus=!0),R.props.tabIndex===void 0&&m==="selectedMenu"&&(J.tabIndex=0),b.cloneElement(R,J)}return R});return p.jsx(VY,{role:"menu",ref:f,className:r,onKeyDown:B,tabIndex:o?0:-1,...Z,children:v})});function jd(e){return typeof e=="string"}function DC(e){return parseInt(b.version,10)>=19?e?.props?.ref||null:e?.ref||null}const Ey=e=>e.scrollTop;function $s(e,g){const{timeout:t,easing:I,style:o={}}=e;return{duration:o.transitionDuration??(typeof t=="number"?t:t[g.mode]||0),easing:o.transitionTimingFunction??(typeof I=="object"?I[g.mode]:I),delay:o.transitionDelay}}function Pd(e){return`scale(${e}, ${e**2})`}const RY={entering:{opacity:1,transform:Pd(1)},entered:{opacity:1,transform:"none"}},nd=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Od=b.forwardRef(function(g,t){const{addEndListener:I,appear:o=!0,children:C,easing:s,in:r,onEnter:c,onEntered:d,onEntering:A,onExit:m,onExited:Z,onExiting:y,style:G,timeout:B="auto",TransitionComponent:f=Wn,...W}=g,v=ky(),R=b.useRef(),k=Wr(),J=b.useRef(null),F=it(J,DC(C),t),U=L=>Q=>{if(L){const q=J.current;Q===void 0?L(q):L(q,Q)}},X=U(A),K=U((L,Q)=>{Ey(L);const{duration:q,delay:j,easing:P}=$s({style:G,timeout:B,easing:s},{mode:"enter"});let $;B==="auto"?($=k.transitions.getAutoHeightDuration(L.clientHeight),R.current=$):$=q,L.style.transition=[k.transitions.create("opacity",{duration:$,delay:j}),k.transitions.create("transform",{duration:nd?$:$*.666,delay:j,easing:P})].join(","),c&&c(L,Q)}),w=U(d),D=U(y),V=U(L=>{const{duration:Q,delay:q,easing:j}=$s({style:G,timeout:B,easing:s},{mode:"exit"});let P;B==="auto"?(P=k.transitions.getAutoHeightDuration(L.clientHeight),R.current=P):P=Q,L.style.transition=[k.transitions.create("opacity",{duration:P,delay:q}),k.transitions.create("transform",{duration:nd?P:P*.666,delay:nd?q:q||P*.333,easing:j})].join(","),L.style.opacity=0,L.style.transform=Pd(.75),m&&m(L)}),z=U(Z),N=L=>{B==="auto"&&v.start(R.current||0,L),I&&I(J.current,L)};return p.jsx(f,{appear:o,in:r,nodeRef:J,onEnter:K,onEntered:w,onEntering:X,onExit:V,onExited:z,onExiting:D,addEndListener:N,timeout:B==="auto"?null:B,...W,children:(L,{ownerState:Q,...q})=>b.cloneElement(C,{style:{opacity:0,transform:Pd(.75),visibility:L==="exited"&&!r?"hidden":void 0,...RY[L],...G,...C.props.style},ref:F,...q})})});Od&&(Od.muiSupportAuto=!0);function XY(e){const g=nn(e);return g.body===e?Mn(e).innerWidth>g.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function cC(e,g){g?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function eb(e){return parseInt(Mn(e).getComputedStyle(e).paddingRight,10)||0}function kY(e){const t=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(e.tagName),I=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return t||I}function gb(e,g,t,I,o){const C=[g,t,...I];[].forEach.call(e.children,s=>{const r=!C.includes(s),c=!kY(s);r&&c&&cC(s,o)})}function Id(e,g){let t=-1;return e.some((I,o)=>g(I)?(t=o,!0):!1),t}function JY(e,g){const t=[],I=e.container;if(!g.disableScrollLock){if(XY(I)){const s=Ny(Mn(I));t.push({value:I.style.paddingRight,property:"padding-right",el:I}),I.style.paddingRight=`${eb(I)+s}px`;const r=nn(I).querySelectorAll(".mui-fixed");[].forEach.call(r,c=>{t.push({value:c.style.paddingRight,property:"padding-right",el:c}),c.style.paddingRight=`${eb(c)+s}px`})}let C;if(I.parentNode instanceof DocumentFragment)C=nn(I).body;else{const s=I.parentElement,r=Mn(I);C=s?.nodeName==="HTML"&&r.getComputedStyle(s).overflowY==="scroll"?s:I}t.push({value:C.style.overflow,property:"overflow",el:C},{value:C.style.overflowX,property:"overflow-x",el:C},{value:C.style.overflowY,property:"overflow-y",el:C}),C.style.overflow="hidden"}return()=>{t.forEach(({value:C,el:s,property:r})=>{C?s.style.setProperty(r,C):s.style.removeProperty(r)})}}function vY(e){const g=[];return[].forEach.call(e.children,t=>{t.getAttribute("aria-hidden")==="true"&&g.push(t)}),g}class YY{constructor(){this.modals=[],this.containers=[]}add(g,t){let I=this.modals.indexOf(g);if(I!==-1)return I;I=this.modals.length,this.modals.push(g),g.modalRef&&cC(g.modalRef,!1);const o=vY(t);gb(t,g.mount,g.modalRef,o,!0);const C=Id(this.containers,s=>s.container===t);return C!==-1?(this.containers[C].modals.push(g),I):(this.containers.push({modals:[g],container:t,restore:null,hiddenSiblings:o}),I)}mount(g,t){const I=Id(this.containers,C=>C.modals.includes(g)),o=this.containers[I];o.restore||(o.restore=JY(o,t))}remove(g,t=!0){const I=this.modals.indexOf(g);if(I===-1)return I;const o=Id(this.containers,s=>s.modals.includes(g)),C=this.containers[o];if(C.modals.splice(C.modals.indexOf(g),1),this.modals.splice(I,1),C.modals.length===0)C.restore&&C.restore(),g.modalRef&&cC(g.modalRef,t),gb(C.container,g.mount,g.modalRef,C.hiddenSiblings,!1),this.containers.splice(o,1);else{const s=C.modals[C.modals.length-1];s.modalRef&&cC(s.modalRef,!1)}return I}isTopModal(g){return this.modals.length>0&&this.modals[this.modals.length-1]===g}}const HY=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function wY(e){const g=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(g)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:g}function FY(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const g=I=>e.ownerDocument.querySelector(`input[type="radio"]${I}`);let t=g(`[name="${e.name}"]:checked`);return t||(t=g(`[name="${e.name}"]`)),t!==e}function KY(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||FY(e))}function NY(e){const g=[],t=[];return Array.from(e.querySelectorAll(HY)).forEach((I,o)=>{const C=wY(I);C===-1||!KY(I)||(C===0?g.push(I):t.push({documentOrder:o,tabIndex:C,node:I}))}),t.sort((I,o)=>I.tabIndex===o.tabIndex?I.documentOrder-o.documentOrder:I.tabIndex-o.tabIndex).map(I=>I.node).concat(g)}function xY(){return!0}function EY(e){const{children:g,disableAutoFocus:t=!1,disableEnforceFocus:I=!1,disableRestoreFocus:o=!1,getTabbable:C=NY,isEnabled:s=xY,open:r}=e,c=b.useRef(!1),d=b.useRef(null),A=b.useRef(null),m=b.useRef(null),Z=b.useRef(null),y=b.useRef(!1),G=b.useRef(null),B=it(DC(g),G),f=b.useRef(null);b.useEffect(()=>{!r||!G.current||(y.current=!t)},[t,r]),b.useEffect(()=>{if(!r||!G.current)return;const R=nn(G.current);return G.current.contains(R.activeElement)||(G.current.hasAttribute("tabIndex")||G.current.setAttribute("tabIndex","-1"),y.current&&G.current.focus()),()=>{o||(m.current&&m.current.focus&&(c.current=!0,m.current.focus()),m.current=null)}},[r]),b.useEffect(()=>{if(!r||!G.current)return;const R=nn(G.current),k=U=>{f.current=U,!(I||!s()||U.key!=="Tab")&&R.activeElement===G.current&&U.shiftKey&&(c.current=!0,A.current&&A.current.focus())},J=()=>{const U=G.current;if(U===null)return;if(!R.hasFocus()||!s()||c.current){c.current=!1;return}if(U.contains(R.activeElement)||I&&R.activeElement!==d.current&&R.activeElement!==A.current)return;if(R.activeElement!==Z.current)Z.current=null;else if(Z.current!==null)return;if(!y.current)return;let X=[];if((R.activeElement===d.current||R.activeElement===A.current)&&(X=C(G.current)),X.length>0){const K=!!(f.current?.shiftKey&&f.current?.key==="Tab"),w=X[0],D=X[X.length-1];typeof w!="string"&&typeof D!="string"&&(K?D.focus():w.focus())}else U.focus()};R.addEventListener("focusin",J),R.addEventListener("keydown",k,!0);const F=setInterval(()=>{R.activeElement&&R.activeElement.tagName==="BODY"&&J()},50);return()=>{clearInterval(F),R.removeEventListener("focusin",J),R.removeEventListener("keydown",k,!0)}},[t,I,o,s,r,C]);const W=R=>{m.current===null&&(m.current=R.relatedTarget),y.current=!0,Z.current=R.target;const k=g.props.onFocus;k&&k(R)},v=R=>{m.current===null&&(m.current=R.relatedTarget),y.current=!0};return p.jsxs(b.Fragment,{children:[p.jsx("div",{tabIndex:r?0:-1,onFocus:v,ref:d,"data-testid":"sentinelStart"}),b.cloneElement(g,{ref:B,onFocus:W}),p.jsx("div",{tabIndex:r?0:-1,onFocus:v,ref:A,"data-testid":"sentinelEnd"})]})}function zY(e){return typeof e=="function"?e():e}const MY=b.forwardRef(function(g,t){const{children:I,container:o,disablePortal:C=!1}=g,[s,r]=b.useState(null),c=it(b.isValidElement(I)?DC(I):null,t);if(pI(()=>{C||r(zY(o)||document.body)},[o,C]),pI(()=>{if(s&&!C)return vZ(t,s),()=>{vZ(t,null)}},[t,s,C]),C){if(b.isValidElement(I)){const d={ref:c};return b.cloneElement(I,d)}return I}return s&&BG.createPortal(I,s)});function et(e,g){const{className:t,elementType:I,ownerState:o,externalForwardedProps:C,internalForwardedProps:s,shouldForwardComponentProp:r=!1,...c}=g,{component:d,slots:A={[e]:void 0},slotProps:m={[e]:void 0},...Z}=C,y=A[e]||I,G=Ky(m[e],o),{props:{component:B,...f},internalRef:W}=Fy({className:t,...c,externalForwardedProps:e==="root"?Z:void 0,externalSlotProps:G}),v=it(W,G?.ref,g.ref),R=e==="root"?B||d:B,k=Hy(y,{...e==="root"&&!d&&!A[e]&&s,...e!=="root"&&!A[e]&&s,...f,...R&&!r&&{as:R},...R&&r&&{component:R},ref:v},o);return[y,k]}const UY={entering:{opacity:1},entered:{opacity:1}},LY=b.forwardRef(function(g,t){const I=Wr(),o={enter:I.transitions.duration.enteringScreen,exit:I.transitions.duration.leavingScreen},{addEndListener:C,appear:s=!0,children:r,easing:c,in:d,onEnter:A,onEntered:m,onEntering:Z,onExit:y,onExited:G,onExiting:B,style:f,timeout:W=o,TransitionComponent:v=Wn,...R}=g,k=b.useRef(null),J=it(k,DC(r),t),F=N=>L=>{if(N){const Q=k.current;L===void 0?N(Q):N(Q,L)}},U=F(Z),X=F((N,L)=>{Ey(N);const Q=$s({style:f,timeout:W,easing:c},{mode:"enter"});N.style.webkitTransition=I.transitions.create("opacity",Q),N.style.transition=I.transitions.create("opacity",Q),A&&A(N,L)}),K=F(m),w=F(B),D=F(N=>{const L=$s({style:f,timeout:W,easing:c},{mode:"exit"});N.style.webkitTransition=I.transitions.create("opacity",L),N.style.transition=I.transitions.create("opacity",L),y&&y(N)}),V=F(G),z=N=>{C&&C(k.current,N)};return p.jsx(v,{appear:s,in:d,nodeRef:k,onEnter:X,onEntered:K,onEntering:U,onExit:D,onExited:V,onExiting:w,addEndListener:z,timeout:W,...R,children:(N,{ownerState:L,...Q})=>b.cloneElement(r,{style:{opacity:0,visibility:N==="exited"&&!d?"hidden":void 0,...UY[N],...f,...r.props.style},ref:J,...Q})})});function TY(e){return Cg("MuiBackdrop",e)}$e("MuiBackdrop",["root","invisible"]);const QY=e=>{const{classes:g,invisible:t}=e;return og({root:["root",t&&"invisible"]},TY,g)},DY=Xe("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,t.invisible&&g.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),jY=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiBackdrop"}),{children:o,className:C,component:s="div",invisible:r=!1,open:c,components:d={},componentsProps:A={},slotProps:m={},slots:Z={},TransitionComponent:y,transitionDuration:G,...B}=I,f={...I,component:s,invisible:r},W=QY(f),v={transition:y,root:d.Root,...Z},R={...A,...m},k={component:s,slots:v,slotProps:R},[J,F]=et("root",{elementType:DY,externalForwardedProps:k,className:Ne(W.root,C),ownerState:f}),[U,X]=et("transition",{elementType:LY,externalForwardedProps:k,ownerState:f});return p.jsx(U,{in:c,timeout:G,...B,...X,children:p.jsx(J,{"aria-hidden":!0,...F,classes:W,ref:t,children:o})})});function PY(e){return typeof e=="function"?e():e}function OY(e){return e?e.props.hasOwnProperty("in"):!1}const tb=()=>{},cs=new YY;function qY(e){const{container:g,disableEscapeKeyDown:t=!1,disableScrollLock:I=!1,closeAfterTransition:o=!1,onTransitionEnter:C,onTransitionExited:s,children:r,onClose:c,open:d,rootRef:A}=e,m=b.useRef({}),Z=b.useRef(null),y=b.useRef(null),G=it(y,A),[B,f]=b.useState(!d),W=OY(r);let v=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(v=!1);const R=()=>nn(Z.current),k=()=>(m.current.modalRef=y.current,m.current.mount=Z.current,m.current),J=()=>{cs.mount(k(),{disableScrollLock:I}),y.current&&(y.current.scrollTop=0)},F=PI(()=>{const L=PY(g)||R().body;cs.add(k(),L),y.current&&J()}),U=()=>cs.isTopModal(k()),X=PI(L=>{Z.current=L,L&&(d&&U()?J():y.current&&cC(y.current,v))}),K=b.useCallback(()=>{cs.remove(k(),v)},[v]);b.useEffect(()=>()=>{K()},[K]),b.useEffect(()=>{d?F():(!W||!o)&&K()},[d,K,W,o,F]);const w=L=>Q=>{L.onKeyDown?.(Q),!(Q.key!=="Escape"||Q.which===229||!U())&&(t||(Q.stopPropagation(),c&&c(Q,"escapeKeyDown")))},D=L=>Q=>{L.onClick?.(Q),Q.target===Q.currentTarget&&c&&c(Q,"backdropClick")};return{getRootProps:(L={})=>{const Q=wy(e);delete Q.onTransitionEnter,delete Q.onTransitionExited;const q={...Q,...L};return{role:"presentation",...q,onKeyDown:w(q),ref:G}},getBackdropProps:(L={})=>{const Q=L;return{"aria-hidden":!0,...Q,onClick:D(Q),open:d}},getTransitionProps:()=>{const L=()=>{f(!1),C&&C()},Q=()=>{f(!0),s&&s(),o&&K()};return{onEnter:$p(L,r?.props.onEnter??tb),onExited:$p(Q,r?.props.onExited??tb)}},rootRef:G,portalRef:X,isTopModal:U,exited:B,hasTransition:W}}function _Y(e){return Cg("MuiModal",e)}$e("MuiModal",["root","hidden","backdrop"]);const $Y=e=>{const{open:g,exited:t,classes:I}=e;return og({root:["root",!g&&t&&"hidden"],backdrop:["backdrop"]},_Y,I)},eH=Xe("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,!t.open&&t.exited&&g.hidden]}})(vg(({theme:e})=>({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:g})=>!g.open&&g.exited,style:{visibility:"hidden"}}]}))),gH=Xe(jY,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),nl=b.forwardRef(function(g,t){const I=sg({name:"MuiModal",props:g}),{BackdropComponent:o=gH,BackdropProps:C,classes:s,className:r,closeAfterTransition:c=!1,children:d,container:A,component:m,components:Z={},componentsProps:y={},disableAutoFocus:G=!1,disableEnforceFocus:B=!1,disableEscapeKeyDown:f=!1,disablePortal:W=!1,disableRestoreFocus:v=!1,disableScrollLock:R=!1,hideBackdrop:k=!1,keepMounted:J=!1,onClose:F,onTransitionEnter:U,onTransitionExited:X,open:K,slotProps:w={},slots:D={},theme:V,...z}=I,N={...I,closeAfterTransition:c,disableAutoFocus:G,disableEnforceFocus:B,disableEscapeKeyDown:f,disablePortal:W,disableRestoreFocus:v,disableScrollLock:R,hideBackdrop:k,keepMounted:J},{getRootProps:L,getBackdropProps:Q,getTransitionProps:q,portalRef:j,isTopModal:P,exited:$,hasTransition:H}=qY({...N,rootRef:t}),M={...N,exited:$},te=$Y(M),oe={};if(d.props.tabIndex===void 0&&(oe.tabIndex="-1"),H){const{onEnter:Ae,onExited:ce}=q();oe.onEnter=Ae,oe.onExited=ce}const ne={slots:{root:Z.Root,backdrop:Z.Backdrop,...D},slotProps:{...y,...w}},[ae,re]=et("root",{ref:t,elementType:eH,externalForwardedProps:{...ne,...z,component:m},getSlotProps:L,ownerState:M,className:Ne(r,te?.root,!M.open&&M.exited&&te?.hidden)}),[Ge,ue]=et("backdrop",{ref:C?.ref,elementType:o,externalForwardedProps:ne,shouldForwardComponentProp:!0,additionalProps:C,getSlotProps:Ae=>Q({...Ae,onClick:ce=>{Ae?.onClick&&Ae.onClick(ce)}}),className:Ne(C?.className,te?.backdrop),ownerState:M});return!J&&!K&&(!H||$)?null:p.jsx(MY,{ref:j,container:A,disablePortal:W,children:p.jsxs(ae,{...re,children:[!k&&o?p.jsx(Ge,{...ue}):null,p.jsx(EY,{disableEnforceFocus:B,disableAutoFocus:G,disableRestoreFocus:v,isEnabled:P,open:K,children:b.cloneElement(d,oe)})]})})});function tH(e){return Cg("MuiPaper",e)}$e("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const nH=e=>{const{square:g,elevation:t,variant:I,classes:o}=e,C={root:["root",I,!g&&"rounded",I==="elevation"&&`elevation${t}`]};return og(C,tH,o)},IH=Xe("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,g[t.variant],!t.square&&g.rounded,t.variant==="elevation"&&g[`elevation${t.elevation}`]]}})(vg(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:g})=>!g.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),zy=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiPaper"}),o=Wr(),{className:C,component:s="div",elevation:r=1,square:c=!1,variant:d="elevation",...A}=I,m={...I,component:s,elevation:r,square:c,variant:d},Z=nH(m);return p.jsx(IH,{as:s,ownerState:m,className:Ne(Z.root,C),ref:t,...A,style:{...d==="elevation"&&{"--Paper-shadow":(o.vars||o).shadows[r],...o.vars&&{"--Paper-overlay":o.vars.overlays?.[r]},...!o.vars&&o.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Ds("#fff",Hd(r))}, ${Ds("#fff",Hd(r))})`}},...A.style}})});function lH(e){return Cg("MuiPopover",e)}$e("MuiPopover",["root","paper"]);function nb(e,g){let t=0;return typeof g=="number"?t=g:g==="center"?t=e.height/2:g==="bottom"&&(t=e.height),t}function Ib(e,g){let t=0;return typeof g=="number"?t=g:g==="center"?t=e.width/2:g==="right"&&(t=e.width),t}function lb(e){return[e.horizontal,e.vertical].map(g=>typeof g=="number"?`${g}px`:g).join(" ")}function ds(e){return typeof e=="function"?e():e}const oH=e=>{const{classes:g}=e;return og({root:["root"],paper:["paper"]},lH,g)},CH=Xe(nl,{name:"MuiPopover",slot:"Root"})({}),My=Xe(zy,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),iH=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiPopover"}),{action:o,anchorEl:C,anchorOrigin:s={vertical:"top",horizontal:"left"},anchorPosition:r,anchorReference:c="anchorEl",children:d,className:A,container:m,elevation:Z=8,marginThreshold:y=16,open:G,PaperProps:B={},slots:f={},slotProps:W={},transformOrigin:v={vertical:"top",horizontal:"left"},TransitionComponent:R,transitionDuration:k="auto",TransitionProps:J={},disableScrollLock:F=!1,...U}=I,X=b.useRef(),K={...I,anchorOrigin:s,anchorReference:c,elevation:Z,marginThreshold:y,transformOrigin:v,TransitionComponent:R,transitionDuration:k,TransitionProps:J},w=oH(K),D=b.useCallback(()=>{if(c==="anchorPosition")return r;const Ae=ds(C),me=(Ae&&Ae.nodeType===1?Ae:nn(X.current).body).getBoundingClientRect();return{top:me.top+nb(me,s.vertical),left:me.left+Ib(me,s.horizontal)}},[C,s.horizontal,s.vertical,r,c]),V=b.useCallback(Ae=>({vertical:nb(Ae,v.vertical),horizontal:Ib(Ae,v.horizontal)}),[v.horizontal,v.vertical]),z=b.useCallback(Ae=>{const ce={width:Ae.offsetWidth,height:Ae.offsetHeight},me=V(ce);if(c==="none")return{top:null,left:null,transformOrigin:lb(me)};const Ke=D();let Ye=Ke.top-me.vertical,xe=Ke.left-me.horizontal;const Qe=Ye+ce.height,ye=xe+ce.width,he=Mn(ds(C)),be=he.innerHeight-y,se=he.innerWidth-y;if(y!==null&&Ye<y){const pe=Ye-y;Ye-=pe,me.vertical+=pe}else if(y!==null&&Qe>be){const pe=Qe-be;Ye-=pe,me.vertical+=pe}if(y!==null&&xe<y){const pe=xe-y;xe-=pe,me.horizontal+=pe}else if(ye>se){const pe=ye-se;xe-=pe,me.horizontal+=pe}return{top:`${Math.round(Ye)}px`,left:`${Math.round(xe)}px`,transformOrigin:lb(me)}},[C,c,D,V,y]),[N,L]=b.useState(G),Q=b.useCallback(()=>{const Ae=X.current;if(!Ae)return;const ce=z(Ae);ce.top!==null&&Ae.style.setProperty("top",ce.top),ce.left!==null&&(Ae.style.left=ce.left),Ae.style.transformOrigin=ce.transformOrigin,L(!0)},[z]);b.useEffect(()=>(F&&window.addEventListener("scroll",Q),()=>window.removeEventListener("scroll",Q)),[C,F,Q]);const q=()=>{Q()},j=()=>{L(!1)};b.useEffect(()=>{G&&Q()}),b.useImperativeHandle(o,()=>G?{updatePosition:()=>{Q()}}:null,[G,Q]),b.useEffect(()=>{if(!G)return;const Ae=ty(()=>{Q()}),ce=Mn(ds(C));return ce.addEventListener("resize",Ae),()=>{Ae.clear(),ce.removeEventListener("resize",Ae)}},[C,G,Q]);let P=k;const $={slots:{transition:R,...f},slotProps:{transition:J,paper:B,...W}},[H,M]=et("transition",{elementType:Od,externalForwardedProps:$,ownerState:K,getSlotProps:Ae=>({...Ae,onEntering:(ce,me)=>{Ae.onEntering?.(ce,me),q()},onExited:ce=>{Ae.onExited?.(ce),j()}}),additionalProps:{appear:!0,in:G}});k==="auto"&&!H.muiSupportAuto&&(P=void 0);const te=m||(C?nn(ds(C)).body:void 0),[oe,{slots:ne,slotProps:ae,...re}]=et("root",{ref:t,elementType:CH,externalForwardedProps:{...$,...U},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:f.backdrop},slotProps:{backdrop:ev(typeof W.backdrop=="function"?W.backdrop(K):W.backdrop,{invisible:!0})},container:te,open:G},ownerState:K,className:Ne(w.root,A)}),[Ge,ue]=et("paper",{ref:X,className:w.paper,elementType:My,externalForwardedProps:$,shouldForwardComponentProp:!0,additionalProps:{elevation:Z,style:N?void 0:{opacity:0}},ownerState:K});return p.jsx(oe,{...re,...!jd(oe)&&{slots:ne,slotProps:ae,disableScrollLock:F},children:p.jsx(H,{...M,timeout:P,children:p.jsx(Ge,{...ue,children:d})})})});function sH(e){return Cg("MuiMenu",e)}$e("MuiMenu",["root","paper","list"]);const rH={vertical:"top",horizontal:"right"},aH={vertical:"top",horizontal:"left"},cH=e=>{const{classes:g}=e;return og({root:["root"],paper:["paper"],list:["list"]},sH,g)},dH=Xe(iH,{shouldForwardProp:e=>Tt(e)||e==="classes",name:"MuiMenu",slot:"Root"})({}),AH=Xe(My,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),uH=Xe(WY,{name:"MuiMenu",slot:"List"})({outline:0}),$A=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiMenu"}),{autoFocus:o=!0,children:C,className:s,disableAutoFocusItem:r=!1,MenuListProps:c={},onClose:d,open:A,PaperProps:m={},PopoverClasses:Z,transitionDuration:y="auto",TransitionProps:{onEntering:G,...B}={},variant:f="selectedMenu",slots:W={},slotProps:v={},...R}=I,k=Ek(),J={...I,autoFocus:o,disableAutoFocusItem:r,MenuListProps:c,onEntering:G,PaperProps:m,transitionDuration:y,TransitionProps:B,variant:f},F=cH(J),U=o&&!r&&A,X=b.useRef(null),K=(P,$)=>{X.current&&X.current.adjustStyleForScrollbar(P,{direction:k?"rtl":"ltr"}),G&&G(P,$)},w=P=>{P.key==="Tab"&&(P.preventDefault(),d&&d(P,"tabKeyDown"))};let D=-1;b.Children.map(C,(P,$)=>{b.isValidElement(P)&&(P.props.disabled||(f==="selectedMenu"&&P.props.selected||D===-1)&&(D=$))});const V={slots:W,slotProps:{list:c,transition:B,paper:m,...v}},z=yY({elementType:W.root,externalSlotProps:v.root,ownerState:J,className:[F.root,s]}),[N,L]=et("paper",{className:F.paper,elementType:AH,externalForwardedProps:V,shouldForwardComponentProp:!0,ownerState:J}),[Q,q]=et("list",{className:Ne(F.list,c.className),elementType:uH,shouldForwardComponentProp:!0,externalForwardedProps:V,getSlotProps:P=>({...P,onKeyDown:$=>{w($),P.onKeyDown?.($)}}),ownerState:J}),j=typeof V.slotProps.transition=="function"?V.slotProps.transition(J):V.slotProps.transition;return p.jsx(dH,{onClose:d,anchorOrigin:{vertical:"bottom",horizontal:k?"right":"left"},transformOrigin:k?rH:aH,slots:{root:W.root,paper:N,backdrop:W.backdrop,...W.transition&&{transition:W.transition}},slotProps:{root:z,paper:L,backdrop:typeof v.backdrop=="function"?v.backdrop(J):v.backdrop,transition:{...j,onEntering:(...P)=>{K(...P),j?.onEntering?.(...P)}}},open:A,ref:t,transitionDuration:y,ownerState:J,...R,classes:Z,children:p.jsx(Q,{actions:X,autoFocus:o&&(D===-1||r),autoFocusItem:U,variant:f,...q,children:C})})}),ob=$e("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),Cb=$e("MuiListItemIcon",["root","alignItemsFlexStart"]);function mH(e){return Cg("MuiTypography",e)}$e("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const hH={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},pH=PJ(),ZH=e=>{const{align:g,gutterBottom:t,noWrap:I,paragraph:o,variant:C,classes:s}=e,r={root:["root",C,e.align!=="inherit"&&`align${ze(g)}`,t&&"gutterBottom",I&&"noWrap",o&&"paragraph"]};return og(r,mH,s)},bH=Xe("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,t.variant&&g[t.variant],t.align!=="inherit"&&g[`align${ze(t.align)}`],t.noWrap&&g.noWrap,t.gutterBottom&&g.gutterBottom,t.paragraph&&g.paragraph]}})(vg(({theme:e})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter(([g,t])=>g!=="inherit"&&t&&typeof t=="object").map(([g,t])=>({props:{variant:g},style:t})),...Object.entries(e.palette).filter(tl()).map(([g])=>({props:{color:g},style:{color:(e.vars||e).palette[g].main}})),...Object.entries(e.palette?.text||{}).filter(([,g])=>typeof g=="string").map(([g])=>({props:{color:`text${ze(g)}`},style:{color:(e.vars||e).palette.text[g]}})),{props:({ownerState:g})=>g.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:g})=>g.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:g})=>g.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:g})=>g.paragraph,style:{marginBottom:16}}]}))),ib={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},yt=b.forwardRef(function(g,t){const{color:I,...o}=sg({props:g,name:"MuiTypography"}),C=!hH[I],s=pH({...o,...C&&{color:I}}),{align:r="inherit",className:c,component:d,gutterBottom:A=!1,noWrap:m=!1,paragraph:Z=!1,variant:y="body1",variantMapping:G=ib,...B}=s,f={...s,align:r,color:I,className:c,component:d,gutterBottom:A,noWrap:m,paragraph:Z,variant:y,variantMapping:G},W=d||(Z?"p":G[y]||ib[y])||"span",v=ZH(f);return p.jsx(bH,{as:W,ref:t,className:Ne(v.root,c),...B,ownerState:f,style:{...r!=="inherit"&&{"--Typography-textAlign":r},...B.style}})}),sb=$e("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function GH(e){return Cg("MuiMenuItem",e)}const _o=$e("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),yH=(e,g)=>{const{ownerState:t}=e;return[g.root,t.dense&&g.dense,t.divider&&g.divider,!t.disableGutters&&g.gutters]},BH=e=>{const{disabled:g,dense:t,divider:I,disableGutters:o,selected:C,classes:s}=e,c=og({root:["root",t&&"dense",g&&"disabled",!o&&"gutters",I&&"divider",C&&"selected"]},GH,s);return{...s,...c}},fH=Xe(Jy,{shouldForwardProp:e=>Tt(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:yH})(vg(({theme:e})=>({...e.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${_o.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${_o.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}},[`&.${_o.selected}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity)}},[`&.${_o.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${_o.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${ob.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${ob.inset}`]:{marginLeft:52},[`& .${sb.root}`]:{marginTop:0,marginBottom:0},[`& .${sb.inset}`]:{paddingLeft:36},[`& .${Cb.root}`]:{minWidth:36},variants:[{props:({ownerState:g})=>!g.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:g})=>g.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:g})=>!g.dense,style:{[e.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:g})=>g.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...e.typography.body2,[`& .${Cb.root} svg`]:{fontSize:"1.25rem"}}}]}))),ht=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiMenuItem"}),{autoFocus:o=!1,component:C="li",dense:s=!1,divider:r=!1,disableGutters:c=!1,focusVisibleClassName:d,role:A="menuitem",tabIndex:m,className:Z,...y}=I,G=b.useContext(Dd),B=b.useMemo(()=>({dense:s||G.dense||!1,disableGutters:c}),[G.dense,s,c]),f=b.useRef(null);pI(()=>{o&&f.current&&f.current.focus()},[o]);const W={...I,dense:B.dense,divider:r,disableGutters:c},v=BH(I),R=it(f,t);let k;return I.disabled||(k=m!==void 0?m:-1),p.jsx(Dd.Provider,{value:B,children:p.jsx(fH,{ref:R,role:A,tabIndex:k,component:C,focusVisibleClassName:Ne(v.focusVisible,d),className:Ne(v.root,Z),...y,ownerState:W,classes:v})})}),SH=In(p.jsx("path",{d:"m11 8.89.94 3.11h2.82l-2.27 1.62.93 3.01L11 14.79l-2.42 1.84.93-3.01L7.24 12h2.82zM8.58 10H1l6.17 4.41L4.83 22 11 17.31 17.18 22l-2.35-7.59L21 10h-7.58L11 2zm12.78 12-1.86-6.01L23.68 13h-3.44l-3.08 2.2 1.46 4.72zM17 8l-1.82-6-1.04 3.45.77 2.55z"})),VH=In(p.jsx("path",{d:"m12 5.69 5 4.5V18h-2v-6H9v6H7v-7.81zM12 3 2 12h3v8h6v-6h2v6h6v-8h3z"})),WH=In(p.jsx("path",{d:"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4"})),RH=In(p.jsx("path",{d:"M12.22 19.85c-.18.18-.5.21-.71 0-.18-.18-.21-.5 0-.71l3.39-3.39-1.41-1.41-3.39 3.39c-.19.2-.51.19-.71 0-.21-.21-.18-.53 0-.71l3.39-3.39-1.41-1.41-3.39 3.39c-.18.18-.5.21-.71 0-.19-.19-.19-.51 0-.71l3.39-3.39-1.42-1.41-3.39 3.39c-.18.18-.5.21-.71 0-.19-.2-.19-.51 0-.71L9.52 8.4l1.87 1.86c.95.95 2.59.94 3.54 0 .98-.98.98-2.56 0-3.54l-1.86-1.86.28-.28c.78-.78 2.05-.78 2.83 0l4.24 4.24c.78.78.78 2.05 0 2.83zm9.61-6.78c1.56-1.56 1.56-4.09 0-5.66l-4.24-4.24c-1.56-1.56-4.09-1.56-5.66 0l-.28.28-.28-.28c-1.56-1.56-4.09-1.56-5.66 0L2.17 6.71C.75 8.13.62 10.34 1.77 11.9l1.45-1.45c-.39-.75-.26-1.7.37-2.33l3.54-3.54c.78-.78 2.05-.78 2.83 0l3.56 3.56c.18.18.21.5 0 .71s-.53.18-.71 0L9.52 5.57l-5.8 5.79c-.98.97-.98 2.56 0 3.54.39.39.89.63 1.42.7.07.52.3 1.02.7 1.42s.9.63 1.42.7c.07.52.3 1.02.7 1.42s.9.63 1.42.7c.07.54.31 1.03.7 1.42.47.47 1.1.73 1.77.73s1.3-.26 1.77-.73z"})),XH="https://pilot-hestia-backend.onrender.com",kH=()=>{const[e,g]=b.useState(0),t=localStorage.getItem("token");return b.useEffect(()=>{(async()=>{try{const o=await We.get(`${XH}/api/points/`,{headers:{Authorization:`Bearer ${t}`}});g(o.data)}catch{console.error("couldn't get points")}})()},[]),p.jsx(p.Fragment,{children:p.jsx("div",{style:{margin:0},children:p.jsxs("h3",{style:{fontSize:"13px",color:"white",margin:0},children:[e," Embers"]})})})},jC=b.createContext(),PC=()=>{const{logout:e}=b.useContext(jC),g=Qn(),[t,I]=b.useState(null),o=!!t,C=c=>{I(c.currentTarget)},s=c=>{I(null),g(c)},r=async c=>{try{await We.post(`${API_URL}/api/auth/logout`)||console.error("couldn't log out"),e(),We.defaults.headers.common.Authorization="",g(c)}catch(d){console.log(d)}};return p.jsxs("div",{id:"nav",style:JH,children:[p.jsxs("div",{children:[p.jsx(_e,{id:"basic-button","aria-controls":o?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":o?"true":void 0,onClick:C,children:p.jsx(Yy,{sx:{color:"white"}})}),p.jsxs($A,{id:"basic-menu",anchorEl:t,open:o,onClose:s,slotProps:{list:{"aria-labelledby":"basic-button"}},children:[p.jsxs(ht,{onClick:()=>s("/profile"),children:[" ",p.jsx(WH,{fontSize:"small"})," Profile"]}),p.jsxs(ht,{onClick:()=>s("/home"),children:[p.jsx(VH,{fontSize:"small"})," Home"]}),p.jsxs(ht,{onClick:()=>s("/rewards"),children:[" ",p.jsx(SH,{fontSize:"small"})," Rewards"]}),p.jsxs(ht,{onClick:()=>s("/member"),children:[" ",p.jsx(RH,{fontSize:"small"})," Member"]}),p.jsx(ht,{onClick:()=>r("/"),style:{color:"red"},children:"Logout"})]})]}),p.jsx("div",{children:p.jsx(kH,{})})]})},JH={width:"100%",display:"flex",alignItems:"center",position:"sticky",top:0,zIndex:10,backgroundColor:"#ff2400",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",justifyContent:"space-between",padding:"10px",paddingRight:"25px"},eu=({img:e,business_name:g,onUpload:t,isSelected:I,onClick:o})=>{const C=localStorage.getItem("role"),s=b.useRef(null),[r,c]=b.useState(e||null);b.useEffect(()=>{e&&c(e)},[e]);const d=()=>{C==="vendor"&&s.current?s.current.click():o&&o()},A=m=>{const Z=m.target.files[0];if(Z){const y=URL.createObjectURL(Z);c(y),t(Z)}};return p.jsxs("div",{style:{boxShadow:I?"0 0 10px #FF5F00":"0 0 3px #FF5F00",border:I?"3px solid #FF5F00":"none",cursor:C==="vendor"?"pointer":"default",borderRadius:"10px",padding:10,display:"flex",flexDirection:"column",alignItems:"center",width:130},onClick:d,children:[C==="vendor"&&!r?p.jsx("div",{style:{width:"110px",height:"110px",borderRadius:"50%",backgroundColor:"lightgray",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:40},children:"+"}):p.jsx("img",{style:{width:"110px",height:"110px",borderRadius:"50%"},src:r,alt:"vendor_img"}),p.jsx("div",{style:{...vH,marginTop:5},children:p.jsx("h4",{style:{color:I?"#FF5F00":"grey"},children:g})}),C==="vendor"&&p.jsx("input",{type:"file",accept:"image/*",ref:s,style:{display:"none"},onChange:A})]})},vH={padding:0,color:"black",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",textAlign:"center",textOverflow:"ellipsis"},YH=In([p.jsx("path",{d:"m12 12.9-2.13 2.09c-.56.56-.87 1.29-.87 2.07C9 18.68 10.35 20 12 20s3-1.32 3-2.94c0-.78-.31-1.52-.87-2.07z"},"0"),p.jsx("path",{d:"m16 6-.44.55C14.38 8.02 12 7.19 12 5.3V2S4 6 4 13c0 2.92 1.56 5.47 3.89 6.86-.56-.79-.89-1.76-.89-2.8 0-1.32.52-2.56 1.47-3.5L12 10.1l3.53 3.47c.95.93 1.47 2.17 1.47 3.5 0 1.02-.31 1.96-.85 2.75 1.89-1.15 3.29-3.06 3.71-5.3.66-3.55-1.07-6.9-3.86-8.52"},"1")]),HH=In(p.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"})),wH=In(p.jsx("path",{d:"m21.41 11.41-8.83-8.83c-.37-.37-.88-.58-1.41-.58H4c-1.1 0-2 .9-2 2v7.17c0 .53.21 1.04.59 1.41l8.83 8.83c.78.78 2.05.78 2.83 0l7.17-7.17c.78-.78.78-2.04-.01-2.83M6.5 8C5.67 8 5 7.33 5 6.5S5.67 5 6.5 5 8 5.67 8 6.5 7.33 8 6.5 8"})),FH=In(p.jsx("path",{d:"M20 4H4v2h16zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6zm-9 4H6v-4h6z"})),KH=({rewardId:e,rewardImg:g,rewardTitle:t,rewardPrice:I})=>p.jsxs("div",{style:NH,children:[p.jsx("img",{style:{width:"70%",height:"70%",margin:0},src:g,alt:`${t} image`}),p.jsx("h4",{style:rb,children:t}),p.jsxs("h4",{style:{...rb,display:"flex",alignItems:"center",gap:"6px"},children:[p.jsx(YH,{}),I," Embers"]})]}),NH={width:"100%",Height:"100%",padding:"10px",margin:0,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},rb={color:"#FF5F00",margin:0,fontSize:"15px",lineHeight:1};var As={},ab;function xH(){if(ab)return As;ab=1,Object.defineProperty(As,"__esModule",{value:!0});var e=Cr();function g(X){return Array.prototype.slice.call(X)}function t(X,K){var w=Math.floor(X);return w===K||w+1===K?X:K}function I(){return Date.now()}function o(X,K,w){if(K="data-keen-slider-"+K,w===null)return X.removeAttribute(K);X.setAttribute(K,w||"")}function C(X,K){return K=K||document,typeof X=="function"&&(X=X(K)),Array.isArray(X)?X:typeof X=="string"?g(K.querySelectorAll(X)):X instanceof HTMLElement?[X]:X instanceof NodeList?g(X):[]}function s(X){X.raw&&(X=X.raw),X.cancelable&&!X.defaultPrevented&&X.preventDefault()}function r(X){X.raw&&(X=X.raw),X.stopPropagation&&X.stopPropagation()}function c(){var X=[];return{add:function(K,w,D,V){K.addListener?K.addListener(D):K.addEventListener(w,D,V),X.push([K,w,D,V])},input:function(K,w,D,V){this.add(K,w,function(z){return function(N){N.nativeEvent&&(N=N.nativeEvent);var L=N.changedTouches||[],Q=N.targetTouches||[],q=N.detail&&N.detail.x?N.detail:null;return z({id:q?q.identifier?q.identifier:"i":Q[0]?Q[0]?Q[0].identifier:"e":"d",idChanged:q?q.identifier?q.identifier:"i":L[0]?L[0]?L[0].identifier:"e":"d",raw:N,x:q&&q.x?q.x:Q[0]?Q[0].screenX:q?q.x:N.pageX,y:q&&q.y?q.y:Q[0]?Q[0].screenY:q?q.y:N.pageY})}}(D),V)},purge:function(){X.forEach(function(K){K[0].removeListener?K[0].removeListener(K[2]):K[0].removeEventListener(K[1],K[2],K[3])}),X=[]}}}function d(X,K,w){return Math.min(Math.max(X,K),w)}function A(X){return(X>0?1:0)-(X<0?1:0)||+X}function m(X){var K=X.getBoundingClientRect();return{height:t(K.height,X.offsetHeight),width:t(K.width,X.offsetWidth)}}function Z(X,K,w,D){var V=X&&X[K];return V==null?w:D&&typeof V=="function"?V():V}function y(X){return Math.round(1e6*X)/1e6}function G(X,K){if(X===K)return!0;var w=typeof X;if(w!==typeof K)return!1;if(w!=="object"||X===null||K===null)return w==="function"&&X.toString()===K.toString();if(X.length!==K.length||Object.getOwnPropertyNames(X).length!==Object.getOwnPropertyNames(K).length)return!1;for(var D in X)if(!G(X[D],K[D]))return!1;return!0}var B=function(){return B=Object.assign||function(X){for(var K,w=1,D=arguments.length;w<D;w++)for(var V in K=arguments[w])Object.prototype.hasOwnProperty.call(K,V)&&(X[V]=K[V]);return X},B.apply(this,arguments)};function f(X,K,w){for(var D,V=0,z=K.length;V<z;V++)!D&&V in K||(D||(D=Array.prototype.slice.call(K,0,V)),D[V]=K[V]);return X.concat(D||Array.prototype.slice.call(K))}function W(X){var K,w,D,V,z,N;function L($){N||(N=$),Q(!0);var H=$-N;H>D&&(H=D);var M=V[w];if(M[3]<H)return w++,L($);var te=M[2],oe=M[4],ne=M[0],ae=M[1]*(0,M[5])(oe===0?1:(H-te)/oe);if(ae&&X.track.to(ne+ae),H<D)return j();N=null,Q(!1),q(null),X.emit("animationEnded")}function Q($){K.active=$}function q($){K.targetIdx=$}function j(){var $;$=L,z=window.requestAnimationFrame($)}function P(){var $;$=z,window.cancelAnimationFrame($),Q(!1),q(null),N&&X.emit("animationStopped"),N=null}return K={active:!1,start:function($){if(P(),X.track.details){var H=0,M=X.track.details.position;w=0,D=0,V=$.map(function(te){var oe,ne=Number(M),ae=(oe=te.earlyExit)!==null&&oe!==void 0?oe:te.duration,re=te.easing,Ge=te.distance*re(ae/te.duration)||0;M+=Ge;var ue=D;return D+=ae,H+=Ge,[ne,te.distance,ue,D,te.duration,re]}),q(X.track.distToIdx(H)),j(),X.emit("animationStarted")}},stop:P,targetIdx:null}}function v(X){var K,w,D,V,z,N,L,Q,q,j,P,$,H,M,te=1/0,oe=[],ne=null,ae=0;function re(he){Qe(ae+he)}function Ge(he){var be=ue(ae+he).abs;return me(be)?be:null}function ue(he){var be=Math.floor(Math.abs(y(he/w))),se=y((he%w+w)%w);se===w&&(se=0);var pe=A(he),Ie=L.indexOf(f([],L).reduce(function(He,Me){return Math.abs(Me-se)<Math.abs(He-se)?Me:He})),ke=Ie;return pe<0&&be++,Ie===N&&(ke=0,be+=pe>0?1:-1),{abs:ke+be*N*pe,origin:Ie,rel:ke}}function Ae(he,be,se){var pe;if(be||!Ye())return ce(he,se);if(!me(he))return null;var Ie=ue(se??ae),ke=Ie.abs,He=he-Ie.rel,Me=ke+He;pe=ce(Me);var gg=ce(Me-N*A(He));return(gg!==null&&Math.abs(gg)<Math.abs(pe)||pe===null)&&(pe=gg),y(pe)}function ce(he,be){if(be==null&&(be=y(ae)),!me(he)||he===null)return null;he=Math.round(he);var se=ue(be),pe=se.abs,Ie=se.rel,ke=se.origin,He=xe(he),Me=(be%w+w)%w,gg=L[ke],Yg=Math.floor((he-(pe-Ie))/N)*w;return y(gg-Me-gg+L[He]+Yg+(ke===N?w:0))}function me(he){return Ke(he)===he}function Ke(he){return d(he,q,j)}function Ye(){return V.loop}function xe(he){return(he%N+N)%N}function Qe(he){var be;be=he-ae,oe.push({distance:be,timestamp:I()}),oe.length>6&&(oe=oe.slice(-6)),ae=y(he);var se=ye().abs;if(se!==ne){var pe=ne!==null;ne=se,pe&&X.emit("slideChanged")}}function ye(he){var be=he?null:function(){if(N){var se=Ye(),pe=se?(ae%w+w)%w:ae,Ie=(se?ae%w:ae)-z[0][2],ke=0-(Ie<0&&se?w-Math.abs(Ie):Ie),He=0,Me=ue(ae),gg=Me.abs,Yg=Me.rel,jg=z[Yg][2],rt=z.map(function(rg,De){var ag=ke+He;(ag<0-rg[0]||ag>1)&&(ag+=(Math.abs(ag)>w-1&&se?w:0)*A(-ag));var on=De-Yg,Dn=A(on),Re=on+gg;se&&(Dn===-1&&ag>jg&&(Re+=N),Dn===1&&ag<jg&&(Re-=N),P!==null&&Re<P&&(ag+=w),$!==null&&Re>$&&(ag-=w));var je=ag+rg[0]+rg[1],pg=Math.max(ag>=0&&je<=1?1:je<0||ag>1?0:ag<0?Math.min(1,(rg[0]+ag)/rg[0]):(1-ag)/rg[0],0);return He+=rg[0]+rg[1],{abs:Re,distance:V.rtl?-1*ag+1-rg[0]:ag,portion:pg,size:rg[0]}});return gg=Ke(gg),Yg=xe(gg),{abs:Ke(gg),length:D,max:M,maxIdx:j,min:H,minIdx:q,position:ae,progress:se?pe/w:ae/D,rel:Yg,slides:rt,slidesLength:w}}}();return K.details=be,X.emit("detailsChanged"),be}return K={absToRel:xe,add:re,details:null,distToIdx:Ge,idxToDist:Ae,init:function(he){if(function(){if(V=X.options,z=(V.trackConfig||[]).map(function(Ie){return[Z(Ie,"size",1),Z(Ie,"spacing",0),Z(Ie,"origin",0)]}),N=z.length){w=y(z.reduce(function(Ie,ke){return Ie+ke[0]+ke[1]},0));var se,pe=N-1;D=y(w+z[0][2]-z[pe][0]-z[pe][2]-z[pe][1]),L=z.reduce(function(Ie,ke){if(!Ie)return[0];var He=z[Ie.length-1],Me=Ie[Ie.length-1]+(He[0]+He[2])+He[1];return Me-=ke[2],Ie[Ie.length-1]>Me&&(Me=Ie[Ie.length-1]),Me=y(Me),Ie.push(Me),(!se||se<Me)&&(Q=Ie.length-1),se=Me,Ie},null),D===0&&(Q=0),L.push(y(w))}}(),!N)return ye(!0);var be;(function(){var se=X.options.range,pe=X.options.loop;P=q=pe?Z(pe,"min",-1/0):0,$=j=pe?Z(pe,"max",te):Q;var Ie=Z(se,"min",null),ke=Z(se,"max",null);Ie!==null&&(q=Ie),ke!==null&&(j=ke),H=q===-1/0?q:X.track.idxToDist(q||0,!0,0),M=j===te?j:Ae(j,!0,0),ke===null&&($=j),Z(se,"align",!1)&&j!==te&&z[xe(j)][2]===0&&(M-=1-z[xe(j)][0],j=Ge(M-ae)),H=y(H),M=y(M)})(),be=he,Number(be)===be?re(ce(Ke(he))):ye()},to:Qe,velocity:function(){var he=I(),be=oe.reduce(function(se,pe){var Ie=pe.distance,ke=pe.timestamp;return he-ke>200||(A(Ie)!==A(se.distance)&&se.distance&&(se={distance:0,lastTimestamp:0,time:0}),se.time&&(se.distance+=Ie),se.lastTimestamp&&(se.time+=ke-se.lastTimestamp),se.lastTimestamp=ke),se},{distance:0,lastTimestamp:0,time:0});return be.distance/be.time||0}}}function R(X){var K,w,D,V,z,N,L,Q;function q(ne){return 2*ne}function j(ne){return d(ne,L,Q)}function P(ne){return 1-Math.pow(1-ne,3)}function $(){return D?X.track.velocity():0}function H(){oe();var ne=X.options.mode==="free-snap",ae=X.track,re=$();V=A(re);var Ge=X.track.details,ue=[];if(re||!ne){var Ae=M(re),ce=Ae.dist,me=Ae.dur;if(me=q(me),ce*=V,ne){var Ke=ae.idxToDist(ae.distToIdx(ce),!0);Ke&&(ce=Ke)}ue.push({distance:ce,duration:me,easing:P});var Ye=Ge.position,xe=Ye+ce;if(xe<z||xe>N){var Qe=xe<z?z-Ye:N-Ye,ye=0,he=re;if(A(Qe)===V){var be=Math.min(Math.abs(Qe)/Math.abs(ce),1),se=function(ke){return 1-Math.pow(1-ke,1/3)}(be)*me;ue[0].earlyExit=se,he=re*(1-be)}else ue[0].earlyExit=0,ye+=Qe;var pe=M(he,100),Ie=pe.dist*V;X.options.rubberband&&(ue.push({distance:Ie,duration:q(pe.dur),easing:P}),ue.push({distance:-Ie+ye,duration:500,easing:P}))}X.animator.start(ue)}else X.moveToIdx(j(Ge.abs),!0,{duration:500,easing:function(ke){return 1+--ke*ke*ke*ke*ke}})}function M(ne,ae){ae===void 0&&(ae=1e3);var re=147e-9+(ne=Math.abs(ne))/ae;return{dist:Math.pow(ne,2)/re,dur:ne/re}}function te(){var ne=X.track.details;ne&&(z=ne.min,N=ne.max,L=ne.minIdx,Q=ne.maxIdx)}function oe(){X.animator.stop()}X.on("updated",te),X.on("optionsChanged",te),X.on("created",te),X.on("dragStarted",function(){D=!1,oe(),K=w=X.track.details.abs}),X.on("dragChecked",function(){D=!0}),X.on("dragEnded",function(){var ne=X.options.mode;ne==="snap"&&function(){var ae=X.track,re=X.track.details,Ge=re.position,ue=A($());(Ge>N||Ge<z)&&(ue=0);var Ae=K+ue;re.slides[ae.absToRel(Ae)].portion===0&&(Ae-=ue),K!==w&&(Ae=w),A(ae.idxToDist(Ae,!0))!==ue&&(Ae+=ue),Ae=j(Ae);var ce=ae.idxToDist(Ae,!0);X.animator.start([{distance:ce,duration:500,easing:function(me){return 1+--me*me*me*me*me}}])}(),ne!=="free"&&ne!=="free-snap"||H()}),X.on("dragged",function(){w=X.track.details.abs})}function k(X){var K,w,D,V,z,N,L,Q,q,j,P,$,H,M,te,oe,ne,ae,re=c();function Ge(ye){if(N&&Q===ye.id){var he=me(ye);if(q){if(!ce(ye))return Ae(ye);j=he,q=!1,X.emit("dragChecked")}if(oe)return j=he;s(ye);var be=function(pe){if(ne===-1/0&&ae===1/0)return pe;var Ie=X.track.details,ke=Ie.length,He=Ie.position,Me=d(pe,ne-He,ae-He);if(ke===0)return 0;if(!X.options.rubberband)return Me;if(He<=ae&&He>=ne||He<ne&&w>0||He>ae&&w<0)return pe;var gg=(He<ne?He-ne:He-ae)/ke,Yg=V*ke,jg=Math.abs(gg*Yg),rt=Math.max(0,1-jg/z*2);return rt*rt*pe}(L(j-he)/V*D);w=A(be);var se=X.track.details.position;(se>ne&&se<ae||se===ne&&w>0||se===ae&&w<0)&&r(ye),P+=be,!$&&Math.abs(P*V)>5&&($=!0),X.track.add(be),j=he,X.emit("dragged")}}function ue(ye){!N&&X.track.details&&X.track.details.length&&(P=0,N=!0,$=!1,q=!0,Q=ye.id,ce(ye),j=me(ye),X.emit("dragStarted"))}function Ae(ye){N&&Q===ye.idChanged&&(N=!1,X.emit("dragEnded"))}function ce(ye){var he=Ke(),be=he?ye.y:ye.x,se=he?ye.x:ye.y,pe=H!==void 0&&M!==void 0&&Math.abs(M-se)<=Math.abs(H-be);return H=be,M=se,pe}function me(ye){return Ke()?ye.y:ye.x}function Ke(){return X.options.vertical}function Ye(){V=X.size,z=Ke()?window.innerHeight:window.innerWidth;var ye=X.track.details;ye&&(ne=ye.min,ae=ye.max)}function xe(ye){$&&(r(ye),s(ye))}function Qe(){if(re.purge(),X.options.drag&&!X.options.disabled){var ye;ye=X.options.dragSpeed||1,L=typeof ye=="function"?ye:function(be){return be*ye},D=X.options.rtl?-1:1,Ye(),K=X.container,function(){var be="data-keen-slider-clickable";C("[".concat(be,"]:not([").concat(be,"=false])"),K).map(function(se){re.add(se,"dragstart",r),re.add(se,"mousedown",r),re.add(se,"touchstart",r)})}(),re.add(K,"dragstart",function(be){s(be)}),re.add(K,"click",xe,{capture:!0}),re.input(K,"ksDragStart",ue),re.input(K,"ksDrag",Ge),re.input(K,"ksDragEnd",Ae),re.input(K,"mousedown",ue),re.input(K,"mousemove",Ge),re.input(K,"mouseleave",Ae),re.input(K,"mouseup",Ae),re.input(K,"touchstart",ue,{passive:!0}),re.input(K,"touchmove",Ge,{passive:!1}),re.input(K,"touchend",Ae),re.input(K,"touchcancel",Ae),re.add(window,"wheel",function(be){N&&s(be)});var he="data-keen-slider-scrollable";C("[".concat(he,"]:not([").concat(he,"=false])"),X.container).map(function(be){return function(se){var pe;re.input(se,"touchstart",function(Ie){pe=me(Ie),oe=!0,te=!0},{passive:!0}),re.input(se,"touchmove",function(Ie){var ke=Ke(),He=ke?se.scrollHeight-se.clientHeight:se.scrollWidth-se.clientWidth,Me=pe-me(Ie),gg=ke?se.scrollTop:se.scrollLeft,Yg=ke&&se.style.overflowY==="scroll"||!ke&&se.style.overflowX==="scroll";if(pe=me(Ie),(Me<0&&gg>0||Me>0&&gg<He)&&te&&Yg)return oe=!0;te=!1,s(Ie),oe=!1}),re.input(se,"touchend",function(){oe=!1})}(be)})}}X.on("updated",Ye),X.on("optionsChanged",Qe),X.on("created",Qe),X.on("destroyed",re.purge)}function J(X){var K,w,D=null;function V(H,M,te){X.animator.active?N(H,M,te):requestAnimationFrame(function(){return N(H,M,te)})}function z(){V(!1,!1,w)}function N(H,M,te){var oe=0,ne=X.size,ae=X.track.details;if(ae&&K){var re=ae.slides;K.forEach(function(Ge,ue){if(H)!D&&M&&Q(Ge,null,te),q(Ge,null,te);else{if(!re[ue])return;var Ae=re[ue].size*ne;!D&&M&&Q(Ge,Ae,te),q(Ge,re[ue].distance*ne-oe,te),oe+=Ae}})}}function L(H){return X.options.renderMode==="performance"?Math.round(H):H}function Q(H,M,te){var oe=te?"height":"width";M!==null&&(M=L(M)+"px"),H.style["min-"+oe]=M,H.style["max-"+oe]=M}function q(H,M,te){if(M!==null){M=L(M);var oe=te?M:0;M="translate3d(".concat(te?0:M,"px, ").concat(oe,"px, 0)")}H.style.transform=M,H.style["-webkit-transform"]=M}function j(){K&&(N(!0,!0,w),K=null),X.on("detailsChanged",z,!0)}function P(){V(!1,!0,w)}function $(){j(),w=X.options.vertical,X.options.disabled||X.options.renderMode==="custom"||(D=Z(X.options.slides,"perView",null)==="auto",X.on("detailsChanged",z),(K=X.slides).length&&P())}X.on("created",$),X.on("optionsChanged",$),X.on("beforeOptionsChanged",function(){j()}),X.on("updated",P),X.on("destroyed",j)}function F(X,K){return function(w){var D,V,z,N,L,Q=c();function q(ce){var me;o(w.container,"reverse",(me=w.container,window.getComputedStyle(me,null).getPropertyValue("direction")!=="rtl"||ce?null:"")),o(w.container,"v",w.options.vertical&&!ce?"":null),o(w.container,"disabled",w.options.disabled&&!ce?"":null)}function j(){P()&&oe()}function P(){var ce=null;if(N.forEach(function(Ke){Ke.matches&&(ce=Ke.__media)}),ce===D)return!1;D||w.emit("beforeOptionsChanged"),D=ce;var me=ce?z.breakpoints[ce]:z;return w.options=B(B({},z),me),q(),ue(),Ae(),ae(),!0}function $(ce){var me=m(ce);return(w.options.vertical?me.height:me.width)/w.size||1}function H(){return w.options.trackConfig.length}function M(ce){for(var me in D=!1,z=B(B({},K),ce),Q.purge(),V=w.size,N=[],z.breakpoints||[]){var Ke=window.matchMedia(me);Ke.__media=me,N.push(Ke),Q.add(Ke,"change",j)}Q.add(window,"orientationchange",Ge),Q.add(window,"resize",re),P()}function te(ce){w.animator.stop();var me=w.track.details;w.track.init(ce??(me?me.abs:0))}function oe(ce){te(ce),w.emit("optionsChanged")}function ne(ce,me){if(ce)return M(ce),void oe(me);ue(),Ae();var Ke=H();ae(),H()!==Ke?oe(me):te(me),w.emit("updated")}function ae(){var ce=w.options.slides;if(typeof ce=="function")return w.options.trackConfig=ce(w.size,w.slides);for(var me=w.slides,Ke=me.length,Ye=typeof ce=="number"?ce:Z(ce,"number",Ke,!0),xe=[],Qe=Z(ce,"perView",1,!0),ye=Z(ce,"spacing",0,!0)/w.size||0,he=Qe==="auto"?ye:ye/Qe,be=Z(ce,"origin","auto"),se=0,pe=0;pe<Ye;pe++){var Ie=Qe==="auto"?$(me[pe]):1/Qe-ye+he,ke=be==="center"?.5-Ie/2:be==="auto"?0:be;xe.push({origin:ke,size:Ie,spacing:ye}),se+=Ie}if(se+=ye*(Ye-1),be==="auto"&&!w.options.loop&&Qe!==1){var He=0;xe.map(function(Me){var gg=se-He;return He+=Me.size+ye,gg>=1||(Me.origin=1-gg-(se>1?0:1-se)),Me})}w.options.trackConfig=xe}function re(){ue();var ce=w.size;w.options.disabled||ce===V||(V=ce,ne())}function Ge(){re(),setTimeout(re,500),setTimeout(re,2e3)}function ue(){var ce=m(w.container);w.size=(w.options.vertical?ce.height:ce.width)||1}function Ae(){w.slides=C(w.options.selector,w.container)}w.container=(L=C(X,document)).length?L[0]:null,w.destroy=function(){Q.purge(),w.emit("destroyed"),q(!0)},w.prev=function(){w.moveToIdx(w.track.details.abs-1,!0)},w.next=function(){w.moveToIdx(w.track.details.abs+1,!0)},w.update=ne,M(w.options)}}var U=function(X,K,w){try{return function(D,V){var z,N={};return z={emit:function(L){N[L]&&N[L].forEach(function(q){q(z)});var Q=z.options&&z.options[L];Q&&Q(z)},moveToIdx:function(L,Q,q){var j=z.track.idxToDist(L,Q);if(j){var P=z.options.defaultAnimation;z.animator.start([{distance:j,duration:Z(q||P,"duration",500),easing:Z(q||P,"easing",function($){return 1+--$*$*$*$*$})}])}},on:function(L,Q,q){q===void 0&&(q=!1),N[L]||(N[L]=[]);var j=N[L].indexOf(Q);j>-1?q&&delete N[L][j]:q||N[L].push(Q)},options:D},function(){if(z.track=v(z),z.animator=W(z),V)for(var L=0,Q=V;L<Q.length;L++)(0,Q[L])(z);z.track.init(z.options.initial||0),z.emit("created")}(),z}(K,f([F(X,{drag:!0,mode:"snap",renderMode:"precision",rubberband:!0,selector:".keen-slider__slide"}),J,k,R],w||[],!0))}catch(D){console.error(D)}};return As.useKeenSlider=function(X,K){var w=e.useRef(null),D=e.useRef(!1),V=e.useRef(X),z=e.useCallback(function(N){N?(V.current=X,w.current=new U(N,X,K),D.current=!1):(w.current&&w.current.destroy&&w.current.destroy(),w.current=null)},[]);return e.useEffect(function(){G(V.current,X)||(V.current=X,w.current&&w.current.update(V.current))},[X]),[z,w]},As}var EH=xH();const zH="https://pilot-hestia-backend.onrender.com",MH=({id:e})=>{const[g,t]=b.useState([]),[I,o]=b.useState(0);b.useEffect(()=>{e&&(async()=>{try{const c=await We.get(`${zH}/api/rewards/${e}`);t(c?.data),console.log(g[0])}catch{console.error("Could't get rewards")}})()},[e]),b.useEffect(()=>{g.length>0&&o(r=>r+1)},[g]);const C=r=>{function d(){const A=360*r.track.details.progress;r.container.style.transform=`translateZ(-300px) rotateY(${-A}deg)`}r.on("created",()=>{const A=360/r.slides.length;r.slides.forEach((m,Z)=>{m.style.transform=`rotateY(${A*Z}deg) translateZ(300px)`}),d()}),r.on("detailsChanged",d)},[s]=EH.useKeenSlider({loop:!0,selector:".carousel__cell",renderMode:"custom",mode:"free-snap"},[C]);return p.jsx(p.Fragment,{children:g.length>0?p.jsx("div",{className:"wrapper",children:p.jsx("div",{className:"scene",children:p.jsx("div",{className:"carousel keen-slider",ref:s,children:g.filter(r=>r?.img).slice(0,6).map((r,c)=>p.jsx("div",{className:`carousel__cell number-slide${c+1}`,children:p.jsx(KH,{rewardId:r.id,rewardImg:r.img,rewardTitle:r.title,rewardPrice:r.cost})},r.id))},I)})}):p.jsx("p",{children:"Loading rewards..."})})},gu=b.createContext(),UH=""+new URL("HeaderBackground-D5cTHpi2.jpeg",import.meta.url).href,Uy=b.createContext({});function LH(e){const g=b.useRef(null);return g.current===null&&(g.current=e()),g.current}const tu=typeof window<"u",TH=tu?b.useLayoutEffect:b.useEffect,nu=b.createContext(null);function Iu(e,g){e.indexOf(g)===-1&&e.push(g)}function lu(e,g){const t=e.indexOf(g);t>-1&&e.splice(t,1)}const Un=(e,g,t)=>t>g?g:t<e?e:t;let ou=()=>{};const Ln={},Ly=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Ty(e){return typeof e=="object"&&e!==null}const Qy=e=>/^0[^.\s]+$/u.test(e);function Cu(e){let g;return()=>(g===void 0&&(g=e()),g)}const Ut=e=>e,QH=(e,g)=>t=>g(e(t)),OC=(...e)=>e.reduce(QH),WC=(e,g,t)=>{const I=g-e;return I===0?1:(t-e)/I};class iu{constructor(){this.subscriptions=[]}add(g){return Iu(this.subscriptions,g),()=>lu(this.subscriptions,g)}notify(g,t,I){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](g,t,I);else for(let C=0;C<o;C++){const s=this.subscriptions[C];s&&s(g,t,I)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Gn=e=>e*1e3,yn=e=>e/1e3;function Dy(e,g){return g?e*(1e3/g):0}const jy=(e,g,t)=>(((1-3*t+3*g)*e+(3*t-6*g))*e+3*g)*e,DH=1e-7,jH=12;function PH(e,g,t,I,o){let C,s,r=0;do s=g+(t-g)/2,C=jy(s,I,o)-e,C>0?t=s:g=s;while(Math.abs(C)>DH&&++r<jH);return s}function qC(e,g,t,I){if(e===g&&t===I)return Ut;const o=C=>PH(C,0,1,e,t);return C=>C===0||C===1?C:jy(o(C),g,I)}const Py=e=>g=>g<=.5?e(2*g)/2:(2-e(2*(1-g)))/2,Oy=e=>g=>1-e(1-g),qy=qC(.33,1.53,.69,.99),su=Oy(qy),_y=Py(su),$y=e=>(e*=2)<1?.5*su(e):.5*(2-Math.pow(2,-10*(e-1))),ru=e=>1-Math.sin(Math.acos(e)),eB=Oy(ru),gB=Py(ru),OH=qC(.42,0,1,1),qH=qC(0,0,.58,1),tB=qC(.42,0,.58,1),_H=e=>Array.isArray(e)&&typeof e[0]!="number",nB=e=>Array.isArray(e)&&typeof e[0]=="number",$H={linear:Ut,easeIn:OH,easeInOut:tB,easeOut:qH,circIn:ru,circInOut:gB,circOut:eB,backIn:su,backInOut:_y,backOut:qy,anticipate:$y},ew=e=>typeof e=="string",cb=e=>{if(nB(e)){ou(e.length===4);const[g,t,I,o]=e;return qC(g,t,I,o)}else if(ew(e))return $H[e];return e},us=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],db={value:null};function gw(e,g){let t=new Set,I=new Set,o=!1,C=!1;const s=new WeakSet;let r={delta:0,timestamp:0,isProcessing:!1},c=0;function d(m){s.has(m)&&(A.schedule(m),e()),c++,m(r)}const A={schedule:(m,Z=!1,y=!1)=>{const B=y&&o?t:I;return Z&&s.add(m),B.has(m)||B.add(m),m},cancel:m=>{I.delete(m),s.delete(m)},process:m=>{if(r=m,o){C=!0;return}o=!0,[t,I]=[I,t],t.forEach(d),g&&db.value&&db.value.frameloop[g].push(c),c=0,t.clear(),o=!1,C&&(C=!1,A.process(m))}};return A}const tw=40;function IB(e,g){let t=!1,I=!0;const o={delta:0,timestamp:0,isProcessing:!1},C=()=>t=!0,s=us.reduce((R,k)=>(R[k]=gw(C,g?k:void 0),R),{}),{setup:r,read:c,resolveKeyframes:d,preUpdate:A,update:m,preRender:Z,render:y,postRender:G}=s,B=()=>{const R=Ln.useManualTiming?o.timestamp:performance.now();t=!1,Ln.useManualTiming||(o.delta=I?1e3/60:Math.max(Math.min(R-o.timestamp,tw),1)),o.timestamp=R,o.isProcessing=!0,r.process(o),c.process(o),d.process(o),A.process(o),m.process(o),Z.process(o),y.process(o),G.process(o),o.isProcessing=!1,t&&g&&(I=!1,e(B))},f=()=>{t=!0,I=!0,o.isProcessing||e(B)};return{schedule:us.reduce((R,k)=>{const J=s[k];return R[k]=(F,U=!1,X=!1)=>(t||f(),J.schedule(F,U,X)),R},{}),cancel:R=>{for(let k=0;k<us.length;k++)s[us[k]].cancel(R)},state:o,steps:s}}const{schedule:hg,cancel:bI,state:Qg,steps:ld}=IB(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ut,!0);let ws;function nw(){ws=void 0}const pt={now:()=>(ws===void 0&&pt.set(Qg.isProcessing||Ln.useManualTiming?Qg.timestamp:performance.now()),ws),set:e=>{ws=e,queueMicrotask(nw)}},lB=e=>g=>typeof g=="string"&&g.startsWith(e),au=lB("--"),Iw=lB("var(--"),cu=e=>Iw(e)?lw.test(e.split("/*")[0].trim()):!1,lw=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,to={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},RC={...to,transform:e=>Un(0,1,e)},ms={...to,default:1},dC=e=>Math.round(e*1e5)/1e5,du=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function ow(e){return e==null}const Cw=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Au=(e,g)=>t=>!!(typeof t=="string"&&Cw.test(t)&&t.startsWith(e)||g&&!ow(t)&&Object.prototype.hasOwnProperty.call(t,g)),oB=(e,g,t)=>I=>{if(typeof I!="string")return I;const[o,C,s,r]=I.match(du);return{[e]:parseFloat(o),[g]:parseFloat(C),[t]:parseFloat(s),alpha:r!==void 0?parseFloat(r):1}},iw=e=>Un(0,255,e),od={...to,transform:e=>Math.round(iw(e))},DI={test:Au("rgb","red"),parse:oB("red","green","blue"),transform:({red:e,green:g,blue:t,alpha:I=1})=>"rgba("+od.transform(e)+", "+od.transform(g)+", "+od.transform(t)+", "+dC(RC.transform(I))+")"};function sw(e){let g="",t="",I="",o="";return e.length>5?(g=e.substring(1,3),t=e.substring(3,5),I=e.substring(5,7),o=e.substring(7,9)):(g=e.substring(1,2),t=e.substring(2,3),I=e.substring(3,4),o=e.substring(4,5),g+=g,t+=t,I+=I,o+=o),{red:parseInt(g,16),green:parseInt(t,16),blue:parseInt(I,16),alpha:o?parseInt(o,16)/255:1}}const qd={test:Au("#"),parse:sw,transform:DI.transform},_C=e=>({test:g=>typeof g=="string"&&g.endsWith(e)&&g.split(" ").length===1,parse:parseFloat,transform:g=>`${g}${e}`}),uI=_C("deg"),Bn=_C("%"),we=_C("px"),rw=_C("vh"),aw=_C("vw"),Ab={...Bn,parse:e=>Bn.parse(e)/100,transform:e=>Bn.transform(e*100)},Kl={test:Au("hsl","hue"),parse:oB("hue","saturation","lightness"),transform:({hue:e,saturation:g,lightness:t,alpha:I=1})=>"hsla("+Math.round(e)+", "+Bn.transform(dC(g))+", "+Bn.transform(dC(t))+", "+dC(RC.transform(I))+")"},wg={test:e=>DI.test(e)||qd.test(e)||Kl.test(e),parse:e=>DI.test(e)?DI.parse(e):Kl.test(e)?Kl.parse(e):qd.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?DI.transform(e):Kl.transform(e),getAnimatableNone:e=>{const g=wg.parse(e);return g.alpha=0,wg.transform(g)}},cw=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function dw(e){return isNaN(e)&&typeof e=="string"&&(e.match(du)?.length||0)+(e.match(cw)?.length||0)>0}const CB="number",iB="color",Aw="var",uw="var(",ub="${}",mw=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function XC(e){const g=e.toString(),t=[],I={color:[],number:[],var:[]},o=[];let C=0;const r=g.replace(mw,c=>(wg.test(c)?(I.color.push(C),o.push(iB),t.push(wg.parse(c))):c.startsWith(uw)?(I.var.push(C),o.push(Aw),t.push(c)):(I.number.push(C),o.push(CB),t.push(parseFloat(c))),++C,ub)).split(ub);return{values:t,split:r,indexes:I,types:o}}function sB(e){return XC(e).values}function rB(e){const{split:g,types:t}=XC(e),I=g.length;return o=>{let C="";for(let s=0;s<I;s++)if(C+=g[s],o[s]!==void 0){const r=t[s];r===CB?C+=dC(o[s]):r===iB?C+=wg.transform(o[s]):C+=o[s]}return C}}const hw=e=>typeof e=="number"?0:wg.test(e)?wg.getAnimatableNone(e):e;function pw(e){const g=sB(e);return rB(e)(g.map(hw))}const GI={test:dw,parse:sB,createTransformer:rB,getAnimatableNone:pw};function Cd(e,g,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+(g-e)*6*t:t<1/2?g:t<2/3?e+(g-e)*(2/3-t)*6:e}function Zw({hue:e,saturation:g,lightness:t,alpha:I}){e/=360,g/=100,t/=100;let o=0,C=0,s=0;if(!g)o=C=s=t;else{const r=t<.5?t*(1+g):t+g-t*g,c=2*t-r;o=Cd(c,r,e+1/3),C=Cd(c,r,e),s=Cd(c,r,e-1/3)}return{red:Math.round(o*255),green:Math.round(C*255),blue:Math.round(s*255),alpha:I}}function er(e,g){return t=>t>0?g:e}const Gg=(e,g,t)=>e+(g-e)*t,id=(e,g,t)=>{const I=e*e,o=t*(g*g-I)+I;return o<0?0:Math.sqrt(o)},bw=[qd,DI,Kl],Gw=e=>bw.find(g=>g.test(e));function mb(e){const g=Gw(e);if(!g)return!1;let t=g.parse(e);return g===Kl&&(t=Zw(t)),t}const hb=(e,g)=>{const t=mb(e),I=mb(g);if(!t||!I)return er(e,g);const o={...t};return C=>(o.red=id(t.red,I.red,C),o.green=id(t.green,I.green,C),o.blue=id(t.blue,I.blue,C),o.alpha=Gg(t.alpha,I.alpha,C),DI.transform(o))},_d=new Set(["none","hidden"]);function yw(e,g){return _d.has(e)?t=>t<=0?e:g:t=>t>=1?g:e}function Bw(e,g){return t=>Gg(e,g,t)}function uu(e){return typeof e=="number"?Bw:typeof e=="string"?cu(e)?er:wg.test(e)?hb:Vw:Array.isArray(e)?aB:typeof e=="object"?wg.test(e)?hb:fw:er}function aB(e,g){const t=[...e],I=t.length,o=e.map((C,s)=>uu(C)(C,g[s]));return C=>{for(let s=0;s<I;s++)t[s]=o[s](C);return t}}function fw(e,g){const t={...e,...g},I={};for(const o in t)e[o]!==void 0&&g[o]!==void 0&&(I[o]=uu(e[o])(e[o],g[o]));return o=>{for(const C in I)t[C]=I[C](o);return t}}function Sw(e,g){const t=[],I={color:0,var:0,number:0};for(let o=0;o<g.values.length;o++){const C=g.types[o],s=e.indexes[C][I[C]],r=e.values[s]??0;t[o]=r,I[C]++}return t}const Vw=(e,g)=>{const t=GI.createTransformer(g),I=XC(e),o=XC(g);return I.indexes.var.length===o.indexes.var.length&&I.indexes.color.length===o.indexes.color.length&&I.indexes.number.length>=o.indexes.number.length?_d.has(e)&&!o.values.length||_d.has(g)&&!I.values.length?yw(e,g):OC(aB(Sw(I,o),o.values),t):er(e,g)};function cB(e,g,t){return typeof e=="number"&&typeof g=="number"&&typeof t=="number"?Gg(e,g,t):uu(e)(e,g)}const Ww=e=>{const g=({timestamp:t})=>e(t);return{start:(t=!0)=>hg.update(g,t),stop:()=>bI(g),now:()=>Qg.isProcessing?Qg.timestamp:pt.now()}},dB=(e,g,t=10)=>{let I="";const o=Math.max(Math.round(g/t),2);for(let C=0;C<o;C++)I+=Math.round(e(C/(o-1))*1e4)/1e4+", ";return`linear(${I.substring(0,I.length-2)})`},gr=2e4;function mu(e){let g=0;const t=50;let I=e.next(g);for(;!I.done&&g<gr;)g+=t,I=e.next(g);return g>=gr?1/0:g}function Rw(e,g=100,t){const I=t({...e,keyframes:[0,g]}),o=Math.min(mu(I),gr);return{type:"keyframes",ease:C=>I.next(o*C).value/g,duration:yn(o)}}const Xw=5;function AB(e,g,t){const I=Math.max(g-Xw,0);return Dy(t-e(I),g-I)}const Wg={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},sd=.001;function kw({duration:e=Wg.duration,bounce:g=Wg.bounce,velocity:t=Wg.velocity,mass:I=Wg.mass}){let o,C,s=1-g;s=Un(Wg.minDamping,Wg.maxDamping,s),e=Un(Wg.minDuration,Wg.maxDuration,yn(e)),s<1?(o=d=>{const A=d*s,m=A*e,Z=A-t,y=$d(d,s),G=Math.exp(-m);return sd-Z/y*G},C=d=>{const m=d*s*e,Z=m*t+t,y=Math.pow(s,2)*Math.pow(d,2)*e,G=Math.exp(-m),B=$d(Math.pow(d,2),s);return(-o(d)+sd>0?-1:1)*((Z-y)*G)/B}):(o=d=>{const A=Math.exp(-d*e),m=(d-t)*e+1;return-sd+A*m},C=d=>{const A=Math.exp(-d*e),m=(t-d)*(e*e);return A*m});const r=5/e,c=vw(o,C,r);if(e=Gn(e),isNaN(c))return{stiffness:Wg.stiffness,damping:Wg.damping,duration:e};{const d=Math.pow(c,2)*I;return{stiffness:d,damping:s*2*Math.sqrt(I*d),duration:e}}}const Jw=12;function vw(e,g,t){let I=t;for(let o=1;o<Jw;o++)I=I-e(I)/g(I);return I}function $d(e,g){return e*Math.sqrt(1-g*g)}const Yw=["duration","bounce"],Hw=["stiffness","damping","mass"];function pb(e,g){return g.some(t=>e[t]!==void 0)}function ww(e){let g={velocity:Wg.velocity,stiffness:Wg.stiffness,damping:Wg.damping,mass:Wg.mass,isResolvedFromDuration:!1,...e};if(!pb(e,Hw)&&pb(e,Yw))if(e.visualDuration){const t=e.visualDuration,I=2*Math.PI/(t*1.2),o=I*I,C=2*Un(.05,1,1-(e.bounce||0))*Math.sqrt(o);g={...g,mass:Wg.mass,stiffness:o,damping:C}}else{const t=kw(e);g={...g,...t,mass:Wg.mass},g.isResolvedFromDuration=!0}return g}function tr(e=Wg.visualDuration,g=Wg.bounce){const t=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:g}:e;let{restSpeed:I,restDelta:o}=t;const C=t.keyframes[0],s=t.keyframes[t.keyframes.length-1],r={done:!1,value:C},{stiffness:c,damping:d,mass:A,duration:m,velocity:Z,isResolvedFromDuration:y}=ww({...t,velocity:-yn(t.velocity||0)}),G=Z||0,B=d/(2*Math.sqrt(c*A)),f=s-C,W=yn(Math.sqrt(c/A)),v=Math.abs(f)<5;I||(I=v?Wg.restSpeed.granular:Wg.restSpeed.default),o||(o=v?Wg.restDelta.granular:Wg.restDelta.default);let R;if(B<1){const J=$d(W,B);R=F=>{const U=Math.exp(-B*W*F);return s-U*((G+B*W*f)/J*Math.sin(J*F)+f*Math.cos(J*F))}}else if(B===1)R=J=>s-Math.exp(-W*J)*(f+(G+W*f)*J);else{const J=W*Math.sqrt(B*B-1);R=F=>{const U=Math.exp(-B*W*F),X=Math.min(J*F,300);return s-U*((G+B*W*f)*Math.sinh(X)+J*f*Math.cosh(X))/J}}const k={calculatedDuration:y&&m||null,next:J=>{const F=R(J);if(y)r.done=J>=m;else{let U=J===0?G:0;B<1&&(U=J===0?Gn(G):AB(R,J,F));const X=Math.abs(U)<=I,K=Math.abs(s-F)<=o;r.done=X&&K}return r.value=r.done?s:F,r},toString:()=>{const J=Math.min(mu(k),gr),F=dB(U=>k.next(J*U).value,J,30);return J+"ms "+F},toTransition:()=>{}};return k}tr.applyToOptions=e=>{const g=Rw(e,100,tr);return e.ease=g.ease,e.duration=Gn(g.duration),e.type="keyframes",e};function eA({keyframes:e,velocity:g=0,power:t=.8,timeConstant:I=325,bounceDamping:o=10,bounceStiffness:C=500,modifyTarget:s,min:r,max:c,restDelta:d=.5,restSpeed:A}){const m=e[0],Z={done:!1,value:m},y=X=>r!==void 0&&X<r||c!==void 0&&X>c,G=X=>r===void 0?c:c===void 0||Math.abs(r-X)<Math.abs(c-X)?r:c;let B=t*g;const f=m+B,W=s===void 0?f:s(f);W!==f&&(B=W-m);const v=X=>-B*Math.exp(-X/I),R=X=>W+v(X),k=X=>{const K=v(X),w=R(X);Z.done=Math.abs(K)<=d,Z.value=Z.done?W:w};let J,F;const U=X=>{y(Z.value)&&(J=X,F=tr({keyframes:[Z.value,G(Z.value)],velocity:AB(R,X,Z.value),damping:o,stiffness:C,restDelta:d,restSpeed:A}))};return U(0),{calculatedDuration:null,next:X=>{let K=!1;return!F&&J===void 0&&(K=!0,k(X),U(X)),J!==void 0&&X>=J?F.next(X-J):(!K&&k(X),Z)}}}function Fw(e,g,t){const I=[],o=t||Ln.mix||cB,C=e.length-1;for(let s=0;s<C;s++){let r=o(e[s],e[s+1]);if(g){const c=Array.isArray(g)?g[s]||Ut:g;r=OC(c,r)}I.push(r)}return I}function Kw(e,g,{clamp:t=!0,ease:I,mixer:o}={}){const C=e.length;if(ou(C===g.length),C===1)return()=>g[0];if(C===2&&g[0]===g[1])return()=>g[1];const s=e[0]===e[1];e[0]>e[C-1]&&(e=[...e].reverse(),g=[...g].reverse());const r=Fw(g,I,o),c=r.length,d=A=>{if(s&&A<e[0])return g[0];let m=0;if(c>1)for(;m<e.length-2&&!(A<e[m+1]);m++);const Z=WC(e[m],e[m+1],A);return r[m](Z)};return t?A=>d(Un(e[0],e[C-1],A)):d}function Nw(e,g){const t=e[e.length-1];for(let I=1;I<=g;I++){const o=WC(0,g,I);e.push(Gg(t,1,o))}}function xw(e){const g=[0];return Nw(g,e.length-1),g}function Ew(e,g){return e.map(t=>t*g)}function zw(e,g){return e.map(()=>g||tB).splice(0,e.length-1)}function AC({duration:e=300,keyframes:g,times:t,ease:I="easeInOut"}){const o=_H(I)?I.map(cb):cb(I),C={done:!1,value:g[0]},s=Ew(t&&t.length===g.length?t:xw(g),e),r=Kw(s,g,{ease:Array.isArray(o)?o:zw(g,o)});return{calculatedDuration:e,next:c=>(C.value=r(c),C.done=c>=e,C)}}const Mw=e=>e!==null;function hu(e,{repeat:g,repeatType:t="loop"},I,o=1){const C=e.filter(Mw),r=o<0||g&&t!=="loop"&&g%2===1?0:C.length-1;return!r||I===void 0?C[r]:I}const Uw={decay:eA,inertia:eA,tween:AC,keyframes:AC,spring:tr};function uB(e){typeof e.type=="string"&&(e.type=Uw[e.type])}class pu{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(g=>{this.resolve=g})}notifyFinished(){this.resolve()}then(g,t){return this.finished.then(g,t)}}const Lw=e=>e/100;class Zu extends pu{constructor(g){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==pt.now()&&this.tick(pt.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=g,this.initAnimation(),this.play(),g.autoplay===!1&&this.pause()}initAnimation(){const{options:g}=this;uB(g);const{type:t=AC,repeat:I=0,repeatDelay:o=0,repeatType:C,velocity:s=0}=g;let{keyframes:r}=g;const c=t||AC;c!==AC&&typeof r[0]!="number"&&(this.mixKeyframes=OC(Lw,cB(r[0],r[1])),r=[0,100]);const d=c({...g,keyframes:r});C==="mirror"&&(this.mirroredGenerator=c({...g,keyframes:[...r].reverse(),velocity:-s})),d.calculatedDuration===null&&(d.calculatedDuration=mu(d));const{calculatedDuration:A}=d;this.calculatedDuration=A,this.resolvedDuration=A+o,this.totalDuration=this.resolvedDuration*(I+1)-o,this.generator=d}updateTime(g){const t=Math.round(g-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(g,t=!1){const{generator:I,totalDuration:o,mixKeyframes:C,mirroredGenerator:s,resolvedDuration:r,calculatedDuration:c}=this;if(this.startTime===null)return I.next(0);const{delay:d=0,keyframes:A,repeat:m,repeatType:Z,repeatDelay:y,type:G,onUpdate:B,finalKeyframe:f}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,g):this.speed<0&&(this.startTime=Math.min(g-o/this.speed,this.startTime)),t?this.currentTime=g:this.updateTime(g);const W=this.currentTime-d*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?W<0:W>o;this.currentTime=Math.max(W,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let R=this.currentTime,k=I;if(m){const X=Math.min(this.currentTime,o)/r;let K=Math.floor(X),w=X%1;!w&&X>=1&&(w=1),w===1&&K--,K=Math.min(K,m+1),!!(K%2)&&(Z==="reverse"?(w=1-w,y&&(w-=y/r)):Z==="mirror"&&(k=s)),R=Un(0,1,w)*r}const J=v?{done:!1,value:A[0]}:k.next(R);C&&(J.value=C(J.value));let{done:F}=J;!v&&c!==null&&(F=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const U=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&F);return U&&G!==eA&&(J.value=hu(A,this.options,f,this.speed)),B&&B(J.value),U&&this.finish(),J}then(g,t){return this.finished.then(g,t)}get duration(){return yn(this.calculatedDuration)}get time(){return yn(this.currentTime)}set time(g){g=Gn(g),this.currentTime=g,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=g:this.driver&&(this.startTime=this.driver.now()-g/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(g){this.updateTime(pt.now());const t=this.playbackSpeed!==g;this.playbackSpeed=g,t&&(this.time=yn(this.currentTime))}play(){if(this.isStopped)return;const{driver:g=Ww,startTime:t}=this.options;this.driver||(this.driver=g(o=>this.tick(o))),this.options.onPlay?.();const I=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=I):this.holdTime!==null?this.startTime=I-this.holdTime:this.startTime||(this.startTime=t??I),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(pt.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(g){return this.startTime=0,this.tick(g,!0)}attachTimeline(g){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),g.observe(this)}}function Tw(e){for(let g=1;g<e.length;g++)e[g]??(e[g]=e[g-1])}const jI=e=>e*180/Math.PI,gA=e=>{const g=jI(Math.atan2(e[1],e[0]));return tA(g)},Qw={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:gA,rotateZ:gA,skewX:e=>jI(Math.atan(e[1])),skewY:e=>jI(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},tA=e=>(e=e%360,e<0&&(e+=360),e),Zb=gA,bb=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Gb=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Dw={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:bb,scaleY:Gb,scale:e=>(bb(e)+Gb(e))/2,rotateX:e=>tA(jI(Math.atan2(e[6],e[5]))),rotateY:e=>tA(jI(Math.atan2(-e[2],e[0]))),rotateZ:Zb,rotate:Zb,skewX:e=>jI(Math.atan(e[4])),skewY:e=>jI(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function nA(e){return e.includes("scale")?1:0}function IA(e,g){if(!e||e==="none")return nA(g);const t=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let I,o;if(t)I=Dw,o=t;else{const r=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);I=Qw,o=r}if(!o)return nA(g);const C=I[g],s=o[1].split(",").map(Pw);return typeof C=="function"?C(s):s[C]}const jw=(e,g)=>{const{transform:t="none"}=getComputedStyle(e);return IA(t,g)};function Pw(e){return parseFloat(e.trim())}const no=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Io=new Set(no),yb=e=>e===to||e===we,Ow=new Set(["x","y","z"]),qw=no.filter(e=>!Ow.has(e));function _w(e){const g=[];return qw.forEach(t=>{const I=e.getValue(t);I!==void 0&&(g.push([t,I.get()]),I.set(t.startsWith("scale")?1:0))}),g}const qI={width:({x:e},{paddingLeft:g="0",paddingRight:t="0"})=>e.max-e.min-parseFloat(g)-parseFloat(t),height:({y:e},{paddingTop:g="0",paddingBottom:t="0"})=>e.max-e.min-parseFloat(g)-parseFloat(t),top:(e,{top:g})=>parseFloat(g),left:(e,{left:g})=>parseFloat(g),bottom:({y:e},{top:g})=>parseFloat(g)+(e.max-e.min),right:({x:e},{left:g})=>parseFloat(g)+(e.max-e.min),x:(e,{transform:g})=>IA(g,"x"),y:(e,{transform:g})=>IA(g,"y")};qI.translateX=qI.x;qI.translateY=qI.y;const _I=new Set;let lA=!1,oA=!1,CA=!1;function mB(){if(oA){const e=Array.from(_I).filter(I=>I.needsMeasurement),g=new Set(e.map(I=>I.element)),t=new Map;g.forEach(I=>{const o=_w(I);o.length&&(t.set(I,o),I.render())}),e.forEach(I=>I.measureInitialState()),g.forEach(I=>{I.render();const o=t.get(I);o&&o.forEach(([C,s])=>{I.getValue(C)?.set(s)})}),e.forEach(I=>I.measureEndState()),e.forEach(I=>{I.suspendedScrollY!==void 0&&window.scrollTo(0,I.suspendedScrollY)})}oA=!1,lA=!1,_I.forEach(e=>e.complete(CA)),_I.clear()}function hB(){_I.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(oA=!0)})}function $w(){CA=!0,hB(),mB(),CA=!1}class bu{constructor(g,t,I,o,C,s=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...g],this.onComplete=t,this.name=I,this.motionValue=o,this.element=C,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(_I.add(this),lA||(lA=!0,hg.read(hB),hg.resolveKeyframes(mB))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:g,name:t,element:I,motionValue:o}=this;if(g[0]===null){const C=o?.get(),s=g[g.length-1];if(C!==void 0)g[0]=C;else if(I&&t){const r=I.readValue(t,s);r!=null&&(g[0]=r)}g[0]===void 0&&(g[0]=s),o&&C===void 0&&o.set(g[0])}Tw(g)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(g=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,g),_I.delete(this)}cancel(){this.state==="scheduled"&&(_I.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const eF=e=>e.startsWith("--");function gF(e,g,t){eF(g)?e.style.setProperty(g,t):e.style[g]=t}const tF=Cu(()=>window.ScrollTimeline!==void 0),nF={};function IF(e,g){const t=Cu(e);return()=>nF[g]??t()}const pB=IF(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),iC=([e,g,t,I])=>`cubic-bezier(${e}, ${g}, ${t}, ${I})`,Bb={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:iC([0,.65,.55,1]),circOut:iC([.55,0,1,.45]),backIn:iC([.31,.01,.66,-.59]),backOut:iC([.33,1.53,.69,.99])};function ZB(e,g){if(e)return typeof e=="function"?pB()?dB(e,g):"ease-out":nB(e)?iC(e):Array.isArray(e)?e.map(t=>ZB(t,g)||Bb.easeOut):Bb[e]}function lF(e,g,t,{delay:I=0,duration:o=300,repeat:C=0,repeatType:s="loop",ease:r="easeOut",times:c}={},d=void 0){const A={[g]:t};c&&(A.offset=c);const m=ZB(r,o);Array.isArray(m)&&(A.easing=m);const Z={delay:I,duration:o,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:C+1,direction:s==="reverse"?"alternate":"normal"};return d&&(Z.pseudoElement=d),e.animate(A,Z)}function bB(e){return typeof e=="function"&&"applyToOptions"in e}function oF({type:e,...g}){return bB(e)&&pB()?e.applyToOptions(g):(g.duration??(g.duration=300),g.ease??(g.ease="easeOut"),g)}class CF extends pu{constructor(g){if(super(),this.finishedTime=null,this.isStopped=!1,!g)return;const{element:t,name:I,keyframes:o,pseudoElement:C,allowFlatten:s=!1,finalKeyframe:r,onComplete:c}=g;this.isPseudoElement=!!C,this.allowFlatten=s,this.options=g,ou(typeof g.type!="string");const d=oF(g);this.animation=lF(t,I,o,d,C),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!C){const A=hu(o,this.options,r,this.speed);this.updateMotionValue?this.updateMotionValue(A):gF(t,I,A),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:g}=this;g==="idle"||g==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const g=this.animation.effect?.getComputedTiming?.().duration||0;return yn(Number(g))}get time(){return yn(Number(this.animation.currentTime)||0)}set time(g){this.finishedTime=null,this.animation.currentTime=Gn(g)}get speed(){return this.animation.playbackRate}set speed(g){g<0&&(this.finishedTime=null),this.animation.playbackRate=g}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(g){this.animation.startTime=g}attachTimeline({timeline:g,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,g&&tF()?(this.animation.timeline=g,Ut):t(this)}}const GB={anticipate:$y,backInOut:_y,circInOut:gB};function iF(e){return e in GB}function sF(e){typeof e.ease=="string"&&iF(e.ease)&&(e.ease=GB[e.ease])}const fb=10;class rF extends CF{constructor(g){sF(g),uB(g),super(g),g.startTime&&(this.startTime=g.startTime),this.options=g}updateMotionValue(g){const{motionValue:t,onUpdate:I,onComplete:o,element:C,...s}=this.options;if(!t)return;if(g!==void 0){t.set(g);return}const r=new Zu({...s,autoplay:!1}),c=Gn(this.finishedTime??this.time);t.setWithVelocity(r.sample(c-fb).value,r.sample(c).value,fb),r.stop()}}const Sb=(e,g)=>g==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(GI.test(e)||e==="0")&&!e.startsWith("url("));function aF(e){const g=e[0];if(e.length===1)return!0;for(let t=0;t<e.length;t++)if(e[t]!==g)return!0}function cF(e,g,t,I){const o=e[0];if(o===null)return!1;if(g==="display"||g==="visibility")return!0;const C=e[e.length-1],s=Sb(o,g),r=Sb(C,g);return!s||!r?!1:aF(e)||(t==="spring"||bB(t))&&I}function yB(e){return Ty(e)&&"offsetHeight"in e}const dF=new Set(["opacity","clipPath","filter","transform"]),AF=Cu(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function uF(e){const{motionValue:g,name:t,repeatDelay:I,repeatType:o,damping:C,type:s}=e;if(!yB(g?.owner?.current))return!1;const{onUpdate:r,transformTemplate:c}=g.owner.getProps();return AF()&&t&&dF.has(t)&&(t!=="transform"||!c)&&!r&&!I&&o!=="mirror"&&C!==0&&s!=="inertia"}const mF=40;class hF extends pu{constructor({autoplay:g=!0,delay:t=0,type:I="keyframes",repeat:o=0,repeatDelay:C=0,repeatType:s="loop",keyframes:r,name:c,motionValue:d,element:A,...m}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=pt.now();const Z={autoplay:g,delay:t,type:I,repeat:o,repeatDelay:C,repeatType:s,name:c,motionValue:d,element:A,...m},y=A?.KeyframeResolver||bu;this.keyframeResolver=new y(r,(G,B,f)=>this.onKeyframesResolved(G,B,Z,!f),c,d,A),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(g,t,I,o){this.keyframeResolver=void 0;const{name:C,type:s,velocity:r,delay:c,isHandoff:d,onUpdate:A}=I;this.resolvedAt=pt.now(),cF(g,C,s,r)||((Ln.instantAnimations||!c)&&A?.(hu(g,I,t)),g[0]=g[g.length-1],I.duration=0,I.repeat=0);const Z={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>mF?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...I,keyframes:g},y=!d&&uF(Z)?new rF({...Z,element:Z.motionValue.owner.current}):new Zu(Z);y.finished.then(()=>this.notifyFinished()).catch(Ut),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(g,t){return this.finished.finally(g).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),$w()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(g){this.animation.time=g}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(g){this.animation.speed=g}get startTime(){return this.animation.startTime}attachTimeline(g){return this._animation?this.stopTimeline=this.animation.attachTimeline(g):this.pendingTimeline=g,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const pF=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function ZF(e){const g=pF.exec(e);if(!g)return[,];const[,t,I,o]=g;return[`--${t??I}`,o]}function BB(e,g,t=1){const[I,o]=ZF(e);if(!I)return;const C=window.getComputedStyle(g).getPropertyValue(I);if(C){const s=C.trim();return Ly(s)?parseFloat(s):s}return cu(o)?BB(o,g,t+1):o}function Gu(e,g){return e?.[g]??e?.default??e}const fB=new Set(["width","height","top","left","right","bottom",...no]),bF={test:e=>e==="auto",parse:e=>e},SB=e=>g=>g.test(e),VB=[to,we,Bn,uI,aw,rw,bF],Vb=e=>VB.find(SB(e));function GF(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Qy(e):!0}const yF=new Set(["brightness","contrast","saturate","opacity"]);function BF(e){const[g,t]=e.slice(0,-1).split("(");if(g==="drop-shadow")return e;const[I]=t.match(du)||[];if(!I)return e;const o=t.replace(I,"");let C=yF.has(g)?1:0;return I!==t&&(C*=100),g+"("+C+o+")"}const fF=/\b([a-z-]*)\(.*?\)/gu,iA={...GI,getAnimatableNone:e=>{const g=e.match(fF);return g?g.map(BF).join(" "):e}},Wb={...to,transform:Math.round},SF={rotate:uI,rotateX:uI,rotateY:uI,rotateZ:uI,scale:ms,scaleX:ms,scaleY:ms,scaleZ:ms,skew:uI,skewX:uI,skewY:uI,distance:we,translateX:we,translateY:we,translateZ:we,x:we,y:we,z:we,perspective:we,transformPerspective:we,opacity:RC,originX:Ab,originY:Ab,originZ:we},yu={borderWidth:we,borderTopWidth:we,borderRightWidth:we,borderBottomWidth:we,borderLeftWidth:we,borderRadius:we,radius:we,borderTopLeftRadius:we,borderTopRightRadius:we,borderBottomRightRadius:we,borderBottomLeftRadius:we,width:we,maxWidth:we,height:we,maxHeight:we,top:we,right:we,bottom:we,left:we,padding:we,paddingTop:we,paddingRight:we,paddingBottom:we,paddingLeft:we,margin:we,marginTop:we,marginRight:we,marginBottom:we,marginLeft:we,backgroundPositionX:we,backgroundPositionY:we,...SF,zIndex:Wb,fillOpacity:RC,strokeOpacity:RC,numOctaves:Wb},VF={...yu,color:wg,backgroundColor:wg,outlineColor:wg,fill:wg,stroke:wg,borderColor:wg,borderTopColor:wg,borderRightColor:wg,borderBottomColor:wg,borderLeftColor:wg,filter:iA,WebkitFilter:iA},WB=e=>VF[e];function RB(e,g){let t=WB(e);return t!==iA&&(t=GI),t.getAnimatableNone?t.getAnimatableNone(g):void 0}const WF=new Set(["auto","none","0"]);function RF(e,g,t){let I=0,o;for(;I<e.length&&!o;){const C=e[I];typeof C=="string"&&!WF.has(C)&&XC(C).values.length&&(o=e[I]),I++}if(o&&t)for(const C of g)e[C]=RB(t,o)}class XF extends bu{constructor(g,t,I,o,C){super(g,t,I,o,C,!0)}readKeyframes(){const{unresolvedKeyframes:g,element:t,name:I}=this;if(!t||!t.current)return;super.readKeyframes();for(let c=0;c<g.length;c++){let d=g[c];if(typeof d=="string"&&(d=d.trim(),cu(d))){const A=BB(d,t.current);A!==void 0&&(g[c]=A),c===g.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!fB.has(I)||g.length!==2)return;const[o,C]=g,s=Vb(o),r=Vb(C);if(s!==r)if(yb(s)&&yb(r))for(let c=0;c<g.length;c++){const d=g[c];typeof d=="string"&&(g[c]=parseFloat(d))}else qI[I]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:g,name:t}=this,I=[];for(let o=0;o<g.length;o++)(g[o]===null||GF(g[o]))&&I.push(o);I.length&&RF(g,I,t)}measureInitialState(){const{element:g,unresolvedKeyframes:t,name:I}=this;if(!g||!g.current)return;I==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=qI[I](g.measureViewportBox(),window.getComputedStyle(g.current)),t[0]=this.measuredOrigin;const o=t[t.length-1];o!==void 0&&g.getValue(I,o).jump(o,!1)}measureEndState(){const{element:g,name:t,unresolvedKeyframes:I}=this;if(!g||!g.current)return;const o=g.getValue(t);o&&o.jump(this.measuredOrigin,!1);const C=I.length-1,s=I[C];I[C]=qI[t](g.measureViewportBox(),window.getComputedStyle(g.current)),s!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=s),this.removedTransforms?.length&&this.removedTransforms.forEach(([r,c])=>{g.getValue(r).set(c)}),this.resolveNoneKeyframes()}}function XB(e,g,t){if(e instanceof EventTarget)return[e];if(typeof e=="string"){const o=document.querySelectorAll(e);return o?Array.from(o):[]}return Array.from(e)}const kB=(e,g)=>g&&typeof e=="number"?g.transform(e):e,Rb=30,kF=e=>!isNaN(parseFloat(e));class JF{constructor(g,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(I,o=!0)=>{const C=pt.now();if(this.updatedAt!==C&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(I),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const s of this.dependents)s.dirty();o&&this.events.renderRequest?.notify(this.current)},this.hasAnimated=!1,this.setCurrent(g),this.owner=t.owner}setCurrent(g){this.current=g,this.updatedAt=pt.now(),this.canTrackVelocity===null&&g!==void 0&&(this.canTrackVelocity=kF(this.current))}setPrevFrameValue(g=this.current){this.prevFrameValue=g,this.prevUpdatedAt=this.updatedAt}onChange(g){return this.on("change",g)}on(g,t){this.events[g]||(this.events[g]=new iu);const I=this.events[g].add(t);return g==="change"?()=>{I(),hg.read(()=>{this.events.change.getSize()||this.stop()})}:I}clearListeners(){for(const g in this.events)this.events[g].clear()}attach(g,t){this.passiveEffect=g,this.stopPassiveEffect=t}set(g,t=!0){!t||!this.passiveEffect?this.updateAndNotify(g,t):this.passiveEffect(g,this.updateAndNotify)}setWithVelocity(g,t,I){this.set(t),this.prev=void 0,this.prevFrameValue=g,this.prevUpdatedAt=this.updatedAt-I}jump(g,t=!0){this.updateAndNotify(g),this.prev=g,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(g){this.dependents||(this.dependents=new Set),this.dependents.add(g)}removeDependent(g){this.dependents&&this.dependents.delete(g)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const g=pt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||g-this.updatedAt>Rb)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,Rb);return Dy(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(g){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=g(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Dl(e,g){return new JF(e,g)}const{schedule:Bu}=IB(queueMicrotask,!1),en={x:!1,y:!1};function JB(){return en.x||en.y}function vF(e){return e==="x"||e==="y"?en[e]?null:(en[e]=!0,()=>{en[e]=!1}):en.x||en.y?null:(en.x=en.y=!0,()=>{en.x=en.y=!1})}function vB(e,g){const t=XB(e),I=new AbortController,o={passive:!0,...g,signal:I.signal};return[t,o,()=>I.abort()]}function Xb(e){return!(e.pointerType==="touch"||JB())}function YF(e,g,t={}){const[I,o,C]=vB(e,t),s=r=>{if(!Xb(r))return;const{target:c}=r,d=g(c,r);if(typeof d!="function"||!c)return;const A=m=>{Xb(m)&&(d(m),c.removeEventListener("pointerleave",A))};c.addEventListener("pointerleave",A,o)};return I.forEach(r=>{r.addEventListener("pointerenter",s,o)}),C}const YB=(e,g)=>g?e===g?!0:YB(e,g.parentElement):!1,fu=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,HF=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function wF(e){return HF.has(e.tagName)||e.tabIndex!==-1}const Fs=new WeakSet;function kb(e){return g=>{g.key==="Enter"&&e(g)}}function rd(e,g){e.dispatchEvent(new PointerEvent("pointer"+g,{isPrimary:!0,bubbles:!0}))}const FF=(e,g)=>{const t=e.currentTarget;if(!t)return;const I=kb(()=>{if(Fs.has(t))return;rd(t,"down");const o=kb(()=>{rd(t,"up")}),C=()=>rd(t,"cancel");t.addEventListener("keyup",o,g),t.addEventListener("blur",C,g)});t.addEventListener("keydown",I,g),t.addEventListener("blur",()=>t.removeEventListener("keydown",I),g)};function Jb(e){return fu(e)&&!JB()}function KF(e,g,t={}){const[I,o,C]=vB(e,t),s=r=>{const c=r.currentTarget;if(!Jb(r))return;Fs.add(c);const d=g(c,r),A=(y,G)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",Z),Fs.has(c)&&Fs.delete(c),Jb(y)&&typeof d=="function"&&d(y,{success:G})},m=y=>{A(y,c===window||c===document||t.useGlobalTarget||YB(c,y.target))},Z=y=>{A(y,!1)};window.addEventListener("pointerup",m,o),window.addEventListener("pointercancel",Z,o)};return I.forEach(r=>{(t.useGlobalTarget?window:r).addEventListener("pointerdown",s,o),yB(r)&&(r.addEventListener("focus",d=>FF(d,o)),!wF(r)&&!r.hasAttribute("tabindex")&&(r.tabIndex=0))}),C}function HB(e){return Ty(e)&&"ownerSVGElement"in e}function NF(e){return HB(e)&&e.tagName==="svg"}const tt=e=>!!(e&&e.getVelocity),xF=[...VB,wg,GI],EF=e=>xF.find(SB(e)),wB=b.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function zF(e=!0){const g=b.useContext(nu);if(g===null)return[!0,null];const{isPresent:t,onExitComplete:I,register:o}=g,C=b.useId();b.useEffect(()=>{if(e)return o(C)},[e]);const s=b.useCallback(()=>e&&I&&I(C),[C,I,e]);return!t&&I?[!1,s]:[!0]}const FB=b.createContext({strict:!1}),vb={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},jl={};for(const e in vb)jl[e]={isEnabled:g=>vb[e].some(t=>!!g[t])};function MF(e){for(const g in e)jl[g]={...jl[g],...e[g]}}const UF=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function nr(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||UF.has(e)}let KB=e=>!nr(e);function LF(e){typeof e=="function"&&(KB=g=>g.startsWith("on")?!nr(g):e(g))}try{LF(require("@emotion/is-prop-valid").default)}catch{}function TF(e,g,t){const I={};for(const o in e)o==="values"&&typeof e.values=="object"||(KB(o)||t===!0&&nr(o)||!g&&!nr(o)||e.draggable&&o.startsWith("onDrag"))&&(I[o]=e[o]);return I}function QF(e){if(typeof Proxy>"u")return e;const g=new Map,t=(...I)=>e(...I);return new Proxy(t,{get:(I,o)=>o==="create"?e:(g.has(o)||g.set(o,e(o)),g.get(o))})}const wr=b.createContext({});function Fr(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function kC(e){return typeof e=="string"||Array.isArray(e)}const Su=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Vu=["initial",...Su];function Kr(e){return Fr(e.animate)||Vu.some(g=>kC(e[g]))}function NB(e){return!!(Kr(e)||e.variants)}function DF(e,g){if(Kr(e)){const{initial:t,animate:I}=e;return{initial:t===!1||kC(t)?t:void 0,animate:kC(I)?I:void 0}}return e.inherit!==!1?g:{}}function jF(e){const{initial:g,animate:t}=DF(e,b.useContext(wr));return b.useMemo(()=>({initial:g,animate:t}),[Yb(g),Yb(t)])}function Yb(e){return Array.isArray(e)?e.join(" "):e}const PF=Symbol.for("motionComponentSymbol");function Nl(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function OF(e,g,t){return b.useCallback(I=>{I&&e.onMount&&e.onMount(I),g&&(I?g.mount(I):g.unmount()),t&&(typeof t=="function"?t(I):Nl(t)&&(t.current=I))},[g])}const Wu=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),qF="framerAppearId",xB="data-"+Wu(qF),EB=b.createContext({});function _F(e,g,t,I,o){const{visualElement:C}=b.useContext(wr),s=b.useContext(FB),r=b.useContext(nu),c=b.useContext(wB).reducedMotion,d=b.useRef(null);I=I||s.renderer,!d.current&&I&&(d.current=I(e,{visualState:g,parent:C,props:t,presenceContext:r,blockInitialAnimation:r?r.initial===!1:!1,reducedMotionConfig:c}));const A=d.current,m=b.useContext(EB);A&&!A.projection&&o&&(A.type==="html"||A.type==="svg")&&$F(d.current,t,o,m);const Z=b.useRef(!1);b.useInsertionEffect(()=>{A&&Z.current&&A.update(t,r)});const y=t[xB],G=b.useRef(!!y&&!window.MotionHandoffIsComplete?.(y)&&window.MotionHasOptimisedAnimation?.(y));return TH(()=>{A&&(Z.current=!0,window.MotionIsMounted=!0,A.updateFeatures(),Bu.render(A.render),G.current&&A.animationState&&A.animationState.animateChanges())}),b.useEffect(()=>{A&&(!G.current&&A.animationState&&A.animationState.animateChanges(),G.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(y)}),G.current=!1))}),A}function $F(e,g,t,I){const{layoutId:o,layout:C,drag:s,dragConstraints:r,layoutScroll:c,layoutRoot:d,layoutCrossfade:A}=g;e.projection=new t(e.latestValues,g["data-framer-portal-id"]?void 0:zB(e.parent)),e.projection.setOptions({layoutId:o,layout:C,alwaysMeasureLayout:!!s||r&&Nl(r),visualElement:e,animationType:typeof C=="string"?C:"both",initialPromotionConfig:I,crossfade:A,layoutScroll:c,layoutRoot:d})}function zB(e){if(e)return e.options.allowProjection!==!1?e.projection:zB(e.parent)}function eK({preloadedFeatures:e,createVisualElement:g,useRender:t,useVisualState:I,Component:o}){e&&MF(e);function C(r,c){let d;const A={...b.useContext(wB),...r,layoutId:gK(r)},{isStatic:m}=A,Z=jF(r),y=I(r,m);if(!m&&tu){tK();const G=nK(A);d=G.MeasureLayout,Z.visualElement=_F(o,y,A,g,G.ProjectionNode)}return p.jsxs(wr.Provider,{value:Z,children:[d&&Z.visualElement?p.jsx(d,{visualElement:Z.visualElement,...A}):null,t(o,r,OF(y,Z.visualElement,c),y,m,Z.visualElement)]})}C.displayName=`motion.${typeof o=="string"?o:`create(${o.displayName??o.name??""})`}`;const s=b.forwardRef(C);return s[PF]=o,s}function gK({layoutId:e}){const g=b.useContext(Uy).id;return g&&e!==void 0?g+"-"+e:e}function tK(e,g){b.useContext(FB).strict}function nK(e){const{drag:g,layout:t}=jl;if(!g&&!t)return{};const I={...g,...t};return{MeasureLayout:g?.isEnabled(e)||t?.isEnabled(e)?I.MeasureLayout:void 0,ProjectionNode:I.ProjectionNode}}const JC={};function IK(e){for(const g in e)JC[g]=e[g],au(g)&&(JC[g].isCSSVariable=!0)}function MB(e,{layout:g,layoutId:t}){return Io.has(e)||e.startsWith("origin")||(g||t!==void 0)&&(!!JC[e]||e==="opacity")}const lK={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},oK=no.length;function CK(e,g,t){let I="",o=!0;for(let C=0;C<oK;C++){const s=no[C],r=e[s];if(r===void 0)continue;let c=!0;if(typeof r=="number"?c=r===(s.startsWith("scale")?1:0):c=parseFloat(r)===0,!c||t){const d=kB(r,yu[s]);if(!c){o=!1;const A=lK[s]||s;I+=`${A}(${d}) `}t&&(g[s]=d)}}return I=I.trim(),t?I=t(g,o?"":I):o&&(I="none"),I}function Ru(e,g,t){const{style:I,vars:o,transformOrigin:C}=e;let s=!1,r=!1;for(const c in g){const d=g[c];if(Io.has(c)){s=!0;continue}else if(au(c)){o[c]=d;continue}else{const A=kB(d,yu[c]);c.startsWith("origin")?(r=!0,C[c]=A):I[c]=A}}if(g.transform||(s||t?I.transform=CK(g,e.transform,t):I.transform&&(I.transform="none")),r){const{originX:c="50%",originY:d="50%",originZ:A=0}=C;I.transformOrigin=`${c} ${d} ${A}`}}const Xu=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function UB(e,g,t){for(const I in g)!tt(g[I])&&!MB(I,t)&&(e[I]=g[I])}function iK({transformTemplate:e},g){return b.useMemo(()=>{const t=Xu();return Ru(t,g,e),Object.assign({},t.vars,t.style)},[g])}function sK(e,g){const t=e.style||{},I={};return UB(I,t,e),Object.assign(I,iK(e,g)),I}function rK(e,g){const t={},I=sK(e,g);return e.drag&&e.dragListener!==!1&&(t.draggable=!1,I.userSelect=I.WebkitUserSelect=I.WebkitTouchCallout="none",I.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(t.tabIndex=0),t.style=I,t}const aK={offset:"stroke-dashoffset",array:"stroke-dasharray"},cK={offset:"strokeDashoffset",array:"strokeDasharray"};function dK(e,g,t=1,I=0,o=!0){e.pathLength=1;const C=o?aK:cK;e[C.offset]=we.transform(-I);const s=we.transform(g),r=we.transform(t);e[C.array]=`${s} ${r}`}function LB(e,{attrX:g,attrY:t,attrScale:I,pathLength:o,pathSpacing:C=1,pathOffset:s=0,...r},c,d,A){if(Ru(e,r,d),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:m,style:Z}=e;m.transform&&(Z.transform=m.transform,delete m.transform),(Z.transform||m.transformOrigin)&&(Z.transformOrigin=m.transformOrigin??"50% 50%",delete m.transformOrigin),Z.transform&&(Z.transformBox=A?.transformBox??"fill-box",delete m.transformBox),g!==void 0&&(m.x=g),t!==void 0&&(m.y=t),I!==void 0&&(m.scale=I),o!==void 0&&dK(m,o,C,s,!1)}const TB=()=>({...Xu(),attrs:{}}),QB=e=>typeof e=="string"&&e.toLowerCase()==="svg";function AK(e,g,t,I){const o=b.useMemo(()=>{const C=TB();return LB(C,g,QB(I),e.transformTemplate,e.style),{...C.attrs,style:{...C.style}}},[g]);if(e.style){const C={};UB(C,e.style,e),o.style={...C,...o.style}}return o}const uK=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ku(e){return typeof e!="string"||e.includes("-")?!1:!!(uK.indexOf(e)>-1||/[A-Z]/u.test(e))}function mK(e=!1){return(t,I,o,{latestValues:C},s)=>{const c=(ku(t)?AK:rK)(I,C,s,t),d=TF(I,typeof t=="string",e),A=t!==b.Fragment?{...d,...c,ref:o}:{},{children:m}=I,Z=b.useMemo(()=>tt(m)?m.get():m,[m]);return b.createElement(t,{...A,children:Z})}}function Hb(e){const g=[{},{}];return e?.values.forEach((t,I)=>{g[0][I]=t.get(),g[1][I]=t.getVelocity()}),g}function Ju(e,g,t,I){if(typeof g=="function"){const[o,C]=Hb(I);g=g(t!==void 0?t:e.custom,o,C)}if(typeof g=="string"&&(g=e.variants&&e.variants[g]),typeof g=="function"){const[o,C]=Hb(I);g=g(t!==void 0?t:e.custom,o,C)}return g}function Ks(e){return tt(e)?e.get():e}function hK({scrapeMotionValuesFromProps:e,createRenderState:g},t,I,o){return{latestValues:pK(t,I,o,e),renderState:g()}}const DB=e=>(g,t)=>{const I=b.useContext(wr),o=b.useContext(nu),C=()=>hK(e,g,I,o);return t?C():LH(C)};function pK(e,g,t,I){const o={},C=I(e,{});for(const Z in C)o[Z]=Ks(C[Z]);let{initial:s,animate:r}=e;const c=Kr(e),d=NB(e);g&&d&&!c&&e.inherit!==!1&&(s===void 0&&(s=g.initial),r===void 0&&(r=g.animate));let A=t?t.initial===!1:!1;A=A||s===!1;const m=A?r:s;if(m&&typeof m!="boolean"&&!Fr(m)){const Z=Array.isArray(m)?m:[m];for(let y=0;y<Z.length;y++){const G=Ju(e,Z[y]);if(G){const{transitionEnd:B,transition:f,...W}=G;for(const v in W){let R=W[v];if(Array.isArray(R)){const k=A?R.length-1:0;R=R[k]}R!==null&&(o[v]=R)}for(const v in B)o[v]=B[v]}}}return o}function vu(e,g,t){const{style:I}=e,o={};for(const C in I)(tt(I[C])||g.style&&tt(g.style[C])||MB(C,e)||t?.getValue(C)?.liveStyle!==void 0)&&(o[C]=I[C]);return o}const ZK={useVisualState:DB({scrapeMotionValuesFromProps:vu,createRenderState:Xu})};function jB(e,g,t){const I=vu(e,g,t);for(const o in e)if(tt(e[o])||tt(g[o])){const C=no.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;I[C]=e[o]}return I}const bK={useVisualState:DB({scrapeMotionValuesFromProps:jB,createRenderState:TB})};function GK(e,g){return function(I,{forwardMotionProps:o}={forwardMotionProps:!1}){const s={...ku(I)?bK:ZK,preloadedFeatures:e,useRender:mK(o),createVisualElement:g,Component:I};return eK(s)}}function vC(e,g,t){const I=e.getProps();return Ju(I,g,t!==void 0?t:I.custom,e)}const sA=e=>Array.isArray(e);function yK(e,g,t){e.hasValue(g)?e.getValue(g).set(t):e.addValue(g,Dl(t))}function BK(e){return sA(e)?e[e.length-1]||0:e}function fK(e,g){const t=vC(e,g);let{transitionEnd:I={},transition:o={},...C}=t||{};C={...C,...I};for(const s in C){const r=BK(C[s]);yK(e,s,r)}}function SK(e){return!!(tt(e)&&e.add)}function rA(e,g){const t=e.getValue("willChange");if(SK(t))return t.add(g);if(!t&&Ln.WillChange){const I=new Ln.WillChange("auto");e.addValue("willChange",I),I.add(g)}}function PB(e){return e.props[xB]}const VK=e=>e!==null;function WK(e,{repeat:g,repeatType:t="loop"},I){const o=e.filter(VK),C=g&&t!=="loop"&&g%2===1?0:o.length-1;return o[C]}const RK={type:"spring",stiffness:500,damping:25,restSpeed:10},XK=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),kK={type:"keyframes",duration:.8},JK={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},vK=(e,{keyframes:g})=>g.length>2?kK:Io.has(e)?e.startsWith("scale")?XK(g[1]):RK:JK;function YK({when:e,delay:g,delayChildren:t,staggerChildren:I,staggerDirection:o,repeat:C,repeatType:s,repeatDelay:r,from:c,elapsed:d,...A}){return!!Object.keys(A).length}const Yu=(e,g,t,I={},o,C)=>s=>{const r=Gu(I,e)||{},c=r.delay||I.delay||0;let{elapsed:d=0}=I;d=d-Gn(c);const A={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:g.getVelocity(),...r,delay:-d,onUpdate:Z=>{g.set(Z),r.onUpdate&&r.onUpdate(Z)},onComplete:()=>{s(),r.onComplete&&r.onComplete()},name:e,motionValue:g,element:C?void 0:o};YK(r)||Object.assign(A,vK(e,A)),A.duration&&(A.duration=Gn(A.duration)),A.repeatDelay&&(A.repeatDelay=Gn(A.repeatDelay)),A.from!==void 0&&(A.keyframes[0]=A.from);let m=!1;if((A.type===!1||A.duration===0&&!A.repeatDelay)&&(A.duration=0,A.delay===0&&(m=!0)),(Ln.instantAnimations||Ln.skipAnimations)&&(m=!0,A.duration=0,A.delay=0),A.allowFlatten=!r.type&&!r.ease,m&&!C&&g.get()!==void 0){const Z=WK(A.keyframes,r);if(Z!==void 0){hg.update(()=>{A.onUpdate(Z),A.onComplete()});return}}return r.isSync?new Zu(A):new hF(A)};function HK({protectedKeys:e,needsAnimating:g},t){const I=e.hasOwnProperty(t)&&g[t]!==!0;return g[t]=!1,I}function OB(e,g,{delay:t=0,transitionOverride:I,type:o}={}){let{transition:C=e.getDefaultTransition(),transitionEnd:s,...r}=g;I&&(C=I);const c=[],d=o&&e.animationState&&e.animationState.getState()[o];for(const A in r){const m=e.getValue(A,e.latestValues[A]??null),Z=r[A];if(Z===void 0||d&&HK(d,A))continue;const y={delay:t,...Gu(C||{},A)},G=m.get();if(G!==void 0&&!m.isAnimating&&!Array.isArray(Z)&&Z===G&&!y.velocity)continue;let B=!1;if(window.MotionHandoffAnimation){const W=PB(e);if(W){const v=window.MotionHandoffAnimation(W,A,hg);v!==null&&(y.startTime=v,B=!0)}}rA(e,A),m.start(Yu(A,m,Z,e.shouldReduceMotion&&fB.has(A)?{type:!1}:y,e,B));const f=m.animation;f&&c.push(f)}return s&&Promise.all(c).then(()=>{hg.update(()=>{s&&fK(e,s)})}),c}function aA(e,g,t={}){const I=vC(e,g,t.type==="exit"?e.presenceContext?.custom:void 0);let{transition:o=e.getDefaultTransition()||{}}=I||{};t.transitionOverride&&(o=t.transitionOverride);const C=I?()=>Promise.all(OB(e,I,t)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:A,staggerDirection:m}=o;return wK(e,g,c,d,A,m,t)}:()=>Promise.resolve(),{when:r}=o;if(r){const[c,d]=r==="beforeChildren"?[C,s]:[s,C];return c().then(()=>d())}else return Promise.all([C(),s(t.delay)])}function wK(e,g,t=0,I=0,o=0,C=1,s){const r=[],c=e.variantChildren.size,d=(c-1)*o,A=typeof I=="function",m=A?Z=>I(Z,c):C===1?(Z=0)=>Z*o:(Z=0)=>d-Z*o;return Array.from(e.variantChildren).sort(FK).forEach((Z,y)=>{Z.notify("AnimationStart",g),r.push(aA(Z,g,{...s,delay:t+(A?0:I)+m(y)}).then(()=>Z.notify("AnimationComplete",g)))}),Promise.all(r)}function FK(e,g){return e.sortNodePosition(g)}function KK(e,g,t={}){e.notify("AnimationStart",g);let I;if(Array.isArray(g)){const o=g.map(C=>aA(e,C,t));I=Promise.all(o)}else if(typeof g=="string")I=aA(e,g,t);else{const o=typeof g=="function"?vC(e,g,t.custom):g;I=Promise.all(OB(e,o,t))}return I.then(()=>{e.notify("AnimationComplete",g)})}function qB(e,g){if(!Array.isArray(g))return!1;const t=g.length;if(t!==e.length)return!1;for(let I=0;I<t;I++)if(g[I]!==e[I])return!1;return!0}const NK=Vu.length;function _B(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent?_B(e.parent)||{}:{};return e.props.initial!==void 0&&(t.initial=e.props.initial),t}const g={};for(let t=0;t<NK;t++){const I=Vu[t],o=e.props[I];(kC(o)||o===!1)&&(g[I]=o)}return g}const xK=[...Su].reverse(),EK=Su.length;function zK(e){return g=>Promise.all(g.map(({animation:t,options:I})=>KK(e,t,I)))}function MK(e){let g=zK(e),t=wb(),I=!0;const o=c=>(d,A)=>{const m=vC(e,A,c==="exit"?e.presenceContext?.custom:void 0);if(m){const{transition:Z,transitionEnd:y,...G}=m;d={...d,...G,...y}}return d};function C(c){g=c(e)}function s(c){const{props:d}=e,A=_B(e.parent)||{},m=[],Z=new Set;let y={},G=1/0;for(let f=0;f<EK;f++){const W=xK[f],v=t[W],R=d[W]!==void 0?d[W]:A[W],k=kC(R),J=W===c?v.isActive:null;J===!1&&(G=f);let F=R===A[W]&&R!==d[W]&&k;if(F&&I&&e.manuallyAnimateOnMount&&(F=!1),v.protectedKeys={...y},!v.isActive&&J===null||!R&&!v.prevProp||Fr(R)||typeof R=="boolean")continue;const U=UK(v.prevProp,R);let X=U||W===c&&v.isActive&&!F&&k||f>G&&k,K=!1;const w=Array.isArray(R)?R:[R];let D=w.reduce(o(W),{});J===!1&&(D={});const{prevResolvedValues:V={}}=v,z={...V,...D},N=q=>{X=!0,Z.has(q)&&(K=!0,Z.delete(q)),v.needsAnimating[q]=!0;const j=e.getValue(q);j&&(j.liveStyle=!1)};for(const q in z){const j=D[q],P=V[q];if(y.hasOwnProperty(q))continue;let $=!1;sA(j)&&sA(P)?$=!qB(j,P):$=j!==P,$?j!=null?N(q):Z.add(q):j!==void 0&&Z.has(q)?N(q):v.protectedKeys[q]=!0}v.prevProp=R,v.prevResolvedValues=D,v.isActive&&(y={...y,...D}),I&&e.blockInitialAnimation&&(X=!1),X&&(!(F&&U)||K)&&m.push(...w.map(q=>({animation:q,options:{type:W}})))}if(Z.size){const f={};if(typeof d.initial!="boolean"){const W=vC(e,Array.isArray(d.initial)?d.initial[0]:d.initial);W&&W.transition&&(f.transition=W.transition)}Z.forEach(W=>{const v=e.getBaseTarget(W),R=e.getValue(W);R&&(R.liveStyle=!0),f[W]=v??null}),m.push({animation:f})}let B=!!m.length;return I&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(B=!1),I=!1,B?g(m):Promise.resolve()}function r(c,d){if(t[c].isActive===d)return Promise.resolve();e.variantChildren?.forEach(m=>m.animationState?.setActive(c,d)),t[c].isActive=d;const A=s(c);for(const m in t)t[m].protectedKeys={};return A}return{animateChanges:s,setActive:r,setAnimateFunction:C,getState:()=>t,reset:()=>{t=wb(),I=!0}}}function UK(e,g){return typeof g=="string"?g!==e:Array.isArray(g)?!qB(g,e):!1}function NI(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wb(){return{animate:NI(!0),whileInView:NI(),whileHover:NI(),whileTap:NI(),whileDrag:NI(),whileFocus:NI(),exit:NI()}}class yI{constructor(g){this.isMounted=!1,this.node=g}update(){}}class LK extends yI{constructor(g){super(g),g.animationState||(g.animationState=MK(g))}updateAnimationControlsSubscription(){const{animate:g}=this.node.getProps();Fr(g)&&(this.unmountControls=g.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:g}=this.node.getProps(),{animate:t}=this.node.prevProps||{};g!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let TK=0;class QK extends yI{constructor(){super(...arguments),this.id=TK++}update(){if(!this.node.presenceContext)return;const{isPresent:g,onExitComplete:t}=this.node.presenceContext,{isPresent:I}=this.node.prevPresenceContext||{};if(!this.node.animationState||g===I)return;const o=this.node.animationState.setActive("exit",!g);t&&!g&&o.then(()=>{t(this.id)})}mount(){const{register:g,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),g&&(this.unmount=g(this.id))}unmount(){}}const DK={animation:{Feature:LK},exit:{Feature:QK}};function YC(e,g,t,I={passive:!0}){return e.addEventListener(g,t,I),()=>e.removeEventListener(g,t)}function $C(e){return{point:{x:e.pageX,y:e.pageY}}}const jK=e=>g=>fu(g)&&e(g,$C(g));function uC(e,g,t,I){return YC(e,g,jK(t),I)}function $B({top:e,left:g,right:t,bottom:I}){return{x:{min:g,max:t},y:{min:e,max:I}}}function PK({x:e,y:g}){return{top:g.min,right:e.max,bottom:g.max,left:e.min}}function OK(e,g){if(!g)return e;const t=g({x:e.left,y:e.top}),I=g({x:e.right,y:e.bottom});return{top:t.y,left:t.x,bottom:I.y,right:I.x}}const ef=1e-4,qK=1-ef,_K=1+ef,gf=.01,$K=0-gf,eN=0+gf;function Ct(e){return e.max-e.min}function gN(e,g,t){return Math.abs(e-g)<=t}function Fb(e,g,t,I=.5){e.origin=I,e.originPoint=Gg(g.min,g.max,e.origin),e.scale=Ct(t)/Ct(g),e.translate=Gg(t.min,t.max,e.origin)-e.originPoint,(e.scale>=qK&&e.scale<=_K||isNaN(e.scale))&&(e.scale=1),(e.translate>=$K&&e.translate<=eN||isNaN(e.translate))&&(e.translate=0)}function mC(e,g,t,I){Fb(e.x,g.x,t.x,I?I.originX:void 0),Fb(e.y,g.y,t.y,I?I.originY:void 0)}function Kb(e,g,t){e.min=t.min+g.min,e.max=e.min+Ct(g)}function tN(e,g,t){Kb(e.x,g.x,t.x),Kb(e.y,g.y,t.y)}function Nb(e,g,t){e.min=g.min-t.min,e.max=e.min+Ct(g)}function hC(e,g,t){Nb(e.x,g.x,t.x),Nb(e.y,g.y,t.y)}const xb=()=>({translate:0,scale:1,origin:0,originPoint:0}),xl=()=>({x:xb(),y:xb()}),Eb=()=>({min:0,max:0}),kg=()=>({x:Eb(),y:Eb()});function xt(e){return[e("x"),e("y")]}function ad(e){return e===void 0||e===1}function cA({scale:e,scaleX:g,scaleY:t}){return!ad(e)||!ad(g)||!ad(t)}function UI(e){return cA(e)||tf(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function tf(e){return zb(e.x)||zb(e.y)}function zb(e){return e&&e!=="0%"}function Ir(e,g,t){const I=e-t,o=g*I;return t+o}function Mb(e,g,t,I,o){return o!==void 0&&(e=Ir(e,o,I)),Ir(e,t,I)+g}function dA(e,g=0,t=1,I,o){e.min=Mb(e.min,g,t,I,o),e.max=Mb(e.max,g,t,I,o)}function nf(e,{x:g,y:t}){dA(e.x,g.translate,g.scale,g.originPoint),dA(e.y,t.translate,t.scale,t.originPoint)}const Ub=.999999999999,Lb=1.0000000000001;function nN(e,g,t,I=!1){const o=t.length;if(!o)return;g.x=g.y=1;let C,s;for(let r=0;r<o;r++){C=t[r],s=C.projectionDelta;const{visualElement:c}=C.options;c&&c.props.style&&c.props.style.display==="contents"||(I&&C.options.layoutScroll&&C.scroll&&C!==C.root&&zl(e,{x:-C.scroll.offset.x,y:-C.scroll.offset.y}),s&&(g.x*=s.x.scale,g.y*=s.y.scale,nf(e,s)),I&&UI(C.latestValues)&&zl(e,C.latestValues))}g.x<Lb&&g.x>Ub&&(g.x=1),g.y<Lb&&g.y>Ub&&(g.y=1)}function El(e,g){e.min=e.min+g,e.max=e.max+g}function Tb(e,g,t,I,o=.5){const C=Gg(e.min,e.max,o);dA(e,g,t,C,I)}function zl(e,g){Tb(e.x,g.x,g.scaleX,g.scale,g.originX),Tb(e.y,g.y,g.scaleY,g.scale,g.originY)}function If(e,g){return $B(OK(e.getBoundingClientRect(),g))}function IN(e,g,t){const I=If(e,t),{scroll:o}=g;return o&&(El(I.x,o.offset.x),El(I.y,o.offset.y)),I}const lf=({current:e})=>e?e.ownerDocument.defaultView:null,Qb=(e,g)=>Math.abs(e-g);function lN(e,g){const t=Qb(e.x,g.x),I=Qb(e.y,g.y);return Math.sqrt(t**2+I**2)}class of{constructor(g,t,{transformPagePoint:I,contextWindow:o=window,dragSnapToOrigin:C=!1,distanceThreshold:s=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const Z=dd(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,G=lN(Z.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!G)return;const{point:B}=Z,{timestamp:f}=Qg;this.history.push({...B,timestamp:f});const{onStart:W,onMove:v}=this.handlers;y||(W&&W(this.lastMoveEvent,Z),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,Z)},this.handlePointerMove=(Z,y)=>{this.lastMoveEvent=Z,this.lastMoveEventInfo=cd(y,this.transformPagePoint),hg.update(this.updatePoint,!0)},this.handlePointerUp=(Z,y)=>{this.end();const{onEnd:G,onSessionEnd:B,resumeAnimation:f}=this.handlers;if(this.dragSnapToOrigin&&f&&f(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const W=dd(Z.type==="pointercancel"?this.lastMoveEventInfo:cd(y,this.transformPagePoint),this.history);this.startEvent&&G&&G(Z,W),B&&B(Z,W)},!fu(g))return;this.dragSnapToOrigin=C,this.handlers=t,this.transformPagePoint=I,this.distanceThreshold=s,this.contextWindow=o||window;const r=$C(g),c=cd(r,this.transformPagePoint),{point:d}=c,{timestamp:A}=Qg;this.history=[{...d,timestamp:A}];const{onSessionStart:m}=t;m&&m(g,dd(c,this.history)),this.removeListeners=OC(uC(this.contextWindow,"pointermove",this.handlePointerMove),uC(this.contextWindow,"pointerup",this.handlePointerUp),uC(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(g){this.handlers=g}end(){this.removeListeners&&this.removeListeners(),bI(this.updatePoint)}}function cd(e,g){return g?{point:g(e.point)}:e}function Db(e,g){return{x:e.x-g.x,y:e.y-g.y}}function dd({point:e},g){return{point:e,delta:Db(e,Cf(g)),offset:Db(e,oN(g)),velocity:CN(g,.1)}}function oN(e){return e[0]}function Cf(e){return e[e.length-1]}function CN(e,g){if(e.length<2)return{x:0,y:0};let t=e.length-1,I=null;const o=Cf(e);for(;t>=0&&(I=e[t],!(o.timestamp-I.timestamp>Gn(g)));)t--;if(!I)return{x:0,y:0};const C=yn(o.timestamp-I.timestamp);if(C===0)return{x:0,y:0};const s={x:(o.x-I.x)/C,y:(o.y-I.y)/C};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function iN(e,{min:g,max:t},I){return g!==void 0&&e<g?e=I?Gg(g,e,I.min):Math.max(e,g):t!==void 0&&e>t&&(e=I?Gg(t,e,I.max):Math.min(e,t)),e}function jb(e,g,t){return{min:g!==void 0?e.min+g:void 0,max:t!==void 0?e.max+t-(e.max-e.min):void 0}}function sN(e,{top:g,left:t,bottom:I,right:o}){return{x:jb(e.x,t,o),y:jb(e.y,g,I)}}function Pb(e,g){let t=g.min-e.min,I=g.max-e.max;return g.max-g.min<e.max-e.min&&([t,I]=[I,t]),{min:t,max:I}}function rN(e,g){return{x:Pb(e.x,g.x),y:Pb(e.y,g.y)}}function aN(e,g){let t=.5;const I=Ct(e),o=Ct(g);return o>I?t=WC(g.min,g.max-I,e.min):I>o&&(t=WC(e.min,e.max-o,g.min)),Un(0,1,t)}function cN(e,g){const t={};return g.min!==void 0&&(t.min=g.min-e.min),g.max!==void 0&&(t.max=g.max-e.min),t}const AA=.35;function dN(e=AA){return e===!1?e=0:e===!0&&(e=AA),{x:Ob(e,"left","right"),y:Ob(e,"top","bottom")}}function Ob(e,g,t){return{min:qb(e,g),max:qb(e,t)}}function qb(e,g){return typeof e=="number"?e:e[g]||0}const AN=new WeakMap;class uN{constructor(g){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=kg(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=g}start(g,{snapToCursor:t=!1,distanceThreshold:I}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const C=m=>{const{dragSnapToOrigin:Z}=this.getProps();Z?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor($C(m).point)},s=(m,Z)=>{const{drag:y,dragPropagation:G,onDragStart:B}=this.getProps();if(y&&!G&&(this.openDragLock&&this.openDragLock(),this.openDragLock=vF(y),!this.openDragLock))return;this.latestPointerEvent=m,this.latestPanInfo=Z,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xt(W=>{let v=this.getAxisMotionValue(W).get()||0;if(Bn.test(v)){const{projection:R}=this.visualElement;if(R&&R.layout){const k=R.layout.layoutBox[W];k&&(v=Ct(k)*(parseFloat(v)/100))}}this.originPoint[W]=v}),B&&hg.postRender(()=>B(m,Z)),rA(this.visualElement,"transform");const{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},r=(m,Z)=>{this.latestPointerEvent=m,this.latestPanInfo=Z;const{dragPropagation:y,dragDirectionLock:G,onDirectionLock:B,onDrag:f}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:W}=Z;if(G&&this.currentDirection===null){this.currentDirection=mN(W),this.currentDirection!==null&&B&&B(this.currentDirection);return}this.updateAxis("x",Z.point,W),this.updateAxis("y",Z.point,W),this.visualElement.render(),f&&f(m,Z)},c=(m,Z)=>{this.latestPointerEvent=m,this.latestPanInfo=Z,this.stop(m,Z),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>xt(m=>this.getAnimationState(m)==="paused"&&this.getAxisMotionValue(m).animation?.play()),{dragSnapToOrigin:A}=this.getProps();this.panSession=new of(g,{onSessionStart:C,onStart:s,onMove:r,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:A,distanceThreshold:I,contextWindow:lf(this.visualElement)})}stop(g,t){const I=g||this.latestPointerEvent,o=t||this.latestPanInfo,C=this.isDragging;if(this.cancel(),!C||!o||!I)return;const{velocity:s}=o;this.startAnimation(s);const{onDragEnd:r}=this.getProps();r&&hg.postRender(()=>r(I,o))}cancel(){this.isDragging=!1;const{projection:g,animationState:t}=this.visualElement;g&&(g.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:I}=this.getProps();!I&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(g,t,I){const{drag:o}=this.getProps();if(!I||!hs(g,o,this.currentDirection))return;const C=this.getAxisMotionValue(g);let s=this.originPoint[g]+I[g];this.constraints&&this.constraints[g]&&(s=iN(s,this.constraints[g],this.elastic[g])),C.set(s)}resolveConstraints(){const{dragConstraints:g,dragElastic:t}=this.getProps(),I=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,o=this.constraints;g&&Nl(g)?this.constraints||(this.constraints=this.resolveRefConstraints()):g&&I?this.constraints=sN(I.layoutBox,g):this.constraints=!1,this.elastic=dN(t),o!==this.constraints&&I&&this.constraints&&!this.hasMutatedConstraints&&xt(C=>{this.constraints!==!1&&this.getAxisMotionValue(C)&&(this.constraints[C]=cN(I.layoutBox[C],this.constraints[C]))})}resolveRefConstraints(){const{dragConstraints:g,onMeasureDragConstraints:t}=this.getProps();if(!g||!Nl(g))return!1;const I=g.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const C=IN(I,o.root,this.visualElement.getTransformPagePoint());let s=rN(o.layout.layoutBox,C);if(t){const r=t(PK(s));this.hasMutatedConstraints=!!r,r&&(s=$B(r))}return s}startAnimation(g){const{drag:t,dragMomentum:I,dragElastic:o,dragTransition:C,dragSnapToOrigin:s,onDragTransitionEnd:r}=this.getProps(),c=this.constraints||{},d=xt(A=>{if(!hs(A,t,this.currentDirection))return;let m=c&&c[A]||{};s&&(m={min:0,max:0});const Z=o?200:1e6,y=o?40:1e7,G={type:"inertia",velocity:I?g[A]:0,bounceStiffness:Z,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...C,...m};return this.startAxisValueAnimation(A,G)});return Promise.all(d).then(r)}startAxisValueAnimation(g,t){const I=this.getAxisMotionValue(g);return rA(this.visualElement,g),I.start(Yu(g,I,0,t,this.visualElement,!1))}stopAnimation(){xt(g=>this.getAxisMotionValue(g).stop())}pauseAnimation(){xt(g=>this.getAxisMotionValue(g).animation?.pause())}getAnimationState(g){return this.getAxisMotionValue(g).animation?.state}getAxisMotionValue(g){const t=`_drag${g.toUpperCase()}`,I=this.visualElement.getProps(),o=I[t];return o||this.visualElement.getValue(g,(I.initial?I.initial[g]:void 0)||0)}snapToCursor(g){xt(t=>{const{drag:I}=this.getProps();if(!hs(t,I,this.currentDirection))return;const{projection:o}=this.visualElement,C=this.getAxisMotionValue(t);if(o&&o.layout){const{min:s,max:r}=o.layout.layoutBox[t];C.set(g[t]-Gg(s,r,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:g,dragConstraints:t}=this.getProps(),{projection:I}=this.visualElement;if(!Nl(t)||!I||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};xt(s=>{const r=this.getAxisMotionValue(s);if(r&&this.constraints!==!1){const c=r.get();o[s]=aN({min:c,max:c},this.constraints[s])}});const{transformTemplate:C}=this.visualElement.getProps();this.visualElement.current.style.transform=C?C({},""):"none",I.root&&I.root.updateScroll(),I.updateLayout(),this.resolveConstraints(),xt(s=>{if(!hs(s,g,null))return;const r=this.getAxisMotionValue(s),{min:c,max:d}=this.constraints[s];r.set(Gg(c,d,o[s]))})}addListeners(){if(!this.visualElement.current)return;AN.set(this.visualElement,this);const g=this.visualElement.current,t=uC(g,"pointerdown",c=>{const{drag:d,dragListener:A=!0}=this.getProps();d&&A&&this.start(c)}),I=()=>{const{dragConstraints:c}=this.getProps();Nl(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,C=o.addEventListener("measure",I);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),hg.read(I);const s=YC(window,"resize",()=>this.scalePositionWithinConstraints()),r=o.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(xt(A=>{const m=this.getAxisMotionValue(A);m&&(this.originPoint[A]+=c[A].translate,m.set(m.get()+c[A].translate))}),this.visualElement.render())});return()=>{s(),t(),C(),r&&r()}}getProps(){const g=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:I=!1,dragPropagation:o=!1,dragConstraints:C=!1,dragElastic:s=AA,dragMomentum:r=!0}=g;return{...g,drag:t,dragDirectionLock:I,dragPropagation:o,dragConstraints:C,dragElastic:s,dragMomentum:r}}}function hs(e,g,t){return(g===!0||g===e)&&(t===null||t===e)}function mN(e,g=10){let t=null;return Math.abs(e.y)>g?t="y":Math.abs(e.x)>g&&(t="x"),t}class hN extends yI{constructor(g){super(g),this.removeGroupControls=Ut,this.removeListeners=Ut,this.controls=new uN(g)}mount(){const{dragControls:g}=this.node.getProps();g&&(this.removeGroupControls=g.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ut}unmount(){this.removeGroupControls(),this.removeListeners()}}const _b=e=>(g,t)=>{e&&hg.postRender(()=>e(g,t))};class pN extends yI{constructor(){super(...arguments),this.removePointerDownListener=Ut}onPointerDown(g){this.session=new of(g,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:lf(this.node)})}createPanHandlers(){const{onPanSessionStart:g,onPanStart:t,onPan:I,onPanEnd:o}=this.node.getProps();return{onSessionStart:_b(g),onStart:_b(t),onMove:I,onEnd:(C,s)=>{delete this.session,o&&hg.postRender(()=>o(C,s))}}}mount(){this.removePointerDownListener=uC(this.node.current,"pointerdown",g=>this.onPointerDown(g))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ns={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function $b(e,g){return g.max===g.min?0:e/(g.max-g.min)*100}const $o={correct:(e,g)=>{if(!g.target)return e;if(typeof e=="string")if(we.test(e))e=parseFloat(e);else return e;const t=$b(e,g.target.x),I=$b(e,g.target.y);return`${t}% ${I}%`}},ZN={correct:(e,{treeScale:g,projectionDelta:t})=>{const I=e,o=GI.parse(e);if(o.length>5)return I;const C=GI.createTransformer(e),s=typeof o[0]!="number"?1:0,r=t.x.scale*g.x,c=t.y.scale*g.y;o[0+s]/=r,o[1+s]/=c;const d=Gg(r,c,.5);return typeof o[2+s]=="number"&&(o[2+s]/=d),typeof o[3+s]=="number"&&(o[3+s]/=d),C(o)}};let e0=!1;class bN extends b.Component{componentDidMount(){const{visualElement:g,layoutGroup:t,switchLayoutGroup:I,layoutId:o}=this.props,{projection:C}=g;IK(GN),C&&(t.group&&t.group.add(C),I&&I.register&&o&&I.register(C),e0&&C.root.didUpdate(),C.addEventListener("animationComplete",()=>{this.safeToRemove()}),C.setOptions({...C.options,onExitComplete:()=>this.safeToRemove()})),Ns.hasEverUpdated=!0}getSnapshotBeforeUpdate(g){const{layoutDependency:t,visualElement:I,drag:o,isPresent:C}=this.props,{projection:s}=I;return s&&(s.isPresent=C,e0=!0,o||g.layoutDependency!==t||t===void 0||g.isPresent!==C?s.willUpdate():this.safeToRemove(),g.isPresent!==C&&(C?s.promote():s.relegate()||hg.postRender(()=>{const r=s.getStack();(!r||!r.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:g}=this.props.visualElement;g&&(g.root.didUpdate(),Bu.postRender(()=>{!g.currentAnimation&&g.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:g,layoutGroup:t,switchLayoutGroup:I}=this.props,{projection:o}=g;o&&(o.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(o),I&&I.deregister&&I.deregister(o))}safeToRemove(){const{safeToRemove:g}=this.props;g&&g()}render(){return null}}function sf(e){const[g,t]=zF(),I=b.useContext(Uy);return p.jsx(bN,{...e,layoutGroup:I,switchLayoutGroup:b.useContext(EB),isPresent:g,safeToRemove:t})}const GN={borderRadius:{...$o,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:$o,borderTopRightRadius:$o,borderBottomLeftRadius:$o,borderBottomRightRadius:$o,boxShadow:ZN};function yN(e,g,t){const I=tt(e)?e:Dl(e);return I.start(Yu("",I,g,t)),I.animation}const BN=(e,g)=>e.depth-g.depth;class fN{constructor(){this.children=[],this.isDirty=!1}add(g){Iu(this.children,g),this.isDirty=!0}remove(g){lu(this.children,g),this.isDirty=!0}forEach(g){this.isDirty&&this.children.sort(BN),this.isDirty=!1,this.children.forEach(g)}}function SN(e,g){const t=pt.now(),I=({timestamp:o})=>{const C=o-t;C>=g&&(bI(I),e(C-g))};return hg.setup(I,!0),()=>bI(I)}const rf=["TopLeft","TopRight","BottomLeft","BottomRight"],VN=rf.length,g0=e=>typeof e=="string"?parseFloat(e):e,t0=e=>typeof e=="number"||we.test(e);function WN(e,g,t,I,o,C){o?(e.opacity=Gg(0,t.opacity??1,RN(I)),e.opacityExit=Gg(g.opacity??1,0,XN(I))):C&&(e.opacity=Gg(g.opacity??1,t.opacity??1,I));for(let s=0;s<VN;s++){const r=`border${rf[s]}Radius`;let c=n0(g,r),d=n0(t,r);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||t0(c)===t0(d)?(e[r]=Math.max(Gg(g0(c),g0(d),I),0),(Bn.test(d)||Bn.test(c))&&(e[r]+="%")):e[r]=d}(g.rotate||t.rotate)&&(e.rotate=Gg(g.rotate||0,t.rotate||0,I))}function n0(e,g){return e[g]!==void 0?e[g]:e.borderRadius}const RN=af(0,.5,eB),XN=af(.5,.95,Ut);function af(e,g,t){return I=>I<e?0:I>g?1:t(WC(e,g,I))}function I0(e,g){e.min=g.min,e.max=g.max}function Kt(e,g){I0(e.x,g.x),I0(e.y,g.y)}function l0(e,g){e.translate=g.translate,e.scale=g.scale,e.originPoint=g.originPoint,e.origin=g.origin}function o0(e,g,t,I,o){return e-=g,e=Ir(e,1/t,I),o!==void 0&&(e=Ir(e,1/o,I)),e}function kN(e,g=0,t=1,I=.5,o,C=e,s=e){if(Bn.test(g)&&(g=parseFloat(g),g=Gg(s.min,s.max,g/100)-s.min),typeof g!="number")return;let r=Gg(C.min,C.max,I);e===C&&(r-=g),e.min=o0(e.min,g,t,r,o),e.max=o0(e.max,g,t,r,o)}function C0(e,g,[t,I,o],C,s){kN(e,g[t],g[I],g[o],g.scale,C,s)}const JN=["x","scaleX","originX"],vN=["y","scaleY","originY"];function i0(e,g,t,I){C0(e.x,g,JN,t?t.x:void 0,I?I.x:void 0),C0(e.y,g,vN,t?t.y:void 0,I?I.y:void 0)}function s0(e){return e.translate===0&&e.scale===1}function cf(e){return s0(e.x)&&s0(e.y)}function r0(e,g){return e.min===g.min&&e.max===g.max}function YN(e,g){return r0(e.x,g.x)&&r0(e.y,g.y)}function a0(e,g){return Math.round(e.min)===Math.round(g.min)&&Math.round(e.max)===Math.round(g.max)}function df(e,g){return a0(e.x,g.x)&&a0(e.y,g.y)}function c0(e){return Ct(e.x)/Ct(e.y)}function d0(e,g){return e.translate===g.translate&&e.scale===g.scale&&e.originPoint===g.originPoint}class HN{constructor(){this.members=[]}add(g){Iu(this.members,g),g.scheduleRender()}remove(g){if(lu(this.members,g),g===this.prevLead&&(this.prevLead=void 0),g===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(g){const t=this.members.findIndex(o=>g===o);if(t===0)return!1;let I;for(let o=t;o>=0;o--){const C=this.members[o];if(C.isPresent!==!1){I=C;break}}return I?(this.promote(I),!0):!1}promote(g,t){const I=this.lead;if(g!==I&&(this.prevLead=I,this.lead=g,g.show(),I)){I.instance&&I.scheduleRender(),g.scheduleRender(),g.resumeFrom=I,t&&(g.resumeFrom.preserveOpacity=!0),I.snapshot&&(g.snapshot=I.snapshot,g.snapshot.latestValues=I.animationValues||I.latestValues),g.root&&g.root.isUpdating&&(g.isLayoutDirty=!0);const{crossfade:o}=g.options;o===!1&&I.hide()}}exitAnimationComplete(){this.members.forEach(g=>{const{options:t,resumingFrom:I}=g;t.onExitComplete&&t.onExitComplete(),I&&I.options.onExitComplete&&I.options.onExitComplete()})}scheduleRender(){this.members.forEach(g=>{g.instance&&g.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function wN(e,g,t){let I="";const o=e.x.translate/g.x,C=e.y.translate/g.y,s=t?.z||0;if((o||C||s)&&(I=`translate3d(${o}px, ${C}px, ${s}px) `),(g.x!==1||g.y!==1)&&(I+=`scale(${1/g.x}, ${1/g.y}) `),t){const{transformPerspective:d,rotate:A,rotateX:m,rotateY:Z,skewX:y,skewY:G}=t;d&&(I=`perspective(${d}px) ${I}`),A&&(I+=`rotate(${A}deg) `),m&&(I+=`rotateX(${m}deg) `),Z&&(I+=`rotateY(${Z}deg) `),y&&(I+=`skewX(${y}deg) `),G&&(I+=`skewY(${G}deg) `)}const r=e.x.scale*g.x,c=e.y.scale*g.y;return(r!==1||c!==1)&&(I+=`scale(${r}, ${c})`),I||"none"}const Ad=["","X","Y","Z"],FN=1e3;let KN=0;function ud(e,g,t,I){const{latestValues:o}=g;o[e]&&(t[e]=o[e],g.setStaticValue(e,0),I&&(I[e]=0))}function Af(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:g}=e.options;if(!g)return;const t=PB(g);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:o,layoutId:C}=e.options;window.MotionCancelOptimisedAnimation(t,"transform",hg,!(o||C))}const{parent:I}=e;I&&!I.hasCheckedOptimisedAppear&&Af(I)}function uf({attachResizeListener:e,defaultParent:g,measureScroll:t,checkIsScrollRoot:I,resetTransform:o}){return class{constructor(s={},r=g?.()){this.id=KN++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(EN),this.nodes.forEach(LN),this.nodes.forEach(TN),this.nodes.forEach(zN)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=r?r.root||r:this,this.path=r?[...r.path,r]:[],this.parent=r,this.depth=r?r.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new fN)}addEventListener(s,r){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new iu),this.eventHandlers.get(s).add(r)}notifyListeners(s,...r){const c=this.eventHandlers.get(s);c&&c.notify(...r)}hasListeners(s){return this.eventHandlers.has(s)}mount(s){if(this.instance)return;this.isSVG=HB(s)&&!NF(s),this.instance=s;const{layoutId:r,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||r)&&(this.isLayoutDirty=!0),e){let A,m=0;const Z=()=>this.root.updateBlockedByResize=!1;hg.read(()=>{m=window.innerWidth}),e(s,()=>{const y=window.innerWidth;y!==m&&(m=y,this.root.updateBlockedByResize=!0,A&&A(),A=SN(Z,250),Ns.hasAnimatedSinceResize&&(Ns.hasAnimatedSinceResize=!1,this.nodes.forEach(m0)))})}r&&this.root.registerSharedNode(r,this),this.options.animate!==!1&&d&&(r||c)&&this.addEventListener("didUpdate",({delta:A,hasLayoutChanged:m,hasRelativeLayoutChanged:Z,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const G=this.options.transition||d.getDefaultTransition()||ON,{onLayoutAnimationStart:B,onLayoutAnimationComplete:f}=d.getProps(),W=!this.targetLayout||!df(this.targetLayout,y),v=!m&&Z;if(this.options.layoutRoot||this.resumeFrom||v||m&&(W||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const R={...Gu(G,"layout"),onPlay:B,onComplete:f};(d.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R),this.setAnimationOrigin(A,v)}else m||m0(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),bI(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(QN),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Af(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let A=0;A<this.path.length;A++){const m=this.path[A];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:r,layout:c}=this.options;if(r===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(A0);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(u0);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(UN),this.nodes.forEach(NN),this.nodes.forEach(xN)):this.nodes.forEach(u0),this.clearAllSnapshots();const r=pt.now();Qg.delta=Un(0,1e3/60,r-Qg.timestamp),Qg.timestamp=r,Qg.isProcessing=!0,ld.update.process(Qg),ld.preRender.process(Qg),ld.render.process(Qg),Qg.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Bu.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(MN),this.sharedNodes.forEach(DN)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,hg.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){hg.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ct(this.snapshot.measuredBox.x)&&!Ct(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=kg(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:r}=this.options;r&&r.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let r=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(r=!1),r&&this.instance){const c=I(this.instance);this.scroll={animationId:this.root.animationId,phase:s,isRoot:c,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!o)return;const s=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,r=this.projectionDelta&&!cf(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,A=d!==this.prevTransformTemplateValue;s&&this.instance&&(r||UI(this.latestValues)||A)&&(o(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const r=this.measurePageBox();let c=this.removeElementScroll(r);return s&&(c=this.removeTransform(c)),qN(c),{animationId:this.root.animationId,measuredBox:r,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:s}=this.options;if(!s)return kg();const r=s.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(_N))){const{scroll:d}=this.root;d&&(El(r.x,d.offset.x),El(r.y,d.offset.y))}return r}removeElementScroll(s){const r=kg();if(Kt(r,s),this.scroll?.wasRoot)return r;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:A,options:m}=d;d!==this.root&&A&&m.layoutScroll&&(A.wasRoot&&Kt(r,s),El(r.x,A.offset.x),El(r.y,A.offset.y))}return r}applyTransform(s,r=!1){const c=kg();Kt(c,s);for(let d=0;d<this.path.length;d++){const A=this.path[d];!r&&A.options.layoutScroll&&A.scroll&&A!==A.root&&zl(c,{x:-A.scroll.offset.x,y:-A.scroll.offset.y}),UI(A.latestValues)&&zl(c,A.latestValues)}return UI(this.latestValues)&&zl(c,this.latestValues),c}removeTransform(s){const r=kg();Kt(r,s);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!UI(d.latestValues))continue;cA(d.latestValues)&&d.updateSnapshot();const A=kg(),m=d.measurePageBox();Kt(A,m),i0(r,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,A)}return UI(this.latestValues)&&i0(r,this.latestValues),r}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Qg.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){const r=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=r.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=r.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=r.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==r;if(!(s||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:A,layoutId:m}=this.options;if(!(!this.layout||!(A||m))){if(this.resolvedRelativeTargetAt=Qg.timestamp,!this.targetDelta&&!this.relativeTarget){const Z=this.getClosestProjectingParent();Z&&Z.layout&&this.animationProgress!==1?(this.relativeParent=Z,this.forceRelativeParentToResolveTarget(),this.relativeTarget=kg(),this.relativeTargetOrigin=kg(),hC(this.relativeTargetOrigin,this.layout.layoutBox,Z.layout.layoutBox),Kt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=kg(),this.targetWithTransforms=kg()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),tN(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Kt(this.target,this.layout.layoutBox),nf(this.target,this.targetDelta)):Kt(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const Z=this.getClosestProjectingParent();Z&&!!Z.resumingFrom==!!this.resumingFrom&&!Z.options.layoutScroll&&Z.target&&this.animationProgress!==1?(this.relativeParent=Z,this.forceRelativeParentToResolveTarget(),this.relativeTarget=kg(),this.relativeTargetOrigin=kg(),hC(this.relativeTargetOrigin,this.target,Z.target),Kt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||cA(this.parent.latestValues)||tf(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const s=this.getLead(),r=!!this.resumingFrom||this!==s;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),r&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Qg.timestamp&&(c=!1),c)return;const{layout:d,layoutId:A}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||A))return;Kt(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,Z=this.treeScale.y;nN(this.layoutCorrected,this.treeScale,this.path,r),s.layout&&!s.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(s.target=s.layout.layoutBox,s.targetWithTransforms=kg());const{target:y}=s;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(l0(this.prevProjectionDelta.x,this.projectionDelta.x),l0(this.prevProjectionDelta.y,this.projectionDelta.y)),mC(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==Z||!d0(this.projectionDelta.x,this.prevProjectionDelta.x)||!d0(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){if(this.options.visualElement?.scheduleRender(),s){const r=this.getStack();r&&r.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=xl(),this.projectionDelta=xl(),this.projectionDeltaWithTransform=xl()}setAnimationOrigin(s,r=!1){const c=this.snapshot,d=c?c.latestValues:{},A={...this.latestValues},m=xl();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!r;const Z=kg(),y=c?c.source:void 0,G=this.layout?this.layout.source:void 0,B=y!==G,f=this.getStack(),W=!f||f.members.length<=1,v=!!(B&&!W&&this.options.crossfade===!0&&!this.path.some(PN));this.animationProgress=0;let R;this.mixTargetDelta=k=>{const J=k/1e3;h0(m.x,s.x,J),h0(m.y,s.y,J),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(hC(Z,this.layout.layoutBox,this.relativeParent.layout.layoutBox),jN(this.relativeTarget,this.relativeTargetOrigin,Z,J),R&&YN(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=kg()),Kt(R,this.relativeTarget)),B&&(this.animationValues=A,WN(A,d,this.latestValues,J,v,W)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=J},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(bI(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=hg.update(()=>{Ns.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Dl(0)),this.currentAnimation=yN(this.motionValue,[0,1e3],{...s,velocity:0,isSync:!0,onUpdate:r=>{this.mixTargetDelta(r),s.onUpdate&&s.onUpdate(r)},onStop:()=>{},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(FN),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:r,target:c,layout:d,latestValues:A}=s;if(!(!r||!c||!d)){if(this!==s&&this.layout&&d&&mf(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||kg();const m=Ct(this.layout.layoutBox.x);c.x.min=s.target.x.min,c.x.max=c.x.min+m;const Z=Ct(this.layout.layoutBox.y);c.y.min=s.target.y.min,c.y.max=c.y.min+Z}Kt(r,c),zl(r,A),mC(this.projectionDeltaWithTransform,this.layoutCorrected,r,A)}}registerSharedNode(s,r){this.sharedNodes.has(s)||this.sharedNodes.set(s,new HN),this.sharedNodes.get(s).add(r);const d=r.options.initialPromotionConfig;r.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(r):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){const{layoutId:s}=this.options;return s?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:s}=this.options;return s?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:r,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),s&&(this.projectionDelta=void 0,this.needsReset=!0),r&&this.setOptions({transition:r})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetSkewAndRotation(){const{visualElement:s}=this.options;if(!s)return;let r=!1;const{latestValues:c}=s;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(r=!0),!r)return;const d={};c.z&&ud("z",s,d,this.animationValues);for(let A=0;A<Ad.length;A++)ud(`rotate${Ad[A]}`,s,d,this.animationValues),ud(`skew${Ad[A]}`,s,d,this.animationValues);s.render();for(const A in d)s.setStaticValue(A,d[A]),this.animationValues&&(this.animationValues[A]=d[A]);s.scheduleRender()}applyProjectionStyles(s,r){if(!this.instance||this.isSVG)return;if(!this.isVisible){s.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,s.visibility="",s.opacity="",s.pointerEvents=Ks(r?.pointerEvents)||"",s.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(s.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,s.pointerEvents=Ks(r?.pointerEvents)||""),this.hasProjected&&!UI(this.latestValues)&&(s.transform=c?c({},""):"none",this.hasProjected=!1);return}s.visibility="";const A=d.animationValues||d.latestValues;this.applyTransformsToTarget();let m=wN(this.projectionDeltaWithTransform,this.treeScale,A);c&&(m=c(A,m)),s.transform=m;const{x:Z,y}=this.projectionDelta;s.transformOrigin=`${Z.origin*100}% ${y.origin*100}% 0`,d.animationValues?s.opacity=d===this?A.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:A.opacityExit:s.opacity=d===this?A.opacity!==void 0?A.opacity:"":A.opacityExit!==void 0?A.opacityExit:0;for(const G in JC){if(A[G]===void 0)continue;const{correct:B,applyTo:f,isCSSVariable:W}=JC[G],v=m==="none"?A[G]:B(A[G],d);if(f){const R=f.length;for(let k=0;k<R;k++)s[f[k]]=v}else W?this.options.visualElement.renderState.vars[G]=v:s[G]=v}this.options.layoutId&&(s.pointerEvents=d===this?Ks(r?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>s.currentAnimation?.stop()),this.root.nodes.forEach(A0),this.root.sharedNodes.clear()}}}function NN(e){e.updateLayout()}function xN(e){const g=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&g&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:I}=e.layout,{animationType:o}=e.options,C=g.source!==e.layout.source;o==="size"?xt(A=>{const m=C?g.measuredBox[A]:g.layoutBox[A],Z=Ct(m);m.min=t[A].min,m.max=m.min+Z}):mf(o,g.layoutBox,t)&&xt(A=>{const m=C?g.measuredBox[A]:g.layoutBox[A],Z=Ct(t[A]);m.max=m.min+Z,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[A].max=e.relativeTarget[A].min+Z)});const s=xl();mC(s,t,g.layoutBox);const r=xl();C?mC(r,e.applyTransform(I,!0),g.measuredBox):mC(r,t,g.layoutBox);const c=!cf(s);let d=!1;if(!e.resumeFrom){const A=e.getClosestProjectingParent();if(A&&!A.resumeFrom){const{snapshot:m,layout:Z}=A;if(m&&Z){const y=kg();hC(y,g.layoutBox,m.layoutBox);const G=kg();hC(G,t,Z.layoutBox),df(y,G)||(d=!0),A.options.layoutRoot&&(e.relativeTarget=G,e.relativeTargetOrigin=y,e.relativeParent=A)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:g,delta:r,layoutDelta:s,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function EN(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function zN(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function MN(e){e.clearSnapshot()}function A0(e){e.clearMeasurements()}function u0(e){e.isLayoutDirty=!1}function UN(e){const{visualElement:g}=e.options;g&&g.getProps().onBeforeLayoutMeasure&&g.notify("BeforeLayoutMeasure"),e.resetTransform()}function m0(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function LN(e){e.resolveTargetDelta()}function TN(e){e.calcProjection()}function QN(e){e.resetSkewAndRotation()}function DN(e){e.removeLeadSnapshot()}function h0(e,g,t){e.translate=Gg(g.translate,0,t),e.scale=Gg(g.scale,1,t),e.origin=g.origin,e.originPoint=g.originPoint}function p0(e,g,t,I){e.min=Gg(g.min,t.min,I),e.max=Gg(g.max,t.max,I)}function jN(e,g,t,I){p0(e.x,g.x,t.x,I),p0(e.y,g.y,t.y,I)}function PN(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const ON={duration:.45,ease:[.4,0,.1,1]},Z0=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),b0=Z0("applewebkit/")&&!Z0("chrome/")?Math.round:Ut;function G0(e){e.min=b0(e.min),e.max=b0(e.max)}function qN(e){G0(e.x),G0(e.y)}function mf(e,g,t){return e==="position"||e==="preserve-aspect"&&!gN(c0(g),c0(t),.2)}function _N(e){return e!==e.root&&e.scroll?.wasRoot}const $N=uf({attachResizeListener:(e,g)=>YC(e,"resize",g),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),md={current:void 0},hf=uf({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!md.current){const e=new $N({});e.mount(window),e.setOptions({layoutScroll:!0}),md.current=e}return md.current},resetTransform:(e,g)=>{e.style.transform=g!==void 0?g:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),e1={pan:{Feature:pN},drag:{Feature:hN,ProjectionNode:hf,MeasureLayout:sf}};function y0(e,g,t){const{props:I}=e;e.animationState&&I.whileHover&&e.animationState.setActive("whileHover",t==="Start");const o="onHover"+t,C=I[o];C&&hg.postRender(()=>C(g,$C(g)))}class g1 extends yI{mount(){const{current:g}=this.node;g&&(this.unmount=YF(g,(t,I)=>(y0(this.node,I,"Start"),o=>y0(this.node,o,"End"))))}unmount(){}}class t1 extends yI{constructor(){super(...arguments),this.isActive=!1}onFocus(){let g=!1;try{g=this.node.current.matches(":focus-visible")}catch{g=!0}!g||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=OC(YC(this.node.current,"focus",()=>this.onFocus()),YC(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function B0(e,g,t){const{props:I}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&I.whileTap&&e.animationState.setActive("whileTap",t==="Start");const o="onTap"+(t==="End"?"":t),C=I[o];C&&hg.postRender(()=>C(g,$C(g)))}class n1 extends yI{mount(){const{current:g}=this.node;g&&(this.unmount=KF(g,(t,I)=>(B0(this.node,I,"Start"),(o,{success:C})=>B0(this.node,o,C?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const uA=new WeakMap,hd=new WeakMap,I1=e=>{const g=uA.get(e.target);g&&g(e)},l1=e=>{e.forEach(I1)};function o1({root:e,...g}){const t=e||document;hd.has(t)||hd.set(t,{});const I=hd.get(t),o=JSON.stringify(g);return I[o]||(I[o]=new IntersectionObserver(l1,{root:e,...g})),I[o]}function C1(e,g,t){const I=o1(g);return uA.set(e,t),I.observe(e),()=>{uA.delete(e),I.unobserve(e)}}const i1={some:0,all:1};class s1 extends yI{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:g={}}=this.node.getProps(),{root:t,margin:I,amount:o="some",once:C}=g,s={root:t?t.current:void 0,rootMargin:I,threshold:typeof o=="number"?o:i1[o]},r=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,C&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:A,onViewportLeave:m}=this.node.getProps(),Z=d?A:m;Z&&Z(c)};return C1(this.node.current,s,r)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:g,prevProps:t}=this.node;["amount","margin","root"].some(r1(g,t))&&this.startObserver()}unmount(){}}function r1({viewport:e={}},{viewport:g={}}={}){return t=>e[t]!==g[t]}const a1={inView:{Feature:s1},tap:{Feature:n1},focus:{Feature:t1},hover:{Feature:g1}},c1={layout:{ProjectionNode:hf,MeasureLayout:sf}},mA={current:null},pf={current:!1};function d1(){if(pf.current=!0,!!tu)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),g=()=>mA.current=e.matches;e.addEventListener("change",g),g()}else mA.current=!1}const A1=new WeakMap;function u1(e,g,t){for(const I in g){const o=g[I],C=t[I];if(tt(o))e.addValue(I,o);else if(tt(C))e.addValue(I,Dl(o,{owner:e}));else if(C!==o)if(e.hasValue(I)){const s=e.getValue(I);s.liveStyle===!0?s.jump(o):s.hasAnimated||s.set(o)}else{const s=e.getStaticValue(I);e.addValue(I,Dl(s!==void 0?s:o,{owner:e}))}}for(const I in t)g[I]===void 0&&e.removeValue(I);return g}const f0=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class m1{scrapeMotionValuesFromProps(g,t,I){return{}}constructor({parent:g,props:t,presenceContext:I,reducedMotionConfig:o,blockInitialAnimation:C,visualState:s},r={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=bu,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const Z=pt.now();this.renderScheduledAt<Z&&(this.renderScheduledAt=Z,hg.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=s;this.latestValues=c,this.baseTarget={...c},this.initialValues=t.initial?{...c}:{},this.renderState=d,this.parent=g,this.props=t,this.presenceContext=I,this.depth=g?g.depth+1:0,this.reducedMotionConfig=o,this.options=r,this.blockInitialAnimation=!!C,this.isControllingVariants=Kr(t),this.isVariantNode=NB(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(g&&g.current);const{willChange:A,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const Z in m){const y=m[Z];c[Z]!==void 0&&tt(y)&&y.set(c[Z],!1)}}mount(g){this.current=g,A1.set(g,this),this.projection&&!this.projection.instance&&this.projection.mount(g),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,I)=>this.bindToMotionValue(I,t)),pf.current||d1(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:mA.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),bI(this.notifyUpdate),bI(this.render),this.valueSubscriptions.forEach(g=>g()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const g in this.events)this.events[g].clear();for(const g in this.features){const t=this.features[g];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(g,t){this.valueSubscriptions.has(g)&&this.valueSubscriptions.get(g)();const I=Io.has(g);I&&this.onBindTransform&&this.onBindTransform();const o=t.on("change",r=>{this.latestValues[g]=r,this.props.onUpdate&&hg.preRender(this.notifyUpdate),I&&this.projection&&(this.projection.isTransformDirty=!0)}),C=t.on("renderRequest",this.scheduleRender);let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,g,t)),this.valueSubscriptions.set(g,()=>{o(),C(),s&&s(),t.owner&&t.stop()})}sortNodePosition(g){return!this.current||!this.sortInstanceNodePosition||this.type!==g.type?0:this.sortInstanceNodePosition(this.current,g.current)}updateFeatures(){let g="animation";for(g in jl){const t=jl[g];if(!t)continue;const{isEnabled:I,Feature:o}=t;if(!this.features[g]&&o&&I(this.props)&&(this.features[g]=new o(this)),this.features[g]){const C=this.features[g];C.isMounted?C.update():(C.mount(),C.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):kg()}getStaticValue(g){return this.latestValues[g]}setStaticValue(g,t){this.latestValues[g]=t}update(g,t){(g.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=g,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let I=0;I<f0.length;I++){const o=f0[I];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const C="on"+o,s=g[C];s&&(this.propEventSubscriptions[o]=this.on(o,s))}this.prevMotionValues=u1(this,this.scrapeMotionValuesFromProps(g,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(g){return this.props.variants?this.props.variants[g]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(g){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(g),()=>t.variantChildren.delete(g)}addValue(g,t){const I=this.values.get(g);t!==I&&(I&&this.removeValue(g),this.bindToMotionValue(g,t),this.values.set(g,t),this.latestValues[g]=t.get())}removeValue(g){this.values.delete(g);const t=this.valueSubscriptions.get(g);t&&(t(),this.valueSubscriptions.delete(g)),delete this.latestValues[g],this.removeValueFromRenderState(g,this.renderState)}hasValue(g){return this.values.has(g)}getValue(g,t){if(this.props.values&&this.props.values[g])return this.props.values[g];let I=this.values.get(g);return I===void 0&&t!==void 0&&(I=Dl(t===null?void 0:t,{owner:this}),this.addValue(g,I)),I}readValue(g,t){let I=this.latestValues[g]!==void 0||!this.current?this.latestValues[g]:this.getBaseTargetFromProps(this.props,g)??this.readValueFromInstance(this.current,g,this.options);return I!=null&&(typeof I=="string"&&(Ly(I)||Qy(I))?I=parseFloat(I):!EF(I)&&GI.test(t)&&(I=RB(g,t)),this.setBaseTarget(g,tt(I)?I.get():I)),tt(I)?I.get():I}setBaseTarget(g,t){this.baseTarget[g]=t}getBaseTarget(g){const{initial:t}=this.props;let I;if(typeof t=="string"||typeof t=="object"){const C=Ju(this.props,t,this.presenceContext?.custom);C&&(I=C[g])}if(t&&I!==void 0)return I;const o=this.getBaseTargetFromProps(this.props,g);return o!==void 0&&!tt(o)?o:this.initialValues[g]!==void 0&&I===void 0?void 0:this.baseTarget[g]}on(g,t){return this.events[g]||(this.events[g]=new iu),this.events[g].add(t)}notify(g,...t){this.events[g]&&this.events[g].notify(...t)}}class Zf extends m1{constructor(){super(...arguments),this.KeyframeResolver=XF}sortInstanceNodePosition(g,t){return g.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(g,t){return g.style?g.style[t]:void 0}removeValueFromRenderState(g,{vars:t,style:I}){delete t[g],delete I[g]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:g}=this.props;tt(g)&&(this.childSubscription=g.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function bf(e,{style:g,vars:t},I,o){const C=e.style;let s;for(s in g)C[s]=g[s];o?.applyProjectionStyles(C,I);for(s in t)C.setProperty(s,t[s])}function h1(e){return window.getComputedStyle(e)}class p1 extends Zf{constructor(){super(...arguments),this.type="html",this.renderInstance=bf}readValueFromInstance(g,t){if(Io.has(t))return this.projection?.isProjecting?nA(t):jw(g,t);{const I=h1(g),o=(au(t)?I.getPropertyValue(t):I[t])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(g,{transformPagePoint:t}){return If(g,t)}build(g,t,I){Ru(g,t,I.transformTemplate)}scrapeMotionValuesFromProps(g,t,I){return vu(g,t,I)}}const Gf=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Z1(e,g,t,I){bf(e,g,void 0,I);for(const o in g.attrs)e.setAttribute(Gf.has(o)?o:Wu(o),g.attrs[o])}class b1 extends Zf{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=kg}getBaseTargetFromProps(g,t){return g[t]}readValueFromInstance(g,t){if(Io.has(t)){const I=WB(t);return I&&I.default||0}return t=Gf.has(t)?t:Wu(t),g.getAttribute(t)}scrapeMotionValuesFromProps(g,t,I){return jB(g,t,I)}build(g,t,I){LB(g,t,this.isSVGTag,I.transformTemplate,I.style)}renderInstance(g,t,I,o){Z1(g,t,I,o)}mount(g){this.isSVGTag=QB(g.tagName),super.mount(g)}}const G1=(e,g)=>ku(e)?new b1(g):new p1(g,{allowProjection:e!==b.Fragment}),y1=GK({...DK,...a1,...e1,...c1},G1),B1=QF(y1),f1={some:0,all:1};function S1(e,g,{root:t,margin:I,amount:o="some"}={}){const C=XB(e),s=new WeakMap,r=d=>{d.forEach(A=>{const m=s.get(A.target);if(A.isIntersecting!==!!m)if(A.isIntersecting){const Z=g(A.target,A);typeof Z=="function"?s.set(A.target,Z):c.unobserve(A.target)}else typeof m=="function"&&(m(A),s.delete(A.target))})},c=new IntersectionObserver(r,{root:t,rootMargin:I,threshold:typeof o=="number"?o:f1[o]});return C.forEach(d=>c.observe(d)),()=>c.disconnect()}function V1(e,{root:g,margin:t,amount:I,once:o=!1,initial:C=!1}={}){const[s,r]=b.useState(C);return b.useEffect(()=>{if(!e.current||o&&s)return;const c=()=>(r(!0),o?void 0:()=>r(!1)),d={root:g&&g.current||void 0,margin:t,amount:I};return S1(e.current,c,d)},[g,e,t,o,I]),s}const W1=({title:e,description:g,cost:t,img:I,num:o})=>{const C=o%2===0,s=b.useRef(null),r=V1(s,{once:!0}),c={opacity:r?1:0,y:r?0:20,transition:{duration:.6,ease:"easeOut"}};return p.jsx(p.Fragment,{children:p.jsx(B1.div,{ref:s,animate:c,children:C?p.jsxs("div",{style:{...S0},children:[p.jsx("img",{src:I,alt:e,style:V0}),p.jsxs("div",{style:W0,children:[p.jsx("h3",{style:{margin:0},children:e}),p.jsx("p",{style:{margin:0},children:g})]})]}):p.jsxs("div",{style:{...S0},children:[p.jsxs("div",{style:W0,children:[p.jsx("h3",{style:{margin:0},children:e}),p.jsx("p",{style:{margin:0},children:g})]}),p.jsx("img",{src:I,alt:e,style:V0})]})})})},S0={display:"flex",flexDirection:"row",alignItems:"center",width:"90%",height:"150px",padding:"10px",color:"white",backgroundColor:"#FF5F00",borderWidth:"2px",borderRadius:"5px",borderColor:"#ff2400",borderStyle:"solid",gap:"10px"},V0={width:"150px",height:"150px",objectFit:"cover",borderRadius:"8px"},W0={width:"200px",display:"flex",flexDirection:"column"},R0="https://pilot-hestia-backend.onrender.com",R1=()=>{const e=Qn(),[g,t]=b.useState([]),[I,o]=b.useState([]),{selectedVendorId:C,setSelectedVendorId:s,handleVendorClick:r}=b.useContext(gu);b.useEffect(()=>{(async()=>{try{const A=await We.get(`${R0}/api/vendor/all`);if(A.data){const m=A.data;t(m),s(Z=>Z||m[0]?.id)}}catch(A){console.log("No vendors received",A)}})()},[]),b.useEffect(()=>{(async()=>{try{const m=(await We.get(`${R0}/api/activities/retrieve`))?.data;o(m),console.log(I)}catch{console.log("couldn't fetch activities")}})()},[]);const c="flex-container"+(g.length===3?" three-items":"");return p.jsxs("div",{id:"superContainer",style:X1,children:[p.jsx(PC,{}),p.jsx("div",{style:J1,children:p.jsxs("div",{style:v1,children:[p.jsx("h2",{style:k1,children:"Earn Points. Get Rewards. Power Your Community."}),p.jsx("h5",{style:X0,children:"Join activities, scan QR codes, and redeem discounts at local vendors."}),p.jsx(_e,{onClick:()=>e("/profile"),variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"10px",fontWeight:600},children:"Profile"}),p.jsx("h5",{style:X0,children:"Check out your profile!"})]})}),p.jsx("div",{style:{width:"90%",marginTop:"1em"},children:p.jsx(v2,{})}),p.jsxs("div",{children:[p.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:p.jsx("h1",{style:{...pd,fontSize:"30px"},children:"Meet the Vendors..."})}),p.jsx("div",{className:c,children:g.map(d=>p.jsx(eu,{img:d?.img,business_name:d?.business_name,onClick:()=>r(d?.id),isSelected:C===d?.id},d?.id))}),p.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:p.jsx("h1",{style:{...pd,fontSize:"20px"},children:"And Their Rewards!"})}),p.jsx("div",{style:{padding:"10px"},children:p.jsx(MH,{id:C})}),p.jsx("br",{})]}),p.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:p.jsx("h1",{style:{...pd,fontSize:"30px"},children:"See what's happening!"})}),p.jsx("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",padding:"10px",gap:"10px"},children:I.map((d,A)=>p.jsx(W1,{title:d?.title,description:d?.description,cost:d?.cost,img:d?.img,num:A+1},d?.id))})]})},X1={position:"relative",width:"100%",overflowX:"hidden",display:"flex",color:"black",flexDirection:"column",alignItems:"center",margin:0},k1={margin:0,fontSize:30,lineHeight:1,color:"white",textShadow:`
    -1px -1px 0 #FF5F00,  
     1px -1px 0 #FF5F00,
    -1px  1px 0 #FF5F00,
     1px  1px 0 #FF5F00
  `},pd={color:"#FF5F00"},X0={margin:0,fontSize:17,lineHeight:1,color:"white",textShadow:`
    -1px -1px 0 #FF5F00,  
     1px -1px 0 #FF5F00,
    -1px  1px 0 #FF5F00,
     1px  1px 0 #FF5F00
  `},J1={position:"relative",margin:"0 auto",display:"flex",color:"White",padding:"10px",gap:"15em",flexDirection:"column",backgroundColor:"white",backgroundImage:`url(${UH})`,backgroundSize:"cover",backgroundPosition:"center",alignItems:"center"},v1={marginTop:"2em",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"8px",padding:"10px"},Y1=$e("MuiBox",["root"]),H1=ey(),st=yk({themeId:Vr,defaultTheme:H1,defaultClassName:Y1.root,generateClassName:fG.generate});function ps(e){return parseInt(e,10)||0}const w1={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function F1(e){for(const g in e)return!1;return!0}function k0(e){return F1(e)||e.outerHeightStyle===0&&!e.overflowing}const K1=b.forwardRef(function(g,t){const{onChange:I,maxRows:o,minRows:C=1,style:s,value:r,...c}=g,{current:d}=b.useRef(r!=null),A=b.useRef(null),m=it(t,A),Z=b.useRef(null),y=b.useRef(null),G=b.useCallback(()=>{const R=A.current,k=y.current;if(!R||!k)return;const F=Mn(R).getComputedStyle(R);if(F.width==="0px")return{outerHeightStyle:0,overflowing:!1};k.style.width=F.width,k.value=R.value||g.placeholder||"x",k.value.slice(-1)===`
`&&(k.value+=" ");const U=F.boxSizing,X=ps(F.paddingBottom)+ps(F.paddingTop),K=ps(F.borderBottomWidth)+ps(F.borderTopWidth),w=k.scrollHeight;k.value="x";const D=k.scrollHeight;let V=w;C&&(V=Math.max(Number(C)*D,V)),o&&(V=Math.min(Number(o)*D,V)),V=Math.max(V,D);const z=V+(U==="border-box"?X+K:0),N=Math.abs(V-w)<=1;return{outerHeightStyle:z,overflowing:N}},[o,C,g.placeholder]),B=PI(()=>{const R=A.current,k=G();if(!R||!k||k0(k))return!1;const J=k.outerHeightStyle;return Z.current!=null&&Z.current!==J}),f=b.useCallback(()=>{const R=A.current,k=G();if(!R||!k||k0(k))return;const J=k.outerHeightStyle;Z.current!==J&&(Z.current=J,R.style.height=`${J}px`),R.style.overflow=k.overflowing?"hidden":""},[G]),W=b.useRef(-1);pI(()=>{const R=ty(f),k=A?.current;if(!k)return;const J=Mn(k);J.addEventListener("resize",R);let F;return typeof ResizeObserver<"u"&&(F=new ResizeObserver(()=>{B()&&(F.unobserve(k),cancelAnimationFrame(W.current),f(),W.current=requestAnimationFrame(()=>{F.observe(k)}))}),F.observe(k)),()=>{R.clear(),cancelAnimationFrame(W.current),J.removeEventListener("resize",R),F&&F.disconnect()}},[G,f,B]),pI(()=>{f()});const v=R=>{d||f();const k=R.target,J=k.value.length,F=k.value.endsWith(`
`),U=k.selectionStart===J;F&&U&&k.setSelectionRange(J,J),I&&I(R)};return p.jsxs(b.Fragment,{children:[p.jsx("textarea",{value:r,onChange:v,ref:m,rows:C,style:s,...c}),p.jsx("textarea",{"aria-hidden":!0,className:g.className,readOnly:!0,ref:y,tabIndex:-1,style:{...w1.shadow,...s,paddingTop:0,paddingBottom:0}})]})});function lo({props:e,states:g,muiFormControl:t}){return g.reduce((I,o)=>(I[o]=e[o],t&&typeof e[o]>"u"&&(I[o]=t[o]),I),{})}const Hu=b.createContext(void 0);function oo(){return b.useContext(Hu)}function J0(e){return e!=null&&!(Array.isArray(e)&&e.length===0)}function lr(e,g=!1){return e&&(J0(e.value)&&e.value!==""||g&&J0(e.defaultValue)&&e.defaultValue!=="")}function N1(e){return e.startAdornment}function x1(e){return Cg("MuiInputBase",e)}const Pl=$e("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var v0;const Nr=(e,g)=>{const{ownerState:t}=e;return[g.root,t.formControl&&g.formControl,t.startAdornment&&g.adornedStart,t.endAdornment&&g.adornedEnd,t.error&&g.error,t.size==="small"&&g.sizeSmall,t.multiline&&g.multiline,t.color&&g[`color${ze(t.color)}`],t.fullWidth&&g.fullWidth,t.hiddenLabel&&g.hiddenLabel]},xr=(e,g)=>{const{ownerState:t}=e;return[g.input,t.size==="small"&&g.inputSizeSmall,t.multiline&&g.inputMultiline,t.type==="search"&&g.inputTypeSearch,t.startAdornment&&g.inputAdornedStart,t.endAdornment&&g.inputAdornedEnd,t.hiddenLabel&&g.inputHiddenLabel]},E1=e=>{const{classes:g,color:t,disabled:I,error:o,endAdornment:C,focused:s,formControl:r,fullWidth:c,hiddenLabel:d,multiline:A,readOnly:m,size:Z,startAdornment:y,type:G}=e,B={root:["root",`color${ze(t)}`,I&&"disabled",o&&"error",c&&"fullWidth",s&&"focused",r&&"formControl",Z&&Z!=="medium"&&`size${ze(Z)}`,A&&"multiline",y&&"adornedStart",C&&"adornedEnd",d&&"hiddenLabel",m&&"readOnly"],input:["input",I&&"disabled",G==="search"&&"inputTypeSearch",A&&"inputMultiline",Z==="small"&&"inputSizeSmall",d&&"inputHiddenLabel",y&&"inputAdornedStart",C&&"inputAdornedEnd",m&&"readOnly"]};return og(B,x1,g)},Er=Xe("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Nr})(vg(({theme:e})=>({...e.typography.body1,color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Pl.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:g})=>g.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:g,size:t})=>g.multiline&&t==="small",style:{paddingTop:1}},{props:({ownerState:g})=>g.fullWidth,style:{width:"100%"}}]}))),zr=Xe("input",{name:"MuiInputBase",slot:"Input",overridesResolver:xr})(vg(({theme:e})=>{const g=e.palette.mode==="light",t={color:"currentColor",...e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:g?.42:.5},transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})},I={opacity:"0 !important"},o=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:g?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":t,"&::-moz-placeholder":t,"&::-ms-input-placeholder":t,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Pl.formControl} &`]:{"&::-webkit-input-placeholder":I,"&::-moz-placeholder":I,"&::-ms-input-placeholder":I,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${Pl.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},variants:[{props:({ownerState:C})=>!C.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:C})=>C.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),Y0=jJ({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),wu=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiInputBase"}),{"aria-describedby":o,autoComplete:C,autoFocus:s,className:r,color:c,components:d={},componentsProps:A={},defaultValue:m,disabled:Z,disableInjectingGlobalStyles:y,endAdornment:G,error:B,fullWidth:f=!1,id:W,inputComponent:v="input",inputProps:R={},inputRef:k,margin:J,maxRows:F,minRows:U,multiline:X=!1,name:K,onBlur:w,onChange:D,onClick:V,onFocus:z,onKeyDown:N,onKeyUp:L,placeholder:Q,readOnly:q,renderSuffix:j,rows:P,size:$,slotProps:H={},slots:M={},startAdornment:te,type:oe="text",value:ne,...ae}=I,re=R.value!=null?R.value:ne,{current:Ge}=b.useRef(re!=null),ue=b.useRef(),Ae=b.useCallback(De=>{},[]),ce=it(ue,k,R.ref,Ae),[me,Ke]=b.useState(!1),Ye=oo(),xe=lo({props:I,muiFormControl:Ye,states:["color","disabled","error","hiddenLabel","size","required","filled"]});xe.focused=Ye?Ye.focused:me,b.useEffect(()=>{!Ye&&Z&&me&&(Ke(!1),w&&w())},[Ye,Z,me,w]);const Qe=Ye&&Ye.onFilled,ye=Ye&&Ye.onEmpty,he=b.useCallback(De=>{lr(De)?Qe&&Qe():ye&&ye()},[Qe,ye]);pI(()=>{Ge&&he({value:re})},[re,he,Ge]);const be=De=>{z&&z(De),R.onFocus&&R.onFocus(De),Ye&&Ye.onFocus?Ye.onFocus(De):Ke(!0)},se=De=>{w&&w(De),R.onBlur&&R.onBlur(De),Ye&&Ye.onBlur?Ye.onBlur(De):Ke(!1)},pe=(De,...ag)=>{if(!Ge){const on=De.target||ue.current;if(on==null)throw new Error(En(1));he({value:on.value})}R.onChange&&R.onChange(De,...ag),D&&D(De,...ag)};b.useEffect(()=>{he(ue.current)},[]);const Ie=De=>{ue.current&&De.currentTarget===De.target&&ue.current.focus(),V&&V(De)};let ke=v,He=R;X&&ke==="input"&&(P?He={type:void 0,minRows:P,maxRows:P,...He}:He={type:void 0,maxRows:F,minRows:U,...He},ke=K1);const Me=De=>{he(De.animationName==="mui-auto-fill-cancel"?ue.current:{value:"x"})};b.useEffect(()=>{Ye&&Ye.setAdornedStart(!!te)},[Ye,te]);const gg={...I,color:xe.color||"primary",disabled:xe.disabled,endAdornment:G,error:xe.error,focused:xe.focused,formControl:Ye,fullWidth:f,hiddenLabel:xe.hiddenLabel,multiline:X,size:xe.size,startAdornment:te,type:oe},Yg=E1(gg),jg=M.root||d.Root||Er,rt=H.root||A.root||{},rg=M.input||d.Input||zr;return He={...He,...H.input??A.input},p.jsxs(b.Fragment,{children:[!y&&typeof Y0=="function"&&(v0||(v0=p.jsx(Y0,{}))),p.jsxs(jg,{...rt,ref:t,onClick:Ie,...ae,...!jd(jg)&&{ownerState:{...gg,...rt.ownerState}},className:Ne(Yg.root,rt.className,r,q&&"MuiInputBase-readOnly"),children:[te,p.jsx(Hu.Provider,{value:null,children:p.jsx(rg,{"aria-invalid":xe.error,"aria-describedby":o,autoComplete:C,autoFocus:s,defaultValue:m,disabled:xe.disabled,id:W,onAnimationStart:Me,name:K,placeholder:Q,readOnly:q,required:xe.required,rows:P,value:re,onKeyDown:N,onKeyUp:L,type:oe,...He,...!jd(rg)&&{as:ke,ownerState:{...gg,...He.ownerState}},ref:ce,className:Ne(Yg.input,He.className,q&&"MuiInputBase-readOnly"),onBlur:se,onChange:pe,onFocus:be})}),G,j?j({...xe,startAdornment:te}):null]})]})});function z1(e){return Cg("MuiInput",e)}const eC={...Pl,...$e("MuiInput",["root","underline","input"])},M1=e=>{const{classes:g,disableUnderline:t}=e,o=og({root:["root",!t&&"underline"],input:["input"]},z1,g);return{...g,...o}},U1=Xe(Er,{shouldForwardProp:e=>Tt(e)||e==="classes",name:"MuiInput",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[...Nr(e,g),!t.disableUnderline&&g.underline]}})(vg(({theme:e})=>{let t=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(t=e.alpha(e.vars.palette.common.onBackground,e.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:I})=>I.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:I})=>!I.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${eC.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${eC.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${eC.disabled}, .${eC.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${t}`}},[`&.${eC.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(tl()).map(([I])=>({props:{color:I,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[I].main}`}}}))]}})),L1=Xe(zr,{name:"MuiInput",slot:"Input",overridesResolver:xr})({}),Fu=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiInput"}),{disableUnderline:o=!1,components:C={},componentsProps:s,fullWidth:r=!1,inputComponent:c="input",multiline:d=!1,slotProps:A,slots:m={},type:Z="text",...y}=I,G=M1(I),f={root:{ownerState:{disableUnderline:o}}},W=A??s?nt(A??s,f):f,v=m.root??C.Root??U1,R=m.input??C.Input??L1;return p.jsx(wu,{slots:{root:v,input:R},slotProps:W,fullWidth:r,inputComponent:c,multiline:d,ref:t,type:Z,...y,classes:G})});Fu.muiName="Input";function T1(e){return Cg("MuiFilledInput",e)}const xI={...Pl,...$e("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},Q1=e=>{const{classes:g,disableUnderline:t,startAdornment:I,endAdornment:o,size:C,hiddenLabel:s,multiline:r}=e,c={root:["root",!t&&"underline",I&&"adornedStart",o&&"adornedEnd",C==="small"&&`size${ze(C)}`,s&&"hiddenLabel",r&&"multiline"],input:["input"]},d=og(c,T1,g);return{...g,...d}},D1=Xe(Er,{shouldForwardProp:e=>Tt(e)||e==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[...Nr(e,g),!t.disableUnderline&&g.underline]}})(vg(({theme:e})=>{const g=e.palette.mode==="light",t=g?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",I=g?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",o=g?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",C=g?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:I,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:o,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:I}},[`&.${xI.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:I},[`&.${xI.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:C},variants:[{props:({ownerState:s})=>!s.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${xI.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${xI.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?e.alpha(e.vars.palette.common.onBackground,e.vars.opacity.inputUnderline):t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${xI.disabled}, .${xI.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${xI.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(tl()).map(([s])=>({props:{disableUnderline:!1,color:s},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[s]?.main}`}}})),{props:({ownerState:s})=>s.startAdornment,style:{paddingLeft:12}},{props:({ownerState:s})=>s.endAdornment,style:{paddingRight:12}},{props:({ownerState:s})=>s.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:s,size:r})=>s.multiline&&r==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel&&s.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),j1=Xe(zr,{name:"MuiFilledInput",slot:"Input",overridesResolver:xr})(vg(({theme:e})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:g})=>g.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:g})=>g.startAdornment,style:{paddingLeft:0}},{props:({ownerState:g})=>g.endAdornment,style:{paddingRight:0}},{props:({ownerState:g})=>g.hiddenLabel&&g.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:g})=>g.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),Ku=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiFilledInput"}),{disableUnderline:o=!1,components:C={},componentsProps:s,fullWidth:r=!1,hiddenLabel:c,inputComponent:d="input",multiline:A=!1,slotProps:m,slots:Z={},type:y="text",...G}=I,B={...I,disableUnderline:o,fullWidth:r,inputComponent:d,multiline:A,type:y},f=Q1(I),W={root:{ownerState:B},input:{ownerState:B}},v=m??s?nt(W,m??s):W,R=Z.root??C.Root??D1,k=Z.input??C.Input??j1;return p.jsx(wu,{slots:{root:R,input:k},slotProps:v,fullWidth:r,inputComponent:d,multiline:A,ref:t,type:y,...G,classes:f})});Ku.muiName="Input";var H0;const P1=Xe("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:Tt})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),O1=Xe("legend",{name:"MuiNotchedOutlined",shouldForwardProp:Tt})(vg(({theme:e})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:g})=>!g.withLabel,style:{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})}},{props:({ownerState:g})=>g.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:g})=>g.withLabel&&g.notched,style:{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}]})));function q1(e){const{children:g,classes:t,className:I,label:o,notched:C,...s}=e,r=o!=null&&o!=="",c={...e,notched:C,withLabel:r};return p.jsx(P1,{"aria-hidden":!0,className:I,ownerState:c,...s,children:p.jsx(O1,{ownerState:c,children:r?p.jsx("span",{children:o}):H0||(H0=p.jsx("span",{className:"notranslate","aria-hidden":!0,children:"​"}))})})}function _1(e){return Cg("MuiOutlinedInput",e)}const mn={...Pl,...$e("MuiOutlinedInput",["root","notchedOutline","input"])},$1=e=>{const{classes:g}=e,I=og({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},_1,g);return{...g,...I}},e9=Xe(Er,{shouldForwardProp:e=>Tt(e)||e==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:Nr})(vg(({theme:e})=>{const g=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${mn.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${mn.notchedOutline}`]:{borderColor:e.vars?e.alpha(e.vars.palette.common.onBackground,.23):g}},[`&.${mn.focused} .${mn.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(e.palette).filter(tl()).map(([t])=>({props:{color:t},style:{[`&.${mn.focused} .${mn.notchedOutline}`]:{borderColor:(e.vars||e).palette[t].main}}})),{props:{},style:{[`&.${mn.error} .${mn.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${mn.disabled} .${mn.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}}},{props:({ownerState:t})=>t.startAdornment,style:{paddingLeft:14}},{props:({ownerState:t})=>t.endAdornment,style:{paddingRight:14}},{props:({ownerState:t})=>t.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:t,size:I})=>t.multiline&&I==="small",style:{padding:"8.5px 14px"}}]}})),g9=Xe(q1,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(vg(({theme:e})=>{const g=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?e.alpha(e.vars.palette.common.onBackground,.23):g}})),t9=Xe(zr,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:xr})(vg(({theme:e})=>({padding:"16.5px 14px",...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:g})=>g.multiline,style:{padding:0}},{props:({ownerState:g})=>g.startAdornment,style:{paddingLeft:0}},{props:({ownerState:g})=>g.endAdornment,style:{paddingRight:0}}]}))),Nu=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiOutlinedInput"}),{components:o={},fullWidth:C=!1,inputComponent:s="input",label:r,multiline:c=!1,notched:d,slots:A={},slotProps:m={},type:Z="text",...y}=I,G=$1(I),B=oo(),f=lo({props:I,muiFormControl:B,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),W={...I,color:f.color||"primary",disabled:f.disabled,error:f.error,focused:f.focused,formControl:B,fullWidth:C,hiddenLabel:f.hiddenLabel,multiline:c,size:f.size,type:Z},v=A.root??o.Root??e9,R=A.input??o.Input??t9,[k,J]=et("notchedOutline",{elementType:g9,className:G.notchedOutline,shouldForwardComponentProp:!0,ownerState:W,externalForwardedProps:{slots:A,slotProps:m},additionalProps:{label:r!=null&&r!==""&&f.required?p.jsxs(b.Fragment,{children:[r," ","*"]}):r}});return p.jsx(wu,{slots:{root:v,input:R},slotProps:m,renderSuffix:F=>p.jsx(k,{...J,notched:typeof d<"u"?d:!!(F.startAdornment||F.filled||F.focused)}),fullWidth:C,inputComponent:s,multiline:c,ref:t,type:Z,...y,classes:{...G,notchedOutline:null}})});Nu.muiName="Input";function n9(e){return Cg("MuiFormLabel",e)}const pC=$e("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),I9=e=>{const{classes:g,color:t,focused:I,disabled:o,error:C,filled:s,required:r}=e,c={root:["root",`color${ze(t)}`,o&&"disabled",C&&"error",s&&"filled",I&&"focused",r&&"required"],asterisk:["asterisk",C&&"error"]};return og(c,n9,g)},l9=Xe("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,t.color==="secondary"&&g.colorSecondary,t.filled&&g.filled]}})(vg(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(e.palette).filter(tl()).map(([g])=>({props:{color:g},style:{[`&.${pC.focused}`]:{color:(e.vars||e).palette[g].main}}})),{props:{},style:{[`&.${pC.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${pC.error}`]:{color:(e.vars||e).palette.error.main}}}]}))),o9=Xe("span",{name:"MuiFormLabel",slot:"Asterisk"})(vg(({theme:e})=>({[`&.${pC.error}`]:{color:(e.vars||e).palette.error.main}}))),C9=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiFormLabel"}),{children:o,className:C,color:s,component:r="label",disabled:c,error:d,filled:A,focused:m,required:Z,...y}=I,G=oo(),B=lo({props:I,muiFormControl:G,states:["color","required","focused","disabled","error","filled"]}),f={...I,color:B.color||"primary",component:r,disabled:B.disabled,error:B.error,filled:B.filled,focused:B.focused,required:B.required},W=I9(f);return p.jsxs(l9,{as:r,ownerState:f,className:Ne(W.root,C),ref:t,...y,children:[o,B.required&&p.jsxs(o9,{ownerState:f,"aria-hidden":!0,className:W.asterisk,children:[" ","*"]})]})});function i9(e){return Cg("MuiInputLabel",e)}$e("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const s9=e=>{const{classes:g,formControl:t,size:I,shrink:o,disableAnimation:C,variant:s,required:r}=e,c={root:["root",t&&"formControl",!C&&"animated",o&&"shrink",I&&I!=="medium"&&`size${ze(I)}`,s],asterisk:[r&&"asterisk"]},d=og(c,i9,g);return{...g,...d}},r9=Xe(C9,{shouldForwardProp:e=>Tt(e)||e==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[{[`& .${pC.asterisk}`]:g.asterisk},g.root,t.formControl&&g.formControl,t.size==="small"&&g.sizeSmall,t.shrink&&g.shrink,!t.disableAnimation&&g.animated,t.focused&&g.focused,g[t.variant]]}})(vg(({theme:e})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:g})=>g.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:g})=>g.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:g})=>!g.disableAnimation,style:{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:g,ownerState:t})=>g==="filled"&&t.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:g,ownerState:t,size:I})=>g==="filled"&&t.shrink&&I==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:g,ownerState:t})=>g==="outlined"&&t.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),yf=b.forwardRef(function(g,t){const I=sg({name:"MuiInputLabel",props:g}),{disableAnimation:o=!1,margin:C,shrink:s,variant:r,className:c,...d}=I,A=oo();let m=s;typeof m>"u"&&A&&(m=A.filled||A.focused||A.adornedStart);const Z=lo({props:I,muiFormControl:A,states:["size","variant","required","focused"]}),y={...I,disableAnimation:o,formControl:A,shrink:m,size:Z.size,variant:Z.variant,required:Z.required,focused:Z.focused},G=s9(y);return p.jsx(r9,{"data-shrink":m,ref:t,className:Ne(G.root,c),...d,ownerState:y,classes:G})});function a9(e){return Cg("MuiFormControl",e)}$e("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const c9=e=>{const{classes:g,margin:t,fullWidth:I}=e,o={root:["root",t!=="none"&&`margin${ze(t)}`,I&&"fullWidth"]};return og(o,a9,g)},d9=Xe("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,g[`margin${ze(t.margin)}`],t.fullWidth&&g.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),Bf=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiFormControl"}),{children:o,className:C,color:s="primary",component:r="div",disabled:c=!1,error:d=!1,focused:A,fullWidth:m=!1,hiddenLabel:Z=!1,margin:y="none",required:G=!1,size:B="medium",variant:f="outlined",...W}=I,v={...I,color:s,component:r,disabled:c,error:d,fullWidth:m,hiddenLabel:Z,margin:y,required:G,size:B,variant:f},R=c9(v),[k,J]=b.useState(()=>{let L=!1;return o&&b.Children.forEach(o,Q=>{if(!Js(Q,["Input","Select"]))return;const q=Js(Q,["Select"])?Q.props.input:Q;q&&N1(q.props)&&(L=!0)}),L}),[F,U]=b.useState(()=>{let L=!1;return o&&b.Children.forEach(o,Q=>{Js(Q,["Input","Select"])&&(lr(Q.props,!0)||lr(Q.props.inputProps,!0))&&(L=!0)}),L}),[X,K]=b.useState(!1);c&&X&&K(!1);const w=A!==void 0&&!c?A:X;let D;b.useRef(!1);const V=b.useCallback(()=>{U(!0)},[]),z=b.useCallback(()=>{U(!1)},[]),N=b.useMemo(()=>({adornedStart:k,setAdornedStart:J,color:s,disabled:c,error:d,filled:F,focused:w,fullWidth:m,hiddenLabel:Z,size:B,onBlur:()=>{K(!1)},onFocus:()=>{K(!0)},onEmpty:z,onFilled:V,registerEffect:D,required:G,variant:f}),[k,s,c,d,F,w,m,Z,D,z,V,G,B,f]);return p.jsx(Hu.Provider,{value:N,children:p.jsx(d9,{as:r,ownerState:v,className:Ne(R.root,C),ref:t,...W,children:o})})});function A9(e){return Cg("MuiFormHelperText",e)}const w0=$e("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var F0;const u9=e=>{const{classes:g,contained:t,size:I,disabled:o,error:C,filled:s,focused:r,required:c}=e,d={root:["root",o&&"disabled",C&&"error",I&&`size${ze(I)}`,t&&"contained",r&&"focused",s&&"filled",c&&"required"]};return og(d,A9,g)},m9=Xe("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,t.size&&g[`size${ze(t.size)}`],t.contained&&g.contained,t.filled&&g.filled]}})(vg(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${w0.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${w0.error}`]:{color:(e.vars||e).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:g})=>g.contained,style:{marginLeft:14,marginRight:14}}]}))),h9=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiFormHelperText"}),{children:o,className:C,component:s="p",disabled:r,error:c,filled:d,focused:A,margin:m,required:Z,variant:y,...G}=I,B=oo(),f=lo({props:I,muiFormControl:B,states:["variant","size","disabled","error","filled","focused","required"]}),W={...I,component:s,contained:f.variant==="filled"||f.variant==="outlined",variant:f.variant,size:f.size,disabled:f.disabled,error:f.error,filled:f.filled,focused:f.focused,required:f.required};delete W.ownerState;const v=u9(W);return p.jsx(m9,{as:s,className:Ne(v.root,C),ref:t,...G,ownerState:W,children:o===" "?F0||(F0=p.jsx("span",{className:"notranslate","aria-hidden":!0,children:"​"})):o})});function p9(e){return Cg("MuiNativeSelect",e)}const xu=$e("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Z9=e=>{const{classes:g,variant:t,disabled:I,multiple:o,open:C,error:s}=e,r={select:["select",t,I&&"disabled",o&&"multiple",s&&"error"],icon:["icon",`icon${ze(t)}`,C&&"iconOpen",I&&"disabled"]};return og(r,p9,g)},ff=Xe("select",{name:"MuiNativeSelect"})(({theme:e})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${xu.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},variants:[{props:({ownerState:g})=>g.variant!=="filled"&&g.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}}]})),b9=Xe(ff,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Tt,overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.select,g[t.variant],t.error&&g.error,{[`&.${xu.multiple}`]:g.multiple}]}})({}),Sf=Xe("svg",{name:"MuiNativeSelect"})(({theme:e})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${xu.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:({ownerState:g})=>g.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),G9=Xe(Sf,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.icon,t.variant&&g[`icon${ze(t.variant)}`],t.open&&g.iconOpen]}})({}),y9=b.forwardRef(function(g,t){const{className:I,disabled:o,error:C,IconComponent:s,inputRef:r,variant:c="standard",...d}=g,A={...g,disabled:o,variant:c,error:C},m=Z9(A);return p.jsxs(b.Fragment,{children:[p.jsx(b9,{ownerState:A,className:Ne(m.select,I),disabled:o,ref:r||t,...d}),g.multiple?null:p.jsx(G9,{as:s,ownerState:A,className:m.icon})]})});function Vf(e){return Cg("MuiSelect",e)}const gC=$e("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var K0;const B9=Xe(ff,{name:"MuiSelect",slot:"Select",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[{[`&.${gC.select}`]:g.select},{[`&.${gC.select}`]:g[t.variant]},{[`&.${gC.error}`]:g.error},{[`&.${gC.multiple}`]:g.multiple}]}})({[`&.${gC.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),f9=Xe(Sf,{name:"MuiSelect",slot:"Icon",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.icon,t.variant&&g[`icon${ze(t.variant)}`],t.open&&g.iconOpen]}})({}),S9=Xe("input",{shouldForwardProp:e=>gy(e)&&e!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function N0(e,g){return typeof g=="object"&&g!==null?e===g:String(e)===String(g)}function V9(e){return e==null||typeof e=="string"&&!e.trim()}const W9=e=>{const{classes:g,variant:t,disabled:I,multiple:o,open:C,error:s}=e,r={select:["select",t,I&&"disabled",o&&"multiple",s&&"error"],icon:["icon",`icon${ze(t)}`,C&&"iconOpen",I&&"disabled"],nativeInput:["nativeInput"]};return og(r,Vf,g)},R9=b.forwardRef(function(g,t){const{"aria-describedby":I,"aria-label":o,autoFocus:C,autoWidth:s,children:r,className:c,defaultOpen:d,defaultValue:A,disabled:m,displayEmpty:Z,error:y=!1,IconComponent:G,inputRef:B,labelId:f,MenuProps:W={},multiple:v,name:R,onBlur:k,onChange:J,onClose:F,onFocus:U,onOpen:X,open:K,readOnly:w,renderValue:D,required:V,SelectDisplayProps:z={},tabIndex:N,type:L,value:Q,variant:q="standard",...j}=g,[P,$]=YZ({controlled:Q,default:A,name:"Select"}),[H,M]=YZ({controlled:K,default:d,name:"Select"}),te=b.useRef(null),oe=b.useRef(null),[ne,ae]=b.useState(null),{current:re}=b.useRef(K!=null),[Ge,ue]=b.useState(),Ae=it(t,B),ce=b.useCallback(Re=>{oe.current=Re,Re&&ae(Re)},[]),me=ne?.parentNode;b.useImperativeHandle(Ae,()=>({focus:()=>{oe.current.focus()},node:te.current,value:P}),[P]),b.useEffect(()=>{d&&H&&ne&&!re&&(ue(s?null:me.clientWidth),oe.current.focus())},[ne,s]),b.useEffect(()=>{C&&oe.current.focus()},[C]),b.useEffect(()=>{if(!f)return;const Re=nn(oe.current).getElementById(f);if(Re){const je=()=>{getSelection().isCollapsed&&oe.current.focus()};return Re.addEventListener("click",je),()=>{Re.removeEventListener("click",je)}}},[f]);const Ke=(Re,je)=>{Re?X&&X(je):F&&F(je),re||(ue(s?null:me.clientWidth),M(Re))},Ye=Re=>{Re.button===0&&(Re.preventDefault(),oe.current.focus(),Ke(!0,Re))},xe=Re=>{Ke(!1,Re)},Qe=b.Children.toArray(r),ye=Re=>{const je=Qe.find(pg=>pg.props.value===Re.target.value);je!==void 0&&($(je.props.value),J&&J(Re,je))},he=Re=>je=>{let pg;if(je.currentTarget.hasAttribute("tabindex")){if(v){pg=Array.isArray(P)?P.slice():[];const Cn=P.indexOf(Re.props.value);Cn===-1?pg.push(Re.props.value):pg.splice(Cn,1)}else pg=Re.props.value;if(Re.props.onClick&&Re.props.onClick(je),P!==pg&&($(pg),J)){const Cn=je.nativeEvent||je,Il=new Cn.constructor(Cn.type,Cn);Object.defineProperty(Il,"target",{writable:!0,value:{value:pg,name:R}}),J(Il,Re)}v||Ke(!1,je)}},be=Re=>{w||[" ","ArrowUp","ArrowDown","Enter"].includes(Re.key)&&(Re.preventDefault(),Ke(!0,Re))},se=ne!==null&&H,pe=Re=>{!se&&k&&(Object.defineProperty(Re,"target",{writable:!0,value:{value:P,name:R}}),k(Re))};delete j["aria-invalid"];let Ie,ke;const He=[];let Me=!1;(lr({value:P})||Z)&&(D?Ie=D(P):Me=!0);const gg=Qe.map(Re=>{if(!b.isValidElement(Re))return null;let je;if(v){if(!Array.isArray(P))throw new Error(En(2));je=P.some(pg=>N0(pg,Re.props.value)),je&&Me&&He.push(Re.props.children)}else je=N0(P,Re.props.value),je&&Me&&(ke=Re.props.children);return b.cloneElement(Re,{"aria-selected":je?"true":"false",onClick:he(Re),onKeyUp:pg=>{pg.key===" "&&pg.preventDefault(),Re.props.onKeyUp&&Re.props.onKeyUp(pg)},role:"option",selected:je,value:void 0,"data-value":Re.props.value})});Me&&(v?He.length===0?Ie=null:Ie=He.reduce((Re,je,pg)=>(Re.push(je),pg<He.length-1&&Re.push(", "),Re),[]):Ie=ke);let Yg=Ge;!s&&re&&ne&&(Yg=me.clientWidth);let jg;typeof N<"u"?jg=N:jg=m?null:0;const rt=z.id||(R?`mui-component-select-${R}`:void 0),rg={...g,variant:q,value:P,open:se,error:y},De=W9(rg),ag={...W.PaperProps,...typeof W.slotProps?.paper=="function"?W.slotProps.paper(rg):W.slotProps?.paper},on={...W.MenuListProps,...typeof W.slotProps?.list=="function"?W.slotProps.list(rg):W.slotProps?.list},Dn=UA();return p.jsxs(b.Fragment,{children:[p.jsx(B9,{as:"div",ref:ce,tabIndex:jg,role:"combobox","aria-controls":se?Dn:void 0,"aria-disabled":m?"true":void 0,"aria-expanded":se?"true":"false","aria-haspopup":"listbox","aria-label":o,"aria-labelledby":[f,rt].filter(Boolean).join(" ")||void 0,"aria-describedby":I,"aria-required":V?"true":void 0,"aria-invalid":y?"true":void 0,onKeyDown:be,onMouseDown:m||w?null:Ye,onBlur:pe,onFocus:U,...z,ownerState:rg,className:Ne(z.className,De.select,c),id:rt,children:V9(Ie)?K0||(K0=p.jsx("span",{className:"notranslate","aria-hidden":!0,children:"​"})):Ie}),p.jsx(S9,{"aria-invalid":y,value:Array.isArray(P)?P.join(","):P,name:R,ref:te,"aria-hidden":!0,onChange:ye,tabIndex:-1,disabled:m,className:De.nativeInput,autoFocus:C,required:V,...j,ownerState:rg}),p.jsx(f9,{as:G,className:De.icon,ownerState:rg}),p.jsx($A,{id:`menu-${R||""}`,anchorEl:me,open:se,onClose:xe,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...W,slotProps:{...W.slotProps,list:{"aria-labelledby":f,role:"listbox","aria-multiselectable":v?"true":void 0,disableListWrap:!0,id:Dn,...on},paper:{...ag,style:{minWidth:Yg,...ag!=null?ag.style:null}}},children:gg})]})}),X9=In(p.jsx("path",{d:"M7 10l5 5 5-5z"})),k9=e=>{const{classes:g}=e,I=og({root:["root"]},Vf,g);return{...g,...I}},Eu={name:"MuiSelect",slot:"Root",shouldForwardProp:e=>Tt(e)&&e!=="variant"},J9=Xe(Fu,Eu)(""),v9=Xe(Nu,Eu)(""),Y9=Xe(Ku,Eu)(""),zu=b.forwardRef(function(g,t){const I=sg({name:"MuiSelect",props:g}),{autoWidth:o=!1,children:C,classes:s={},className:r,defaultOpen:c=!1,displayEmpty:d=!1,IconComponent:A=X9,id:m,input:Z,inputProps:y,label:G,labelId:B,MenuProps:f,multiple:W=!1,native:v=!1,onClose:R,onOpen:k,open:J,renderValue:F,SelectDisplayProps:U,variant:X="outlined",...K}=I,w=v?y9:R9,D=oo(),V=lo({props:I,muiFormControl:D,states:["variant","error"]}),z=V.variant||X,N={...I,variant:z,classes:s},L=k9(N),{root:Q,...q}=L,j=Z||{standard:p.jsx(J9,{ownerState:N}),outlined:p.jsx(v9,{label:G,ownerState:N}),filled:p.jsx(Y9,{ownerState:N})}[z],P=it(t,DC(j));return p.jsx(b.Fragment,{children:b.cloneElement(j,{inputComponent:w,inputProps:{children:C,error:V.error,IconComponent:A,variant:z,type:void 0,multiple:W,...v?{id:m}:{autoWidth:o,defaultOpen:c,displayEmpty:d,labelId:B,MenuProps:f,onClose:R,onOpen:k,open:J,renderValue:F,SelectDisplayProps:{id:m,...U}},...y,classes:y?nt(q,y.classes):q,...Z?Z.props.inputProps:{}},...(W&&v||d)&&z==="outlined"?{notched:!0}:{},ref:P,className:Ne(j.props.className,r,L.root),...!Z&&{variant:z},...K})})});zu.muiName="Select";function H9(e){return Cg("MuiTextField",e)}$e("MuiTextField",["root"]);const w9={standard:Fu,filled:Ku,outlined:Nu},F9=e=>{const{classes:g}=e;return og({root:["root"]},H9,g)},K9=Xe(Bf,{name:"MuiTextField",slot:"Root"})({}),yg=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiTextField"}),{autoComplete:o,autoFocus:C=!1,children:s,className:r,color:c="primary",defaultValue:d,disabled:A=!1,error:m=!1,FormHelperTextProps:Z,fullWidth:y=!1,helperText:G,id:B,InputLabelProps:f,inputProps:W,InputProps:v,inputRef:R,label:k,maxRows:J,minRows:F,multiline:U=!1,name:X,onBlur:K,onChange:w,onFocus:D,placeholder:V,required:z=!1,rows:N,select:L=!1,SelectProps:Q,slots:q={},slotProps:j={},type:P,value:$,variant:H="outlined",...M}=I,te={...I,autoFocus:C,color:c,disabled:A,error:m,fullWidth:y,multiline:U,required:z,select:L,variant:H},oe=F9(te),ne=UA(B),ae=G&&ne?`${ne}-helper-text`:void 0,re=k&&ne?`${ne}-label`:void 0,Ge=w9[H],ue={slots:q,slotProps:{input:v,inputLabel:f,htmlInput:W,formHelperText:Z,select:Q,...j}},Ae={},ce=ue.slotProps.inputLabel;H==="outlined"&&(ce&&typeof ce.shrink<"u"&&(Ae.notched=ce.shrink),Ae.label=k),L&&((!Q||!Q.native)&&(Ae.id=void 0),Ae["aria-describedby"]=void 0);const[me,Ke]=et("root",{elementType:K9,shouldForwardComponentProp:!0,externalForwardedProps:{...ue,...M},ownerState:te,className:Ne(oe.root,r),ref:t,additionalProps:{disabled:A,error:m,fullWidth:y,required:z,color:c,variant:H}}),[Ye,xe]=et("input",{elementType:Ge,externalForwardedProps:ue,additionalProps:Ae,ownerState:te}),[Qe,ye]=et("inputLabel",{elementType:yf,externalForwardedProps:ue,ownerState:te}),[he,be]=et("htmlInput",{elementType:"input",externalForwardedProps:ue,ownerState:te}),[se,pe]=et("formHelperText",{elementType:h9,externalForwardedProps:ue,ownerState:te}),[Ie,ke]=et("select",{elementType:zu,externalForwardedProps:ue,ownerState:te}),He=p.jsx(Ye,{"aria-describedby":ae,autoComplete:o,autoFocus:C,defaultValue:d,fullWidth:y,multiline:U,name:X,rows:N,maxRows:J,minRows:F,type:P,value:$,id:ne,inputRef:R,onBlur:K,onChange:w,onFocus:D,placeholder:V,inputProps:be,slots:{input:q.htmlInput?he:void 0},...xe});return p.jsxs(me,{...Ke,children:[k!=null&&k!==""&&p.jsx(Qe,{htmlFor:ne,id:re,...ye,children:k}),L?p.jsx(Ie,{"aria-describedby":ae,id:ne,labelId:re,value:$,input:He,...ke,children:s}):He,G&&p.jsx(se,{id:ae,...pe,children:G})]})}),N9="https://pilot-hestia-backend.onrender.com",x9=async e=>{try{return(await We.post(`${N9}/api/auth/login`,e)).data}catch(g){throw console.error("Login failed",g),g}},E9=()=>{const e=Qn(),[g,t]=b.useState([]),[I,o]=b.useState([]),[C,s]=b.useState([]),r={email:g,password:I},c=async d=>{s("");try{const A=await x9(d);localStorage.setItem("token",A.token),localStorage.setItem("role","user"),t(""),o(""),A&&e("/home")}catch(A){console.error("login failed",A),s(A.message||"Log in failed")}};return p.jsxs("div",{style:z9,children:[p.jsxs("div",{children:[p.jsx("h1",{style:{...x0,fontSize:"30px",margin:0},children:"Log In to Your Account"}),p.jsx("center",{children:p.jsx("h3",{style:{...x0,margin:0},children:"Enter the Block Party"})})]}),p.jsx("div",{style:M9,children:p.jsxs(st,{component:"section",sx:{p:2,border:1,borderRadius:2},style:U9,children:[p.jsx(yg,{id:"outlined-basic",label:"Email",variant:"outlined",onChange:d=>t(d.target.value),value:g}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-password-input",label:"Password",type:"password",autoComplete:"current-password",onChange:d=>o(d.target.value),value:I}),p.jsx("br",{}),p.jsx(_e,{variant:"contained",sx:{color:"white",backgroundColor:"#ff2400"},onClick:()=>c(r),children:"Submit"}),p.jsx(_e,{size:"small",sx:{color:"#ff2400"},onClick:()=>e("/register"),children:"Register"}),C&&p.jsx("p",{style:{color:"red",marginTop:"10px"},children:C})]})})]})},z9={position:"relative",width:"100vw",height:"100vh",margin:"0 auto",display:"flex",gap:"50px",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#FF5F00"},M9={position:"relative",margin:"0 auto",display:"flex",justifyContent:"center",alignItems:"center"},U9={display:"flex",flexDirection:"column",gap:"5px",padding:"32px",background:"#fff",borderRadius:"8px",boxShadow:"0 0 10px rgba(0,0,0,0.1)",borderWidth:"3px",borderColor:"#ff2400",width:"300px"},x0={color:"white",textShadow:`
    -1px -1px 0 #ff2400,  
     1px -1px 0 #ff2400,
    -1px  1px 0 #ff2400,
     1px  1px 0 #ff2400
  `},L9="https://pilot-hestia-backend.onrender.com",T9=async e=>{try{const t=(await We.post(`${L9}/api/auth/register`,e)).data;return localStorage.setItem("token",t.token),t}catch(g){throw console.error("register failed",g),g}},Q9=()=>{const e=Qn(),[g,t]=b.useState(""),[I,o]=b.useState(""),[C,s]=b.useState(""),[r,c]=b.useState(""),[d,A]=b.useState(""),m={first_name:g,last_name:I,email:C,password:r},Z=async()=>{A("");try{const y=await T9(m);localStorage.setItem("token",y.token),s(""),c(""),t(""),o(""),console.log("data: "+y),y&&e("/home")}catch(y){console.error("Registration failed",y),A(y.response?.data?.message)}};return p.jsxs("div",{style:D9,children:[p.jsxs("div",{children:[p.jsx("h1",{style:{...E0,fontSize:"30px",margin:0},children:"Register an Account"}),p.jsx("center",{children:p.jsx("h3",{style:{...E0,margin:0},children:"Welcome to the Block Party!"})})]}),p.jsx("div",{style:j9,children:p.jsxs(st,{component:"section",sx:{p:2,border:1,borderRadius:2},style:P9,children:[p.jsx(yg,{id:"outlined-basic",label:"First Name",variant:"outlined",onChange:y=>t(y.target.value),value:g}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"Last Name",variant:"outlined",onChange:y=>o(y.target.value),value:I}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"Email",variant:"outlined",onChange:y=>s(y.target.value),value:C}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-password-input",label:"Password",type:"password",autoComplete:"current-password",onChange:y=>c(y.target.value),value:r}),p.jsx("br",{}),p.jsx(_e,{variant:"contained",sx:{color:"white",backgroundColor:"#ff2400"},onClick:()=>Z(),children:"Submit"}),p.jsx(_e,{size:"small",sx:{color:"#ff2400"},onClick:()=>e("/"),children:"Log in"}),d&&p.jsx("p",{style:{color:"red",marginTop:"10px"},children:d})]})})]})},D9={position:"relative",width:"100vw",height:"100vh",margin:"0 auto",color:"white",display:"flex",gap:"50px",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#FF5F00"},j9={position:"relative",margin:"0 auto",display:"flex",justifyContent:"center",alignItems:"center"},P9={display:"flex",flexDirection:"column",gap:"5px",padding:"32px",background:"#fff",borderRadius:"8px",borderWidth:"3px",borderColor:"#ff2400",width:"300px"},E0={textShadow:`
    -1px -1px 0 #ff2400,  
     1px -1px 0 #ff2400,
    -1px  1px 0 #ff2400,
     1px  1px 0 #ff2400
  `},O9={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:250,bgcolor:"background.paper",color:"black",borderRadius:"5px",boxShadow:24,p:4,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"};function q9(){const[e,g]=b.useState(!1),t=()=>g(!0),I=()=>{g(!1)},[o,C]=b.useState(""),{memberPasscodeValidationClick:s}=b.useContext(jC);localStorage.getItem("role");const[r,c]=b.useState(""),d=async()=>{c("");try{await s(o),I()}catch{c("Invalid passcode. Please try again.")}};return p.jsxs("div",{children:[p.jsx(_e,{onClick:t,variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"10px",fontWeight:600},children:"Unlock"}),p.jsx(nl,{open:e,onClose:I,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:p.jsxs(st,{sx:O9,children:[p.jsx(yt,{sx:{marginBottom:"10px"},id:"modal-modal-title",variant:"h6",component:"h2",children:"Enter Passcode"}),p.jsx(yg,{onChange:A=>C(A.target.value),id:"outlined-basic",label:"passcode",variant:"outlined"}),p.jsx(_e,{onClick:d,variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"12px",fontWeight:600},children:"Submit"}),r&&p.jsx(yt,{color:"error",sx:{mt:1},children:r})]})})]})}const _9=()=>p.jsxs("div",{style:$9,children:[p.jsx("div",{style:{position:"absolute",top:"5px",left:"10px"},children:p.jsx(PC,{})}),p.jsx("h1",{style:{fontSize:"20px"},children:"This page is for members only"}),p.jsx(HH,{fontSize:"large",sx:{marginTop:"10px"}}),p.jsx(q9,{})]}),$9={minHeight:"100vh",width:"100%",display:"flex",color:"white",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"10px",boxSizing:"border-box",background:"linear-gradient(135deg, rgba(255,127,50,0.95), rgba(230,92,0,0.9))"};function e5(e){return Cg("MuiCard",e)}$e("MuiCard",["root"]);const g5=e=>{const{classes:g}=e;return og({root:["root"]},e5,g)},t5=Xe(zy,{name:"MuiCard",slot:"Root"})({overflow:"hidden"}),Mu=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiCard"}),{className:o,raised:C=!1,...s}=I,r={...I,raised:C},c=g5(r);return p.jsx(t5,{className:Ne(c.root,o),elevation:C?8:void 0,ref:t,ownerState:r,...s})});function n5(e){return Cg("MuiCardContent",e)}$e("MuiCardContent",["root"]);const I5=e=>{const{classes:g}=e;return og({root:["root"]},n5,g)},l5=Xe("div",{name:"MuiCardContent",slot:"Root"})({padding:16,"&:last-child":{paddingBottom:24}}),Uu=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiCardContent"}),{className:o,component:C="div",...s}=I,r={...I,component:C},c=I5(r);return p.jsx(l5,{as:C,className:Ne(c.root,o),ownerState:r,ref:t,...s})});function o5(e){return Cg("MuiCardMedia",e)}$e("MuiCardMedia",["root","media","img"]);const C5=e=>{const{classes:g,isMediaComponent:t,isImageComponent:I}=e;return og({root:["root",t&&"media",I&&"img"]},o5,g)},i5=Xe("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e,{isMediaComponent:I,isImageComponent:o}=t;return[g.root,I&&g.media,o&&g.img]}})({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",variants:[{props:{isMediaComponent:!0},style:{width:"100%"}},{props:{isImageComponent:!0},style:{objectFit:"cover"}}]}),s5=["video","audio","picture","iframe","img"],r5=["picture","img"],Lu=b.forwardRef(function(g,t){const I=sg({props:g,name:"MuiCardMedia"}),{children:o,className:C,component:s="div",image:r,src:c,style:d,...A}=I,m=s5.includes(s),Z=!m&&r?{backgroundImage:`url("${r}")`,...d}:d,y={...I,component:s,isMediaComponent:m,isImageComponent:r5.includes(s)},G=C5(y);return p.jsx(i5,{className:Ne(G.root,C),as:s,role:!m&&r?"img":void 0,ref:t,style:Z,ownerState:y,src:m?r||c:void 0,...A,children:o})}),Rt=dJ({createStyledComponent:Xe("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,g)=>{const{ownerState:t}=e;return[g.root,t.container&&g.container]}}),componentName:"MuiGrid",useThemeProps:e=>sg({props:e,name:"MuiGrid"}),useTheme:Wr}),a5=({activities:e,onCardClick:g,isSelected:t})=>p.jsx(Rt,{container:!0,spacing:2,children:e.map((I,o)=>p.jsx("div",{style:{padding:"2px"},children:p.jsx(Rt,{item:!0,xs:2,sm:2,md:2,children:p.jsxs(Mu,{sx:{maxWidth:150,borderRadius:3,cursor:"pointer",boxShadow:t===I.id?"0 0 10px #FF5F00":"0 0 3px #FF5F00",border:t===I.id?"3px solid #FF5F00":"none"},onClick:()=>g(I),children:[p.jsx(Lu,{component:"img",height:"100",image:I.img,alt:I.title}),p.jsxs(Uu,{children:[p.jsx(yt,{variant:"h6",sx:{fontSize:"20px"},component:"div",children:I.title}),p.jsxs(yt,{variant:"body2",color:"text.secondary",children:["Points: ",I.points]})]})]})},o)}))}),z0="https://pilot-hestia-backend.onrender.com",c5={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:350,bgcolor:"background.paper",color:"black",borderRadius:"5px",boxShadow:24,p:4,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},d5=({user:e,handleUserRefresh:g})=>{const[t,I]=b.useState([]),[o,C]=b.useState(null),[s,r]=b.useState(!1),c=()=>r(!0),d=()=>{r(!1)};b.useEffect(()=>{(async()=>{try{const f=(await We.get(`${z0}/api/activities/retrieve`))?.data;I(f)}catch{console.log("couldn't fetch activities")}})()},[]);const[A,m]=b.useState(""),Z=async()=>{const G={user_id:e?.id,activity_id:o?.id};try{const B=We.post(`${z0}/api/activities/complete`,G);g(),d()}catch(B){console.log("error ocurred",B)}},y=G=>{C(G)};return p.jsxs("div",{children:[p.jsx(_e,{disabled:!e,onClick:c,variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"10px",fontWeight:600},children:"Pay"}),p.jsx(nl,{open:s,onClose:d,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:p.jsxs(st,{sx:c5,children:[p.jsx(yt,{sx:{marginBottom:"10px"},id:"modal-modal-title",variant:"h6",component:"h2",children:"Which Activity?"}),p.jsx(a5,{activities:t,onCardClick:y,isSelected:o?.id}),p.jsxs(_e,{onClick:Z,variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"12px",fontWeight:600},children:[" Pay ",o?.points]}),A&&p.jsx(yt,{color:"error",sx:{mt:1},children:A})]})})]})};function HC(e){"@babel/helpers - typeof";return HC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},HC(e)}function A5(e,g){if(HC(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var I=t.call(e,g);if(HC(I)!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(e)}function u5(e){var g=A5(e,"string");return HC(g)=="symbol"?g:g+""}function m5(e,g,t){return(g=u5(g))in e?Object.defineProperty(e,g,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[g]=t,e}function h5(e){if(Array.isArray(e))return e}function p5(e,g){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var I,o,C,s,r=[],c=!0,d=!1;try{if(C=(t=t.call(e)).next,g!==0)for(;!(c=(I=C.call(t)).done)&&(r.push(I.value),r.length!==g);c=!0);}catch(A){d=!0,o=A}finally{try{if(!c&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(d)throw o}}return r}}function M0(e,g){(g==null||g>e.length)&&(g=e.length);for(var t=0,I=Array(g);t<g;t++)I[t]=e[t];return I}function Z5(e,g){if(e){if(typeof e=="string")return M0(e,g);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?M0(e,g):void 0}}function b5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G5(e,g){return h5(e)||p5(e,g)||Z5(e,g)||b5()}function y5(e,g){if(e==null)return{};var t,I,o=PA(e,g);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(e);for(I=0;I<C.length;I++)t=C[I],g.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var Wf={exports:{}},ig={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ug=typeof Symbol=="function"&&Symbol.for,Tu=Ug?Symbol.for("react.element"):60103,Qu=Ug?Symbol.for("react.portal"):60106,Mr=Ug?Symbol.for("react.fragment"):60107,Ur=Ug?Symbol.for("react.strict_mode"):60108,Lr=Ug?Symbol.for("react.profiler"):60114,Tr=Ug?Symbol.for("react.provider"):60109,Qr=Ug?Symbol.for("react.context"):60110,Du=Ug?Symbol.for("react.async_mode"):60111,Dr=Ug?Symbol.for("react.concurrent_mode"):60111,jr=Ug?Symbol.for("react.forward_ref"):60112,Pr=Ug?Symbol.for("react.suspense"):60113,B5=Ug?Symbol.for("react.suspense_list"):60120,Or=Ug?Symbol.for("react.memo"):60115,qr=Ug?Symbol.for("react.lazy"):60116,f5=Ug?Symbol.for("react.block"):60121,S5=Ug?Symbol.for("react.fundamental"):60117,V5=Ug?Symbol.for("react.responder"):60118,W5=Ug?Symbol.for("react.scope"):60119;function kt(e){if(typeof e=="object"&&e!==null){var g=e.$$typeof;switch(g){case Tu:switch(e=e.type,e){case Du:case Dr:case Mr:case Lr:case Ur:case Pr:return e;default:switch(e=e&&e.$$typeof,e){case Qr:case jr:case qr:case Or:case Tr:return e;default:return g}}case Qu:return g}}}function Rf(e){return kt(e)===Dr}ig.AsyncMode=Du;ig.ConcurrentMode=Dr;ig.ContextConsumer=Qr;ig.ContextProvider=Tr;ig.Element=Tu;ig.ForwardRef=jr;ig.Fragment=Mr;ig.Lazy=qr;ig.Memo=Or;ig.Portal=Qu;ig.Profiler=Lr;ig.StrictMode=Ur;ig.Suspense=Pr;ig.isAsyncMode=function(e){return Rf(e)||kt(e)===Du};ig.isConcurrentMode=Rf;ig.isContextConsumer=function(e){return kt(e)===Qr};ig.isContextProvider=function(e){return kt(e)===Tr};ig.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Tu};ig.isForwardRef=function(e){return kt(e)===jr};ig.isFragment=function(e){return kt(e)===Mr};ig.isLazy=function(e){return kt(e)===qr};ig.isMemo=function(e){return kt(e)===Or};ig.isPortal=function(e){return kt(e)===Qu};ig.isProfiler=function(e){return kt(e)===Lr};ig.isStrictMode=function(e){return kt(e)===Ur};ig.isSuspense=function(e){return kt(e)===Pr};ig.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Mr||e===Dr||e===Lr||e===Ur||e===Pr||e===B5||typeof e=="object"&&e!==null&&(e.$$typeof===qr||e.$$typeof===Or||e.$$typeof===Tr||e.$$typeof===Qr||e.$$typeof===jr||e.$$typeof===S5||e.$$typeof===V5||e.$$typeof===W5||e.$$typeof===f5)};ig.typeOf=kt;/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var U0=Object.getOwnPropertySymbols,R5=Object.prototype.hasOwnProperty,X5=Object.prototype.propertyIsEnumerable;function k5(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function J5(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var g={},t=0;t<10;t++)g["_"+String.fromCharCode(t)]=t;var I=Object.getOwnPropertyNames(g).map(function(C){return g[C]});if(I.join("")!=="0123456789")return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(C){o[C]=C}),Object.keys(Object.assign({},o)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}J5();var v5="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Y5=v5;Function.call.bind(Object.prototype.hasOwnProperty);var H5=Y5;function Xf(){}function kf(){}kf.resetWarningCache=Xf;var w5=function(){function e(I,o,C,s,r,c){if(c!==H5){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function g(){return e}var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:g,element:e,elementType:e,instanceOf:g,node:e,objectOf:g,oneOf:g,oneOfType:g,shape:g,exact:g,checkPropTypes:kf,resetWarningCache:Xf};return t.PropTypes=t,t};Wf.exports=w5();var wl=Wf.exports;function F5(e,g){var t=atob(e);return t}function K5(e,g,t){var I=F5(e),o=I.indexOf(`
`,10)+1,C=I.substring(o)+"",s=new Blob([C],{type:"application/javascript"});return URL.createObjectURL(s)}function N5(e,g,t){var I;return function(C){return I=I||K5(e),new Worker(I,C)}}var x5=N5("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg=="),E5=["constraints","onError","onLoad","onScan","resolution","qrArea"];function L0(e,g){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(e);g&&(I=I.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,I)}return t}function T0(e){for(var g=1;g<arguments.length;g++){var t=arguments[g]!=null?arguments[g]:{};g%2?L0(Object(t),!0).forEach(function(I){m5(e,I,t[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L0(Object(t)).forEach(function(I){Object.defineProperty(e,I,Object.getOwnPropertyDescriptor(t,I))})}return e}var z5=function(){return new x5},Q0=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().forEach(function(t){g.removeTrack(t),t.stop()}),g.getAudioTracks().forEach(function(t){g.removeTrack(t),t.stop()})):g.stop())},ju=function(g){var t=g.constraints,I=g.onError,o=g.onLoad,C=g.onScan,s=g.resolution,r=g.qrArea,c=y5(g,E5),d=b.useRef(null),A=b.useRef(null),m=b.useRef(document.createElement("canvas")),Z=b.useRef(null),y=b.useRef(),G=b.useState(null),B=G5(G,2),f=B[0],W=B[1],v=b.useRef(!1),R=b.useRef();b.useEffect(function(){R.current=z5();var U=R.current;return U.onmessage=function(X){C&&C(X.data?T0(T0({},X.data),{},{canvas:m.current}):null),v.current=!1},function(){U.terminate()}},[C]);var k=JSON.stringify(r),J=b.useCallback(function(){var U=JSON.parse(k),X=R.current,K=A.current&&A.current.readyState===A.current.HAVE_ENOUGH_DATA;if(!v.current&&K){v.current=!0;var w=A.current.videoWidth,D=A.current.videoHeight,V=w>D?w:D,z=Math.floor(s/V*100)/100;D=Math.floor(z*D),w=Math.floor(z*w),m.current.width=w,m.current.height=D,Z.current=m.current.getContext("2d"),Z.current.drawImage(A.current,0,0,w,D);var N;U&&U.length===2&&U[0]>0&&U[1]>0?N=Z.current.getImageData(Math.floor((w-U[0])/2),Math.floor((D-U[1])/2),U[0],U[1]):N=Z.current.getImageData(0,0,w,D),X.postMessage(N)}y.current=requestAnimationFrame(J)},[s,k]),F=JSON.stringify(t);return b.useEffect(function(){var U=JSON.parse(F),X=!0;return navigator.mediaDevices.getUserMedia(U).then(function(K){if(!X)Q0(K);else{d.current=K;try{A.current&&(A.current.srcObject=K,A.current.setAttribute("playsinline",!0))}catch{W(window.URL.createObjectURL(K))}o&&o(),y.current=requestAnimationFrame(J)}}).catch(function(K){return X?I(K):null}),function(){cancelAnimationFrame(y.current),X=!1,Q0(d.current),f&&window.URL.revokeObjectURL(f)}},[J,F,I,o,f]),b.createElement("video",bC({autoPlay:!0,playsInline:!0,src:f,ref:A},c))};ju.propTypes={constraints:wl.object,onError:wl.func.isRequired,onLoad:wl.func,onScan:wl.func.isRequired,resolution:wl.number,qrArea:wl.array};ju.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]};const M5="https://pilot-hestia-backend.onrender.com",U5=()=>{const[e,g]=b.useState("No result"),[t,I]=b.useState(null),[o,C]=b.useState(!1),s=b.useRef(!1),r=async A=>{if(!A||s.current)return;const m=A?.text;if(m)try{const Z=await We.post(`${M5}/api/user/scan`,{qr_code:m});Z?.data&&(s.current=!0,C(!1),I(Z?.data.user),console.log("User found:",Z.data));return}catch{console.error("Couldn't find user");return}},c=()=>{I(null),s.current=!1,C(A=>!A),console.log("Scanner toggled",s)},d=()=>{I(null)};return p.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[p.jsx(st,{component:"section",sx:{border:1,borderRadius:2},style:{...L5,backgroundColor:o?"transparent":"grey"},children:o?p.jsx(ju,{delay:300,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"8px"},onError:A=>console.error("QR Scan error",A),onScan:A=>{A&&!s.current&&r(A)},constraints:{facingMode:"environment"}}):p.jsx(yt,{variant:"body1",sx:{color:"white",textAlign:"center",px:2},children:"Tap below to activate your camera and scan a user’s QR code."})}),p.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:"1em"},children:[p.jsx(_e,{variant:"contained",sx:{mt:2,backgroundColor:o?"orange":"#ff2400"},onClick:c,children:o?"Stop Scanner":"Activate Scanner"}),p.jsx(d5,{user:t,handleUserRefresh:d})]}),t&&p.jsx("div",{style:{marginTop:16},children:p.jsxs(yt,{variant:"h6",children:["User Found: ",t?.first_name," ",t?.last_name]})})]})},L5={display:"flex",flexDirection:"column",gap:"5px",background:"#fff",borderRadius:"8px",borderWidth:"3px",borderColor:"#ff2400",color:"white",width:"90vw",maxWidth:"400px",aspectRatio:"1"},D0="https://pilot-hestia-backend.onrender.com",T5=()=>{const[e,g]=b.useState(""),[t,I]=b.useState(""),[o,C]=b.useState(""),[s,r]=b.useState(""),[c,d]=b.useState(null),[A,m]=b.useState(""),Z=G=>{const B=G.target.files[0];B&&(r(B),d(URL.createObjectURL(B)))},y=async()=>{if(!e||!t||!o||!s){m("All fields including image are required.");return}m("");let G="";console.log("this is the preview: "+c);try{const B=new FormData;if(B.append("image",s),G=(await We.post(`${D0}/api/upload`,B,{headers:{"Content-Type":"multipart/form-data"}}))?.data?.imageUrl,!G)throw new Error("No image URL returned from server");console.log("Uploaded Image URL:",G)}catch(B){console.error("Upload failed",B);return}try{const B={title:e,description:t,points:o,img:G};if(!(await We.post(`${D0}/api/activities/create`,B)).ok)throw new Error("Failed to submit activity");alert("Activity submitted!")}catch{console.log("Error occured while creating activities")}g(""),I(""),r(""),C("")};return p.jsx(p.Fragment,{children:p.jsx("div",{style:Q5,children:p.jsxs(st,{component:"section",sx:{p:2,border:1,borderRadius:2},style:D5,children:[p.jsx(yg,{id:"outlined-basic",label:"Title",variant:"outlined",onChange:G=>g(G.target.value),value:e}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"Description",variant:"outlined",onChange:G=>I(G.target.value),value:t}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"points",variant:"outlined",onChange:G=>C(G.target.value),value:o}),p.jsx("br",{}),p.jsx("input",{type:"file",accept:"image/*",onChange:Z}),p.jsx("br",{}),c&&p.jsx("img",{src:c,alt:"Preview",style:{width:"100%",marginTop:"10px"}}),p.jsx(_e,{variant:"contained",sx:{color:"white",backgroundColor:"#ff2400"},onClick:()=>y(),children:"Submit"}),p.jsx("br",{}),A&&p.jsx("p",{style:{color:"red",marginTop:"10px"},children:A})]})})})},Q5={position:"relative",margin:"0 auto",display:"flex",justifyContent:"center",alignItems:"center"},D5={display:"flex",flexDirection:"column",gap:"5px",padding:"32px",background:"#fff",borderRadius:"8px",borderWidth:"3px",borderColor:"#ff2400",width:"300px"},j0="https://pilot-hestia-backend.onrender.com",j5=()=>{const[e,g]=b.useState(""),[t,I]=b.useState(""),[o,C]=b.useState(""),[s,r]=b.useState(""),[c,d]=b.useState(""),[A,m]=b.useState(""),[Z,y]=b.useState(null),[G,B]=b.useState(""),f=v=>{const R=v.target.files[0];R&&(m(R),y(URL.createObjectURL(R)))},W=async()=>{if(!t||!o||!s||!c||!A){B("All fields including image are required.");return}B("");let v="";try{const k=e,J=encodeURIComponent(k);console.log(k);const F=await We.get(`${j0}/api/vendor/find/${J}`);console.log("Vendor data:",F.data),v=F.data.id}catch{console.error("Unable to get vendor");return}let R="";console.log("this is the preview: "+Z);try{const k=new FormData;if(k.append("image",A),R=(await We.post(`${j0}/api/upload`,k,{headers:{"Content-Type":"multipart/form-data"}}))?.data?.imageUrl,!R)throw new Error("No image URL returned from server");console.log("Uploaded Image URL:",R)}catch(k){console.error("Upload failed",k);return}try{const k={vendor_id:v,title:t,cost:o,quantity:s,UsdPrice:c,img:R};console.log(k);const J=await We.post("/api/rewards/create",k);if(J.status!==200&&J.status!==201)throw new Error("Failed to submit reward");alert("Reward submitted!")}catch{console.error("Error occured while creating rewards")}g(""),I(""),m(""),C(""),r(""),d("")};return p.jsx(p.Fragment,{children:p.jsx("div",{style:P5,children:p.jsxs(st,{component:"section",sx:{p:2,border:1,borderRadius:2},style:O5,children:[p.jsx(yg,{id:"outlined-basic",label:"Business Name",variant:"outlined",onChange:v=>g(v.target.value),value:e}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"Title",variant:"outlined",onChange:v=>I(v.target.value),value:t}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"cost",variant:"outlined",onChange:v=>C(v.target.value),value:o}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"quantity",variant:"outlined",onChange:v=>r(v.target.value),value:s}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"UsdPrice",variant:"outlined",onChange:v=>d(v.target.value),value:c}),p.jsx("br",{}),p.jsx("input",{type:"file",accept:"image/*",onChange:f}),p.jsx("br",{}),Z&&p.jsx("img",{src:Z,alt:"Preview",style:{width:"100%",marginTop:"10px"}}),p.jsx(_e,{variant:"contained",sx:{color:"white",backgroundColor:"#ff2400"},onClick:()=>W(),children:"Submit"}),p.jsx("br",{}),G&&p.jsx("p",{style:{color:"red",marginTop:"10px"},children:G})]})})})},P5={position:"relative",margin:"0 auto",display:"flex",justifyContent:"center",alignItems:"center"},O5={display:"flex",flexDirection:"column",gap:"5px",padding:"32px",background:"#fff",borderRadius:"8px",borderWidth:"3px",borderColor:"#ff2400",width:"300px"},q5=()=>{const{isMember:e}=b.useContext(jC),[g,t]=b.useState(!0),I=o=>{t(o!=="reward")};return p.jsx(p.Fragment,{children:e?p.jsxs("div",{style:_5,children:[p.jsx(PC,{}),p.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[p.jsx("h1",{children:"Scan"}),p.jsx("div",{children:p.jsx(U5,{})})]}),p.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[p.jsx("h1",{children:"Create"}),p.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:"1em"},children:[p.jsx(_e,{onClick:()=>I("activity"),variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:".3em",fontWeight:600},children:"Activity"}),p.jsx("p1",{children:"or"}),p.jsx(_e,{onClick:()=>I("reward"),variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:".2em",fontWeight:600},children:"Reward"})]})]}),g?p.jsx(T5,{}):p.jsx(j5,{})]}):p.jsx("div",{children:p.jsx(_9,{})})})},_5={position:"relative",width:"100%",minHeight:"100vh",overflowX:"hidden",margin:"0 auto",display:"flex",color:"black",flexDirection:"column",alignItems:"center",gap:"2em"},P0="https://pilot-hestia-backend.onrender.com",Jf=({order_number:e,discount:g,first_name:t,last_name:I,reward_id:o,vendor_id:C,code:s})=>{const[r,c]=b.useState(null),[d,A]=b.useState(null),[m,Z]=b.useState(null),[y,G]=b.useState(null);return b.useEffect(()=>{(async()=>{try{const f=await We.get(`${P0}/api/vendor/id/${C}`);c(f?.data)}catch(f){console.log("No vendor found",f)}})()},[]),b.useEffect(()=>{(async()=>{try{const f=await We.get(`${P0}/api/rewards/id/${o}`);A(f?.data);const W=f?.data.cost,R=W*(1-g/100)/100,k=W-R*100;G("$"+R),Z(k)}catch(f){console.log("No reward found",f.message)}})()},[]),p.jsxs("div",{style:{...$5,display:"flex",flexDirection:"row"},children:[p.jsxs("div",{id:"left-side",style:{...EI,width:"50%"},children:[p.jsxs("h1",{style:{margin:0},children:["#",String(e).padStart(3,"0")]}),p.jsxs("h2",{style:{marginTop:0,fontSize:30},children:[g,"% Discount"]}),p.jsxs("div",{style:{...EI,...tC,padding:0},children:[p.jsx("h4",{style:Nt,children:"Embers spent: "}),p.jsxs("p",{style:Nt,children:[m," Embers"]})]}),p.jsxs("div",{style:{...EI,...tC,padding:0},children:[p.jsx("h4",{style:Nt,children:"Remaining USD:"}),p.jsx("p",{style:Nt,children:y})]})]}),p.jsxs("div",{id:"right-side",style:{...EI,width:"50%",gap:"0.5em"},children:[p.jsxs("div",{style:{...EI,...tC},children:[p.jsx("h4",{style:Nt,children:"Owner of Discount:"}),p.jsxs("p",{style:Nt,children:[t," ",I]})]}),p.jsxs("div",{style:{...EI,...tC},children:[p.jsx("h4",{style:Nt,children:"Item:"}),p.jsx("p",{style:Nt,children:d?.title})]}),p.jsxs("div",{style:{...EI,...tC},children:[p.jsx("h4",{style:Nt,children:"Vendor:"}),p.jsx("p",{style:Nt,children:r?.business_name})]}),p.jsxs("div",{children:[p.jsx("h2",{style:Nt,children:"Code:"}),p.jsx("h3",{style:{...Nt,textAlign:"center",backgroundColor:"lightgrey"},children:s})]})]})]})},$5={width:"90%",border:"3px, solid, red",padding:"1em"},EI={display:"flex",flexDirection:"column"},tC={justifyContent:"flex-start",alignItems:"flex-start"},Nt={margin:0,padding:0,textAlign:"left",fontSize:17};class sC extends Error{}sC.prototype.name="InvalidTokenError";function ex(e){return decodeURIComponent(atob(e).replace(/(.)/g,(g,t)=>{let I=t.charCodeAt(0).toString(16).toUpperCase();return I.length<2&&(I="0"+I),"%"+I}))}function gx(e){let g=e.replace(/-/g,"+").replace(/_/g,"/");switch(g.length%4){case 0:break;case 2:g+="==";break;case 3:g+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return ex(g)}catch{return atob(g)}}function or(e,g){if(typeof e!="string")throw new sC("Invalid token specified: must be a string");g||(g={});const t=g.header===!0?0:1,I=e.split(".")[t];if(typeof I!="string")throw new sC(`Invalid token specified: missing part #${t+1}`);let o;try{o=gx(I)}catch(C){throw new sC(`Invalid token specified: invalid base64 for part #${t+1} (${C.message})`)}try{return JSON.parse(o)}catch(C){throw new sC(`Invalid token specified: invalid json for part #${t+1} (${C.message})`)}}const Sn=Object.create(null);Sn.open="0";Sn.close="1";Sn.ping="2";Sn.pong="3";Sn.message="4";Sn.upgrade="5";Sn.noop="6";const xs=Object.create(null);Object.keys(Sn).forEach(e=>{xs[Sn[e]]=e});const hA={type:"error",data:"parser error"},vf=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Yf=typeof ArrayBuffer=="function",Hf=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Pu=({type:e,data:g},t,I)=>vf&&g instanceof Blob?t?I(g):O0(g,I):Yf&&(g instanceof ArrayBuffer||Hf(g))?t?I(g):O0(new Blob([g]),I):I(Sn[e]+(g||"")),O0=(e,g)=>{const t=new FileReader;return t.onload=function(){const I=t.result.split(",")[1];g("b"+(I||""))},t.readAsDataURL(e)};function q0(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Zd;function tx(e,g){if(vf&&e.data instanceof Blob)return e.data.arrayBuffer().then(q0).then(g);if(Yf&&(e.data instanceof ArrayBuffer||Hf(e.data)))return g(q0(e.data));Pu(e,!1,t=>{Zd||(Zd=new TextEncoder),g(Zd.encode(t))})}const _0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rC=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<_0.length;e++)rC[_0.charCodeAt(e)]=e;const nx=e=>{let g=e.length*.75,t=e.length,I,o=0,C,s,r,c;e[e.length-1]==="="&&(g--,e[e.length-2]==="="&&g--);const d=new ArrayBuffer(g),A=new Uint8Array(d);for(I=0;I<t;I+=4)C=rC[e.charCodeAt(I)],s=rC[e.charCodeAt(I+1)],r=rC[e.charCodeAt(I+2)],c=rC[e.charCodeAt(I+3)],A[o++]=C<<2|s>>4,A[o++]=(s&15)<<4|r>>2,A[o++]=(r&3)<<6|c&63;return d},Ix=typeof ArrayBuffer=="function",Ou=(e,g)=>{if(typeof e!="string")return{type:"message",data:wf(e,g)};const t=e.charAt(0);return t==="b"?{type:"message",data:lx(e.substring(1),g)}:xs[t]?e.length>1?{type:xs[t],data:e.substring(1)}:{type:xs[t]}:hA},lx=(e,g)=>{if(Ix){const t=nx(e);return wf(t,g)}else return{base64:!0,data:e}},wf=(e,g)=>{switch(g){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Ff="",ox=(e,g)=>{const t=e.length,I=new Array(t);let o=0;e.forEach((C,s)=>{Pu(C,!1,r=>{I[s]=r,++o===t&&g(I.join(Ff))})})},Cx=(e,g)=>{const t=e.split(Ff),I=[];for(let o=0;o<t.length;o++){const C=Ou(t[o],g);if(I.push(C),C.type==="error")break}return I};function ix(){return new TransformStream({transform(e,g){tx(e,t=>{const I=t.length;let o;if(I<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,I);else if(I<65536){o=new Uint8Array(3);const C=new DataView(o.buffer);C.setUint8(0,126),C.setUint16(1,I)}else{o=new Uint8Array(9);const C=new DataView(o.buffer);C.setUint8(0,127),C.setBigUint64(1,BigInt(I))}e.data&&typeof e.data!="string"&&(o[0]|=128),g.enqueue(o),g.enqueue(t)})}})}let bd;function Zs(e){return e.reduce((g,t)=>g+t.length,0)}function bs(e,g){if(e[0].length===g)return e.shift();const t=new Uint8Array(g);let I=0;for(let o=0;o<g;o++)t[o]=e[0][I++],I===e[0].length&&(e.shift(),I=0);return e.length&&I<e[0].length&&(e[0]=e[0].slice(I)),t}function sx(e,g){bd||(bd=new TextDecoder);const t=[];let I=0,o=-1,C=!1;return new TransformStream({transform(s,r){for(t.push(s);;){if(I===0){if(Zs(t)<1)break;const c=bs(t,1);C=(c[0]&128)===128,o=c[0]&127,o<126?I=3:o===126?I=1:I=2}else if(I===1){if(Zs(t)<2)break;const c=bs(t,2);o=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),I=3}else if(I===2){if(Zs(t)<8)break;const c=bs(t,8),d=new DataView(c.buffer,c.byteOffset,c.length),A=d.getUint32(0);if(A>Math.pow(2,21)-1){r.enqueue(hA);break}o=A*Math.pow(2,32)+d.getUint32(4),I=3}else{if(Zs(t)<o)break;const c=bs(t,o);r.enqueue(Ou(C?c:bd.decode(c),g)),I=0}if(o===0||o>e){r.enqueue(hA);break}}}})}const Kf=4;function Kg(e){if(e)return rx(e)}function rx(e){for(var g in Kg.prototype)e[g]=Kg.prototype[g];return e}Kg.prototype.on=Kg.prototype.addEventListener=function(e,g){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(g),this};Kg.prototype.once=function(e,g){function t(){this.off(e,t),g.apply(this,arguments)}return t.fn=g,this.on(e,t),this};Kg.prototype.off=Kg.prototype.removeListener=Kg.prototype.removeAllListeners=Kg.prototype.removeEventListener=function(e,g){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+e];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var I,o=0;o<t.length;o++)if(I=t[o],I===g||I.fn===g){t.splice(o,1);break}return t.length===0&&delete this._callbacks["$"+e],this};Kg.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var g=new Array(arguments.length-1),t=this._callbacks["$"+e],I=1;I<arguments.length;I++)g[I-1]=arguments[I];if(t){t=t.slice(0);for(var I=0,o=t.length;I<o;++I)t[I].apply(this,g)}return this};Kg.prototype.emitReserved=Kg.prototype.emit;Kg.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Kg.prototype.hasListeners=function(e){return!!this.listeners(e).length};const _r=typeof Promise=="function"&&typeof Promise.resolve=="function"?g=>Promise.resolve().then(g):(g,t)=>t(g,0),Mt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),ax="arraybuffer";function Nf(e,...g){return g.reduce((t,I)=>(e.hasOwnProperty(I)&&(t[I]=e[I]),t),{})}const cx=Mt.setTimeout,dx=Mt.clearTimeout;function $r(e,g){g.useNativeTimers?(e.setTimeoutFn=cx.bind(Mt),e.clearTimeoutFn=dx.bind(Mt)):(e.setTimeoutFn=Mt.setTimeout.bind(Mt),e.clearTimeoutFn=Mt.clearTimeout.bind(Mt))}const Ax=1.33;function ux(e){return typeof e=="string"?mx(e):Math.ceil((e.byteLength||e.size)*Ax)}function mx(e){let g=0,t=0;for(let I=0,o=e.length;I<o;I++)g=e.charCodeAt(I),g<128?t+=1:g<2048?t+=2:g<55296||g>=57344?t+=3:(I++,t+=4);return t}function xf(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function hx(e){let g="";for(let t in e)e.hasOwnProperty(t)&&(g.length&&(g+="&"),g+=encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return g}function px(e){let g={},t=e.split("&");for(let I=0,o=t.length;I<o;I++){let C=t[I].split("=");g[decodeURIComponent(C[0])]=decodeURIComponent(C[1])}return g}class Zx extends Error{constructor(g,t,I){super(g),this.description=t,this.context=I,this.type="TransportError"}}class qu extends Kg{constructor(g){super(),this.writable=!1,$r(this,g),this.opts=g,this.query=g.query,this.socket=g.socket,this.supportsBinary=!g.forceBase64}onError(g,t,I){return super.emitReserved("error",new Zx(g,t,I)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(g){this.readyState==="open"&&this.write(g)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(g){const t=Ou(g,this.socket.binaryType);this.onPacket(t)}onPacket(g){super.emitReserved("packet",g)}onClose(g){this.readyState="closed",super.emitReserved("close",g)}pause(g){}createUri(g,t={}){return g+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const g=this.opts.hostname;return g.indexOf(":")===-1?g:"["+g+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(g){const t=hx(g);return t.length?"?"+t:""}}class bx extends qu{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(g){this.readyState="pausing";const t=()=>{this.readyState="paused",g()};if(this._polling||!this.writable){let I=0;this._polling&&(I++,this.once("pollComplete",function(){--I||t()})),this.writable||(I++,this.once("drain",function(){--I||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(g){const t=I=>{if(this.readyState==="opening"&&I.type==="open"&&this.onOpen(),I.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(I)};Cx(g,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const g=()=>{this.write([{type:"close"}])};this.readyState==="open"?g():this.once("open",g)}write(g){this.writable=!1,ox(g,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const g=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=xf()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(g,t)}}let Ef=!1;try{Ef=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Gx=Ef;function yx(){}class Bx extends bx{constructor(g){if(super(g),typeof location<"u"){const t=location.protocol==="https:";let I=location.port;I||(I=t?"443":"80"),this.xd=typeof location<"u"&&g.hostname!==location.hostname||I!==g.port}}doWrite(g,t){const I=this.request({method:"POST",data:g});I.on("success",t),I.on("error",(o,C)=>{this.onError("xhr post error",o,C)})}doPoll(){const g=this.request();g.on("data",this.onData.bind(this)),g.on("error",(t,I)=>{this.onError("xhr poll error",t,I)}),this.pollXhr=g}}let Tl=class Es extends Kg{constructor(g,t,I){super(),this.createRequest=g,$r(this,I),this._opts=I,this._method=I.method||"GET",this._uri=t,this._data=I.data!==void 0?I.data:null,this._create()}_create(){var g;const t=Nf(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const I=this._xhr=this.createRequest(t);try{I.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){I.setDisableHeaderCheck&&I.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&I.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{I.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{I.setRequestHeader("Accept","*/*")}catch{}(g=this._opts.cookieJar)===null||g===void 0||g.addCookies(I),"withCredentials"in I&&(I.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(I.timeout=this._opts.requestTimeout),I.onreadystatechange=()=>{var o;I.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(I.getResponseHeader("set-cookie"))),I.readyState===4&&(I.status===200||I.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof I.status=="number"?I.status:0)},0))},I.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=Es.requestsCount++,Es.requests[this._index]=this)}_onError(g){this.emitReserved("error",g,this._xhr),this._cleanup(!0)}_cleanup(g){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=yx,g)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Es.requests[this._index],this._xhr=null}}_onLoad(){const g=this._xhr.responseText;g!==null&&(this.emitReserved("data",g),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Tl.requestsCount=0;Tl.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",$0);else if(typeof addEventListener=="function"){const e="onpagehide"in Mt?"pagehide":"unload";addEventListener(e,$0,!1)}}function $0(){for(let e in Tl.requests)Tl.requests.hasOwnProperty(e)&&Tl.requests[e].abort()}const fx=function(){const e=zf({xdomain:!1});return e&&e.responseType!==null}();class Sx extends Bx{constructor(g){super(g);const t=g&&g.forceBase64;this.supportsBinary=fx&&!t}request(g={}){return Object.assign(g,{xd:this.xd},this.opts),new Tl(zf,this.uri(),g)}}function zf(e){const g=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!g||Gx))return new XMLHttpRequest}catch{}if(!g)try{return new Mt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Mf=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Vx extends qu{get name(){return"websocket"}doOpen(){const g=this.uri(),t=this.opts.protocols,I=Mf?{}:Nf(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(I.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(g,t,I)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=g=>this.onClose({description:"websocket connection closed",context:g}),this.ws.onmessage=g=>this.onData(g.data),this.ws.onerror=g=>this.onError("websocket error",g)}write(g){this.writable=!1;for(let t=0;t<g.length;t++){const I=g[t],o=t===g.length-1;Pu(I,this.supportsBinary,C=>{try{this.doWrite(I,C)}catch{}o&&_r(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const g=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=xf()),this.supportsBinary||(t.b64=1),this.createUri(g,t)}}const Gd=Mt.WebSocket||Mt.MozWebSocket;class Wx extends Vx{createSocket(g,t,I){return Mf?new Gd(g,t,I):t?new Gd(g,t):new Gd(g)}doWrite(g,t){this.ws.send(t)}}class Rx extends qu{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(g){return this.emitReserved("error",g)}this._transport.closed.then(()=>{this.onClose()}).catch(g=>{this.onError("webtransport error",g)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(g=>{const t=sx(Number.MAX_SAFE_INTEGER,this.socket.binaryType),I=g.readable.pipeThrough(t).getReader(),o=ix();o.readable.pipeTo(g.writable),this._writer=o.writable.getWriter();const C=()=>{I.read().then(({done:r,value:c})=>{r||(this.onPacket(c),C())}).catch(r=>{})};C();const s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this._writer.write(s).then(()=>this.onOpen())})})}write(g){this.writable=!1;for(let t=0;t<g.length;t++){const I=g[t],o=t===g.length-1;this._writer.write(I).then(()=>{o&&_r(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var g;(g=this._transport)===null||g===void 0||g.close()}}const Xx={websocket:Wx,webtransport:Rx,polling:Sx},kx=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Jx=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function pA(e){if(e.length>8e3)throw"URI too long";const g=e,t=e.indexOf("["),I=e.indexOf("]");t!=-1&&I!=-1&&(e=e.substring(0,t)+e.substring(t,I).replace(/:/g,";")+e.substring(I,e.length));let o=kx.exec(e||""),C={},s=14;for(;s--;)C[Jx[s]]=o[s]||"";return t!=-1&&I!=-1&&(C.source=g,C.host=C.host.substring(1,C.host.length-1).replace(/;/g,":"),C.authority=C.authority.replace("[","").replace("]","").replace(/;/g,":"),C.ipv6uri=!0),C.pathNames=vx(C,C.path),C.queryKey=Yx(C,C.query),C}function vx(e,g){const t=/\/{2,9}/g,I=g.replace(t,"/").split("/");return(g.slice(0,1)=="/"||g.length===0)&&I.splice(0,1),g.slice(-1)=="/"&&I.splice(I.length-1,1),I}function Yx(e,g){const t={};return g.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(I,o,C){o&&(t[o]=C)}),t}const ZA=typeof addEventListener=="function"&&typeof removeEventListener=="function",zs=[];ZA&&addEventListener("offline",()=>{zs.forEach(e=>e())},!1);class hI extends Kg{constructor(g,t){if(super(),this.binaryType=ax,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,g&&typeof g=="object"&&(t=g,g=null),g){const I=pA(g);t.hostname=I.host,t.secure=I.protocol==="https"||I.protocol==="wss",t.port=I.port,I.query&&(t.query=I.query)}else t.host&&(t.hostname=pA(t.host).host);$r(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(I=>{const o=I.prototype.name;this.transports.push(o),this._transportsByName[o]=I}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=px(this.opts.query)),ZA&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},zs.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(g){const t=Object.assign({},this.opts.query);t.EIO=Kf,t.transport=g,this.id&&(t.sid=this.id);const I=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[g]);return new this._transportsByName[g](I)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const g=this.opts.rememberUpgrade&&hI.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(g);t.open(),this.setTransport(t)}setTransport(g){this.transport&&this.transport.removeAllListeners(),this.transport=g,g.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",hI.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(g){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",g),this.emitReserved("heartbeat"),g.type){case"open":this.onHandshake(JSON.parse(g.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=g.data,this._onError(t);break;case"message":this.emitReserved("data",g.data),this.emitReserved("message",g.data);break}}onHandshake(g){this.emitReserved("handshake",g),this.id=g.sid,this.transport.query.sid=g.sid,this._pingInterval=g.pingInterval,this._pingTimeout=g.pingTimeout,this._maxPayload=g.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const g=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+g,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},g),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const g=this._getWritablePackets();this.transport.send(g),this._prevBufferLen=g.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let I=0;I<this.writeBuffer.length;I++){const o=this.writeBuffer[I].data;if(o&&(t+=ux(o)),I>0&&t>this._maxPayload)return this.writeBuffer.slice(0,I);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const g=Date.now()>this._pingTimeoutTime;return g&&(this._pingTimeoutTime=0,_r(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),g}write(g,t,I){return this._sendPacket("message",g,t,I),this}send(g,t,I){return this._sendPacket("message",g,t,I),this}_sendPacket(g,t,I,o){if(typeof t=="function"&&(o=t,t=void 0),typeof I=="function"&&(o=I,I=null),this.readyState==="closing"||this.readyState==="closed")return;I=I||{},I.compress=I.compress!==!1;const C={type:g,data:t,options:I};this.emitReserved("packetCreate",C),this.writeBuffer.push(C),o&&this.once("flush",o),this.flush()}close(){const g=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),g()},I=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?I():g()}):this.upgrading?I():g()),this}_onError(g){if(hI.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",g),this._onClose("transport error",g)}_onClose(g,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ZA&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const I=zs.indexOf(this._offlineEventListener);I!==-1&&zs.splice(I,1)}this.readyState="closed",this.id=null,this.emitReserved("close",g,t),this.writeBuffer=[],this._prevBufferLen=0}}}hI.protocol=Kf;class Hx extends hI{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let g=0;g<this._upgrades.length;g++)this._probe(this._upgrades[g])}_probe(g){let t=this.createTransport(g),I=!1;hI.priorWebsocketSuccess=!1;const o=()=>{I||(t.send([{type:"ping",data:"probe"}]),t.once("packet",m=>{if(!I)if(m.type==="pong"&&m.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;hI.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{I||this.readyState!=="closed"&&(A(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const Z=new Error("probe error");Z.transport=t.name,this.emitReserved("upgradeError",Z)}}))};function C(){I||(I=!0,A(),t.close(),t=null)}const s=m=>{const Z=new Error("probe error: "+m);Z.transport=t.name,C(),this.emitReserved("upgradeError",Z)};function r(){s("transport closed")}function c(){s("socket closed")}function d(m){t&&m.name!==t.name&&C()}const A=()=>{t.removeListener("open",o),t.removeListener("error",s),t.removeListener("close",r),this.off("close",c),this.off("upgrading",d)};t.once("open",o),t.once("error",s),t.once("close",r),this.once("close",c),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&g!=="webtransport"?this.setTimeoutFn(()=>{I||t.open()},200):t.open()}onHandshake(g){this._upgrades=this._filterUpgrades(g.upgrades),super.onHandshake(g)}_filterUpgrades(g){const t=[];for(let I=0;I<g.length;I++)~this.transports.indexOf(g[I])&&t.push(g[I]);return t}}let wx=class extends Hx{constructor(g,t={}){const I=typeof g=="object"?g:t;(!I.transports||I.transports&&typeof I.transports[0]=="string")&&(I.transports=(I.transports||["polling","websocket","webtransport"]).map(o=>Xx[o]).filter(o=>!!o)),super(g,I)}};function Fx(e,g="",t){let I=e;t=t||typeof location<"u"&&location,e==null&&(e=t.protocol+"//"+t.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=t.protocol+e:e=t.host+e),/^(https?|wss?):\/\//.test(e)||(typeof t<"u"?e=t.protocol+"//"+e:e="https://"+e),I=pA(e)),I.port||(/^(http|ws)$/.test(I.protocol)?I.port="80":/^(http|ws)s$/.test(I.protocol)&&(I.port="443")),I.path=I.path||"/";const C=I.host.indexOf(":")!==-1?"["+I.host+"]":I.host;return I.id=I.protocol+"://"+C+":"+I.port+g,I.href=I.protocol+"://"+C+(t&&t.port===I.port?"":":"+I.port),I}const Kx=typeof ArrayBuffer=="function",Nx=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Uf=Object.prototype.toString,xx=typeof Blob=="function"||typeof Blob<"u"&&Uf.call(Blob)==="[object BlobConstructor]",Ex=typeof File=="function"||typeof File<"u"&&Uf.call(File)==="[object FileConstructor]";function _u(e){return Kx&&(e instanceof ArrayBuffer||Nx(e))||xx&&e instanceof Blob||Ex&&e instanceof File}function Ms(e,g){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let t=0,I=e.length;t<I;t++)if(Ms(e[t]))return!0;return!1}if(_u(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Ms(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&Ms(e[t]))return!0;return!1}function zx(e){const g=[],t=e.data,I=e;return I.data=bA(t,g),I.attachments=g.length,{packet:I,buffers:g}}function bA(e,g){if(!e)return e;if(_u(e)){const t={_placeholder:!0,num:g.length};return g.push(e),t}else if(Array.isArray(e)){const t=new Array(e.length);for(let I=0;I<e.length;I++)t[I]=bA(e[I],g);return t}else if(typeof e=="object"&&!(e instanceof Date)){const t={};for(const I in e)Object.prototype.hasOwnProperty.call(e,I)&&(t[I]=bA(e[I],g));return t}return e}function Mx(e,g){return e.data=GA(e.data,g),delete e.attachments,e}function GA(e,g){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<g.length)return g[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let t=0;t<e.length;t++)e[t]=GA(e[t],g);else if(typeof e=="object")for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(e[t]=GA(e[t],g));return e}const Ux=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Lx=5;var Le;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Le||(Le={}));class Tx{constructor(g){this.replacer=g}encode(g){return(g.type===Le.EVENT||g.type===Le.ACK)&&Ms(g)?this.encodeAsBinary({type:g.type===Le.EVENT?Le.BINARY_EVENT:Le.BINARY_ACK,nsp:g.nsp,data:g.data,id:g.id}):[this.encodeAsString(g)]}encodeAsString(g){let t=""+g.type;return(g.type===Le.BINARY_EVENT||g.type===Le.BINARY_ACK)&&(t+=g.attachments+"-"),g.nsp&&g.nsp!=="/"&&(t+=g.nsp+","),g.id!=null&&(t+=g.id),g.data!=null&&(t+=JSON.stringify(g.data,this.replacer)),t}encodeAsBinary(g){const t=zx(g),I=this.encodeAsString(t.packet),o=t.buffers;return o.unshift(I),o}}function eG(e){return Object.prototype.toString.call(e)==="[object Object]"}class $u extends Kg{constructor(g){super(),this.reviver=g}add(g){let t;if(typeof g=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(g);const I=t.type===Le.BINARY_EVENT;I||t.type===Le.BINARY_ACK?(t.type=I?Le.EVENT:Le.ACK,this.reconstructor=new Qx(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(_u(g)||g.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(g),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+g)}decodeString(g){let t=0;const I={type:Number(g.charAt(0))};if(Le[I.type]===void 0)throw new Error("unknown packet type "+I.type);if(I.type===Le.BINARY_EVENT||I.type===Le.BINARY_ACK){const C=t+1;for(;g.charAt(++t)!=="-"&&t!=g.length;);const s=g.substring(C,t);if(s!=Number(s)||g.charAt(t)!=="-")throw new Error("Illegal attachments");I.attachments=Number(s)}if(g.charAt(t+1)==="/"){const C=t+1;for(;++t&&!(g.charAt(t)===","||t===g.length););I.nsp=g.substring(C,t)}else I.nsp="/";const o=g.charAt(t+1);if(o!==""&&Number(o)==o){const C=t+1;for(;++t;){const s=g.charAt(t);if(s==null||Number(s)!=s){--t;break}if(t===g.length)break}I.id=Number(g.substring(C,t+1))}if(g.charAt(++t)){const C=this.tryParse(g.substr(t));if($u.isPayloadValid(I.type,C))I.data=C;else throw new Error("invalid payload")}return I}tryParse(g){try{return JSON.parse(g,this.reviver)}catch{return!1}}static isPayloadValid(g,t){switch(g){case Le.CONNECT:return eG(t);case Le.DISCONNECT:return t===void 0;case Le.CONNECT_ERROR:return typeof t=="string"||eG(t);case Le.EVENT:case Le.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Ux.indexOf(t[0])===-1);case Le.ACK:case Le.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Qx{constructor(g){this.packet=g,this.buffers=[],this.reconPack=g}takeBinaryData(g){if(this.buffers.push(g),this.buffers.length===this.reconPack.attachments){const t=Mx(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Dx=Object.freeze(Object.defineProperty({__proto__:null,Decoder:$u,Encoder:Tx,get PacketType(){return Le},protocol:Lx},Symbol.toStringTag,{value:"Module"}));function gn(e,g,t){return e.on(g,t),function(){e.off(g,t)}}const jx=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Lf extends Kg{constructor(g,t,I){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=g,this.nsp=t,I&&I.auth&&(this.auth=I.auth),this._opts=Object.assign({},I),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const g=this.io;this.subs=[gn(g,"open",this.onopen.bind(this)),gn(g,"packet",this.onpacket.bind(this)),gn(g,"error",this.onerror.bind(this)),gn(g,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...g){return g.unshift("message"),this.emit.apply(this,g),this}emit(g,...t){var I,o,C;if(jx.hasOwnProperty(g))throw new Error('"'+g.toString()+'" is a reserved event name');if(t.unshift(g),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const s={type:Le.EVENT,data:t};if(s.options={},s.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const A=this.ids++,m=t.pop();this._registerAckCallback(A,m),s.id=A}const r=(o=(I=this.io.engine)===null||I===void 0?void 0:I.transport)===null||o===void 0?void 0:o.writable,c=this.connected&&!(!((C=this.io.engine)===null||C===void 0)&&C._hasPingExpired());return this.flags.volatile&&!r||(c?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(g,t){var I;const o=(I=this.flags.timeout)!==null&&I!==void 0?I:this._opts.ackTimeout;if(o===void 0){this.acks[g]=t;return}const C=this.io.setTimeoutFn(()=>{delete this.acks[g];for(let r=0;r<this.sendBuffer.length;r++)this.sendBuffer[r].id===g&&this.sendBuffer.splice(r,1);t.call(this,new Error("operation has timed out"))},o),s=(...r)=>{this.io.clearTimeoutFn(C),t.apply(this,r)};s.withError=!0,this.acks[g]=s}emitWithAck(g,...t){return new Promise((I,o)=>{const C=(s,r)=>s?o(s):I(r);C.withError=!0,t.push(C),this.emit(g,...t)})}_addToQueue(g){let t;typeof g[g.length-1]=="function"&&(t=g.pop());const I={id:this._queueSeq++,tryCount:0,pending:!1,args:g,flags:Object.assign({fromQueue:!0},this.flags)};g.push((o,...C)=>I!==this._queue[0]?void 0:(o!==null?I.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(o)):(this._queue.shift(),t&&t(null,...C)),I.pending=!1,this._drainQueue())),this._queue.push(I),this._drainQueue()}_drainQueue(g=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!g||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(g){g.nsp=this.nsp,this.io._packet(g)}onopen(){typeof this.auth=="function"?this.auth(g=>{this._sendConnectPacket(g)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(g){this.packet({type:Le.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},g):g})}onerror(g){this.connected||this.emitReserved("connect_error",g)}onclose(g,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",g,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(g=>{if(!this.sendBuffer.some(I=>String(I.id)===g)){const I=this.acks[g];delete this.acks[g],I.withError&&I.call(this,new Error("socket has been disconnected"))}})}onpacket(g){if(g.nsp===this.nsp)switch(g.type){case Le.CONNECT:g.data&&g.data.sid?this.onconnect(g.data.sid,g.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Le.EVENT:case Le.BINARY_EVENT:this.onevent(g);break;case Le.ACK:case Le.BINARY_ACK:this.onack(g);break;case Le.DISCONNECT:this.ondisconnect();break;case Le.CONNECT_ERROR:this.destroy();const I=new Error(g.data.message);I.data=g.data.data,this.emitReserved("connect_error",I);break}}onevent(g){const t=g.data||[];g.id!=null&&t.push(this.ack(g.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(g){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const I of t)I.apply(this,g)}super.emit.apply(this,g),this._pid&&g.length&&typeof g[g.length-1]=="string"&&(this._lastOffset=g[g.length-1])}ack(g){const t=this;let I=!1;return function(...o){I||(I=!0,t.packet({type:Le.ACK,id:g,data:o}))}}onack(g){const t=this.acks[g.id];typeof t=="function"&&(delete this.acks[g.id],t.withError&&g.data.unshift(null),t.apply(this,g.data))}onconnect(g,t){this.id=g,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(g=>this.emitEvent(g)),this.receiveBuffer=[],this.sendBuffer.forEach(g=>{this.notifyOutgoingListeners(g),this.packet(g)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(g=>g()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Le.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(g){return this.flags.compress=g,this}get volatile(){return this.flags.volatile=!0,this}timeout(g){return this.flags.timeout=g,this}onAny(g){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(g),this}prependAny(g){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(g),this}offAny(g){if(!this._anyListeners)return this;if(g){const t=this._anyListeners;for(let I=0;I<t.length;I++)if(g===t[I])return t.splice(I,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(g){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(g),this}prependAnyOutgoing(g){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(g),this}offAnyOutgoing(g){if(!this._anyOutgoingListeners)return this;if(g){const t=this._anyOutgoingListeners;for(let I=0;I<t.length;I++)if(g===t[I])return t.splice(I,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(g){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const I of t)I.apply(this,g.data)}}}function Co(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Co.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var g=Math.random(),t=Math.floor(g*this.jitter*e);e=(Math.floor(g*10)&1)==0?e-t:e+t}return Math.min(e,this.max)|0};Co.prototype.reset=function(){this.attempts=0};Co.prototype.setMin=function(e){this.ms=e};Co.prototype.setMax=function(e){this.max=e};Co.prototype.setJitter=function(e){this.jitter=e};class yA extends Kg{constructor(g,t){var I;super(),this.nsps={},this.subs=[],g&&typeof g=="object"&&(t=g,g=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,$r(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((I=t.randomizationFactor)!==null&&I!==void 0?I:.5),this.backoff=new Co({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=g;const o=t.parser||Dx;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(g){return arguments.length?(this._reconnection=!!g,g||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(g){return g===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=g,this)}reconnectionDelay(g){var t;return g===void 0?this._reconnectionDelay:(this._reconnectionDelay=g,(t=this.backoff)===null||t===void 0||t.setMin(g),this)}randomizationFactor(g){var t;return g===void 0?this._randomizationFactor:(this._randomizationFactor=g,(t=this.backoff)===null||t===void 0||t.setJitter(g),this)}reconnectionDelayMax(g){var t;return g===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=g,(t=this.backoff)===null||t===void 0||t.setMax(g),this)}timeout(g){return arguments.length?(this._timeout=g,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(g){if(~this._readyState.indexOf("open"))return this;this.engine=new wx(this.uri,this.opts);const t=this.engine,I=this;this._readyState="opening",this.skipReconnect=!1;const o=gn(t,"open",function(){I.onopen(),g&&g()}),C=r=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",r),g?g(r):this.maybeReconnectOnOpen()},s=gn(t,"error",C);if(this._timeout!==!1){const r=this._timeout,c=this.setTimeoutFn(()=>{o(),C(new Error("timeout")),t.close()},r);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(o),this.subs.push(s),this}connect(g){return this.open(g)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const g=this.engine;this.subs.push(gn(g,"ping",this.onping.bind(this)),gn(g,"data",this.ondata.bind(this)),gn(g,"error",this.onerror.bind(this)),gn(g,"close",this.onclose.bind(this)),gn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(g){try{this.decoder.add(g)}catch(t){this.onclose("parse error",t)}}ondecoded(g){_r(()=>{this.emitReserved("packet",g)},this.setTimeoutFn)}onerror(g){this.emitReserved("error",g)}socket(g,t){let I=this.nsps[g];return I?this._autoConnect&&!I.active&&I.connect():(I=new Lf(this,g,t),this.nsps[g]=I),I}_destroy(g){const t=Object.keys(this.nsps);for(const I of t)if(this.nsps[I].active)return;this._close()}_packet(g){const t=this.encoder.encode(g);for(let I=0;I<t.length;I++)this.engine.write(t[I],g.options)}cleanup(){this.subs.forEach(g=>g()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(g,t){var I;this.cleanup(),(I=this.engine)===null||I===void 0||I.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",g,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const g=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const I=this.setTimeoutFn(()=>{g.skipReconnect||(this.emitReserved("reconnect_attempt",g.backoff.attempts),!g.skipReconnect&&g.open(o=>{o?(g._reconnecting=!1,g.reconnect(),this.emitReserved("reconnect_error",o)):g.onreconnect()}))},t);this.opts.autoUnref&&I.unref(),this.subs.push(()=>{this.clearTimeoutFn(I)})}}onreconnect(){const g=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",g)}}const nC={};function Us(e,g){typeof e=="object"&&(g=e,e=void 0),g=g||{};const t=Fx(e,g.path||"/socket.io"),I=t.source,o=t.id,C=t.path,s=nC[o]&&C in nC[o].nsps,r=g.forceNew||g["force new connection"]||g.multiplex===!1||s;let c;return r?c=new yA(I,g):(nC[o]||(nC[o]=new yA(I,g)),c=nC[o]),t.query&&!g.query&&(g.query=t.queryKey),c.socket(t.path,g)}Object.assign(Us,{Manager:yA,Socket:Lf,io:Us,connect:Us});const ot=Us("https://pilot-hestia-backend.onrender.com",{auth:{token:localStorage.getItem("token")},transports:["websocket"]}),Px=()=>{const[e,g]=b.useState(!1),[t,I]=b.useState(null),[o,C]=b.useState([]),[s,r]=b.useState(null),c=localStorage.getItem("token");b.useEffect(()=>{(async()=>{try{const m=await We.get("/api/user/me",{headers:{Authorization:`Bearer ${c}`}});I(m.data);const Z=await We.get("/api/rewards/coupon",{headers:{Authorization:`Bearer ${c}`}});C(Z.data)}catch(m){console.log("Error fetching profile data:",m)}})()},[]),b.useEffect(()=>{if(!c)return;let A;try{A=or(c)}catch(y){console.error("Invalid token",y);return}const m=A?.id;if(!m){console.warn("User ID missing in token");return}const Z=()=>{console.log("connected"),ot.emit("register_user",{userId:m})};ot.on("connect",Z),ot.on("registered_user",({userId:y})=>{console.log(`User ${y} has joined`)}),ot.on("join_receipt_room",({room:y})=>{const G={room:y,role:"user"};console.log(G.room,G.role),ot.emit("request_join_receipt_room",G)}),ot.on("show_receipt",y=>{r(y),console.log(y)}),s&&console.log(s)},[]),b.useEffect(()=>{s&&(console.log("Receipt received:",s),g(!0))},[s]);const d=()=>{g(!1),r(null)};return p.jsx(p.Fragment,{children:p.jsxs("div",{style:{...gG,color:"black"},children:[p.jsx(PC,{}),p.jsx("h1",{style:{color:"black",fontSize:"35px"},children:" Profile "}),p.jsx("div",{style:Ox,children:p.jsx("img",{style:{width:"100%"},src:t?.qr_url,alt:""})}),p.jsx(nl,{open:!!s,onClose:()=>d,children:p.jsxs(st,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,width:300},children:[p.jsx("h2",{style:{marginTop:0},children:"Receipt"}),p.jsxs("p",{children:[p.jsx("strong",{children:"Order:"})," ",s?.order_number]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Customer:"})," ",s?.user_name]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Vendor Business:"})," ",s?.business_name]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Vendor Name:"})," ",s?.vendor_name]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Title:"})," ",s?.reward_title]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Embers Spent:"})," ",s?.spent]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Remaining Price"})," ",s?.remaining_USD]}),p.jsx("button",{onClick:()=>r(null),children:"Close"})]})}),o?.length>0?p.jsx(p.Fragment,{children:p.jsxs("div",{style:gG,children:[p.jsx("h2",{style:{textAlign:"center"},children:"Purchased Rewards"}),p.jsx("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",padding:"10px",gap:"10px"},children:o.filter(A=>A?.status==="pending").map((A,m)=>p.jsx(Jf,{order_number:A?.order_number,discount:A?.discount,first_name:t?.first_name,last_name:t?.last_name,reward_id:A?.reward_id,vendor_id:A?.vendor_id,code:A?.code},A?.id))})]})}):p.jsx("div",{style:{color:"black"},children:p.jsx("center",{children:p.jsx("h3",{children:"No Coupons Have Been Purchased Yet"})})})]})})},gG={width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},Ox={width:250,height:250,border:"2px, solid, red",borderRadius:"5px"},qx=({handleChange:e})=>{const[g,t]=b.useState(""),I=o=>{const C=o.target.value;t(C),e(C)};return p.jsx(st,{sx:{minWidth:100},children:p.jsxs(Bf,{fullWidth:!0,children:[p.jsx(yf,{id:"demo-simple-select-label",children:"Size"}),p.jsxs(zu,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:g,label:"size",onChange:o=>I(o),children:[p.jsx(ht,{value:"xs",children:"XS"}),p.jsx(ht,{value:"s",children:"S"}),p.jsx(ht,{value:"m",children:"M"}),p.jsx(ht,{value:"l",children:"L"}),p.jsx(ht,{value:"xl",children:"XL"}),p.jsx(ht,{value:"xxl",children:"XXL"})]})]})})};function _x(e,g=1e3){const[t,I]=b.useState(e);return b.useEffect(()=>{const o=t,C=e-o,s=Math.round(g/16);let r=0;const c=()=>{r++;const d=r/s,A=Math.round(o+C*d);I(A),r<s&&requestAnimationFrame(c)};c()},[e]),t}const yd="https://pilot-hestia-backend.onrender.com",$x={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:370,bgcolor:"background.paper",color:"black",borderRadius:"5px",boxShadow:24,p:4,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"1em"},e3=({id:e,img:g,rewardTitle:t,quantity:I,cost:o,usdPrice:C,vendor_id:s})=>{const r=Qn(),[c,d]=b.useState(null),[A,m]=b.useState(null),[Z,y]=b.useState(null),[G,B]=b.useState(`$${C}`),[f,W]=b.useState(null),[v,R]=b.useState(null),[k,J]=b.useState(null),[F,U]=b.useState(null),[X,K]=b.useState(!1),[w,D]=b.useState(!1),V=()=>{K(!1),D(!0)},z=()=>{D(!1),W(null),y(null),B(`$${C}`)},N=localStorage.getItem("token"),L=Z?A-Z:A,Q=_x(L);b.useEffect(()=>{(async()=>{try{const te=await We.get(`${yd}/api/user/me`,{headers:{Authorization:`Bearer ${N}`}});te?.data&&d(te?.data),console.log(te?.data)}catch(te){console.log("couldn't fetch user",te)}})()},[]),b.useEffect(()=>{(async()=>{try{const oe=(await We.get(`${yd}/api/points/`,{headers:{Authorization:`Bearer ${N}`}}))?.data;m(oe)}catch{console.log("couldn't fetch points")}})()},[]);const[q,j]=b.useState(""),P=async()=>{let M=e,te=f,oe=Z;console.log(v);try{let ne=await We.put(`${yd}/api/rewards/purchase`,{reward_id:M,size:te,cost:oe,discount:v},{headers:{Authorization:`Bearer ${N}`}});K(!0),J(ne?.data.code),U(ne?.data.order_number),console.log(ne?.data)}catch(ne){console.log("error ocurred",ne)}},$=M=>{W(M)},H=M=>{const te=Number(M),oe=o*(1-te/100)/100,ne=o-oe*100;R(te),B("$"+oe),y(ne)};return p.jsxs("div",{children:[p.jsx(_e,{onClick:V,variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"10px",fontWeight:600},children:"View"}),p.jsx(nl,{open:w,onClose:z,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:p.jsx(st,{sx:$x,children:X?p.jsx(p.Fragment,{children:p.jsxs("div",{style:{...IC,textAlign:"center"},children:[p.jsx("h3",{children:"Your Discount Has Been Purchased!"}),p.jsx(Jf,{order_number:F,discount:v,first_name:c?.first_name,last_name:c?.last_name,reward_id:e,title:t,vendor_id:s,code:k}),p.jsx(_e,{onClick:()=>r("/profile"),variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"10px",fontWeight:600},children:"Profile"}),p.jsx("p1",{children:"Please head to your profile to see all purchased rewards!"})]})}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{id:"full-containter",style:{width:"100%",display:"flex",flexDirection:"row",gap:"3em"},children:[p.jsxs("div",{id:"left-container",style:{...IC,justifyContent:"start"},children:[p.jsx("img",{src:g,alt:"",style:{maxWidth:150}}),p.jsxs("div",{style:{...IC,justifyContent:"center"},children:[p.jsx("p",{style:ys,children:t}),p.jsxs("p",{children:["Quantity: ",I]}),p.jsx(qx,{handleChange:$})]})]}),p.jsxs("div",{id:"right-container",style:{...IC,width:"100%"},children:[p.jsx("div",{style:{marginTop:"auto"},children:p.jsxs(st,{sx:{width:"100%",...IC},children:[p.jsx(yt,{sx:{width:"100%",marginLeft:"auto",textAlign:"center",fontSize:25,marginBottom:"10px"},id:"modal-modal-title",variant:"h8",component:"h2",children:"Purchase a Discount!"}),p.jsxs(Rt,{container:!0,rowSpacing:2,columnSpacing:{xs:12,sm:8,md:8},children:[p.jsx(Rt,{size:3,children:p.jsx("div",{children:p.jsx(_e,{disabled:!f,variant:"contained",name:"10",sx:Gs,onClick:M=>H(M.target.name),children:"10%"})})}),p.jsx(Rt,{size:3,children:p.jsx("div",{children:p.jsx(_e,{disabled:!f,variant:"contained",name:"20",sx:Gs,onClick:M=>H(M.target.name),children:"20%"})})}),p.jsx(Rt,{size:3,children:p.jsx("div",{children:p.jsx(_e,{disabled:!f,variant:"contained",name:"50",sx:Gs,onClick:M=>H(M.target.name),children:"50%"})})}),p.jsx(Rt,{size:3,children:p.jsx("div",{children:p.jsx(_e,{disabled:!f,variant:"contained",name:"100",sx:Gs,onClick:M=>H(M.target.name),children:"100%"})})})]})]})}),p.jsxs("div",{style:{marginTop:"auto",paddingTop:"20px"},children:[p.jsxs("h1",{style:{...ys,color:Q<=0?"red":"black"},children:["Ember Balance: ",Q]}),p.jsxs("h1",{style:ys,children:["USD Cost: ",G," "]}),p.jsxs("h1",{style:ys,children:["Embers Cost: ",Z]})]})]})]}),p.jsxs(_e,{disabled:!v,onClick:P,variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"2em",fontWeight:600},children:[" Pay ",Z]}),q&&p.jsx(yt,{color:"error",sx:{mt:1},children:q})]})})})]})},Gs={backgroundColor:"#ff2400",color:"white",marginTop:"10px",fontWeight:600},ys={margin:0,overflow:"hidden",textOverflow:"ellipsis",wordBreak:"break-word",lineHeight:"1.1",fontSize:"15px",fontWeight:"bold"},IC={display:"flex",flexDirection:"column"},g3="https://pilot-hestia-backend.onrender.com",t3=({id:e})=>{const[g,t]=b.useState([]);return console.log(e),b.useEffect(()=>{e&&(async()=>{try{const o=await We.get(`${g3}/api/rewards/${e}`);t(o?.data),console.log(g[0])}catch{console.error("Could't get rewards")}})()},[e]),p.jsx(Rt,{container:!0,spacing:4,justifyContent:"center",children:g.map((I,o)=>p.jsx(Rt,{sx:Bd,item:!0,xs:"auto",sm:6,md:6,children:p.jsxs(Mu,{sx:{...Bd,padding:".5em",width:150,height:230,borderRadius:3,cursor:"pointer",boxShadow:"0 0 3px #FF5F00"},children:[p.jsx(Lu,{component:"img",height:"100",image:I?.img,alt:I?.title}),p.jsxs(Uu,{sx:{...Bd,paddingTop:"1em",gap:3},children:[p.jsx(yt,{variant:"h6",sx:n3,component:"div",children:I?.title}),p.jsx(e3,{id:I.id,img:I?.img,rewardTitle:I?.title,quantity:I?.quantity,cost:I?.cost,size:I?.size,usdPrice:I?.UsdPrice,vendor_id:e})]})]})},o))})},Bd={margin:0,padding:0,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},n3={margin:0,overflow:"hidden",textOverflow:"ellipsis",wordBreak:"break-word",lineHeight:"1.1",fontSize:"15px",fontWeight:"bold"},I3="https://pilot-hestia-backend.onrender.com",l3=()=>{const[e,g]=b.useState([]),[t,I]=b.useState(null),{selectedVendorId:o,setSelectedVendorId:C,handleVendorClick:s}=b.useContext(gu),r="flex-container"+(e.length===3?" three-items":"");b.useEffect(()=>{(async()=>{try{const A=await We.get(`${I3}/api/vendor/all`);if(A.data){const m=A.data;g(m),C(Z=>Z||m[0]?.id)}}catch(A){console.log("No vendors received",A)}})()},[]);const c=d=>{console.log("Reward selected:",d),I(d)};return p.jsx(p.Fragment,{children:p.jsxs("div",{style:tG,children:[p.jsx(PC,{}),p.jsxs("div",{children:[p.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:p.jsx("h1",{style:{...o3,fontSize:"30px"},children:"Purchase Rewards!"})}),p.jsx("div",{className:r,children:e.map(d=>p.jsx(eu,{img:d?.img,business_name:d?.business_name,onClick:()=>s(d?.id),isSelected:o===d.id},d?.id))}),p.jsx("div",{style:{...tG,margin:0,padding:"1em"},children:p.jsx(t3,{handleCardClick:c,isSelected:t?.id,id:o})})]})]})})},o3={color:"#FF5F00"},tG={display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},C3="https://pilot-hestia-backend.onrender.com",i3=async e=>{try{const t=(await We.post(`${C3}/api/vendor/register`,e)).data;return localStorage.setItem("token",t.token),t}catch(g){throw console.error("register failed",g),g}},s3=()=>{const e=Qn(),[g,t]=b.useState(""),[I,o]=b.useState(""),[C,s]=b.useState(""),[r,c]=b.useState(""),[d,A]=b.useState(""),[m,Z]=b.useState(""),y={business_name:g,first_name:I,last_name:C,email:r,password:d},G=async()=>{Z("");try{const B=await i3(y);localStorage.setItem("token",B.token),localStorage.setItem("role","vendor"),t(""),c(""),A(""),o(""),s(""),console.log("data: "+B),B&&e("/vendor/store")}catch(B){console.error("Registration failed",B),Z(B.response?.data?.message)}};return p.jsxs("div",{style:r3,children:[p.jsxs("div",{children:[p.jsx("h1",{style:{...nG,fontSize:"30px",margin:0},children:"Register Your Business"}),p.jsx("center",{children:p.jsx("h3",{style:{...nG,margin:0},children:"Welcome to the Block Party!"})})]}),p.jsx("div",{style:a3,children:p.jsxs(st,{component:"section",sx:{p:2,border:1,borderRadius:2},style:c3,children:[p.jsx(yg,{id:"outlined-basic",label:"Business Name",variant:"outlined",onChange:B=>t(B.target.value),value:g}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"First Name",variant:"outlined",onChange:B=>o(B.target.value),value:I}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"Last Name",variant:"outlined",onChange:B=>s(B.target.value),value:C}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-basic",label:"Email",variant:"outlined",onChange:B=>c(B.target.value),value:r}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-password-input",label:"Password",type:"password",autoComplete:"current-password",onChange:B=>A(B.target.value),value:d}),p.jsx("br",{}),p.jsx(_e,{variant:"contained",sx:{color:"white",backgroundColor:"#ff2400"},onClick:()=>G(),children:"Submit"}),p.jsx(_e,{size:"small",sx:{color:"#ff2400"},onClick:()=>e("/vendor/login"),children:"Log in"}),m&&p.jsx("p",{style:{color:"red",marginTop:"10px"},children:m})]})})]})},r3={position:"relative",width:"100vw",height:"100vh",margin:"0 auto",color:"white",display:"flex",gap:"50px",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#FF5F00"},a3={position:"relative",margin:"0 auto",display:"flex",justifyContent:"center",alignItems:"center"},c3={display:"flex",flexDirection:"column",gap:"5px",padding:"32px",background:"#fff",borderRadius:"8px",borderWidth:"3px",borderColor:"#ff2400",width:"300px"},nG={textShadow:`
        -1px -1px 0 #ff2400,  
        1px -1px 0 #ff2400,
        -1px  1px 0 #ff2400,
        1px  1px 0 #ff2400
    `},d3="https://pilot-hestia-backend.onrender.com",A3=async e=>{try{return(await We.post(`${d3}/api/vendor/login`,e)).data}catch(g){throw console.error("Login failed",g),g}},u3=()=>{const e=Qn(),[g,t]=b.useState([]),[I,o]=b.useState([]),[C,s]=b.useState([]),r={email:g,password:I},c=async d=>{s("");try{const A=await A3(d);localStorage.setItem("token",A.token),localStorage.setItem("role","vendor"),t(""),o(""),A&&e("/vendor/store")}catch(A){console.error("login failed",A),s(A.message||"Log in failed")}};return p.jsxs("div",{style:m3,children:[p.jsxs("div",{children:[p.jsx("h1",{style:{...IG,fontSize:"30px",margin:0},children:"Log In to Your Business"}),p.jsx("center",{children:p.jsx("h3",{style:{...IG,margin:0},children:"Enter the Block Party"})})]}),p.jsx("div",{style:h3,children:p.jsxs(st,{component:"section",sx:{p:2,border:1,borderRadius:2},style:p3,children:[p.jsx(yg,{id:"outlined-basic",label:"Email",variant:"outlined",onChange:d=>t(d.target.value),value:g}),p.jsx("br",{}),p.jsx(yg,{id:"outlined-password-input",label:"Password",type:"password",autoComplete:"current-password",onChange:d=>o(d.target.value),value:I}),p.jsx("br",{}),p.jsx(_e,{variant:"contained",sx:{color:"white",backgroundColor:"#ff2400"},onClick:()=>c(r),children:"Submit"}),p.jsx(_e,{size:"small",sx:{color:"#ff2400"},onClick:()=>e("/vendor/register"),children:"Register"}),C&&p.jsx("p",{style:{color:"red",marginTop:"10px"},children:C})]})})]})},m3={position:"relative",width:"100vw",height:"100vh",margin:"0 auto",display:"flex",gap:"50px",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#FF5F00"},h3={position:"relative",margin:"0 auto",display:"flex",justifyContent:"center",alignItems:"center"},p3={display:"flex",flexDirection:"column",gap:"5px",padding:"32px",background:"#fff",borderRadius:"8px",boxShadow:"0 0 10px rgba(0,0,0,0.1)",borderWidth:"3px",borderColor:"#ff2400",width:"300px"},IG={color:"white",textShadow:`
    -1px -1px 0 #ff2400,  
     1px -1px 0 #ff2400,
    -1px  1px 0 #ff2400,
     1px  1px 0 #ff2400
  `},Z3="https://pilot-hestia-backend.onrender.com",Tf=()=>{const{logout:e}=b.useContext(jC),g=Qn(),[t,I]=b.useState(null),o=!!t,C=c=>{I(c.currentTarget)},s=c=>{I(null),g(c)},r=async c=>{try{await We.post(`${Z3}/api/auth/logout`)||console.error("couldn't log out"),e(),We.defaults.headers.common.Authorization="",g(c)}catch(d){console.log(d)}};return p.jsx("div",{id:"nav",style:b3,children:p.jsxs("div",{children:[p.jsx(_e,{id:"basic-button","aria-controls":o?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":o?"true":void 0,onClick:C,children:p.jsx(Yy,{sx:{color:"white"}})}),p.jsxs($A,{id:"basic-menu",anchorEl:t,open:o,onClose:()=>s(),slotProps:{list:{"aria-labelledby":"basic-button"}},children:[p.jsxs(ht,{onClick:()=>s("/vendor/store"),children:[p.jsx(FH,{fontSize:"small"})," Store"]}),p.jsxs(ht,{onClick:()=>s("/vendor/rewards"),children:[" ",p.jsx(wH,{fontSize:"small"})," Purchased Rewards"]}),p.jsx(ht,{onClick:()=>r("/vendor/login"),style:{color:"red"},children:"Logout"})]})]})})},b3={width:"100%",display:"flex",alignItems:"center",position:"sticky",top:0,zIndex:10,backgroundColor:"#ff2400",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",justifyContent:"space-between"},G3="https://pilot-hestia-backend.onrender.com",y3=({id:e})=>{const g=["xs","s","m","l","xl","xxl"],[t,I]=b.useState(null),o=c=>I(c),C=()=>I(null),s=async c=>{try{const d={reward_id:e,sizeKey:c,value:!1},A=await We.put(`${G3}/api/rewards/update/size`,d);console.log("Updated size:",A.data),C()}catch(d){console.error("Error updating size",d)}},r={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:250,bgcolor:"background.paper",color:"black",borderRadius:"5px",boxShadow:24,p:4,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center"};return p.jsx(Rt,{container:!0,rowSpacing:1,columnSpacing:{xs:2,sm:8,md:8},children:g.map(c=>p.jsxs(Rt,{item:!0,xs:4,children:[" ",p.jsx(_e,{variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"10px",fontWeight:600},onClick:()=>o(c),children:c.toUpperCase()}),p.jsx(nl,{open:t===c,onClose:C,children:p.jsxs(st,{sx:r,children:[p.jsxs(yt,{variant:"h6",component:"h2",sx:{marginBottom:"1em",color:"black"},children:["Are you sure you want to disable ",c.toUpperCase(),"?"]}),p.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"1em"},children:[p.jsx(_e,{onClick:()=>s(c),variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",fontWeight:600},children:"Yes"}),p.jsx(_e,{onClick:C,variant:"outlined",sx:{fontWeight:600},children:"Cancel"})]})]})})]},c))})},Bs="https://pilot-hestia-backend.onrender.com",B3=()=>{const[e,g]=b.useState(null),[t,I]=b.useState(null);b.useEffect(()=>{(async()=>{const r=localStorage.getItem("token");try{const c=await We.get(`${Bs}/api/vendor/`,{headers:{Authorization:`Bearer ${r}`}});g(c?.data),console.log(c?.data)}catch{console.error("Unable to get vendor");return}})()},[]),b.useEffect(()=>{(async()=>{try{if(e?.id){const r=await We.get(`${Bs}/api/rewards/${e?.id}`);I(r?.data)}console.log(e?.id)}catch{console.error("Could't get rewards")}})()},[e?.id]);const o=async s=>{let r="";console.log("this is the preview: "+s);try{const c=new FormData;if(c.append("image",s),r=(await We.post(`${Bs}/api/upload`,c,{headers:{"Content-Type":"multipart/form-data"}}))?.data?.imageUrl,!r)throw new Error("No image URL returned from server");console.log("Uploaded Image URL:",r)}catch(c){console.error("Upload failed",c);return}try{const c={img:r};console.log(c);const d=await We.put(`${Bs}/api/vendor/${e.id}/image`,c);if(d.status!==200&&d.status!==201)throw new Error("Failed to set image");alert("Image set!")}catch{console.error("Error occured while setting image")}};return p.jsxs("div",{style:f3,children:[p.jsx(Tf,{}),p.jsx("h2",{style:{...S3,color:"black",textAlign:"center"},children:"Click to set an image for your business"}),p.jsx("div",{className:"flex-container",children:p.jsx(eu,{img:e?.img,business_name:e?.business_name,onUpload:o})}),p.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:p.jsx(Rt,{container:!0,spacing:3,style:{marginTop:"2em",maxWidth:"90%"},children:t?.map((s,r)=>p.jsx(Rt,{item:!0,xs:12,sm:6,md:4,children:p.jsxs(Mu,{sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:"1em",borderRadius:3,boxShadow:"0 0 5px #FF5F00",minHeight:120,gap:2},children:[p.jsx(Lu,{component:"img",image:s?.img,alt:s?.title,sx:{width:100,height:100,objectFit:"cover",borderRadius:2}}),p.jsxs(Uu,{sx:{flex:1,padding:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[p.jsx(yt,{variant:"subtitle1",sx:{fontWeight:600},children:s?.title}),p.jsxs(yt,{variant:"body2",sx:{marginBottom:1},children:["Quantity: ",s?.quantity]}),p.jsx(y3,{id:s?.id})]})]})},r))})})]})},f3={width:"100vw"},S3={display:"flex",alignItems:"center",justifyContent:"center"},V3="https://pilot-hestia-backend.onrender.com",W3=({order_number:e,first_name:g,last_name:t,title:I,size:o,discount:C,cost:s})=>{const[r,c]=b.useState(null),d=s*(1-C/100)/100,A=async()=>{try{const m=await We.put(`${V3}/api/rewards/redeem`,{code:r});console.log(m?.message)}catch(m){console.log("error:",m.message)}};return p.jsxs("div",{style:R3,children:[p.jsxs("div",{style:X3,children:[p.jsxs("h3",{style:k3,children:["Order: #",String(e).padStart(3,"0")]}),p.jsxs("div",{style:fs,children:[p.jsx("h3",{style:AI,children:"Name:"}),p.jsxs("p",{style:AI,children:[g," ",t]})]}),p.jsxs("div",{style:fs,children:[p.jsx("h3",{style:AI,children:"Item:"}),p.jsx("p",{style:AI,children:I})]}),p.jsxs("div",{children:[p.jsxs("div",{style:fs,children:[p.jsx("h3",{style:AI,children:"Discounted Price:"}),p.jsxs("p",{style:AI,children:["$",d]})]}),p.jsxs("div",{style:fs,children:[p.jsx("h3",{style:AI,children:"Size: "}),p.jsx("p",{style:AI,children:o?.toUpperCase()})]})]})]}),p.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[p.jsx(yg,{onChange:m=>c(m.target.value),id:"outlined-basic",label:"code",variant:"outlined"}),p.jsx(_e,{onClick:A,variant:"contained",sx:{backgroundColor:"#ff2400",color:"white",marginTop:"12px",fontWeight:600},children:"Submit"})]})]})},R3={width:250,borderRadius:"5px",color:"black",padding:15,border:"3px solid #FF5F00",radius:"15px",marginBottom:"1rem"},fs={display:"flex",flexDirection:"row",gap:"2px"},X3={justifyContent:"flex-start",alignItems:"flex-start",fontSize:25,marginTop:0,marginBottom:10,padding:0},AI={margin:0,padding:0,textAlign:"left",fontSize:17},k3={marginTop:0,marginBottom:5,padding:0,textAlign:"center",fontSize:20},J3="https://pilot-hestia-backend.onrender.com",v3=()=>{const[e,g]=b.useState(!1),[t,I]=b.useState([]),[o,C]=b.useState(null),s=b.useRef(new Set),r=localStorage.getItem("token");b.useEffect(()=>{if(!r)return;let d;try{d=or(r)}catch(Z){console.error("Invalid token",Z);return}const A=d?.id;if(!A){console.warn("Vendor ID missing in token");return}const m=()=>{console.log("connected"),ot.emit("register_vendor",{vendorId:A})};return ot.on("connect",m),ot.on("registered_vendor",({vendorId:Z})=>{ot.emit("join_vendor_room",{vendorId:Z})}),ot.on("new_coupon",Z=>{s.current.has(Z?.order_number)||(s.current.add(Z?.order_number),console.log("live coupon:",Z),I(y=>[...y,Z]))}),ot.on("join_receipt_room",({room:Z})=>{const y={room:Z,role:"vendor"};ot.emit("request_join_receipt_room",y)}),ot.on("show_receipt",Z=>{C(Z),console.log(Z)}),()=>{ot.off("connect",m)}},[r]),b.useEffect(()=>{o&&(console.log("Receipt received:",o),g(!0))},[o]);const c=()=>{g(!1),C(null)};return b.useEffect(()=>{if(!r||o!==null)return;(async()=>{try{const A=await We.get(`${J3}/api/rewards/vendor/coupon`,{headers:{Authorization:`Bearer ${r}`}});I(A?.data),console.log("coupons",A?.data)}catch(A){console.log("Error fetching profile data:",A)}})()},[r,o]),p.jsxs("div",{style:Y3,children:[p.jsx(Tf,{}),p.jsx("h1",{style:{color:"black",textAlign:"center",fontSize:32},children:"Discounted Rewards"}),p.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[p.jsx(nl,{open:!!o,onClose:()=>c,children:p.jsx(st,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,width:300},children:p.jsxs("div",{style:{marginTop:0,color:"black"},children:[p.jsx("h2",{style:{marginTop:0,color:"black"},children:"Receipt"}),p.jsxs("p",{children:[p.jsx("strong",{children:"Order:"})," ",o?.order_number]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Customer:"})," ",o?.user_name]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Vendor Business:"})," ",o?.business_name]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Vendor Name:"})," ",o?.vendor_name]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Title:"})," ",o?.reward_title]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Embers Spent:"})," ",o?.spent]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Remaining Price"})," ",o?.remaining_USD]}),p.jsx("button",{onClick:()=>C(null),children:"Close"})]})})}),t?.filter(d=>d.status==="pending").map((d,A)=>p.jsx(W3,{order_number:d?.order_number,first_name:d?.first_name,last_name:d?.last_name,title:d?.reward_title,size:d?.size,discount:d?.discount,cost:d?.cost},A))]})]})},Y3={width:"100vw"};function H3(){return p.jsx(rR,{children:p.jsxs(EW,{children:[p.jsx($t,{path:"/vendor/rewards",element:p.jsx(v3,{})}),p.jsx($t,{path:"/vendor/store",element:p.jsx(B3,{})}),p.jsx($t,{path:"/vendor/login",element:p.jsx(u3,{})}),p.jsx($t,{path:"/vendor/register",element:p.jsx(s3,{})}),p.jsx($t,{path:"/member",element:p.jsx(q5,{})}),p.jsx($t,{path:"/rewards",element:p.jsx(l3,{})}),p.jsx($t,{path:"/profile",element:p.jsx(Px,{})}),p.jsx($t,{path:"/home",element:p.jsx(R1,{})}),p.jsx($t,{path:"/",element:p.jsx(E9,{})}),p.jsx($t,{path:"/register",element:p.jsx(Q9,{})})]})})}const w3="https://pilot-hestia-backend.onrender.com",F3=({children:e})=>{const[g,t]=b.useState(null),[I,o]=b.useState(()=>localStorage.getItem("isMember")==="true"),[C,s]=b.useState(()=>localStorage.getItem("isAdmin")==="true"),[r,c]=b.useState(()=>localStorage.getItem("userRole")||null);b.useEffect(()=>{const Z=localStorage.getItem("token");if(Z)try{const y=or(Z);t(y)}catch(y){console.error("Invalid token:",y),localStorage.removeItem("token"),t(null)}},[]);const d=async Z=>{try{const y=await We.post(`${w3}/api/validate`,{passcode:Z});console.log("ran"),y?.data?.valid&&(y.data.role==="member"&&(o(!0),localStorage.setItem("isMember","true")),y.data.role==="admin"&&(s(!0),localStorage.setItem("isAdmin","true")),c(y.data.role),localStorage.setItem("userRole",y.data.role),console.log("User role:",y.data.role))}catch(y){console.error("Validation error",y),alert("Something went wrong.")}},A=Z=>{localStorage.setItem("token",Z);const y=or(Z);t(y)},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("isMember"),localStorage.removeItem("isAdmin"),localStorage.removeItem("userRole"),localStorage.removeItem("role"),o(!1),s(!1),c(null),t(null)};return p.jsx(jC.Provider,{value:{user:g,login:A,logout:m,isMember:I,isAdmin:C,userRole:r,memberPasscodeValidationClick:d},children:e})},K3=({children:e})=>{const[g,t]=b.useState(null),I=o=>{t(o)};return p.jsx(gu.Provider,{value:{selectedVendorId:g,setSelectedVendorId:t,handleVendorClick:I},children:e})},N3=b.createContext(),x3=({children:e})=>p.jsx(N3.Provider,{value:{},children:e});PV.createRoot(document.getElementById("root")).render(p.jsx(F3,{children:p.jsx(tn.StrictMode,{children:p.jsx(x3,{children:p.jsx(K3,{children:p.jsx(H3,{})})})})}));
